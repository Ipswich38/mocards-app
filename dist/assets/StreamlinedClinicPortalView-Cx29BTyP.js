import{c as X,u as k,j as e,a as f,t as h}from"./index-C7D83qeo.js";import{r as c}from"./charts-sad3owxz.js";import{a as g}from"./data-BaVw-MiH.js";import{a as j,e as F,f as $,g as b,h as y,d as v,U as w,c as R,P as O,i as U}from"./icons-Dcms2sEL.js";import"./vendor-N--QU9DW.js";import"./database-BUiByx9r.js";import"./supabase-BYaNx0mI.js";function z(){const{isAuthenticated:A,login:C,logout:S}=X(),[n,u]=c.useState(null),[l,p]=c.useState({username:"",password:""}),[d,m]=c.useState([]),[P,N]=c.useState(!1),{addToast:r}=k();c.useEffect(()=>{(async()=>{if(n)try{N(!0);const i=(await g.getByClinicId(n.id)).map(t=>({id:t.id,cardControlNumber:t.cardControlNumber,patientName:t.patientName,patientEmail:t.patientEmail,patientPhone:t.patientPhone,preferredDate:t.preferredDate,preferredTime:t.preferredTime,serviceType:t.serviceType,status:t.status,adminNotes:t.notes,clinicNotes:"",forwardedAt:t.createdAt,processedAt:void 0}));m(i)}catch(a){console.error("Failed to load appointments:",a)}finally{N(!1)}})()},[n]);const D=async s=>{if(s.preventDefault(),l.username&&l.password){const a={id:`clinic_${l.username}`,name:`${l.username} Dental Clinic`,code:l.username.toUpperCase(),address:"123 Clinic Street",phone:"+63 XXX XXX XXXX"};u(a),C("clinic",a),r(f("Welcome",`Logged in to ${a.name}`))}else r(h("Login Failed","Please enter valid credentials"))},L=()=>{S(),u(null),p({username:"",password:""}),m([])},E=async s=>{const a=prompt("Add any notes for the patient (optional):");try{await g.updateStatus(s,"accepted"),m(i=>i.map(t=>t.id===s?{...t,status:"accepted",clinicNotes:a||"",processedAt:new Date().toISOString()}:t)),r(f("Appointment Accepted","Patient will be notified"))}catch{r(h("Error","Failed to accept appointment"))}},T=async s=>{const a=prompt("Please provide a reason for declining:");if(a)try{await g.updateStatus(s,"declined"),m(i=>i.map(t=>t.id===s?{...t,status:"declined",clinicNotes:a,processedAt:new Date().toISOString()}:t)),r(h("Appointment Declined","Patient will be notified"))}catch{r(h("Error","Failed to decline appointment"))}};if(!A)return e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsxs("div",{className:"light-card p-8 w-full max-w-md",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("div",{className:"w-16 h-16 bg-blue-100 rounded-2xl flex items-center justify-center mx-auto mb-4",children:e.jsx(j,{className:"h-8 w-8 text-blue-600"})}),e.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Clinic Portal"}),e.jsx("p",{className:"text-gray-600",children:"Login to manage your appointment requests"})]}),e.jsxs("form",{onSubmit:D,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Clinic Code"}),e.jsx("input",{type:"text",value:l.username,onChange:s=>p({...l,username:s.target.value}),className:"light-input",placeholder:"Enter your clinic code",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Password"}),e.jsx("input",{type:"password",value:l.password,onChange:s=>p({...l,password:s.target.value}),className:"light-input",placeholder:"Enter your password",required:!0})]}),e.jsxs("button",{type:"submit",className:"light-button-primary w-full flex items-center justify-center",children:[e.jsx(F,{className:"h-4 w-4 mr-2"}),"Access Clinic Portal"]})]})]})});if(!n||P)return e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsxs("div",{className:"light-card p-8 w-full max-w-md text-center",children:[e.jsx("div",{className:"w-16 h-16 bg-blue-100 rounded-2xl flex items-center justify-center mx-auto mb-4",children:e.jsx(j,{className:"h-8 w-8 text-blue-600"})}),e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-2 border-blue-200 border-t-blue-600 mx-auto mb-4"}),e.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Loading Clinic Portal"}),e.jsx("p",{className:"text-gray-600",children:"Loading your appointment requests..."})]})});const o=d.filter(s=>s.status==="pending"),x=d.filter(s=>s.status!=="pending");return e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx("div",{className:"light-card mb-6",children:e.jsx("div",{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"w-12 h-12 bg-blue-100 rounded-2xl flex items-center justify-center",children:e.jsx(j,{className:"h-6 w-6 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:n.name}),e.jsxs("p",{className:"text-sm text-gray-600",children:[n.address," â€¢ ",n.phone]})]})]}),e.jsxs("button",{onClick:L,className:"light-button-secondary flex items-center space-x-2",children:[e.jsx($,{className:"h-4 w-4"}),e.jsx("span",{children:"Logout"})]})]})})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-6",children:[e.jsx("div",{className:"light-card p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-12 h-12 bg-yellow-100 rounded-xl flex items-center justify-center",children:e.jsx(b,{className:"h-6 w-6 text-yellow-600"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:o.length}),e.jsx("p",{className:"text-sm text-gray-600",children:"Pending Requests"})]})]})}),e.jsx("div",{className:"light-card p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-12 h-12 bg-green-100 rounded-xl flex items-center justify-center",children:e.jsx(y,{className:"h-6 w-6 text-green-600"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:x.filter(s=>s.status==="accepted").length}),e.jsx("p",{className:"text-sm text-gray-600",children:"Accepted"})]})]})}),e.jsx("div",{className:"light-card p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-12 h-12 bg-blue-100 rounded-xl flex items-center justify-center",children:e.jsx(v,{className:"h-6 w-6 text-blue-600"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:d.length}),e.jsx("p",{className:"text-sm text-gray-600",children:"Total Requests"})]})]})})]}),o.length>0&&e.jsx("div",{className:"light-card mb-6",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("h2",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[e.jsx(b,{className:"h-5 w-5 mr-2 text-yellow-600"}),"Pending Appointment Requests (",o.length,")"]}),e.jsx("div",{className:"space-y-4",children:o.map(s=>e.jsxs("div",{className:"border border-yellow-200 rounded-xl p-6 bg-yellow-50",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center",children:e.jsx(w,{className:"h-5 w-5 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium text-gray-900",children:s.patientName}),e.jsx("p",{className:"text-sm text-gray-600",children:s.cardControlNumber})]})]}),e.jsx("span",{className:"px-3 py-1 rounded-full text-sm font-medium bg-yellow-100 text-yellow-800",children:s.status})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Date"}),e.jsx("p",{className:"font-medium",children:new Date(s.preferredDate).toLocaleDateString()})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Time"}),e.jsx("p",{className:"font-medium",children:s.preferredTime})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Service"}),e.jsx("p",{className:"font-medium",children:s.serviceType})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Phone"}),e.jsx("p",{className:"font-medium",children:s.patientPhone})]})]}),s.adminNotes&&e.jsx("div",{className:"bg-blue-50 p-3 rounded-lg mb-4",children:e.jsxs("p",{className:"text-sm text-blue-800",children:[e.jsx("strong",{children:"Admin Notes:"})," ",s.adminNotes]})}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:()=>E(s.id),className:"flex items-center space-x-2 px-4 py-2 bg-green-100 text-green-700 rounded-lg hover:bg-green-200 transition-colors",children:[e.jsx(y,{className:"h-4 w-4"}),e.jsx("span",{children:"Accept"})]}),e.jsxs("button",{onClick:()=>T(s.id),className:"flex items-center space-x-2 px-4 py-2 bg-red-100 text-red-700 rounded-lg hover:bg-red-200 transition-colors",children:[e.jsx(R,{className:"h-4 w-4"}),e.jsx("span",{children:"Decline"})]}),e.jsxs("a",{href:`tel:${s.patientPhone}`,className:"flex items-center space-x-2 px-4 py-2 bg-blue-100 text-blue-700 rounded-lg hover:bg-blue-200 transition-colors",children:[e.jsx(O,{className:"h-4 w-4"}),e.jsx("span",{children:"Call"})]}),e.jsxs("a",{href:`mailto:${s.patientEmail}`,className:"flex items-center space-x-2 px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors",children:[e.jsx(U,{className:"h-4 w-4"}),e.jsx("span",{children:"Email"})]})]}),e.jsxs("div",{className:"text-xs text-gray-500 mt-4",children:["Forwarded: ",new Date(s.forwardedAt).toLocaleString()]})]},s.id))})]})}),x.length>0&&e.jsx("div",{className:"light-card",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:["Recent Processed Appointments (",x.length,")"]}),e.jsx("div",{className:"space-y-3",children:x.slice(0,5).map(s=>e.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-8 h-8 bg-gray-100 rounded-full flex items-center justify-center",children:e.jsx(w,{className:"h-4 w-4 text-gray-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-900",children:s.patientName}),e.jsx("p",{className:"text-sm text-gray-600",children:s.serviceType})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${s.status==="accepted"?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:s.status}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:s.processedAt&&new Date(s.processedAt).toLocaleDateString()})]})]}),s.clinicNotes&&e.jsxs("div",{className:"mt-2 text-sm text-gray-600 bg-gray-50 p-2 rounded",children:[e.jsx("strong",{children:"Notes:"})," ",s.clinicNotes]})]},s.id))})]})}),d.length===0&&e.jsx("div",{className:"light-card",children:e.jsxs("div",{className:"p-12 text-center",children:[e.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx(v,{className:"h-8 w-8 text-gray-400"})}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No Appointments Yet"}),e.jsxs("p",{className:"text-gray-600",children:["No appointment requests have been forwarded to your clinic.",e.jsx("br",{}),"When patients request appointments, they will appear here."]})]})})]})}export{z as StreamlinedClinicPortalView};
