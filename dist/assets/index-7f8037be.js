var jm=Object.defineProperty;var Nm=(t,e,r)=>e in t?jm(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r;var rr=(t,e,r)=>(Nm(t,typeof e!="symbol"?e+"":e,r),r);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const a of s)if(a.type==="childList")for(const o of a.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function r(s){const a={};return s.integrity&&(a.integrity=s.integrity),s.referrerPolicy&&(a.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?a.credentials="include":s.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function n(s){if(s.ep)return;s.ep=!0;const a=r(s);fetch(s.href,a)}})();function km(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var Pd={exports:{}},ga={},Rd={exports:{}},K={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Gs=Symbol.for("react.element"),Sm=Symbol.for("react.portal"),Cm=Symbol.for("react.fragment"),Em=Symbol.for("react.strict_mode"),Am=Symbol.for("react.profiler"),Tm=Symbol.for("react.provider"),Pm=Symbol.for("react.context"),Rm=Symbol.for("react.forward_ref"),Om=Symbol.for("react.suspense"),Im=Symbol.for("react.memo"),Dm=Symbol.for("react.lazy"),Lc=Symbol.iterator;function $m(t){return t===null||typeof t!="object"?null:(t=Lc&&t[Lc]||t["@@iterator"],typeof t=="function"?t:null)}var Od={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Id=Object.assign,Dd={};function Mn(t,e,r){this.props=t,this.context=e,this.refs=Dd,this.updater=r||Od}Mn.prototype.isReactComponent={};Mn.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};Mn.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function $d(){}$d.prototype=Mn.prototype;function Ol(t,e,r){this.props=t,this.context=e,this.refs=Dd,this.updater=r||Od}var Il=Ol.prototype=new $d;Il.constructor=Ol;Id(Il,Mn.prototype);Il.isPureReactComponent=!0;var Uc=Array.isArray,Ld=Object.prototype.hasOwnProperty,Dl={current:null},Ud={key:!0,ref:!0,__self:!0,__source:!0};function Md(t,e,r){var n,s={},a=null,o=null;if(e!=null)for(n in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(a=""+e.key),e)Ld.call(e,n)&&!Ud.hasOwnProperty(n)&&(s[n]=e[n]);var l=arguments.length-2;if(l===1)s.children=r;else if(1<l){for(var c=Array(l),u=0;u<l;u++)c[u]=arguments[u+2];s.children=c}if(t&&t.defaultProps)for(n in l=t.defaultProps,l)s[n]===void 0&&(s[n]=l[n]);return{$$typeof:Gs,type:t,key:a,ref:o,props:s,_owner:Dl.current}}function Lm(t,e){return{$$typeof:Gs,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function $l(t){return typeof t=="object"&&t!==null&&t.$$typeof===Gs}function Um(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(r){return e[r]})}var Mc=/\/+/g;function Ma(t,e){return typeof t=="object"&&t!==null&&t.key!=null?Um(""+t.key):e.toString(36)}function Ci(t,e,r,n,s){var a=typeof t;(a==="undefined"||a==="boolean")&&(t=null);var o=!1;if(t===null)o=!0;else switch(a){case"string":case"number":o=!0;break;case"object":switch(t.$$typeof){case Gs:case Sm:o=!0}}if(o)return o=t,s=s(o),t=n===""?"."+Ma(o,0):n,Uc(s)?(r="",t!=null&&(r=t.replace(Mc,"$&/")+"/"),Ci(s,e,r,"",function(u){return u})):s!=null&&($l(s)&&(s=Lm(s,r+(!s.key||o&&o.key===s.key?"":(""+s.key).replace(Mc,"$&/")+"/")+t)),e.push(s)),1;if(o=0,n=n===""?".":n+":",Uc(t))for(var l=0;l<t.length;l++){a=t[l];var c=n+Ma(a,l);o+=Ci(a,e,r,c,s)}else if(c=$m(t),typeof c=="function")for(t=c.call(t),l=0;!(a=t.next()).done;)a=a.value,c=n+Ma(a,l++),o+=Ci(a,e,r,c,s);else if(a==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function si(t,e,r){if(t==null)return t;var n=[],s=0;return Ci(t,n,"","",function(a){return e.call(r,a,s++)}),n}function Mm(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(r){(t._status===0||t._status===-1)&&(t._status=1,t._result=r)},function(r){(t._status===0||t._status===-1)&&(t._status=2,t._result=r)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var Ve={current:null},Ei={transition:null},zm={ReactCurrentDispatcher:Ve,ReactCurrentBatchConfig:Ei,ReactCurrentOwner:Dl};function zd(){throw Error("act(...) is not supported in production builds of React.")}K.Children={map:si,forEach:function(t,e,r){si(t,function(){e.apply(this,arguments)},r)},count:function(t){var e=0;return si(t,function(){e++}),e},toArray:function(t){return si(t,function(e){return e})||[]},only:function(t){if(!$l(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};K.Component=Mn;K.Fragment=Cm;K.Profiler=Am;K.PureComponent=Ol;K.StrictMode=Em;K.Suspense=Om;K.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=zm;K.act=zd;K.cloneElement=function(t,e,r){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var n=Id({},t.props),s=t.key,a=t.ref,o=t._owner;if(e!=null){if(e.ref!==void 0&&(a=e.ref,o=Dl.current),e.key!==void 0&&(s=""+e.key),t.type&&t.type.defaultProps)var l=t.type.defaultProps;for(c in e)Ld.call(e,c)&&!Ud.hasOwnProperty(c)&&(n[c]=e[c]===void 0&&l!==void 0?l[c]:e[c])}var c=arguments.length-2;if(c===1)n.children=r;else if(1<c){l=Array(c);for(var u=0;u<c;u++)l[u]=arguments[u+2];n.children=l}return{$$typeof:Gs,type:t.type,key:s,ref:a,props:n,_owner:o}};K.createContext=function(t){return t={$$typeof:Pm,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:Tm,_context:t},t.Consumer=t};K.createElement=Md;K.createFactory=function(t){var e=Md.bind(null,t);return e.type=t,e};K.createRef=function(){return{current:null}};K.forwardRef=function(t){return{$$typeof:Rm,render:t}};K.isValidElement=$l;K.lazy=function(t){return{$$typeof:Dm,_payload:{_status:-1,_result:t},_init:Mm}};K.memo=function(t,e){return{$$typeof:Im,type:t,compare:e===void 0?null:e}};K.startTransition=function(t){var e=Ei.transition;Ei.transition={};try{t()}finally{Ei.transition=e}};K.unstable_act=zd;K.useCallback=function(t,e){return Ve.current.useCallback(t,e)};K.useContext=function(t){return Ve.current.useContext(t)};K.useDebugValue=function(){};K.useDeferredValue=function(t){return Ve.current.useDeferredValue(t)};K.useEffect=function(t,e){return Ve.current.useEffect(t,e)};K.useId=function(){return Ve.current.useId()};K.useImperativeHandle=function(t,e,r){return Ve.current.useImperativeHandle(t,e,r)};K.useInsertionEffect=function(t,e){return Ve.current.useInsertionEffect(t,e)};K.useLayoutEffect=function(t,e){return Ve.current.useLayoutEffect(t,e)};K.useMemo=function(t,e){return Ve.current.useMemo(t,e)};K.useReducer=function(t,e,r){return Ve.current.useReducer(t,e,r)};K.useRef=function(t){return Ve.current.useRef(t)};K.useState=function(t){return Ve.current.useState(t)};K.useSyncExternalStore=function(t,e,r){return Ve.current.useSyncExternalStore(t,e,r)};K.useTransition=function(){return Ve.current.useTransition()};K.version="18.3.1";Rd.exports=K;var k=Rd.exports;const Fm=km(k);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Bm=k,qm=Symbol.for("react.element"),Vm=Symbol.for("react.fragment"),Wm=Object.prototype.hasOwnProperty,Hm=Bm.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Km={key:!0,ref:!0,__self:!0,__source:!0};function Fd(t,e,r){var n,s={},a=null,o=null;r!==void 0&&(a=""+r),e.key!==void 0&&(a=""+e.key),e.ref!==void 0&&(o=e.ref);for(n in e)Wm.call(e,n)&&!Km.hasOwnProperty(n)&&(s[n]=e[n]);if(t&&t.defaultProps)for(n in e=t.defaultProps,e)s[n]===void 0&&(s[n]=e[n]);return{$$typeof:qm,type:t,key:a,ref:o,props:s,_owner:Hm.current}}ga.Fragment=Vm;ga.jsx=Fd;ga.jsxs=Fd;Pd.exports=ga;var i=Pd.exports,ko={},Bd={exports:{}},ot={},qd={exports:{}},Vd={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(T,$){var B=T.length;T.push($);e:for(;0<B;){var X=B-1>>>1,G=T[X];if(0<s(G,$))T[X]=$,T[B]=G,B=X;else break e}}function r(T){return T.length===0?null:T[0]}function n(T){if(T.length===0)return null;var $=T[0],B=T.pop();if(B!==$){T[0]=B;e:for(var X=0,G=T.length,Ne=G>>>1;X<Ne;){var ne=2*(X+1)-1,Ce=T[ne],ct=ne+1,Fe=T[ct];if(0>s(Ce,B))ct<G&&0>s(Fe,Ce)?(T[X]=Fe,T[ct]=B,X=ct):(T[X]=Ce,T[ne]=B,X=ne);else if(ct<G&&0>s(Fe,B))T[X]=Fe,T[ct]=B,X=ct;else break e}}return $}function s(T,$){var B=T.sortIndex-$.sortIndex;return B!==0?B:T.id-$.id}if(typeof performance=="object"&&typeof performance.now=="function"){var a=performance;t.unstable_now=function(){return a.now()}}else{var o=Date,l=o.now();t.unstable_now=function(){return o.now()-l}}var c=[],u=[],f=1,m=null,d=3,y=!1,x=!1,w=!1,C=typeof setTimeout=="function"?setTimeout:null,p=typeof clearTimeout=="function"?clearTimeout:null,g=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function v(T){for(var $=r(u);$!==null;){if($.callback===null)n(u);else if($.startTime<=T)n(u),$.sortIndex=$.expirationTime,e(c,$);else break;$=r(u)}}function b(T){if(w=!1,v(T),!x)if(r(c)!==null)x=!0,je(j);else{var $=r(u);$!==null&&xt(b,$.startTime-T)}}function j(T,$){x=!1,w&&(w=!1,p(P),P=-1),y=!0;var B=d;try{for(v($),m=r(c);m!==null&&(!(m.expirationTime>$)||T&&!V());){var X=m.callback;if(typeof X=="function"){m.callback=null,d=m.priorityLevel;var G=X(m.expirationTime<=$);$=t.unstable_now(),typeof G=="function"?m.callback=G:m===r(c)&&n(c),v($)}else n(c);m=r(c)}if(m!==null)var Ne=!0;else{var ne=r(u);ne!==null&&xt(b,ne.startTime-$),Ne=!1}return Ne}finally{m=null,d=B,y=!1}}var N=!1,S=null,P=-1,W=5,q=-1;function V(){return!(t.unstable_now()-q<W)}function pe(){if(S!==null){var T=t.unstable_now();q=T;var $=!0;try{$=S(!0,T)}finally{$?Tt():(N=!1,S=null)}}else N=!1}var Tt;if(typeof g=="function")Tt=function(){g(pe)};else if(typeof MessageChannel<"u"){var Zt=new MessageChannel,Ie=Zt.port2;Zt.port1.onmessage=pe,Tt=function(){Ie.postMessage(null)}}else Tt=function(){C(pe,0)};function je(T){S=T,N||(N=!0,Tt())}function xt(T,$){P=C(function(){T(t.unstable_now())},$)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(T){T.callback=null},t.unstable_continueExecution=function(){x||y||(x=!0,je(j))},t.unstable_forceFrameRate=function(T){0>T||125<T?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):W=0<T?Math.floor(1e3/T):5},t.unstable_getCurrentPriorityLevel=function(){return d},t.unstable_getFirstCallbackNode=function(){return r(c)},t.unstable_next=function(T){switch(d){case 1:case 2:case 3:var $=3;break;default:$=d}var B=d;d=$;try{return T()}finally{d=B}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(T,$){switch(T){case 1:case 2:case 3:case 4:case 5:break;default:T=3}var B=d;d=T;try{return $()}finally{d=B}},t.unstable_scheduleCallback=function(T,$,B){var X=t.unstable_now();switch(typeof B=="object"&&B!==null?(B=B.delay,B=typeof B=="number"&&0<B?X+B:X):B=X,T){case 1:var G=-1;break;case 2:G=250;break;case 5:G=1073741823;break;case 4:G=1e4;break;default:G=5e3}return G=B+G,T={id:f++,callback:$,priorityLevel:T,startTime:B,expirationTime:G,sortIndex:-1},B>X?(T.sortIndex=B,e(u,T),r(c)===null&&T===r(u)&&(w?(p(P),P=-1):w=!0,xt(b,B-X))):(T.sortIndex=G,e(c,T),x||y||(x=!0,je(j))),T},t.unstable_shouldYield=V,t.unstable_wrapCallback=function(T){var $=d;return function(){var B=d;d=$;try{return T.apply(this,arguments)}finally{d=B}}}})(Vd);qd.exports=Vd;var Gm=qd.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Jm=k,at=Gm;function E(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,r=1;r<arguments.length;r++)e+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var Wd=new Set,bs={};function Qr(t,e){Pn(t,e),Pn(t+"Capture",e)}function Pn(t,e){for(bs[t]=e,t=0;t<e.length;t++)Wd.add(e[t])}var Kt=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),So=Object.prototype.hasOwnProperty,Qm=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,zc={},Fc={};function Ym(t){return So.call(Fc,t)?!0:So.call(zc,t)?!1:Qm.test(t)?Fc[t]=!0:(zc[t]=!0,!1)}function Xm(t,e,r,n){if(r!==null&&r.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function Zm(t,e,r,n){if(e===null||typeof e>"u"||Xm(t,e,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function We(t,e,r,n,s,a,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=n,this.attributeNamespace=s,this.mustUseProperty=r,this.propertyName=t,this.type=e,this.sanitizeURL=a,this.removeEmptyString=o}var Oe={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){Oe[t]=new We(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];Oe[e]=new We(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){Oe[t]=new We(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){Oe[t]=new We(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){Oe[t]=new We(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){Oe[t]=new We(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){Oe[t]=new We(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){Oe[t]=new We(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){Oe[t]=new We(t,5,!1,t.toLowerCase(),null,!1,!1)});var Ll=/[\-:]([a-z])/g;function Ul(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(Ll,Ul);Oe[e]=new We(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(Ll,Ul);Oe[e]=new We(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(Ll,Ul);Oe[e]=new We(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){Oe[t]=new We(t,1,!1,t.toLowerCase(),null,!1,!1)});Oe.xlinkHref=new We("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){Oe[t]=new We(t,1,!1,t.toLowerCase(),null,!0,!0)});function Ml(t,e,r,n){var s=Oe.hasOwnProperty(e)?Oe[e]:null;(s!==null?s.type!==0:n||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(Zm(e,r,s,n)&&(r=null),n||s===null?Ym(e)&&(r===null?t.removeAttribute(e):t.setAttribute(e,""+r)):s.mustUseProperty?t[s.propertyName]=r===null?s.type===3?!1:"":r:(e=s.attributeName,n=s.attributeNamespace,r===null?t.removeAttribute(e):(s=s.type,r=s===3||s===4&&r===!0?"":""+r,n?t.setAttributeNS(n,e,r):t.setAttribute(e,r))))}var Yt=Jm.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,ii=Symbol.for("react.element"),cn=Symbol.for("react.portal"),un=Symbol.for("react.fragment"),zl=Symbol.for("react.strict_mode"),Co=Symbol.for("react.profiler"),Hd=Symbol.for("react.provider"),Kd=Symbol.for("react.context"),Fl=Symbol.for("react.forward_ref"),Eo=Symbol.for("react.suspense"),Ao=Symbol.for("react.suspense_list"),Bl=Symbol.for("react.memo"),sr=Symbol.for("react.lazy"),Gd=Symbol.for("react.offscreen"),Bc=Symbol.iterator;function Wn(t){return t===null||typeof t!="object"?null:(t=Bc&&t[Bc]||t["@@iterator"],typeof t=="function"?t:null)}var he=Object.assign,za;function rs(t){if(za===void 0)try{throw Error()}catch(r){var e=r.stack.trim().match(/\n( *(at )?)/);za=e&&e[1]||""}return`
`+za+t}var Fa=!1;function Ba(t,e){if(!t||Fa)return"";Fa=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(u){var n=u}Reflect.construct(t,[],e)}else{try{e.call()}catch(u){n=u}t.call(e.prototype)}else{try{throw Error()}catch(u){n=u}t()}}catch(u){if(u&&n&&typeof u.stack=="string"){for(var s=u.stack.split(`
`),a=n.stack.split(`
`),o=s.length-1,l=a.length-1;1<=o&&0<=l&&s[o]!==a[l];)l--;for(;1<=o&&0<=l;o--,l--)if(s[o]!==a[l]){if(o!==1||l!==1)do if(o--,l--,0>l||s[o]!==a[l]){var c=`
`+s[o].replace(" at new "," at ");return t.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",t.displayName)),c}while(1<=o&&0<=l);break}}}finally{Fa=!1,Error.prepareStackTrace=r}return(t=t?t.displayName||t.name:"")?rs(t):""}function ep(t){switch(t.tag){case 5:return rs(t.type);case 16:return rs("Lazy");case 13:return rs("Suspense");case 19:return rs("SuspenseList");case 0:case 2:case 15:return t=Ba(t.type,!1),t;case 11:return t=Ba(t.type.render,!1),t;case 1:return t=Ba(t.type,!0),t;default:return""}}function To(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case un:return"Fragment";case cn:return"Portal";case Co:return"Profiler";case zl:return"StrictMode";case Eo:return"Suspense";case Ao:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case Kd:return(t.displayName||"Context")+".Consumer";case Hd:return(t._context.displayName||"Context")+".Provider";case Fl:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case Bl:return e=t.displayName||null,e!==null?e:To(t.type)||"Memo";case sr:e=t._payload,t=t._init;try{return To(t(e))}catch{}}return null}function tp(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return To(e);case 8:return e===zl?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function jr(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function Jd(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function rp(t){var e=Jd(t)?"checked":"value",r=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),n=""+t[e];if(!t.hasOwnProperty(e)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var s=r.get,a=r.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return s.call(this)},set:function(o){n=""+o,a.call(this,o)}}),Object.defineProperty(t,e,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(o){n=""+o},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function ai(t){t._valueTracker||(t._valueTracker=rp(t))}function Qd(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var r=e.getValue(),n="";return t&&(n=Jd(t)?t.checked?"true":"false":t.value),t=n,t!==r?(e.setValue(t),!0):!1}function zi(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function Po(t,e){var r=e.checked;return he({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??t._wrapperState.initialChecked})}function qc(t,e){var r=e.defaultValue==null?"":e.defaultValue,n=e.checked!=null?e.checked:e.defaultChecked;r=jr(e.value!=null?e.value:r),t._wrapperState={initialChecked:n,initialValue:r,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function Yd(t,e){e=e.checked,e!=null&&Ml(t,"checked",e,!1)}function Ro(t,e){Yd(t,e);var r=jr(e.value),n=e.type;if(r!=null)n==="number"?(r===0&&t.value===""||t.value!=r)&&(t.value=""+r):t.value!==""+r&&(t.value=""+r);else if(n==="submit"||n==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?Oo(t,e.type,r):e.hasOwnProperty("defaultValue")&&Oo(t,e.type,jr(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function Vc(t,e,r){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var n=e.type;if(!(n!=="submit"&&n!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,r||e===t.value||(t.value=e),t.defaultValue=e}r=t.name,r!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,r!==""&&(t.name=r)}function Oo(t,e,r){(e!=="number"||zi(t.ownerDocument)!==t)&&(r==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+r&&(t.defaultValue=""+r))}var ns=Array.isArray;function jn(t,e,r,n){if(t=t.options,e){e={};for(var s=0;s<r.length;s++)e["$"+r[s]]=!0;for(r=0;r<t.length;r++)s=e.hasOwnProperty("$"+t[r].value),t[r].selected!==s&&(t[r].selected=s),s&&n&&(t[r].defaultSelected=!0)}else{for(r=""+jr(r),e=null,s=0;s<t.length;s++){if(t[s].value===r){t[s].selected=!0,n&&(t[s].defaultSelected=!0);return}e!==null||t[s].disabled||(e=t[s])}e!==null&&(e.selected=!0)}}function Io(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(E(91));return he({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function Wc(t,e){var r=e.value;if(r==null){if(r=e.children,e=e.defaultValue,r!=null){if(e!=null)throw Error(E(92));if(ns(r)){if(1<r.length)throw Error(E(93));r=r[0]}e=r}e==null&&(e=""),r=e}t._wrapperState={initialValue:jr(r)}}function Xd(t,e){var r=jr(e.value),n=jr(e.defaultValue);r!=null&&(r=""+r,r!==t.value&&(t.value=r),e.defaultValue==null&&t.defaultValue!==r&&(t.defaultValue=r)),n!=null&&(t.defaultValue=""+n)}function Hc(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function Zd(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Do(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?Zd(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var oi,eh=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,r,n,s){MSApp.execUnsafeLocalFunction(function(){return t(e,r,n,s)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(oi=oi||document.createElement("div"),oi.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=oi.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function js(t,e){if(e){var r=t.firstChild;if(r&&r===t.lastChild&&r.nodeType===3){r.nodeValue=e;return}}t.textContent=e}var cs={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},np=["Webkit","ms","Moz","O"];Object.keys(cs).forEach(function(t){np.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),cs[e]=cs[t]})});function th(t,e,r){return e==null||typeof e=="boolean"||e===""?"":r||typeof e!="number"||e===0||cs.hasOwnProperty(t)&&cs[t]?(""+e).trim():e+"px"}function rh(t,e){t=t.style;for(var r in e)if(e.hasOwnProperty(r)){var n=r.indexOf("--")===0,s=th(r,e[r],n);r==="float"&&(r="cssFloat"),n?t.setProperty(r,s):t[r]=s}}var sp=he({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function $o(t,e){if(e){if(sp[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(E(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(E(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(E(61))}if(e.style!=null&&typeof e.style!="object")throw Error(E(62))}}function Lo(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Uo=null;function ql(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var Mo=null,Nn=null,kn=null;function Kc(t){if(t=Ys(t)){if(typeof Mo!="function")throw Error(E(280));var e=t.stateNode;e&&(e=_a(e),Mo(t.stateNode,t.type,e))}}function nh(t){Nn?kn?kn.push(t):kn=[t]:Nn=t}function sh(){if(Nn){var t=Nn,e=kn;if(kn=Nn=null,Kc(t),e)for(t=0;t<e.length;t++)Kc(e[t])}}function ih(t,e){return t(e)}function ah(){}var qa=!1;function oh(t,e,r){if(qa)return t(e,r);qa=!0;try{return ih(t,e,r)}finally{qa=!1,(Nn!==null||kn!==null)&&(ah(),sh())}}function Ns(t,e){var r=t.stateNode;if(r===null)return null;var n=_a(r);if(n===null)return null;r=n[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(t=t.type,n=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!n;break e;default:t=!1}if(t)return null;if(r&&typeof r!="function")throw Error(E(231,e,typeof r));return r}var zo=!1;if(Kt)try{var Hn={};Object.defineProperty(Hn,"passive",{get:function(){zo=!0}}),window.addEventListener("test",Hn,Hn),window.removeEventListener("test",Hn,Hn)}catch{zo=!1}function ip(t,e,r,n,s,a,o,l,c){var u=Array.prototype.slice.call(arguments,3);try{e.apply(r,u)}catch(f){this.onError(f)}}var us=!1,Fi=null,Bi=!1,Fo=null,ap={onError:function(t){us=!0,Fi=t}};function op(t,e,r,n,s,a,o,l,c){us=!1,Fi=null,ip.apply(ap,arguments)}function lp(t,e,r,n,s,a,o,l,c){if(op.apply(this,arguments),us){if(us){var u=Fi;us=!1,Fi=null}else throw Error(E(198));Bi||(Bi=!0,Fo=u)}}function Yr(t){var e=t,r=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(r=e.return),t=e.return;while(t)}return e.tag===3?r:null}function lh(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function Gc(t){if(Yr(t)!==t)throw Error(E(188))}function cp(t){var e=t.alternate;if(!e){if(e=Yr(t),e===null)throw Error(E(188));return e!==t?null:t}for(var r=t,n=e;;){var s=r.return;if(s===null)break;var a=s.alternate;if(a===null){if(n=s.return,n!==null){r=n;continue}break}if(s.child===a.child){for(a=s.child;a;){if(a===r)return Gc(s),t;if(a===n)return Gc(s),e;a=a.sibling}throw Error(E(188))}if(r.return!==n.return)r=s,n=a;else{for(var o=!1,l=s.child;l;){if(l===r){o=!0,r=s,n=a;break}if(l===n){o=!0,n=s,r=a;break}l=l.sibling}if(!o){for(l=a.child;l;){if(l===r){o=!0,r=a,n=s;break}if(l===n){o=!0,n=a,r=s;break}l=l.sibling}if(!o)throw Error(E(189))}}if(r.alternate!==n)throw Error(E(190))}if(r.tag!==3)throw Error(E(188));return r.stateNode.current===r?t:e}function ch(t){return t=cp(t),t!==null?uh(t):null}function uh(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=uh(t);if(e!==null)return e;t=t.sibling}return null}var dh=at.unstable_scheduleCallback,Jc=at.unstable_cancelCallback,up=at.unstable_shouldYield,dp=at.unstable_requestPaint,ge=at.unstable_now,hp=at.unstable_getCurrentPriorityLevel,Vl=at.unstable_ImmediatePriority,hh=at.unstable_UserBlockingPriority,qi=at.unstable_NormalPriority,fp=at.unstable_LowPriority,fh=at.unstable_IdlePriority,ya=null,Lt=null;function mp(t){if(Lt&&typeof Lt.onCommitFiberRoot=="function")try{Lt.onCommitFiberRoot(ya,t,void 0,(t.current.flags&128)===128)}catch{}}var Ct=Math.clz32?Math.clz32:yp,pp=Math.log,gp=Math.LN2;function yp(t){return t>>>=0,t===0?32:31-(pp(t)/gp|0)|0}var li=64,ci=4194304;function ss(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function Vi(t,e){var r=t.pendingLanes;if(r===0)return 0;var n=0,s=t.suspendedLanes,a=t.pingedLanes,o=r&268435455;if(o!==0){var l=o&~s;l!==0?n=ss(l):(a&=o,a!==0&&(n=ss(a)))}else o=r&~s,o!==0?n=ss(o):a!==0&&(n=ss(a));if(n===0)return 0;if(e!==0&&e!==n&&!(e&s)&&(s=n&-n,a=e&-e,s>=a||s===16&&(a&4194240)!==0))return e;if(n&4&&(n|=r&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=n;0<e;)r=31-Ct(e),s=1<<r,n|=t[r],e&=~s;return n}function vp(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function xp(t,e){for(var r=t.suspendedLanes,n=t.pingedLanes,s=t.expirationTimes,a=t.pendingLanes;0<a;){var o=31-Ct(a),l=1<<o,c=s[o];c===-1?(!(l&r)||l&n)&&(s[o]=vp(l,e)):c<=e&&(t.expiredLanes|=l),a&=~l}}function Bo(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function mh(){var t=li;return li<<=1,!(li&4194240)&&(li=64),t}function Va(t){for(var e=[],r=0;31>r;r++)e.push(t);return e}function Js(t,e,r){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-Ct(e),t[e]=r}function wp(t,e){var r=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var n=t.eventTimes;for(t=t.expirationTimes;0<r;){var s=31-Ct(r),a=1<<s;e[s]=0,n[s]=-1,t[s]=-1,r&=~a}}function Wl(t,e){var r=t.entangledLanes|=e;for(t=t.entanglements;r;){var n=31-Ct(r),s=1<<n;s&e|t[n]&e&&(t[n]|=e),r&=~s}}var Y=0;function ph(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var gh,Hl,yh,vh,xh,qo=!1,ui=[],pr=null,gr=null,yr=null,ks=new Map,Ss=new Map,cr=[],_p="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Qc(t,e){switch(t){case"focusin":case"focusout":pr=null;break;case"dragenter":case"dragleave":gr=null;break;case"mouseover":case"mouseout":yr=null;break;case"pointerover":case"pointerout":ks.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Ss.delete(e.pointerId)}}function Kn(t,e,r,n,s,a){return t===null||t.nativeEvent!==a?(t={blockedOn:e,domEventName:r,eventSystemFlags:n,nativeEvent:a,targetContainers:[s]},e!==null&&(e=Ys(e),e!==null&&Hl(e)),t):(t.eventSystemFlags|=n,e=t.targetContainers,s!==null&&e.indexOf(s)===-1&&e.push(s),t)}function bp(t,e,r,n,s){switch(e){case"focusin":return pr=Kn(pr,t,e,r,n,s),!0;case"dragenter":return gr=Kn(gr,t,e,r,n,s),!0;case"mouseover":return yr=Kn(yr,t,e,r,n,s),!0;case"pointerover":var a=s.pointerId;return ks.set(a,Kn(ks.get(a)||null,t,e,r,n,s)),!0;case"gotpointercapture":return a=s.pointerId,Ss.set(a,Kn(Ss.get(a)||null,t,e,r,n,s)),!0}return!1}function wh(t){var e=Mr(t.target);if(e!==null){var r=Yr(e);if(r!==null){if(e=r.tag,e===13){if(e=lh(r),e!==null){t.blockedOn=e,xh(t.priority,function(){yh(r)});return}}else if(e===3&&r.stateNode.current.memoizedState.isDehydrated){t.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}t.blockedOn=null}function Ai(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var r=Vo(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(r===null){r=t.nativeEvent;var n=new r.constructor(r.type,r);Uo=n,r.target.dispatchEvent(n),Uo=null}else return e=Ys(r),e!==null&&Hl(e),t.blockedOn=r,!1;e.shift()}return!0}function Yc(t,e,r){Ai(t)&&r.delete(e)}function jp(){qo=!1,pr!==null&&Ai(pr)&&(pr=null),gr!==null&&Ai(gr)&&(gr=null),yr!==null&&Ai(yr)&&(yr=null),ks.forEach(Yc),Ss.forEach(Yc)}function Gn(t,e){t.blockedOn===e&&(t.blockedOn=null,qo||(qo=!0,at.unstable_scheduleCallback(at.unstable_NormalPriority,jp)))}function Cs(t){function e(s){return Gn(s,t)}if(0<ui.length){Gn(ui[0],t);for(var r=1;r<ui.length;r++){var n=ui[r];n.blockedOn===t&&(n.blockedOn=null)}}for(pr!==null&&Gn(pr,t),gr!==null&&Gn(gr,t),yr!==null&&Gn(yr,t),ks.forEach(e),Ss.forEach(e),r=0;r<cr.length;r++)n=cr[r],n.blockedOn===t&&(n.blockedOn=null);for(;0<cr.length&&(r=cr[0],r.blockedOn===null);)wh(r),r.blockedOn===null&&cr.shift()}var Sn=Yt.ReactCurrentBatchConfig,Wi=!0;function Np(t,e,r,n){var s=Y,a=Sn.transition;Sn.transition=null;try{Y=1,Kl(t,e,r,n)}finally{Y=s,Sn.transition=a}}function kp(t,e,r,n){var s=Y,a=Sn.transition;Sn.transition=null;try{Y=4,Kl(t,e,r,n)}finally{Y=s,Sn.transition=a}}function Kl(t,e,r,n){if(Wi){var s=Vo(t,e,r,n);if(s===null)eo(t,e,n,Hi,r),Qc(t,n);else if(bp(s,t,e,r,n))n.stopPropagation();else if(Qc(t,n),e&4&&-1<_p.indexOf(t)){for(;s!==null;){var a=Ys(s);if(a!==null&&gh(a),a=Vo(t,e,r,n),a===null&&eo(t,e,n,Hi,r),a===s)break;s=a}s!==null&&n.stopPropagation()}else eo(t,e,n,null,r)}}var Hi=null;function Vo(t,e,r,n){if(Hi=null,t=ql(n),t=Mr(t),t!==null)if(e=Yr(t),e===null)t=null;else if(r=e.tag,r===13){if(t=lh(e),t!==null)return t;t=null}else if(r===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return Hi=t,null}function _h(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(hp()){case Vl:return 1;case hh:return 4;case qi:case fp:return 16;case fh:return 536870912;default:return 16}default:return 16}}var fr=null,Gl=null,Ti=null;function bh(){if(Ti)return Ti;var t,e=Gl,r=e.length,n,s="value"in fr?fr.value:fr.textContent,a=s.length;for(t=0;t<r&&e[t]===s[t];t++);var o=r-t;for(n=1;n<=o&&e[r-n]===s[a-n];n++);return Ti=s.slice(t,1<n?1-n:void 0)}function Pi(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function di(){return!0}function Xc(){return!1}function lt(t){function e(r,n,s,a,o){this._reactName=r,this._targetInst=s,this.type=n,this.nativeEvent=a,this.target=o,this.currentTarget=null;for(var l in t)t.hasOwnProperty(l)&&(r=t[l],this[l]=r?r(a):a[l]);return this.isDefaultPrevented=(a.defaultPrevented!=null?a.defaultPrevented:a.returnValue===!1)?di:Xc,this.isPropagationStopped=Xc,this}return he(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=di)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=di)},persist:function(){},isPersistent:di}),e}var zn={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Jl=lt(zn),Qs=he({},zn,{view:0,detail:0}),Sp=lt(Qs),Wa,Ha,Jn,va=he({},Qs,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Ql,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==Jn&&(Jn&&t.type==="mousemove"?(Wa=t.screenX-Jn.screenX,Ha=t.screenY-Jn.screenY):Ha=Wa=0,Jn=t),Wa)},movementY:function(t){return"movementY"in t?t.movementY:Ha}}),Zc=lt(va),Cp=he({},va,{dataTransfer:0}),Ep=lt(Cp),Ap=he({},Qs,{relatedTarget:0}),Ka=lt(Ap),Tp=he({},zn,{animationName:0,elapsedTime:0,pseudoElement:0}),Pp=lt(Tp),Rp=he({},zn,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),Op=lt(Rp),Ip=he({},zn,{data:0}),eu=lt(Ip),Dp={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},$p={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Lp={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Up(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=Lp[t])?!!e[t]:!1}function Ql(){return Up}var Mp=he({},Qs,{key:function(t){if(t.key){var e=Dp[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=Pi(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?$p[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Ql,charCode:function(t){return t.type==="keypress"?Pi(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?Pi(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),zp=lt(Mp),Fp=he({},va,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),tu=lt(Fp),Bp=he({},Qs,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Ql}),qp=lt(Bp),Vp=he({},zn,{propertyName:0,elapsedTime:0,pseudoElement:0}),Wp=lt(Vp),Hp=he({},va,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),Kp=lt(Hp),Gp=[9,13,27,32],Yl=Kt&&"CompositionEvent"in window,ds=null;Kt&&"documentMode"in document&&(ds=document.documentMode);var Jp=Kt&&"TextEvent"in window&&!ds,jh=Kt&&(!Yl||ds&&8<ds&&11>=ds),ru=String.fromCharCode(32),nu=!1;function Nh(t,e){switch(t){case"keyup":return Gp.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function kh(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var dn=!1;function Qp(t,e){switch(t){case"compositionend":return kh(e);case"keypress":return e.which!==32?null:(nu=!0,ru);case"textInput":return t=e.data,t===ru&&nu?null:t;default:return null}}function Yp(t,e){if(dn)return t==="compositionend"||!Yl&&Nh(t,e)?(t=bh(),Ti=Gl=fr=null,dn=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return jh&&e.locale!=="ko"?null:e.data;default:return null}}var Xp={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function su(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!Xp[t.type]:e==="textarea"}function Sh(t,e,r,n){nh(n),e=Ki(e,"onChange"),0<e.length&&(r=new Jl("onChange","change",null,r,n),t.push({event:r,listeners:e}))}var hs=null,Es=null;function Zp(t){Lh(t,0)}function xa(t){var e=mn(t);if(Qd(e))return t}function eg(t,e){if(t==="change")return e}var Ch=!1;if(Kt){var Ga;if(Kt){var Ja="oninput"in document;if(!Ja){var iu=document.createElement("div");iu.setAttribute("oninput","return;"),Ja=typeof iu.oninput=="function"}Ga=Ja}else Ga=!1;Ch=Ga&&(!document.documentMode||9<document.documentMode)}function au(){hs&&(hs.detachEvent("onpropertychange",Eh),Es=hs=null)}function Eh(t){if(t.propertyName==="value"&&xa(Es)){var e=[];Sh(e,Es,t,ql(t)),oh(Zp,e)}}function tg(t,e,r){t==="focusin"?(au(),hs=e,Es=r,hs.attachEvent("onpropertychange",Eh)):t==="focusout"&&au()}function rg(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return xa(Es)}function ng(t,e){if(t==="click")return xa(e)}function sg(t,e){if(t==="input"||t==="change")return xa(e)}function ig(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var At=typeof Object.is=="function"?Object.is:ig;function As(t,e){if(At(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var r=Object.keys(t),n=Object.keys(e);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var s=r[n];if(!So.call(e,s)||!At(t[s],e[s]))return!1}return!0}function ou(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function lu(t,e){var r=ou(t);t=0;for(var n;r;){if(r.nodeType===3){if(n=t+r.textContent.length,t<=e&&n>=e)return{node:r,offset:e-t};t=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=ou(r)}}function Ah(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?Ah(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function Th(){for(var t=window,e=zi();e instanceof t.HTMLIFrameElement;){try{var r=typeof e.contentWindow.location.href=="string"}catch{r=!1}if(r)t=e.contentWindow;else break;e=zi(t.document)}return e}function Xl(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function ag(t){var e=Th(),r=t.focusedElem,n=t.selectionRange;if(e!==r&&r&&r.ownerDocument&&Ah(r.ownerDocument.documentElement,r)){if(n!==null&&Xl(r)){if(e=n.start,t=n.end,t===void 0&&(t=e),"selectionStart"in r)r.selectionStart=e,r.selectionEnd=Math.min(t,r.value.length);else if(t=(e=r.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var s=r.textContent.length,a=Math.min(n.start,s);n=n.end===void 0?a:Math.min(n.end,s),!t.extend&&a>n&&(s=n,n=a,a=s),s=lu(r,a);var o=lu(r,n);s&&o&&(t.rangeCount!==1||t.anchorNode!==s.node||t.anchorOffset!==s.offset||t.focusNode!==o.node||t.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(s.node,s.offset),t.removeAllRanges(),a>n?(t.addRange(e),t.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),t.addRange(e)))}}for(e=[],t=r;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<e.length;r++)t=e[r],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var og=Kt&&"documentMode"in document&&11>=document.documentMode,hn=null,Wo=null,fs=null,Ho=!1;function cu(t,e,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;Ho||hn==null||hn!==zi(n)||(n=hn,"selectionStart"in n&&Xl(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),fs&&As(fs,n)||(fs=n,n=Ki(Wo,"onSelect"),0<n.length&&(e=new Jl("onSelect","select",null,e,r),t.push({event:e,listeners:n}),e.target=hn)))}function hi(t,e){var r={};return r[t.toLowerCase()]=e.toLowerCase(),r["Webkit"+t]="webkit"+e,r["Moz"+t]="moz"+e,r}var fn={animationend:hi("Animation","AnimationEnd"),animationiteration:hi("Animation","AnimationIteration"),animationstart:hi("Animation","AnimationStart"),transitionend:hi("Transition","TransitionEnd")},Qa={},Ph={};Kt&&(Ph=document.createElement("div").style,"AnimationEvent"in window||(delete fn.animationend.animation,delete fn.animationiteration.animation,delete fn.animationstart.animation),"TransitionEvent"in window||delete fn.transitionend.transition);function wa(t){if(Qa[t])return Qa[t];if(!fn[t])return t;var e=fn[t],r;for(r in e)if(e.hasOwnProperty(r)&&r in Ph)return Qa[t]=e[r];return t}var Rh=wa("animationend"),Oh=wa("animationiteration"),Ih=wa("animationstart"),Dh=wa("transitionend"),$h=new Map,uu="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function kr(t,e){$h.set(t,e),Qr(e,[t])}for(var Ya=0;Ya<uu.length;Ya++){var Xa=uu[Ya],lg=Xa.toLowerCase(),cg=Xa[0].toUpperCase()+Xa.slice(1);kr(lg,"on"+cg)}kr(Rh,"onAnimationEnd");kr(Oh,"onAnimationIteration");kr(Ih,"onAnimationStart");kr("dblclick","onDoubleClick");kr("focusin","onFocus");kr("focusout","onBlur");kr(Dh,"onTransitionEnd");Pn("onMouseEnter",["mouseout","mouseover"]);Pn("onMouseLeave",["mouseout","mouseover"]);Pn("onPointerEnter",["pointerout","pointerover"]);Pn("onPointerLeave",["pointerout","pointerover"]);Qr("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Qr("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Qr("onBeforeInput",["compositionend","keypress","textInput","paste"]);Qr("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Qr("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Qr("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var is="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),ug=new Set("cancel close invalid load scroll toggle".split(" ").concat(is));function du(t,e,r){var n=t.type||"unknown-event";t.currentTarget=r,lp(n,e,void 0,t),t.currentTarget=null}function Lh(t,e){e=(e&4)!==0;for(var r=0;r<t.length;r++){var n=t[r],s=n.event;n=n.listeners;e:{var a=void 0;if(e)for(var o=n.length-1;0<=o;o--){var l=n[o],c=l.instance,u=l.currentTarget;if(l=l.listener,c!==a&&s.isPropagationStopped())break e;du(s,l,u),a=c}else for(o=0;o<n.length;o++){if(l=n[o],c=l.instance,u=l.currentTarget,l=l.listener,c!==a&&s.isPropagationStopped())break e;du(s,l,u),a=c}}}if(Bi)throw t=Fo,Bi=!1,Fo=null,t}function se(t,e){var r=e[Yo];r===void 0&&(r=e[Yo]=new Set);var n=t+"__bubble";r.has(n)||(Uh(e,t,2,!1),r.add(n))}function Za(t,e,r){var n=0;e&&(n|=4),Uh(r,t,n,e)}var fi="_reactListening"+Math.random().toString(36).slice(2);function Ts(t){if(!t[fi]){t[fi]=!0,Wd.forEach(function(r){r!=="selectionchange"&&(ug.has(r)||Za(r,!1,t),Za(r,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[fi]||(e[fi]=!0,Za("selectionchange",!1,e))}}function Uh(t,e,r,n){switch(_h(e)){case 1:var s=Np;break;case 4:s=kp;break;default:s=Kl}r=s.bind(null,e,r,t),s=void 0,!zo||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(s=!0),n?s!==void 0?t.addEventListener(e,r,{capture:!0,passive:s}):t.addEventListener(e,r,!0):s!==void 0?t.addEventListener(e,r,{passive:s}):t.addEventListener(e,r,!1)}function eo(t,e,r,n,s){var a=n;if(!(e&1)&&!(e&2)&&n!==null)e:for(;;){if(n===null)return;var o=n.tag;if(o===3||o===4){var l=n.stateNode.containerInfo;if(l===s||l.nodeType===8&&l.parentNode===s)break;if(o===4)for(o=n.return;o!==null;){var c=o.tag;if((c===3||c===4)&&(c=o.stateNode.containerInfo,c===s||c.nodeType===8&&c.parentNode===s))return;o=o.return}for(;l!==null;){if(o=Mr(l),o===null)return;if(c=o.tag,c===5||c===6){n=a=o;continue e}l=l.parentNode}}n=n.return}oh(function(){var u=a,f=ql(r),m=[];e:{var d=$h.get(t);if(d!==void 0){var y=Jl,x=t;switch(t){case"keypress":if(Pi(r)===0)break e;case"keydown":case"keyup":y=zp;break;case"focusin":x="focus",y=Ka;break;case"focusout":x="blur",y=Ka;break;case"beforeblur":case"afterblur":y=Ka;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":y=Zc;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":y=Ep;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":y=qp;break;case Rh:case Oh:case Ih:y=Pp;break;case Dh:y=Wp;break;case"scroll":y=Sp;break;case"wheel":y=Kp;break;case"copy":case"cut":case"paste":y=Op;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":y=tu}var w=(e&4)!==0,C=!w&&t==="scroll",p=w?d!==null?d+"Capture":null:d;w=[];for(var g=u,v;g!==null;){v=g;var b=v.stateNode;if(v.tag===5&&b!==null&&(v=b,p!==null&&(b=Ns(g,p),b!=null&&w.push(Ps(g,b,v)))),C)break;g=g.return}0<w.length&&(d=new y(d,x,null,r,f),m.push({event:d,listeners:w}))}}if(!(e&7)){e:{if(d=t==="mouseover"||t==="pointerover",y=t==="mouseout"||t==="pointerout",d&&r!==Uo&&(x=r.relatedTarget||r.fromElement)&&(Mr(x)||x[Gt]))break e;if((y||d)&&(d=f.window===f?f:(d=f.ownerDocument)?d.defaultView||d.parentWindow:window,y?(x=r.relatedTarget||r.toElement,y=u,x=x?Mr(x):null,x!==null&&(C=Yr(x),x!==C||x.tag!==5&&x.tag!==6)&&(x=null)):(y=null,x=u),y!==x)){if(w=Zc,b="onMouseLeave",p="onMouseEnter",g="mouse",(t==="pointerout"||t==="pointerover")&&(w=tu,b="onPointerLeave",p="onPointerEnter",g="pointer"),C=y==null?d:mn(y),v=x==null?d:mn(x),d=new w(b,g+"leave",y,r,f),d.target=C,d.relatedTarget=v,b=null,Mr(f)===u&&(w=new w(p,g+"enter",x,r,f),w.target=v,w.relatedTarget=C,b=w),C=b,y&&x)t:{for(w=y,p=x,g=0,v=w;v;v=Xr(v))g++;for(v=0,b=p;b;b=Xr(b))v++;for(;0<g-v;)w=Xr(w),g--;for(;0<v-g;)p=Xr(p),v--;for(;g--;){if(w===p||p!==null&&w===p.alternate)break t;w=Xr(w),p=Xr(p)}w=null}else w=null;y!==null&&hu(m,d,y,w,!1),x!==null&&C!==null&&hu(m,C,x,w,!0)}}e:{if(d=u?mn(u):window,y=d.nodeName&&d.nodeName.toLowerCase(),y==="select"||y==="input"&&d.type==="file")var j=eg;else if(su(d))if(Ch)j=sg;else{j=rg;var N=tg}else(y=d.nodeName)&&y.toLowerCase()==="input"&&(d.type==="checkbox"||d.type==="radio")&&(j=ng);if(j&&(j=j(t,u))){Sh(m,j,r,f);break e}N&&N(t,d,u),t==="focusout"&&(N=d._wrapperState)&&N.controlled&&d.type==="number"&&Oo(d,"number",d.value)}switch(N=u?mn(u):window,t){case"focusin":(su(N)||N.contentEditable==="true")&&(hn=N,Wo=u,fs=null);break;case"focusout":fs=Wo=hn=null;break;case"mousedown":Ho=!0;break;case"contextmenu":case"mouseup":case"dragend":Ho=!1,cu(m,r,f);break;case"selectionchange":if(og)break;case"keydown":case"keyup":cu(m,r,f)}var S;if(Yl)e:{switch(t){case"compositionstart":var P="onCompositionStart";break e;case"compositionend":P="onCompositionEnd";break e;case"compositionupdate":P="onCompositionUpdate";break e}P=void 0}else dn?Nh(t,r)&&(P="onCompositionEnd"):t==="keydown"&&r.keyCode===229&&(P="onCompositionStart");P&&(jh&&r.locale!=="ko"&&(dn||P!=="onCompositionStart"?P==="onCompositionEnd"&&dn&&(S=bh()):(fr=f,Gl="value"in fr?fr.value:fr.textContent,dn=!0)),N=Ki(u,P),0<N.length&&(P=new eu(P,t,null,r,f),m.push({event:P,listeners:N}),S?P.data=S:(S=kh(r),S!==null&&(P.data=S)))),(S=Jp?Qp(t,r):Yp(t,r))&&(u=Ki(u,"onBeforeInput"),0<u.length&&(f=new eu("onBeforeInput","beforeinput",null,r,f),m.push({event:f,listeners:u}),f.data=S))}Lh(m,e)})}function Ps(t,e,r){return{instance:t,listener:e,currentTarget:r}}function Ki(t,e){for(var r=e+"Capture",n=[];t!==null;){var s=t,a=s.stateNode;s.tag===5&&a!==null&&(s=a,a=Ns(t,r),a!=null&&n.unshift(Ps(t,a,s)),a=Ns(t,e),a!=null&&n.push(Ps(t,a,s))),t=t.return}return n}function Xr(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function hu(t,e,r,n,s){for(var a=e._reactName,o=[];r!==null&&r!==n;){var l=r,c=l.alternate,u=l.stateNode;if(c!==null&&c===n)break;l.tag===5&&u!==null&&(l=u,s?(c=Ns(r,a),c!=null&&o.unshift(Ps(r,c,l))):s||(c=Ns(r,a),c!=null&&o.push(Ps(r,c,l)))),r=r.return}o.length!==0&&t.push({event:e,listeners:o})}var dg=/\r\n?/g,hg=/\u0000|\uFFFD/g;function fu(t){return(typeof t=="string"?t:""+t).replace(dg,`
`).replace(hg,"")}function mi(t,e,r){if(e=fu(e),fu(t)!==e&&r)throw Error(E(425))}function Gi(){}var Ko=null,Go=null;function Jo(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var Qo=typeof setTimeout=="function"?setTimeout:void 0,fg=typeof clearTimeout=="function"?clearTimeout:void 0,mu=typeof Promise=="function"?Promise:void 0,mg=typeof queueMicrotask=="function"?queueMicrotask:typeof mu<"u"?function(t){return mu.resolve(null).then(t).catch(pg)}:Qo;function pg(t){setTimeout(function(){throw t})}function to(t,e){var r=e,n=0;do{var s=r.nextSibling;if(t.removeChild(r),s&&s.nodeType===8)if(r=s.data,r==="/$"){if(n===0){t.removeChild(s),Cs(e);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=s}while(r);Cs(e)}function vr(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function pu(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var r=t.data;if(r==="$"||r==="$!"||r==="$?"){if(e===0)return t;e--}else r==="/$"&&e++}t=t.previousSibling}return null}var Fn=Math.random().toString(36).slice(2),$t="__reactFiber$"+Fn,Rs="__reactProps$"+Fn,Gt="__reactContainer$"+Fn,Yo="__reactEvents$"+Fn,gg="__reactListeners$"+Fn,yg="__reactHandles$"+Fn;function Mr(t){var e=t[$t];if(e)return e;for(var r=t.parentNode;r;){if(e=r[Gt]||r[$t]){if(r=e.alternate,e.child!==null||r!==null&&r.child!==null)for(t=pu(t);t!==null;){if(r=t[$t])return r;t=pu(t)}return e}t=r,r=t.parentNode}return null}function Ys(t){return t=t[$t]||t[Gt],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function mn(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(E(33))}function _a(t){return t[Rs]||null}var Xo=[],pn=-1;function Sr(t){return{current:t}}function ie(t){0>pn||(t.current=Xo[pn],Xo[pn]=null,pn--)}function re(t,e){pn++,Xo[pn]=t.current,t.current=e}var Nr={},ze=Sr(Nr),Qe=Sr(!1),Wr=Nr;function Rn(t,e){var r=t.type.contextTypes;if(!r)return Nr;var n=t.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===e)return n.__reactInternalMemoizedMaskedChildContext;var s={},a;for(a in r)s[a]=e[a];return n&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=s),s}function Ye(t){return t=t.childContextTypes,t!=null}function Ji(){ie(Qe),ie(ze)}function gu(t,e,r){if(ze.current!==Nr)throw Error(E(168));re(ze,e),re(Qe,r)}function Mh(t,e,r){var n=t.stateNode;if(e=e.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var s in n)if(!(s in e))throw Error(E(108,tp(t)||"Unknown",s));return he({},r,n)}function Qi(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||Nr,Wr=ze.current,re(ze,t),re(Qe,Qe.current),!0}function yu(t,e,r){var n=t.stateNode;if(!n)throw Error(E(169));r?(t=Mh(t,e,Wr),n.__reactInternalMemoizedMergedChildContext=t,ie(Qe),ie(ze),re(ze,t)):ie(Qe),re(Qe,r)}var Bt=null,ba=!1,ro=!1;function zh(t){Bt===null?Bt=[t]:Bt.push(t)}function vg(t){ba=!0,zh(t)}function Cr(){if(!ro&&Bt!==null){ro=!0;var t=0,e=Y;try{var r=Bt;for(Y=1;t<r.length;t++){var n=r[t];do n=n(!0);while(n!==null)}Bt=null,ba=!1}catch(s){throw Bt!==null&&(Bt=Bt.slice(t+1)),dh(Vl,Cr),s}finally{Y=e,ro=!1}}return null}var gn=[],yn=0,Yi=null,Xi=0,ht=[],ft=0,Hr=null,qt=1,Vt="";function Ir(t,e){gn[yn++]=Xi,gn[yn++]=Yi,Yi=t,Xi=e}function Fh(t,e,r){ht[ft++]=qt,ht[ft++]=Vt,ht[ft++]=Hr,Hr=t;var n=qt;t=Vt;var s=32-Ct(n)-1;n&=~(1<<s),r+=1;var a=32-Ct(e)+s;if(30<a){var o=s-s%5;a=(n&(1<<o)-1).toString(32),n>>=o,s-=o,qt=1<<32-Ct(e)+s|r<<s|n,Vt=a+t}else qt=1<<a|r<<s|n,Vt=t}function Zl(t){t.return!==null&&(Ir(t,1),Fh(t,1,0))}function ec(t){for(;t===Yi;)Yi=gn[--yn],gn[yn]=null,Xi=gn[--yn],gn[yn]=null;for(;t===Hr;)Hr=ht[--ft],ht[ft]=null,Vt=ht[--ft],ht[ft]=null,qt=ht[--ft],ht[ft]=null}var it=null,st=null,oe=!1,St=null;function Bh(t,e){var r=pt(5,null,null,0);r.elementType="DELETED",r.stateNode=e,r.return=t,e=t.deletions,e===null?(t.deletions=[r],t.flags|=16):e.push(r)}function vu(t,e){switch(t.tag){case 5:var r=t.type;return e=e.nodeType!==1||r.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,it=t,st=vr(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,it=t,st=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(r=Hr!==null?{id:qt,overflow:Vt}:null,t.memoizedState={dehydrated:e,treeContext:r,retryLane:1073741824},r=pt(18,null,null,0),r.stateNode=e,r.return=t,t.child=r,it=t,st=null,!0):!1;default:return!1}}function Zo(t){return(t.mode&1)!==0&&(t.flags&128)===0}function el(t){if(oe){var e=st;if(e){var r=e;if(!vu(t,e)){if(Zo(t))throw Error(E(418));e=vr(r.nextSibling);var n=it;e&&vu(t,e)?Bh(n,r):(t.flags=t.flags&-4097|2,oe=!1,it=t)}}else{if(Zo(t))throw Error(E(418));t.flags=t.flags&-4097|2,oe=!1,it=t}}}function xu(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;it=t}function pi(t){if(t!==it)return!1;if(!oe)return xu(t),oe=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!Jo(t.type,t.memoizedProps)),e&&(e=st)){if(Zo(t))throw qh(),Error(E(418));for(;e;)Bh(t,e),e=vr(e.nextSibling)}if(xu(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(E(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var r=t.data;if(r==="/$"){if(e===0){st=vr(t.nextSibling);break e}e--}else r!=="$"&&r!=="$!"&&r!=="$?"||e++}t=t.nextSibling}st=null}}else st=it?vr(t.stateNode.nextSibling):null;return!0}function qh(){for(var t=st;t;)t=vr(t.nextSibling)}function On(){st=it=null,oe=!1}function tc(t){St===null?St=[t]:St.push(t)}var xg=Yt.ReactCurrentBatchConfig;function Qn(t,e,r){if(t=r.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(E(309));var n=r.stateNode}if(!n)throw Error(E(147,t));var s=n,a=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===a?e.ref:(e=function(o){var l=s.refs;o===null?delete l[a]:l[a]=o},e._stringRef=a,e)}if(typeof t!="string")throw Error(E(284));if(!r._owner)throw Error(E(290,t))}return t}function gi(t,e){throw t=Object.prototype.toString.call(e),Error(E(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function wu(t){var e=t._init;return e(t._payload)}function Vh(t){function e(p,g){if(t){var v=p.deletions;v===null?(p.deletions=[g],p.flags|=16):v.push(g)}}function r(p,g){if(!t)return null;for(;g!==null;)e(p,g),g=g.sibling;return null}function n(p,g){for(p=new Map;g!==null;)g.key!==null?p.set(g.key,g):p.set(g.index,g),g=g.sibling;return p}function s(p,g){return p=br(p,g),p.index=0,p.sibling=null,p}function a(p,g,v){return p.index=v,t?(v=p.alternate,v!==null?(v=v.index,v<g?(p.flags|=2,g):v):(p.flags|=2,g)):(p.flags|=1048576,g)}function o(p){return t&&p.alternate===null&&(p.flags|=2),p}function l(p,g,v,b){return g===null||g.tag!==6?(g=co(v,p.mode,b),g.return=p,g):(g=s(g,v),g.return=p,g)}function c(p,g,v,b){var j=v.type;return j===un?f(p,g,v.props.children,b,v.key):g!==null&&(g.elementType===j||typeof j=="object"&&j!==null&&j.$$typeof===sr&&wu(j)===g.type)?(b=s(g,v.props),b.ref=Qn(p,g,v),b.return=p,b):(b=Ui(v.type,v.key,v.props,null,p.mode,b),b.ref=Qn(p,g,v),b.return=p,b)}function u(p,g,v,b){return g===null||g.tag!==4||g.stateNode.containerInfo!==v.containerInfo||g.stateNode.implementation!==v.implementation?(g=uo(v,p.mode,b),g.return=p,g):(g=s(g,v.children||[]),g.return=p,g)}function f(p,g,v,b,j){return g===null||g.tag!==7?(g=Vr(v,p.mode,b,j),g.return=p,g):(g=s(g,v),g.return=p,g)}function m(p,g,v){if(typeof g=="string"&&g!==""||typeof g=="number")return g=co(""+g,p.mode,v),g.return=p,g;if(typeof g=="object"&&g!==null){switch(g.$$typeof){case ii:return v=Ui(g.type,g.key,g.props,null,p.mode,v),v.ref=Qn(p,null,g),v.return=p,v;case cn:return g=uo(g,p.mode,v),g.return=p,g;case sr:var b=g._init;return m(p,b(g._payload),v)}if(ns(g)||Wn(g))return g=Vr(g,p.mode,v,null),g.return=p,g;gi(p,g)}return null}function d(p,g,v,b){var j=g!==null?g.key:null;if(typeof v=="string"&&v!==""||typeof v=="number")return j!==null?null:l(p,g,""+v,b);if(typeof v=="object"&&v!==null){switch(v.$$typeof){case ii:return v.key===j?c(p,g,v,b):null;case cn:return v.key===j?u(p,g,v,b):null;case sr:return j=v._init,d(p,g,j(v._payload),b)}if(ns(v)||Wn(v))return j!==null?null:f(p,g,v,b,null);gi(p,v)}return null}function y(p,g,v,b,j){if(typeof b=="string"&&b!==""||typeof b=="number")return p=p.get(v)||null,l(g,p,""+b,j);if(typeof b=="object"&&b!==null){switch(b.$$typeof){case ii:return p=p.get(b.key===null?v:b.key)||null,c(g,p,b,j);case cn:return p=p.get(b.key===null?v:b.key)||null,u(g,p,b,j);case sr:var N=b._init;return y(p,g,v,N(b._payload),j)}if(ns(b)||Wn(b))return p=p.get(v)||null,f(g,p,b,j,null);gi(g,b)}return null}function x(p,g,v,b){for(var j=null,N=null,S=g,P=g=0,W=null;S!==null&&P<v.length;P++){S.index>P?(W=S,S=null):W=S.sibling;var q=d(p,S,v[P],b);if(q===null){S===null&&(S=W);break}t&&S&&q.alternate===null&&e(p,S),g=a(q,g,P),N===null?j=q:N.sibling=q,N=q,S=W}if(P===v.length)return r(p,S),oe&&Ir(p,P),j;if(S===null){for(;P<v.length;P++)S=m(p,v[P],b),S!==null&&(g=a(S,g,P),N===null?j=S:N.sibling=S,N=S);return oe&&Ir(p,P),j}for(S=n(p,S);P<v.length;P++)W=y(S,p,P,v[P],b),W!==null&&(t&&W.alternate!==null&&S.delete(W.key===null?P:W.key),g=a(W,g,P),N===null?j=W:N.sibling=W,N=W);return t&&S.forEach(function(V){return e(p,V)}),oe&&Ir(p,P),j}function w(p,g,v,b){var j=Wn(v);if(typeof j!="function")throw Error(E(150));if(v=j.call(v),v==null)throw Error(E(151));for(var N=j=null,S=g,P=g=0,W=null,q=v.next();S!==null&&!q.done;P++,q=v.next()){S.index>P?(W=S,S=null):W=S.sibling;var V=d(p,S,q.value,b);if(V===null){S===null&&(S=W);break}t&&S&&V.alternate===null&&e(p,S),g=a(V,g,P),N===null?j=V:N.sibling=V,N=V,S=W}if(q.done)return r(p,S),oe&&Ir(p,P),j;if(S===null){for(;!q.done;P++,q=v.next())q=m(p,q.value,b),q!==null&&(g=a(q,g,P),N===null?j=q:N.sibling=q,N=q);return oe&&Ir(p,P),j}for(S=n(p,S);!q.done;P++,q=v.next())q=y(S,p,P,q.value,b),q!==null&&(t&&q.alternate!==null&&S.delete(q.key===null?P:q.key),g=a(q,g,P),N===null?j=q:N.sibling=q,N=q);return t&&S.forEach(function(pe){return e(p,pe)}),oe&&Ir(p,P),j}function C(p,g,v,b){if(typeof v=="object"&&v!==null&&v.type===un&&v.key===null&&(v=v.props.children),typeof v=="object"&&v!==null){switch(v.$$typeof){case ii:e:{for(var j=v.key,N=g;N!==null;){if(N.key===j){if(j=v.type,j===un){if(N.tag===7){r(p,N.sibling),g=s(N,v.props.children),g.return=p,p=g;break e}}else if(N.elementType===j||typeof j=="object"&&j!==null&&j.$$typeof===sr&&wu(j)===N.type){r(p,N.sibling),g=s(N,v.props),g.ref=Qn(p,N,v),g.return=p,p=g;break e}r(p,N);break}else e(p,N);N=N.sibling}v.type===un?(g=Vr(v.props.children,p.mode,b,v.key),g.return=p,p=g):(b=Ui(v.type,v.key,v.props,null,p.mode,b),b.ref=Qn(p,g,v),b.return=p,p=b)}return o(p);case cn:e:{for(N=v.key;g!==null;){if(g.key===N)if(g.tag===4&&g.stateNode.containerInfo===v.containerInfo&&g.stateNode.implementation===v.implementation){r(p,g.sibling),g=s(g,v.children||[]),g.return=p,p=g;break e}else{r(p,g);break}else e(p,g);g=g.sibling}g=uo(v,p.mode,b),g.return=p,p=g}return o(p);case sr:return N=v._init,C(p,g,N(v._payload),b)}if(ns(v))return x(p,g,v,b);if(Wn(v))return w(p,g,v,b);gi(p,v)}return typeof v=="string"&&v!==""||typeof v=="number"?(v=""+v,g!==null&&g.tag===6?(r(p,g.sibling),g=s(g,v),g.return=p,p=g):(r(p,g),g=co(v,p.mode,b),g.return=p,p=g),o(p)):r(p,g)}return C}var In=Vh(!0),Wh=Vh(!1),Zi=Sr(null),ea=null,vn=null,rc=null;function nc(){rc=vn=ea=null}function sc(t){var e=Zi.current;ie(Zi),t._currentValue=e}function tl(t,e,r){for(;t!==null;){var n=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,n!==null&&(n.childLanes|=e)):n!==null&&(n.childLanes&e)!==e&&(n.childLanes|=e),t===r)break;t=t.return}}function Cn(t,e){ea=t,rc=vn=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(Je=!0),t.firstContext=null)}function yt(t){var e=t._currentValue;if(rc!==t)if(t={context:t,memoizedValue:e,next:null},vn===null){if(ea===null)throw Error(E(308));vn=t,ea.dependencies={lanes:0,firstContext:t}}else vn=vn.next=t;return e}var zr=null;function ic(t){zr===null?zr=[t]:zr.push(t)}function Hh(t,e,r,n){var s=e.interleaved;return s===null?(r.next=r,ic(e)):(r.next=s.next,s.next=r),e.interleaved=r,Jt(t,n)}function Jt(t,e){t.lanes|=e;var r=t.alternate;for(r!==null&&(r.lanes|=e),r=t,t=t.return;t!==null;)t.childLanes|=e,r=t.alternate,r!==null&&(r.childLanes|=e),r=t,t=t.return;return r.tag===3?r.stateNode:null}var ir=!1;function ac(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Kh(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function Wt(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function xr(t,e,r){var n=t.updateQueue;if(n===null)return null;if(n=n.shared,J&2){var s=n.pending;return s===null?e.next=e:(e.next=s.next,s.next=e),n.pending=e,Jt(t,r)}return s=n.interleaved,s===null?(e.next=e,ic(n)):(e.next=s.next,s.next=e),n.interleaved=e,Jt(t,r)}function Ri(t,e,r){if(e=e.updateQueue,e!==null&&(e=e.shared,(r&4194240)!==0)){var n=e.lanes;n&=t.pendingLanes,r|=n,e.lanes=r,Wl(t,r)}}function _u(t,e){var r=t.updateQueue,n=t.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var s=null,a=null;if(r=r.firstBaseUpdate,r!==null){do{var o={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};a===null?s=a=o:a=a.next=o,r=r.next}while(r!==null);a===null?s=a=e:a=a.next=e}else s=a=e;r={baseState:n.baseState,firstBaseUpdate:s,lastBaseUpdate:a,shared:n.shared,effects:n.effects},t.updateQueue=r;return}t=r.lastBaseUpdate,t===null?r.firstBaseUpdate=e:t.next=e,r.lastBaseUpdate=e}function ta(t,e,r,n){var s=t.updateQueue;ir=!1;var a=s.firstBaseUpdate,o=s.lastBaseUpdate,l=s.shared.pending;if(l!==null){s.shared.pending=null;var c=l,u=c.next;c.next=null,o===null?a=u:o.next=u,o=c;var f=t.alternate;f!==null&&(f=f.updateQueue,l=f.lastBaseUpdate,l!==o&&(l===null?f.firstBaseUpdate=u:l.next=u,f.lastBaseUpdate=c))}if(a!==null){var m=s.baseState;o=0,f=u=c=null,l=a;do{var d=l.lane,y=l.eventTime;if((n&d)===d){f!==null&&(f=f.next={eventTime:y,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var x=t,w=l;switch(d=e,y=r,w.tag){case 1:if(x=w.payload,typeof x=="function"){m=x.call(y,m,d);break e}m=x;break e;case 3:x.flags=x.flags&-65537|128;case 0:if(x=w.payload,d=typeof x=="function"?x.call(y,m,d):x,d==null)break e;m=he({},m,d);break e;case 2:ir=!0}}l.callback!==null&&l.lane!==0&&(t.flags|=64,d=s.effects,d===null?s.effects=[l]:d.push(l))}else y={eventTime:y,lane:d,tag:l.tag,payload:l.payload,callback:l.callback,next:null},f===null?(u=f=y,c=m):f=f.next=y,o|=d;if(l=l.next,l===null){if(l=s.shared.pending,l===null)break;d=l,l=d.next,d.next=null,s.lastBaseUpdate=d,s.shared.pending=null}}while(1);if(f===null&&(c=m),s.baseState=c,s.firstBaseUpdate=u,s.lastBaseUpdate=f,e=s.shared.interleaved,e!==null){s=e;do o|=s.lane,s=s.next;while(s!==e)}else a===null&&(s.shared.lanes=0);Gr|=o,t.lanes=o,t.memoizedState=m}}function bu(t,e,r){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var n=t[e],s=n.callback;if(s!==null){if(n.callback=null,n=r,typeof s!="function")throw Error(E(191,s));s.call(n)}}}var Xs={},Ut=Sr(Xs),Os=Sr(Xs),Is=Sr(Xs);function Fr(t){if(t===Xs)throw Error(E(174));return t}function oc(t,e){switch(re(Is,e),re(Os,t),re(Ut,Xs),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:Do(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=Do(e,t)}ie(Ut),re(Ut,e)}function Dn(){ie(Ut),ie(Os),ie(Is)}function Gh(t){Fr(Is.current);var e=Fr(Ut.current),r=Do(e,t.type);e!==r&&(re(Os,t),re(Ut,r))}function lc(t){Os.current===t&&(ie(Ut),ie(Os))}var ue=Sr(0);function ra(t){for(var e=t;e!==null;){if(e.tag===13){var r=e.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var no=[];function cc(){for(var t=0;t<no.length;t++)no[t]._workInProgressVersionPrimary=null;no.length=0}var Oi=Yt.ReactCurrentDispatcher,so=Yt.ReactCurrentBatchConfig,Kr=0,de=null,_e=null,ke=null,na=!1,ms=!1,Ds=0,wg=0;function $e(){throw Error(E(321))}function uc(t,e){if(e===null)return!1;for(var r=0;r<e.length&&r<t.length;r++)if(!At(t[r],e[r]))return!1;return!0}function dc(t,e,r,n,s,a){if(Kr=a,de=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,Oi.current=t===null||t.memoizedState===null?Ng:kg,t=r(n,s),ms){a=0;do{if(ms=!1,Ds=0,25<=a)throw Error(E(301));a+=1,ke=_e=null,e.updateQueue=null,Oi.current=Sg,t=r(n,s)}while(ms)}if(Oi.current=sa,e=_e!==null&&_e.next!==null,Kr=0,ke=_e=de=null,na=!1,e)throw Error(E(300));return t}function hc(){var t=Ds!==0;return Ds=0,t}function It(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return ke===null?de.memoizedState=ke=t:ke=ke.next=t,ke}function vt(){if(_e===null){var t=de.alternate;t=t!==null?t.memoizedState:null}else t=_e.next;var e=ke===null?de.memoizedState:ke.next;if(e!==null)ke=e,_e=t;else{if(t===null)throw Error(E(310));_e=t,t={memoizedState:_e.memoizedState,baseState:_e.baseState,baseQueue:_e.baseQueue,queue:_e.queue,next:null},ke===null?de.memoizedState=ke=t:ke=ke.next=t}return ke}function $s(t,e){return typeof e=="function"?e(t):e}function io(t){var e=vt(),r=e.queue;if(r===null)throw Error(E(311));r.lastRenderedReducer=t;var n=_e,s=n.baseQueue,a=r.pending;if(a!==null){if(s!==null){var o=s.next;s.next=a.next,a.next=o}n.baseQueue=s=a,r.pending=null}if(s!==null){a=s.next,n=n.baseState;var l=o=null,c=null,u=a;do{var f=u.lane;if((Kr&f)===f)c!==null&&(c=c.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),n=u.hasEagerState?u.eagerState:t(n,u.action);else{var m={lane:f,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};c===null?(l=c=m,o=n):c=c.next=m,de.lanes|=f,Gr|=f}u=u.next}while(u!==null&&u!==a);c===null?o=n:c.next=l,At(n,e.memoizedState)||(Je=!0),e.memoizedState=n,e.baseState=o,e.baseQueue=c,r.lastRenderedState=n}if(t=r.interleaved,t!==null){s=t;do a=s.lane,de.lanes|=a,Gr|=a,s=s.next;while(s!==t)}else s===null&&(r.lanes=0);return[e.memoizedState,r.dispatch]}function ao(t){var e=vt(),r=e.queue;if(r===null)throw Error(E(311));r.lastRenderedReducer=t;var n=r.dispatch,s=r.pending,a=e.memoizedState;if(s!==null){r.pending=null;var o=s=s.next;do a=t(a,o.action),o=o.next;while(o!==s);At(a,e.memoizedState)||(Je=!0),e.memoizedState=a,e.baseQueue===null&&(e.baseState=a),r.lastRenderedState=a}return[a,n]}function Jh(){}function Qh(t,e){var r=de,n=vt(),s=e(),a=!At(n.memoizedState,s);if(a&&(n.memoizedState=s,Je=!0),n=n.queue,fc(Zh.bind(null,r,n,t),[t]),n.getSnapshot!==e||a||ke!==null&&ke.memoizedState.tag&1){if(r.flags|=2048,Ls(9,Xh.bind(null,r,n,s,e),void 0,null),Se===null)throw Error(E(349));Kr&30||Yh(r,e,s)}return s}function Yh(t,e,r){t.flags|=16384,t={getSnapshot:e,value:r},e=de.updateQueue,e===null?(e={lastEffect:null,stores:null},de.updateQueue=e,e.stores=[t]):(r=e.stores,r===null?e.stores=[t]:r.push(t))}function Xh(t,e,r,n){e.value=r,e.getSnapshot=n,ef(e)&&tf(t)}function Zh(t,e,r){return r(function(){ef(e)&&tf(t)})}function ef(t){var e=t.getSnapshot;t=t.value;try{var r=e();return!At(t,r)}catch{return!0}}function tf(t){var e=Jt(t,1);e!==null&&Et(e,t,1,-1)}function ju(t){var e=It();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:$s,lastRenderedState:t},e.queue=t,t=t.dispatch=jg.bind(null,de,t),[e.memoizedState,t]}function Ls(t,e,r,n){return t={tag:t,create:e,destroy:r,deps:n,next:null},e=de.updateQueue,e===null?(e={lastEffect:null,stores:null},de.updateQueue=e,e.lastEffect=t.next=t):(r=e.lastEffect,r===null?e.lastEffect=t.next=t:(n=r.next,r.next=t,t.next=n,e.lastEffect=t)),t}function rf(){return vt().memoizedState}function Ii(t,e,r,n){var s=It();de.flags|=t,s.memoizedState=Ls(1|e,r,void 0,n===void 0?null:n)}function ja(t,e,r,n){var s=vt();n=n===void 0?null:n;var a=void 0;if(_e!==null){var o=_e.memoizedState;if(a=o.destroy,n!==null&&uc(n,o.deps)){s.memoizedState=Ls(e,r,a,n);return}}de.flags|=t,s.memoizedState=Ls(1|e,r,a,n)}function Nu(t,e){return Ii(8390656,8,t,e)}function fc(t,e){return ja(2048,8,t,e)}function nf(t,e){return ja(4,2,t,e)}function sf(t,e){return ja(4,4,t,e)}function af(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function of(t,e,r){return r=r!=null?r.concat([t]):null,ja(4,4,af.bind(null,e,t),r)}function mc(){}function lf(t,e){var r=vt();e=e===void 0?null:e;var n=r.memoizedState;return n!==null&&e!==null&&uc(e,n[1])?n[0]:(r.memoizedState=[t,e],t)}function cf(t,e){var r=vt();e=e===void 0?null:e;var n=r.memoizedState;return n!==null&&e!==null&&uc(e,n[1])?n[0]:(t=t(),r.memoizedState=[t,e],t)}function uf(t,e,r){return Kr&21?(At(r,e)||(r=mh(),de.lanes|=r,Gr|=r,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,Je=!0),t.memoizedState=r)}function _g(t,e){var r=Y;Y=r!==0&&4>r?r:4,t(!0);var n=so.transition;so.transition={};try{t(!1),e()}finally{Y=r,so.transition=n}}function df(){return vt().memoizedState}function bg(t,e,r){var n=_r(t);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},hf(t))ff(e,r);else if(r=Hh(t,e,r,n),r!==null){var s=qe();Et(r,t,n,s),mf(r,e,n)}}function jg(t,e,r){var n=_r(t),s={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(hf(t))ff(e,s);else{var a=t.alternate;if(t.lanes===0&&(a===null||a.lanes===0)&&(a=e.lastRenderedReducer,a!==null))try{var o=e.lastRenderedState,l=a(o,r);if(s.hasEagerState=!0,s.eagerState=l,At(l,o)){var c=e.interleaved;c===null?(s.next=s,ic(e)):(s.next=c.next,c.next=s),e.interleaved=s;return}}catch{}finally{}r=Hh(t,e,s,n),r!==null&&(s=qe(),Et(r,t,n,s),mf(r,e,n))}}function hf(t){var e=t.alternate;return t===de||e!==null&&e===de}function ff(t,e){ms=na=!0;var r=t.pending;r===null?e.next=e:(e.next=r.next,r.next=e),t.pending=e}function mf(t,e,r){if(r&4194240){var n=e.lanes;n&=t.pendingLanes,r|=n,e.lanes=r,Wl(t,r)}}var sa={readContext:yt,useCallback:$e,useContext:$e,useEffect:$e,useImperativeHandle:$e,useInsertionEffect:$e,useLayoutEffect:$e,useMemo:$e,useReducer:$e,useRef:$e,useState:$e,useDebugValue:$e,useDeferredValue:$e,useTransition:$e,useMutableSource:$e,useSyncExternalStore:$e,useId:$e,unstable_isNewReconciler:!1},Ng={readContext:yt,useCallback:function(t,e){return It().memoizedState=[t,e===void 0?null:e],t},useContext:yt,useEffect:Nu,useImperativeHandle:function(t,e,r){return r=r!=null?r.concat([t]):null,Ii(4194308,4,af.bind(null,e,t),r)},useLayoutEffect:function(t,e){return Ii(4194308,4,t,e)},useInsertionEffect:function(t,e){return Ii(4,2,t,e)},useMemo:function(t,e){var r=It();return e=e===void 0?null:e,t=t(),r.memoizedState=[t,e],t},useReducer:function(t,e,r){var n=It();return e=r!==void 0?r(e):e,n.memoizedState=n.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},n.queue=t,t=t.dispatch=bg.bind(null,de,t),[n.memoizedState,t]},useRef:function(t){var e=It();return t={current:t},e.memoizedState=t},useState:ju,useDebugValue:mc,useDeferredValue:function(t){return It().memoizedState=t},useTransition:function(){var t=ju(!1),e=t[0];return t=_g.bind(null,t[1]),It().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,r){var n=de,s=It();if(oe){if(r===void 0)throw Error(E(407));r=r()}else{if(r=e(),Se===null)throw Error(E(349));Kr&30||Yh(n,e,r)}s.memoizedState=r;var a={value:r,getSnapshot:e};return s.queue=a,Nu(Zh.bind(null,n,a,t),[t]),n.flags|=2048,Ls(9,Xh.bind(null,n,a,r,e),void 0,null),r},useId:function(){var t=It(),e=Se.identifierPrefix;if(oe){var r=Vt,n=qt;r=(n&~(1<<32-Ct(n)-1)).toString(32)+r,e=":"+e+"R"+r,r=Ds++,0<r&&(e+="H"+r.toString(32)),e+=":"}else r=wg++,e=":"+e+"r"+r.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},kg={readContext:yt,useCallback:lf,useContext:yt,useEffect:fc,useImperativeHandle:of,useInsertionEffect:nf,useLayoutEffect:sf,useMemo:cf,useReducer:io,useRef:rf,useState:function(){return io($s)},useDebugValue:mc,useDeferredValue:function(t){var e=vt();return uf(e,_e.memoizedState,t)},useTransition:function(){var t=io($s)[0],e=vt().memoizedState;return[t,e]},useMutableSource:Jh,useSyncExternalStore:Qh,useId:df,unstable_isNewReconciler:!1},Sg={readContext:yt,useCallback:lf,useContext:yt,useEffect:fc,useImperativeHandle:of,useInsertionEffect:nf,useLayoutEffect:sf,useMemo:cf,useReducer:ao,useRef:rf,useState:function(){return ao($s)},useDebugValue:mc,useDeferredValue:function(t){var e=vt();return _e===null?e.memoizedState=t:uf(e,_e.memoizedState,t)},useTransition:function(){var t=ao($s)[0],e=vt().memoizedState;return[t,e]},useMutableSource:Jh,useSyncExternalStore:Qh,useId:df,unstable_isNewReconciler:!1};function bt(t,e){if(t&&t.defaultProps){e=he({},e),t=t.defaultProps;for(var r in t)e[r]===void 0&&(e[r]=t[r]);return e}return e}function rl(t,e,r,n){e=t.memoizedState,r=r(n,e),r=r==null?e:he({},e,r),t.memoizedState=r,t.lanes===0&&(t.updateQueue.baseState=r)}var Na={isMounted:function(t){return(t=t._reactInternals)?Yr(t)===t:!1},enqueueSetState:function(t,e,r){t=t._reactInternals;var n=qe(),s=_r(t),a=Wt(n,s);a.payload=e,r!=null&&(a.callback=r),e=xr(t,a,s),e!==null&&(Et(e,t,s,n),Ri(e,t,s))},enqueueReplaceState:function(t,e,r){t=t._reactInternals;var n=qe(),s=_r(t),a=Wt(n,s);a.tag=1,a.payload=e,r!=null&&(a.callback=r),e=xr(t,a,s),e!==null&&(Et(e,t,s,n),Ri(e,t,s))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var r=qe(),n=_r(t),s=Wt(r,n);s.tag=2,e!=null&&(s.callback=e),e=xr(t,s,n),e!==null&&(Et(e,t,n,r),Ri(e,t,n))}};function ku(t,e,r,n,s,a,o){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(n,a,o):e.prototype&&e.prototype.isPureReactComponent?!As(r,n)||!As(s,a):!0}function pf(t,e,r){var n=!1,s=Nr,a=e.contextType;return typeof a=="object"&&a!==null?a=yt(a):(s=Ye(e)?Wr:ze.current,n=e.contextTypes,a=(n=n!=null)?Rn(t,s):Nr),e=new e(r,a),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=Na,t.stateNode=e,e._reactInternals=t,n&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=s,t.__reactInternalMemoizedMaskedChildContext=a),e}function Su(t,e,r,n){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(r,n),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(r,n),e.state!==t&&Na.enqueueReplaceState(e,e.state,null)}function nl(t,e,r,n){var s=t.stateNode;s.props=r,s.state=t.memoizedState,s.refs={},ac(t);var a=e.contextType;typeof a=="object"&&a!==null?s.context=yt(a):(a=Ye(e)?Wr:ze.current,s.context=Rn(t,a)),s.state=t.memoizedState,a=e.getDerivedStateFromProps,typeof a=="function"&&(rl(t,e,a,r),s.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(e=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),e!==s.state&&Na.enqueueReplaceState(s,s.state,null),ta(t,r,s,n),s.state=t.memoizedState),typeof s.componentDidMount=="function"&&(t.flags|=4194308)}function $n(t,e){try{var r="",n=e;do r+=ep(n),n=n.return;while(n);var s=r}catch(a){s=`
Error generating stack: `+a.message+`
`+a.stack}return{value:t,source:e,stack:s,digest:null}}function oo(t,e,r){return{value:t,source:null,stack:r??null,digest:e??null}}function sl(t,e){try{console.error(e.value)}catch(r){setTimeout(function(){throw r})}}var Cg=typeof WeakMap=="function"?WeakMap:Map;function gf(t,e,r){r=Wt(-1,r),r.tag=3,r.payload={element:null};var n=e.value;return r.callback=function(){aa||(aa=!0,ml=n),sl(t,e)},r}function yf(t,e,r){r=Wt(-1,r),r.tag=3;var n=t.type.getDerivedStateFromError;if(typeof n=="function"){var s=e.value;r.payload=function(){return n(s)},r.callback=function(){sl(t,e)}}var a=t.stateNode;return a!==null&&typeof a.componentDidCatch=="function"&&(r.callback=function(){sl(t,e),typeof n!="function"&&(wr===null?wr=new Set([this]):wr.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),r}function Cu(t,e,r){var n=t.pingCache;if(n===null){n=t.pingCache=new Cg;var s=new Set;n.set(e,s)}else s=n.get(e),s===void 0&&(s=new Set,n.set(e,s));s.has(r)||(s.add(r),t=Fg.bind(null,t,e,r),e.then(t,t))}function Eu(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function Au(t,e,r,n,s){return t.mode&1?(t.flags|=65536,t.lanes=s,t):(t===e?t.flags|=65536:(t.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(e=Wt(-1,1),e.tag=2,xr(r,e,1))),r.lanes|=1),t)}var Eg=Yt.ReactCurrentOwner,Je=!1;function Be(t,e,r,n){e.child=t===null?Wh(e,null,r,n):In(e,t.child,r,n)}function Tu(t,e,r,n,s){r=r.render;var a=e.ref;return Cn(e,s),n=dc(t,e,r,n,a,s),r=hc(),t!==null&&!Je?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,Qt(t,e,s)):(oe&&r&&Zl(e),e.flags|=1,Be(t,e,n,s),e.child)}function Pu(t,e,r,n,s){if(t===null){var a=r.type;return typeof a=="function"&&!bc(a)&&a.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(e.tag=15,e.type=a,vf(t,e,a,n,s)):(t=Ui(r.type,null,n,e,e.mode,s),t.ref=e.ref,t.return=e,e.child=t)}if(a=t.child,!(t.lanes&s)){var o=a.memoizedProps;if(r=r.compare,r=r!==null?r:As,r(o,n)&&t.ref===e.ref)return Qt(t,e,s)}return e.flags|=1,t=br(a,n),t.ref=e.ref,t.return=e,e.child=t}function vf(t,e,r,n,s){if(t!==null){var a=t.memoizedProps;if(As(a,n)&&t.ref===e.ref)if(Je=!1,e.pendingProps=n=a,(t.lanes&s)!==0)t.flags&131072&&(Je=!0);else return e.lanes=t.lanes,Qt(t,e,s)}return il(t,e,r,n,s)}function xf(t,e,r){var n=e.pendingProps,s=n.children,a=t!==null?t.memoizedState:null;if(n.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},re(wn,et),et|=r;else{if(!(r&1073741824))return t=a!==null?a.baseLanes|r:r,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,re(wn,et),et|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=a!==null?a.baseLanes:r,re(wn,et),et|=n}else a!==null?(n=a.baseLanes|r,e.memoizedState=null):n=r,re(wn,et),et|=n;return Be(t,e,s,r),e.child}function wf(t,e){var r=e.ref;(t===null&&r!==null||t!==null&&t.ref!==r)&&(e.flags|=512,e.flags|=2097152)}function il(t,e,r,n,s){var a=Ye(r)?Wr:ze.current;return a=Rn(e,a),Cn(e,s),r=dc(t,e,r,n,a,s),n=hc(),t!==null&&!Je?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,Qt(t,e,s)):(oe&&n&&Zl(e),e.flags|=1,Be(t,e,r,s),e.child)}function Ru(t,e,r,n,s){if(Ye(r)){var a=!0;Qi(e)}else a=!1;if(Cn(e,s),e.stateNode===null)Di(t,e),pf(e,r,n),nl(e,r,n,s),n=!0;else if(t===null){var o=e.stateNode,l=e.memoizedProps;o.props=l;var c=o.context,u=r.contextType;typeof u=="object"&&u!==null?u=yt(u):(u=Ye(r)?Wr:ze.current,u=Rn(e,u));var f=r.getDerivedStateFromProps,m=typeof f=="function"||typeof o.getSnapshotBeforeUpdate=="function";m||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==n||c!==u)&&Su(e,o,n,u),ir=!1;var d=e.memoizedState;o.state=d,ta(e,n,o,s),c=e.memoizedState,l!==n||d!==c||Qe.current||ir?(typeof f=="function"&&(rl(e,r,f,n),c=e.memoizedState),(l=ir||ku(e,r,l,n,d,c,u))?(m||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=n,e.memoizedState=c),o.props=n,o.state=c,o.context=u,n=l):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),n=!1)}else{o=e.stateNode,Kh(t,e),l=e.memoizedProps,u=e.type===e.elementType?l:bt(e.type,l),o.props=u,m=e.pendingProps,d=o.context,c=r.contextType,typeof c=="object"&&c!==null?c=yt(c):(c=Ye(r)?Wr:ze.current,c=Rn(e,c));var y=r.getDerivedStateFromProps;(f=typeof y=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==m||d!==c)&&Su(e,o,n,c),ir=!1,d=e.memoizedState,o.state=d,ta(e,n,o,s);var x=e.memoizedState;l!==m||d!==x||Qe.current||ir?(typeof y=="function"&&(rl(e,r,y,n),x=e.memoizedState),(u=ir||ku(e,r,u,n,d,x,c)||!1)?(f||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(n,x,c),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(n,x,c)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||l===t.memoizedProps&&d===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===t.memoizedProps&&d===t.memoizedState||(e.flags|=1024),e.memoizedProps=n,e.memoizedState=x),o.props=n,o.state=x,o.context=c,n=u):(typeof o.componentDidUpdate!="function"||l===t.memoizedProps&&d===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===t.memoizedProps&&d===t.memoizedState||(e.flags|=1024),n=!1)}return al(t,e,r,n,a,s)}function al(t,e,r,n,s,a){wf(t,e);var o=(e.flags&128)!==0;if(!n&&!o)return s&&yu(e,r,!1),Qt(t,e,a);n=e.stateNode,Eg.current=e;var l=o&&typeof r.getDerivedStateFromError!="function"?null:n.render();return e.flags|=1,t!==null&&o?(e.child=In(e,t.child,null,a),e.child=In(e,null,l,a)):Be(t,e,l,a),e.memoizedState=n.state,s&&yu(e,r,!0),e.child}function _f(t){var e=t.stateNode;e.pendingContext?gu(t,e.pendingContext,e.pendingContext!==e.context):e.context&&gu(t,e.context,!1),oc(t,e.containerInfo)}function Ou(t,e,r,n,s){return On(),tc(s),e.flags|=256,Be(t,e,r,n),e.child}var ol={dehydrated:null,treeContext:null,retryLane:0};function ll(t){return{baseLanes:t,cachePool:null,transitions:null}}function bf(t,e,r){var n=e.pendingProps,s=ue.current,a=!1,o=(e.flags&128)!==0,l;if((l=o)||(l=t!==null&&t.memoizedState===null?!1:(s&2)!==0),l?(a=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(s|=1),re(ue,s&1),t===null)return el(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=n.children,t=n.fallback,a?(n=e.mode,a=e.child,o={mode:"hidden",children:o},!(n&1)&&a!==null?(a.childLanes=0,a.pendingProps=o):a=Ca(o,n,0,null),t=Vr(t,n,r,null),a.return=e,t.return=e,a.sibling=t,e.child=a,e.child.memoizedState=ll(r),e.memoizedState=ol,t):pc(e,o));if(s=t.memoizedState,s!==null&&(l=s.dehydrated,l!==null))return Ag(t,e,o,n,l,s,r);if(a){a=n.fallback,o=e.mode,s=t.child,l=s.sibling;var c={mode:"hidden",children:n.children};return!(o&1)&&e.child!==s?(n=e.child,n.childLanes=0,n.pendingProps=c,e.deletions=null):(n=br(s,c),n.subtreeFlags=s.subtreeFlags&14680064),l!==null?a=br(l,a):(a=Vr(a,o,r,null),a.flags|=2),a.return=e,n.return=e,n.sibling=a,e.child=n,n=a,a=e.child,o=t.child.memoizedState,o=o===null?ll(r):{baseLanes:o.baseLanes|r,cachePool:null,transitions:o.transitions},a.memoizedState=o,a.childLanes=t.childLanes&~r,e.memoizedState=ol,n}return a=t.child,t=a.sibling,n=br(a,{mode:"visible",children:n.children}),!(e.mode&1)&&(n.lanes=r),n.return=e,n.sibling=null,t!==null&&(r=e.deletions,r===null?(e.deletions=[t],e.flags|=16):r.push(t)),e.child=n,e.memoizedState=null,n}function pc(t,e){return e=Ca({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function yi(t,e,r,n){return n!==null&&tc(n),In(e,t.child,null,r),t=pc(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function Ag(t,e,r,n,s,a,o){if(r)return e.flags&256?(e.flags&=-257,n=oo(Error(E(422))),yi(t,e,o,n)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(a=n.fallback,s=e.mode,n=Ca({mode:"visible",children:n.children},s,0,null),a=Vr(a,s,o,null),a.flags|=2,n.return=e,a.return=e,n.sibling=a,e.child=n,e.mode&1&&In(e,t.child,null,o),e.child.memoizedState=ll(o),e.memoizedState=ol,a);if(!(e.mode&1))return yi(t,e,o,null);if(s.data==="$!"){if(n=s.nextSibling&&s.nextSibling.dataset,n)var l=n.dgst;return n=l,a=Error(E(419)),n=oo(a,n,void 0),yi(t,e,o,n)}if(l=(o&t.childLanes)!==0,Je||l){if(n=Se,n!==null){switch(o&-o){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(n.suspendedLanes|o)?0:s,s!==0&&s!==a.retryLane&&(a.retryLane=s,Jt(t,s),Et(n,t,s,-1))}return _c(),n=oo(Error(E(421))),yi(t,e,o,n)}return s.data==="$?"?(e.flags|=128,e.child=t.child,e=Bg.bind(null,t),s._reactRetry=e,null):(t=a.treeContext,st=vr(s.nextSibling),it=e,oe=!0,St=null,t!==null&&(ht[ft++]=qt,ht[ft++]=Vt,ht[ft++]=Hr,qt=t.id,Vt=t.overflow,Hr=e),e=pc(e,n.children),e.flags|=4096,e)}function Iu(t,e,r){t.lanes|=e;var n=t.alternate;n!==null&&(n.lanes|=e),tl(t.return,e,r)}function lo(t,e,r,n,s){var a=t.memoizedState;a===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:s}:(a.isBackwards=e,a.rendering=null,a.renderingStartTime=0,a.last=n,a.tail=r,a.tailMode=s)}function jf(t,e,r){var n=e.pendingProps,s=n.revealOrder,a=n.tail;if(Be(t,e,n.children,r),n=ue.current,n&2)n=n&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&Iu(t,r,e);else if(t.tag===19)Iu(t,r,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}n&=1}if(re(ue,n),!(e.mode&1))e.memoizedState=null;else switch(s){case"forwards":for(r=e.child,s=null;r!==null;)t=r.alternate,t!==null&&ra(t)===null&&(s=r),r=r.sibling;r=s,r===null?(s=e.child,e.child=null):(s=r.sibling,r.sibling=null),lo(e,!1,s,r,a);break;case"backwards":for(r=null,s=e.child,e.child=null;s!==null;){if(t=s.alternate,t!==null&&ra(t)===null){e.child=s;break}t=s.sibling,s.sibling=r,r=s,s=t}lo(e,!0,r,null,a);break;case"together":lo(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function Di(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function Qt(t,e,r){if(t!==null&&(e.dependencies=t.dependencies),Gr|=e.lanes,!(r&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(E(153));if(e.child!==null){for(t=e.child,r=br(t,t.pendingProps),e.child=r,r.return=e;t.sibling!==null;)t=t.sibling,r=r.sibling=br(t,t.pendingProps),r.return=e;r.sibling=null}return e.child}function Tg(t,e,r){switch(e.tag){case 3:_f(e),On();break;case 5:Gh(e);break;case 1:Ye(e.type)&&Qi(e);break;case 4:oc(e,e.stateNode.containerInfo);break;case 10:var n=e.type._context,s=e.memoizedProps.value;re(Zi,n._currentValue),n._currentValue=s;break;case 13:if(n=e.memoizedState,n!==null)return n.dehydrated!==null?(re(ue,ue.current&1),e.flags|=128,null):r&e.child.childLanes?bf(t,e,r):(re(ue,ue.current&1),t=Qt(t,e,r),t!==null?t.sibling:null);re(ue,ue.current&1);break;case 19:if(n=(r&e.childLanes)!==0,t.flags&128){if(n)return jf(t,e,r);e.flags|=128}if(s=e.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),re(ue,ue.current),n)break;return null;case 22:case 23:return e.lanes=0,xf(t,e,r)}return Qt(t,e,r)}var Nf,cl,kf,Sf;Nf=function(t,e){for(var r=e.child;r!==null;){if(r.tag===5||r.tag===6)t.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===e)break;for(;r.sibling===null;){if(r.return===null||r.return===e)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};cl=function(){};kf=function(t,e,r,n){var s=t.memoizedProps;if(s!==n){t=e.stateNode,Fr(Ut.current);var a=null;switch(r){case"input":s=Po(t,s),n=Po(t,n),a=[];break;case"select":s=he({},s,{value:void 0}),n=he({},n,{value:void 0}),a=[];break;case"textarea":s=Io(t,s),n=Io(t,n),a=[];break;default:typeof s.onClick!="function"&&typeof n.onClick=="function"&&(t.onclick=Gi)}$o(r,n);var o;r=null;for(u in s)if(!n.hasOwnProperty(u)&&s.hasOwnProperty(u)&&s[u]!=null)if(u==="style"){var l=s[u];for(o in l)l.hasOwnProperty(o)&&(r||(r={}),r[o]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(bs.hasOwnProperty(u)?a||(a=[]):(a=a||[]).push(u,null));for(u in n){var c=n[u];if(l=s!=null?s[u]:void 0,n.hasOwnProperty(u)&&c!==l&&(c!=null||l!=null))if(u==="style")if(l){for(o in l)!l.hasOwnProperty(o)||c&&c.hasOwnProperty(o)||(r||(r={}),r[o]="");for(o in c)c.hasOwnProperty(o)&&l[o]!==c[o]&&(r||(r={}),r[o]=c[o])}else r||(a||(a=[]),a.push(u,r)),r=c;else u==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,l=l?l.__html:void 0,c!=null&&l!==c&&(a=a||[]).push(u,c)):u==="children"?typeof c!="string"&&typeof c!="number"||(a=a||[]).push(u,""+c):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(bs.hasOwnProperty(u)?(c!=null&&u==="onScroll"&&se("scroll",t),a||l===c||(a=[])):(a=a||[]).push(u,c))}r&&(a=a||[]).push("style",r);var u=a;(e.updateQueue=u)&&(e.flags|=4)}};Sf=function(t,e,r,n){r!==n&&(e.flags|=4)};function Yn(t,e){if(!oe)switch(t.tailMode){case"hidden":e=t.tail;for(var r=null;e!==null;)e.alternate!==null&&(r=e),e=e.sibling;r===null?t.tail=null:r.sibling=null;break;case"collapsed":r=t.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:n.sibling=null}}function Le(t){var e=t.alternate!==null&&t.alternate.child===t.child,r=0,n=0;if(e)for(var s=t.child;s!==null;)r|=s.lanes|s.childLanes,n|=s.subtreeFlags&14680064,n|=s.flags&14680064,s.return=t,s=s.sibling;else for(s=t.child;s!==null;)r|=s.lanes|s.childLanes,n|=s.subtreeFlags,n|=s.flags,s.return=t,s=s.sibling;return t.subtreeFlags|=n,t.childLanes=r,e}function Pg(t,e,r){var n=e.pendingProps;switch(ec(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Le(e),null;case 1:return Ye(e.type)&&Ji(),Le(e),null;case 3:return n=e.stateNode,Dn(),ie(Qe),ie(ze),cc(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(t===null||t.child===null)&&(pi(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,St!==null&&(yl(St),St=null))),cl(t,e),Le(e),null;case 5:lc(e);var s=Fr(Is.current);if(r=e.type,t!==null&&e.stateNode!=null)kf(t,e,r,n,s),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!n){if(e.stateNode===null)throw Error(E(166));return Le(e),null}if(t=Fr(Ut.current),pi(e)){n=e.stateNode,r=e.type;var a=e.memoizedProps;switch(n[$t]=e,n[Rs]=a,t=(e.mode&1)!==0,r){case"dialog":se("cancel",n),se("close",n);break;case"iframe":case"object":case"embed":se("load",n);break;case"video":case"audio":for(s=0;s<is.length;s++)se(is[s],n);break;case"source":se("error",n);break;case"img":case"image":case"link":se("error",n),se("load",n);break;case"details":se("toggle",n);break;case"input":qc(n,a),se("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!a.multiple},se("invalid",n);break;case"textarea":Wc(n,a),se("invalid",n)}$o(r,a),s=null;for(var o in a)if(a.hasOwnProperty(o)){var l=a[o];o==="children"?typeof l=="string"?n.textContent!==l&&(a.suppressHydrationWarning!==!0&&mi(n.textContent,l,t),s=["children",l]):typeof l=="number"&&n.textContent!==""+l&&(a.suppressHydrationWarning!==!0&&mi(n.textContent,l,t),s=["children",""+l]):bs.hasOwnProperty(o)&&l!=null&&o==="onScroll"&&se("scroll",n)}switch(r){case"input":ai(n),Vc(n,a,!0);break;case"textarea":ai(n),Hc(n);break;case"select":case"option":break;default:typeof a.onClick=="function"&&(n.onclick=Gi)}n=s,e.updateQueue=n,n!==null&&(e.flags|=4)}else{o=s.nodeType===9?s:s.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=Zd(r)),t==="http://www.w3.org/1999/xhtml"?r==="script"?(t=o.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof n.is=="string"?t=o.createElement(r,{is:n.is}):(t=o.createElement(r),r==="select"&&(o=t,n.multiple?o.multiple=!0:n.size&&(o.size=n.size))):t=o.createElementNS(t,r),t[$t]=e,t[Rs]=n,Nf(t,e,!1,!1),e.stateNode=t;e:{switch(o=Lo(r,n),r){case"dialog":se("cancel",t),se("close",t),s=n;break;case"iframe":case"object":case"embed":se("load",t),s=n;break;case"video":case"audio":for(s=0;s<is.length;s++)se(is[s],t);s=n;break;case"source":se("error",t),s=n;break;case"img":case"image":case"link":se("error",t),se("load",t),s=n;break;case"details":se("toggle",t),s=n;break;case"input":qc(t,n),s=Po(t,n),se("invalid",t);break;case"option":s=n;break;case"select":t._wrapperState={wasMultiple:!!n.multiple},s=he({},n,{value:void 0}),se("invalid",t);break;case"textarea":Wc(t,n),s=Io(t,n),se("invalid",t);break;default:s=n}$o(r,s),l=s;for(a in l)if(l.hasOwnProperty(a)){var c=l[a];a==="style"?rh(t,c):a==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&eh(t,c)):a==="children"?typeof c=="string"?(r!=="textarea"||c!=="")&&js(t,c):typeof c=="number"&&js(t,""+c):a!=="suppressContentEditableWarning"&&a!=="suppressHydrationWarning"&&a!=="autoFocus"&&(bs.hasOwnProperty(a)?c!=null&&a==="onScroll"&&se("scroll",t):c!=null&&Ml(t,a,c,o))}switch(r){case"input":ai(t),Vc(t,n,!1);break;case"textarea":ai(t),Hc(t);break;case"option":n.value!=null&&t.setAttribute("value",""+jr(n.value));break;case"select":t.multiple=!!n.multiple,a=n.value,a!=null?jn(t,!!n.multiple,a,!1):n.defaultValue!=null&&jn(t,!!n.multiple,n.defaultValue,!0);break;default:typeof s.onClick=="function"&&(t.onclick=Gi)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return Le(e),null;case 6:if(t&&e.stateNode!=null)Sf(t,e,t.memoizedProps,n);else{if(typeof n!="string"&&e.stateNode===null)throw Error(E(166));if(r=Fr(Is.current),Fr(Ut.current),pi(e)){if(n=e.stateNode,r=e.memoizedProps,n[$t]=e,(a=n.nodeValue!==r)&&(t=it,t!==null))switch(t.tag){case 3:mi(n.nodeValue,r,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&mi(n.nodeValue,r,(t.mode&1)!==0)}a&&(e.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[$t]=e,e.stateNode=n}return Le(e),null;case 13:if(ie(ue),n=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(oe&&st!==null&&e.mode&1&&!(e.flags&128))qh(),On(),e.flags|=98560,a=!1;else if(a=pi(e),n!==null&&n.dehydrated!==null){if(t===null){if(!a)throw Error(E(318));if(a=e.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(E(317));a[$t]=e}else On(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;Le(e),a=!1}else St!==null&&(yl(St),St=null),a=!0;if(!a)return e.flags&65536?e:null}return e.flags&128?(e.lanes=r,e):(n=n!==null,n!==(t!==null&&t.memoizedState!==null)&&n&&(e.child.flags|=8192,e.mode&1&&(t===null||ue.current&1?be===0&&(be=3):_c())),e.updateQueue!==null&&(e.flags|=4),Le(e),null);case 4:return Dn(),cl(t,e),t===null&&Ts(e.stateNode.containerInfo),Le(e),null;case 10:return sc(e.type._context),Le(e),null;case 17:return Ye(e.type)&&Ji(),Le(e),null;case 19:if(ie(ue),a=e.memoizedState,a===null)return Le(e),null;if(n=(e.flags&128)!==0,o=a.rendering,o===null)if(n)Yn(a,!1);else{if(be!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(o=ra(t),o!==null){for(e.flags|=128,Yn(a,!1),n=o.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),e.subtreeFlags=0,n=r,r=e.child;r!==null;)a=r,t=n,a.flags&=14680066,o=a.alternate,o===null?(a.childLanes=0,a.lanes=t,a.child=null,a.subtreeFlags=0,a.memoizedProps=null,a.memoizedState=null,a.updateQueue=null,a.dependencies=null,a.stateNode=null):(a.childLanes=o.childLanes,a.lanes=o.lanes,a.child=o.child,a.subtreeFlags=0,a.deletions=null,a.memoizedProps=o.memoizedProps,a.memoizedState=o.memoizedState,a.updateQueue=o.updateQueue,a.type=o.type,t=o.dependencies,a.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),r=r.sibling;return re(ue,ue.current&1|2),e.child}t=t.sibling}a.tail!==null&&ge()>Ln&&(e.flags|=128,n=!0,Yn(a,!1),e.lanes=4194304)}else{if(!n)if(t=ra(o),t!==null){if(e.flags|=128,n=!0,r=t.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),Yn(a,!0),a.tail===null&&a.tailMode==="hidden"&&!o.alternate&&!oe)return Le(e),null}else 2*ge()-a.renderingStartTime>Ln&&r!==1073741824&&(e.flags|=128,n=!0,Yn(a,!1),e.lanes=4194304);a.isBackwards?(o.sibling=e.child,e.child=o):(r=a.last,r!==null?r.sibling=o:e.child=o,a.last=o)}return a.tail!==null?(e=a.tail,a.rendering=e,a.tail=e.sibling,a.renderingStartTime=ge(),e.sibling=null,r=ue.current,re(ue,n?r&1|2:r&1),e):(Le(e),null);case 22:case 23:return wc(),n=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==n&&(e.flags|=8192),n&&e.mode&1?et&1073741824&&(Le(e),e.subtreeFlags&6&&(e.flags|=8192)):Le(e),null;case 24:return null;case 25:return null}throw Error(E(156,e.tag))}function Rg(t,e){switch(ec(e),e.tag){case 1:return Ye(e.type)&&Ji(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return Dn(),ie(Qe),ie(ze),cc(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return lc(e),null;case 13:if(ie(ue),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(E(340));On()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return ie(ue),null;case 4:return Dn(),null;case 10:return sc(e.type._context),null;case 22:case 23:return wc(),null;case 24:return null;default:return null}}var vi=!1,Me=!1,Og=typeof WeakSet=="function"?WeakSet:Set,O=null;function xn(t,e){var r=t.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){me(t,e,n)}else r.current=null}function ul(t,e,r){try{r()}catch(n){me(t,e,n)}}var Du=!1;function Ig(t,e){if(Ko=Wi,t=Th(),Xl(t)){if("selectionStart"in t)var r={start:t.selectionStart,end:t.selectionEnd};else e:{r=(r=t.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var s=n.anchorOffset,a=n.focusNode;n=n.focusOffset;try{r.nodeType,a.nodeType}catch{r=null;break e}var o=0,l=-1,c=-1,u=0,f=0,m=t,d=null;t:for(;;){for(var y;m!==r||s!==0&&m.nodeType!==3||(l=o+s),m!==a||n!==0&&m.nodeType!==3||(c=o+n),m.nodeType===3&&(o+=m.nodeValue.length),(y=m.firstChild)!==null;)d=m,m=y;for(;;){if(m===t)break t;if(d===r&&++u===s&&(l=o),d===a&&++f===n&&(c=o),(y=m.nextSibling)!==null)break;m=d,d=m.parentNode}m=y}r=l===-1||c===-1?null:{start:l,end:c}}else r=null}r=r||{start:0,end:0}}else r=null;for(Go={focusedElem:t,selectionRange:r},Wi=!1,O=e;O!==null;)if(e=O,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,O=t;else for(;O!==null;){e=O;try{var x=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(x!==null){var w=x.memoizedProps,C=x.memoizedState,p=e.stateNode,g=p.getSnapshotBeforeUpdate(e.elementType===e.type?w:bt(e.type,w),C);p.__reactInternalSnapshotBeforeUpdate=g}break;case 3:var v=e.stateNode.containerInfo;v.nodeType===1?v.textContent="":v.nodeType===9&&v.documentElement&&v.removeChild(v.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(E(163))}}catch(b){me(e,e.return,b)}if(t=e.sibling,t!==null){t.return=e.return,O=t;break}O=e.return}return x=Du,Du=!1,x}function ps(t,e,r){var n=e.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var s=n=n.next;do{if((s.tag&t)===t){var a=s.destroy;s.destroy=void 0,a!==void 0&&ul(e,r,a)}s=s.next}while(s!==n)}}function ka(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var r=e=e.next;do{if((r.tag&t)===t){var n=r.create;r.destroy=n()}r=r.next}while(r!==e)}}function dl(t){var e=t.ref;if(e!==null){var r=t.stateNode;switch(t.tag){case 5:t=r;break;default:t=r}typeof e=="function"?e(t):e.current=t}}function Cf(t){var e=t.alternate;e!==null&&(t.alternate=null,Cf(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[$t],delete e[Rs],delete e[Yo],delete e[gg],delete e[yg])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function Ef(t){return t.tag===5||t.tag===3||t.tag===4}function $u(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||Ef(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function hl(t,e,r){var n=t.tag;if(n===5||n===6)t=t.stateNode,e?r.nodeType===8?r.parentNode.insertBefore(t,e):r.insertBefore(t,e):(r.nodeType===8?(e=r.parentNode,e.insertBefore(t,r)):(e=r,e.appendChild(t)),r=r._reactRootContainer,r!=null||e.onclick!==null||(e.onclick=Gi));else if(n!==4&&(t=t.child,t!==null))for(hl(t,e,r),t=t.sibling;t!==null;)hl(t,e,r),t=t.sibling}function fl(t,e,r){var n=t.tag;if(n===5||n===6)t=t.stateNode,e?r.insertBefore(t,e):r.appendChild(t);else if(n!==4&&(t=t.child,t!==null))for(fl(t,e,r),t=t.sibling;t!==null;)fl(t,e,r),t=t.sibling}var Te=null,Nt=!1;function nr(t,e,r){for(r=r.child;r!==null;)Af(t,e,r),r=r.sibling}function Af(t,e,r){if(Lt&&typeof Lt.onCommitFiberUnmount=="function")try{Lt.onCommitFiberUnmount(ya,r)}catch{}switch(r.tag){case 5:Me||xn(r,e);case 6:var n=Te,s=Nt;Te=null,nr(t,e,r),Te=n,Nt=s,Te!==null&&(Nt?(t=Te,r=r.stateNode,t.nodeType===8?t.parentNode.removeChild(r):t.removeChild(r)):Te.removeChild(r.stateNode));break;case 18:Te!==null&&(Nt?(t=Te,r=r.stateNode,t.nodeType===8?to(t.parentNode,r):t.nodeType===1&&to(t,r),Cs(t)):to(Te,r.stateNode));break;case 4:n=Te,s=Nt,Te=r.stateNode.containerInfo,Nt=!0,nr(t,e,r),Te=n,Nt=s;break;case 0:case 11:case 14:case 15:if(!Me&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){s=n=n.next;do{var a=s,o=a.destroy;a=a.tag,o!==void 0&&(a&2||a&4)&&ul(r,e,o),s=s.next}while(s!==n)}nr(t,e,r);break;case 1:if(!Me&&(xn(r,e),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(l){me(r,e,l)}nr(t,e,r);break;case 21:nr(t,e,r);break;case 22:r.mode&1?(Me=(n=Me)||r.memoizedState!==null,nr(t,e,r),Me=n):nr(t,e,r);break;default:nr(t,e,r)}}function Lu(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var r=t.stateNode;r===null&&(r=t.stateNode=new Og),e.forEach(function(n){var s=qg.bind(null,t,n);r.has(n)||(r.add(n),n.then(s,s))})}}function wt(t,e){var r=e.deletions;if(r!==null)for(var n=0;n<r.length;n++){var s=r[n];try{var a=t,o=e,l=o;e:for(;l!==null;){switch(l.tag){case 5:Te=l.stateNode,Nt=!1;break e;case 3:Te=l.stateNode.containerInfo,Nt=!0;break e;case 4:Te=l.stateNode.containerInfo,Nt=!0;break e}l=l.return}if(Te===null)throw Error(E(160));Af(a,o,s),Te=null,Nt=!1;var c=s.alternate;c!==null&&(c.return=null),s.return=null}catch(u){me(s,e,u)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)Tf(e,t),e=e.sibling}function Tf(t,e){var r=t.alternate,n=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(wt(e,t),Ot(t),n&4){try{ps(3,t,t.return),ka(3,t)}catch(w){me(t,t.return,w)}try{ps(5,t,t.return)}catch(w){me(t,t.return,w)}}break;case 1:wt(e,t),Ot(t),n&512&&r!==null&&xn(r,r.return);break;case 5:if(wt(e,t),Ot(t),n&512&&r!==null&&xn(r,r.return),t.flags&32){var s=t.stateNode;try{js(s,"")}catch(w){me(t,t.return,w)}}if(n&4&&(s=t.stateNode,s!=null)){var a=t.memoizedProps,o=r!==null?r.memoizedProps:a,l=t.type,c=t.updateQueue;if(t.updateQueue=null,c!==null)try{l==="input"&&a.type==="radio"&&a.name!=null&&Yd(s,a),Lo(l,o);var u=Lo(l,a);for(o=0;o<c.length;o+=2){var f=c[o],m=c[o+1];f==="style"?rh(s,m):f==="dangerouslySetInnerHTML"?eh(s,m):f==="children"?js(s,m):Ml(s,f,m,u)}switch(l){case"input":Ro(s,a);break;case"textarea":Xd(s,a);break;case"select":var d=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!a.multiple;var y=a.value;y!=null?jn(s,!!a.multiple,y,!1):d!==!!a.multiple&&(a.defaultValue!=null?jn(s,!!a.multiple,a.defaultValue,!0):jn(s,!!a.multiple,a.multiple?[]:"",!1))}s[Rs]=a}catch(w){me(t,t.return,w)}}break;case 6:if(wt(e,t),Ot(t),n&4){if(t.stateNode===null)throw Error(E(162));s=t.stateNode,a=t.memoizedProps;try{s.nodeValue=a}catch(w){me(t,t.return,w)}}break;case 3:if(wt(e,t),Ot(t),n&4&&r!==null&&r.memoizedState.isDehydrated)try{Cs(e.containerInfo)}catch(w){me(t,t.return,w)}break;case 4:wt(e,t),Ot(t);break;case 13:wt(e,t),Ot(t),s=t.child,s.flags&8192&&(a=s.memoizedState!==null,s.stateNode.isHidden=a,!a||s.alternate!==null&&s.alternate.memoizedState!==null||(vc=ge())),n&4&&Lu(t);break;case 22:if(f=r!==null&&r.memoizedState!==null,t.mode&1?(Me=(u=Me)||f,wt(e,t),Me=u):wt(e,t),Ot(t),n&8192){if(u=t.memoizedState!==null,(t.stateNode.isHidden=u)&&!f&&t.mode&1)for(O=t,f=t.child;f!==null;){for(m=O=f;O!==null;){switch(d=O,y=d.child,d.tag){case 0:case 11:case 14:case 15:ps(4,d,d.return);break;case 1:xn(d,d.return);var x=d.stateNode;if(typeof x.componentWillUnmount=="function"){n=d,r=d.return;try{e=n,x.props=e.memoizedProps,x.state=e.memoizedState,x.componentWillUnmount()}catch(w){me(n,r,w)}}break;case 5:xn(d,d.return);break;case 22:if(d.memoizedState!==null){Mu(m);continue}}y!==null?(y.return=d,O=y):Mu(m)}f=f.sibling}e:for(f=null,m=t;;){if(m.tag===5){if(f===null){f=m;try{s=m.stateNode,u?(a=s.style,typeof a.setProperty=="function"?a.setProperty("display","none","important"):a.display="none"):(l=m.stateNode,c=m.memoizedProps.style,o=c!=null&&c.hasOwnProperty("display")?c.display:null,l.style.display=th("display",o))}catch(w){me(t,t.return,w)}}}else if(m.tag===6){if(f===null)try{m.stateNode.nodeValue=u?"":m.memoizedProps}catch(w){me(t,t.return,w)}}else if((m.tag!==22&&m.tag!==23||m.memoizedState===null||m===t)&&m.child!==null){m.child.return=m,m=m.child;continue}if(m===t)break e;for(;m.sibling===null;){if(m.return===null||m.return===t)break e;f===m&&(f=null),m=m.return}f===m&&(f=null),m.sibling.return=m.return,m=m.sibling}}break;case 19:wt(e,t),Ot(t),n&4&&Lu(t);break;case 21:break;default:wt(e,t),Ot(t)}}function Ot(t){var e=t.flags;if(e&2){try{e:{for(var r=t.return;r!==null;){if(Ef(r)){var n=r;break e}r=r.return}throw Error(E(160))}switch(n.tag){case 5:var s=n.stateNode;n.flags&32&&(js(s,""),n.flags&=-33);var a=$u(t);fl(t,a,s);break;case 3:case 4:var o=n.stateNode.containerInfo,l=$u(t);hl(t,l,o);break;default:throw Error(E(161))}}catch(c){me(t,t.return,c)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function Dg(t,e,r){O=t,Pf(t)}function Pf(t,e,r){for(var n=(t.mode&1)!==0;O!==null;){var s=O,a=s.child;if(s.tag===22&&n){var o=s.memoizedState!==null||vi;if(!o){var l=s.alternate,c=l!==null&&l.memoizedState!==null||Me;l=vi;var u=Me;if(vi=o,(Me=c)&&!u)for(O=s;O!==null;)o=O,c=o.child,o.tag===22&&o.memoizedState!==null?zu(s):c!==null?(c.return=o,O=c):zu(s);for(;a!==null;)O=a,Pf(a),a=a.sibling;O=s,vi=l,Me=u}Uu(t)}else s.subtreeFlags&8772&&a!==null?(a.return=s,O=a):Uu(t)}}function Uu(t){for(;O!==null;){var e=O;if(e.flags&8772){var r=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:Me||ka(5,e);break;case 1:var n=e.stateNode;if(e.flags&4&&!Me)if(r===null)n.componentDidMount();else{var s=e.elementType===e.type?r.memoizedProps:bt(e.type,r.memoizedProps);n.componentDidUpdate(s,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var a=e.updateQueue;a!==null&&bu(e,a,n);break;case 3:var o=e.updateQueue;if(o!==null){if(r=null,e.child!==null)switch(e.child.tag){case 5:r=e.child.stateNode;break;case 1:r=e.child.stateNode}bu(e,o,r)}break;case 5:var l=e.stateNode;if(r===null&&e.flags&4){r=l;var c=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&r.focus();break;case"img":c.src&&(r.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var u=e.alternate;if(u!==null){var f=u.memoizedState;if(f!==null){var m=f.dehydrated;m!==null&&Cs(m)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(E(163))}Me||e.flags&512&&dl(e)}catch(d){me(e,e.return,d)}}if(e===t){O=null;break}if(r=e.sibling,r!==null){r.return=e.return,O=r;break}O=e.return}}function Mu(t){for(;O!==null;){var e=O;if(e===t){O=null;break}var r=e.sibling;if(r!==null){r.return=e.return,O=r;break}O=e.return}}function zu(t){for(;O!==null;){var e=O;try{switch(e.tag){case 0:case 11:case 15:var r=e.return;try{ka(4,e)}catch(c){me(e,r,c)}break;case 1:var n=e.stateNode;if(typeof n.componentDidMount=="function"){var s=e.return;try{n.componentDidMount()}catch(c){me(e,s,c)}}var a=e.return;try{dl(e)}catch(c){me(e,a,c)}break;case 5:var o=e.return;try{dl(e)}catch(c){me(e,o,c)}}}catch(c){me(e,e.return,c)}if(e===t){O=null;break}var l=e.sibling;if(l!==null){l.return=e.return,O=l;break}O=e.return}}var $g=Math.ceil,ia=Yt.ReactCurrentDispatcher,gc=Yt.ReactCurrentOwner,gt=Yt.ReactCurrentBatchConfig,J=0,Se=null,ve=null,Re=0,et=0,wn=Sr(0),be=0,Us=null,Gr=0,Sa=0,yc=0,gs=null,Ge=null,vc=0,Ln=1/0,Mt=null,aa=!1,ml=null,wr=null,xi=!1,mr=null,oa=0,ys=0,pl=null,$i=-1,Li=0;function qe(){return J&6?ge():$i!==-1?$i:$i=ge()}function _r(t){return t.mode&1?J&2&&Re!==0?Re&-Re:xg.transition!==null?(Li===0&&(Li=mh()),Li):(t=Y,t!==0||(t=window.event,t=t===void 0?16:_h(t.type)),t):1}function Et(t,e,r,n){if(50<ys)throw ys=0,pl=null,Error(E(185));Js(t,r,n),(!(J&2)||t!==Se)&&(t===Se&&(!(J&2)&&(Sa|=r),be===4&&ur(t,Re)),Xe(t,n),r===1&&J===0&&!(e.mode&1)&&(Ln=ge()+500,ba&&Cr()))}function Xe(t,e){var r=t.callbackNode;xp(t,e);var n=Vi(t,t===Se?Re:0);if(n===0)r!==null&&Jc(r),t.callbackNode=null,t.callbackPriority=0;else if(e=n&-n,t.callbackPriority!==e){if(r!=null&&Jc(r),e===1)t.tag===0?vg(Fu.bind(null,t)):zh(Fu.bind(null,t)),mg(function(){!(J&6)&&Cr()}),r=null;else{switch(ph(n)){case 1:r=Vl;break;case 4:r=hh;break;case 16:r=qi;break;case 536870912:r=fh;break;default:r=qi}r=Mf(r,Rf.bind(null,t))}t.callbackPriority=e,t.callbackNode=r}}function Rf(t,e){if($i=-1,Li=0,J&6)throw Error(E(327));var r=t.callbackNode;if(En()&&t.callbackNode!==r)return null;var n=Vi(t,t===Se?Re:0);if(n===0)return null;if(n&30||n&t.expiredLanes||e)e=la(t,n);else{e=n;var s=J;J|=2;var a=If();(Se!==t||Re!==e)&&(Mt=null,Ln=ge()+500,qr(t,e));do try{Mg();break}catch(l){Of(t,l)}while(1);nc(),ia.current=a,J=s,ve!==null?e=0:(Se=null,Re=0,e=be)}if(e!==0){if(e===2&&(s=Bo(t),s!==0&&(n=s,e=gl(t,s))),e===1)throw r=Us,qr(t,0),ur(t,n),Xe(t,ge()),r;if(e===6)ur(t,n);else{if(s=t.current.alternate,!(n&30)&&!Lg(s)&&(e=la(t,n),e===2&&(a=Bo(t),a!==0&&(n=a,e=gl(t,a))),e===1))throw r=Us,qr(t,0),ur(t,n),Xe(t,ge()),r;switch(t.finishedWork=s,t.finishedLanes=n,e){case 0:case 1:throw Error(E(345));case 2:Dr(t,Ge,Mt);break;case 3:if(ur(t,n),(n&130023424)===n&&(e=vc+500-ge(),10<e)){if(Vi(t,0)!==0)break;if(s=t.suspendedLanes,(s&n)!==n){qe(),t.pingedLanes|=t.suspendedLanes&s;break}t.timeoutHandle=Qo(Dr.bind(null,t,Ge,Mt),e);break}Dr(t,Ge,Mt);break;case 4:if(ur(t,n),(n&4194240)===n)break;for(e=t.eventTimes,s=-1;0<n;){var o=31-Ct(n);a=1<<o,o=e[o],o>s&&(s=o),n&=~a}if(n=s,n=ge()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*$g(n/1960))-n,10<n){t.timeoutHandle=Qo(Dr.bind(null,t,Ge,Mt),n);break}Dr(t,Ge,Mt);break;case 5:Dr(t,Ge,Mt);break;default:throw Error(E(329))}}}return Xe(t,ge()),t.callbackNode===r?Rf.bind(null,t):null}function gl(t,e){var r=gs;return t.current.memoizedState.isDehydrated&&(qr(t,e).flags|=256),t=la(t,e),t!==2&&(e=Ge,Ge=r,e!==null&&yl(e)),t}function yl(t){Ge===null?Ge=t:Ge.push.apply(Ge,t)}function Lg(t){for(var e=t;;){if(e.flags&16384){var r=e.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var s=r[n],a=s.getSnapshot;s=s.value;try{if(!At(a(),s))return!1}catch{return!1}}}if(r=e.child,e.subtreeFlags&16384&&r!==null)r.return=e,e=r;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function ur(t,e){for(e&=~yc,e&=~Sa,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var r=31-Ct(e),n=1<<r;t[r]=-1,e&=~n}}function Fu(t){if(J&6)throw Error(E(327));En();var e=Vi(t,0);if(!(e&1))return Xe(t,ge()),null;var r=la(t,e);if(t.tag!==0&&r===2){var n=Bo(t);n!==0&&(e=n,r=gl(t,n))}if(r===1)throw r=Us,qr(t,0),ur(t,e),Xe(t,ge()),r;if(r===6)throw Error(E(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,Dr(t,Ge,Mt),Xe(t,ge()),null}function xc(t,e){var r=J;J|=1;try{return t(e)}finally{J=r,J===0&&(Ln=ge()+500,ba&&Cr())}}function Jr(t){mr!==null&&mr.tag===0&&!(J&6)&&En();var e=J;J|=1;var r=gt.transition,n=Y;try{if(gt.transition=null,Y=1,t)return t()}finally{Y=n,gt.transition=r,J=e,!(J&6)&&Cr()}}function wc(){et=wn.current,ie(wn)}function qr(t,e){t.finishedWork=null,t.finishedLanes=0;var r=t.timeoutHandle;if(r!==-1&&(t.timeoutHandle=-1,fg(r)),ve!==null)for(r=ve.return;r!==null;){var n=r;switch(ec(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&Ji();break;case 3:Dn(),ie(Qe),ie(ze),cc();break;case 5:lc(n);break;case 4:Dn();break;case 13:ie(ue);break;case 19:ie(ue);break;case 10:sc(n.type._context);break;case 22:case 23:wc()}r=r.return}if(Se=t,ve=t=br(t.current,null),Re=et=e,be=0,Us=null,yc=Sa=Gr=0,Ge=gs=null,zr!==null){for(e=0;e<zr.length;e++)if(r=zr[e],n=r.interleaved,n!==null){r.interleaved=null;var s=n.next,a=r.pending;if(a!==null){var o=a.next;a.next=s,n.next=o}r.pending=n}zr=null}return t}function Of(t,e){do{var r=ve;try{if(nc(),Oi.current=sa,na){for(var n=de.memoizedState;n!==null;){var s=n.queue;s!==null&&(s.pending=null),n=n.next}na=!1}if(Kr=0,ke=_e=de=null,ms=!1,Ds=0,gc.current=null,r===null||r.return===null){be=1,Us=e,ve=null;break}e:{var a=t,o=r.return,l=r,c=e;if(e=Re,l.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var u=c,f=l,m=f.tag;if(!(f.mode&1)&&(m===0||m===11||m===15)){var d=f.alternate;d?(f.updateQueue=d.updateQueue,f.memoizedState=d.memoizedState,f.lanes=d.lanes):(f.updateQueue=null,f.memoizedState=null)}var y=Eu(o);if(y!==null){y.flags&=-257,Au(y,o,l,a,e),y.mode&1&&Cu(a,u,e),e=y,c=u;var x=e.updateQueue;if(x===null){var w=new Set;w.add(c),e.updateQueue=w}else x.add(c);break e}else{if(!(e&1)){Cu(a,u,e),_c();break e}c=Error(E(426))}}else if(oe&&l.mode&1){var C=Eu(o);if(C!==null){!(C.flags&65536)&&(C.flags|=256),Au(C,o,l,a,e),tc($n(c,l));break e}}a=c=$n(c,l),be!==4&&(be=2),gs===null?gs=[a]:gs.push(a),a=o;do{switch(a.tag){case 3:a.flags|=65536,e&=-e,a.lanes|=e;var p=gf(a,c,e);_u(a,p);break e;case 1:l=c;var g=a.type,v=a.stateNode;if(!(a.flags&128)&&(typeof g.getDerivedStateFromError=="function"||v!==null&&typeof v.componentDidCatch=="function"&&(wr===null||!wr.has(v)))){a.flags|=65536,e&=-e,a.lanes|=e;var b=yf(a,l,e);_u(a,b);break e}}a=a.return}while(a!==null)}$f(r)}catch(j){e=j,ve===r&&r!==null&&(ve=r=r.return);continue}break}while(1)}function If(){var t=ia.current;return ia.current=sa,t===null?sa:t}function _c(){(be===0||be===3||be===2)&&(be=4),Se===null||!(Gr&268435455)&&!(Sa&268435455)||ur(Se,Re)}function la(t,e){var r=J;J|=2;var n=If();(Se!==t||Re!==e)&&(Mt=null,qr(t,e));do try{Ug();break}catch(s){Of(t,s)}while(1);if(nc(),J=r,ia.current=n,ve!==null)throw Error(E(261));return Se=null,Re=0,be}function Ug(){for(;ve!==null;)Df(ve)}function Mg(){for(;ve!==null&&!up();)Df(ve)}function Df(t){var e=Uf(t.alternate,t,et);t.memoizedProps=t.pendingProps,e===null?$f(t):ve=e,gc.current=null}function $f(t){var e=t;do{var r=e.alternate;if(t=e.return,e.flags&32768){if(r=Rg(r,e),r!==null){r.flags&=32767,ve=r;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{be=6,ve=null;return}}else if(r=Pg(r,e,et),r!==null){ve=r;return}if(e=e.sibling,e!==null){ve=e;return}ve=e=t}while(e!==null);be===0&&(be=5)}function Dr(t,e,r){var n=Y,s=gt.transition;try{gt.transition=null,Y=1,zg(t,e,r,n)}finally{gt.transition=s,Y=n}return null}function zg(t,e,r,n){do En();while(mr!==null);if(J&6)throw Error(E(327));r=t.finishedWork;var s=t.finishedLanes;if(r===null)return null;if(t.finishedWork=null,t.finishedLanes=0,r===t.current)throw Error(E(177));t.callbackNode=null,t.callbackPriority=0;var a=r.lanes|r.childLanes;if(wp(t,a),t===Se&&(ve=Se=null,Re=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||xi||(xi=!0,Mf(qi,function(){return En(),null})),a=(r.flags&15990)!==0,r.subtreeFlags&15990||a){a=gt.transition,gt.transition=null;var o=Y;Y=1;var l=J;J|=4,gc.current=null,Ig(t,r),Tf(r,t),ag(Go),Wi=!!Ko,Go=Ko=null,t.current=r,Dg(r),dp(),J=l,Y=o,gt.transition=a}else t.current=r;if(xi&&(xi=!1,mr=t,oa=s),a=t.pendingLanes,a===0&&(wr=null),mp(r.stateNode),Xe(t,ge()),e!==null)for(n=t.onRecoverableError,r=0;r<e.length;r++)s=e[r],n(s.value,{componentStack:s.stack,digest:s.digest});if(aa)throw aa=!1,t=ml,ml=null,t;return oa&1&&t.tag!==0&&En(),a=t.pendingLanes,a&1?t===pl?ys++:(ys=0,pl=t):ys=0,Cr(),null}function En(){if(mr!==null){var t=ph(oa),e=gt.transition,r=Y;try{if(gt.transition=null,Y=16>t?16:t,mr===null)var n=!1;else{if(t=mr,mr=null,oa=0,J&6)throw Error(E(331));var s=J;for(J|=4,O=t.current;O!==null;){var a=O,o=a.child;if(O.flags&16){var l=a.deletions;if(l!==null){for(var c=0;c<l.length;c++){var u=l[c];for(O=u;O!==null;){var f=O;switch(f.tag){case 0:case 11:case 15:ps(8,f,a)}var m=f.child;if(m!==null)m.return=f,O=m;else for(;O!==null;){f=O;var d=f.sibling,y=f.return;if(Cf(f),f===u){O=null;break}if(d!==null){d.return=y,O=d;break}O=y}}}var x=a.alternate;if(x!==null){var w=x.child;if(w!==null){x.child=null;do{var C=w.sibling;w.sibling=null,w=C}while(w!==null)}}O=a}}if(a.subtreeFlags&2064&&o!==null)o.return=a,O=o;else e:for(;O!==null;){if(a=O,a.flags&2048)switch(a.tag){case 0:case 11:case 15:ps(9,a,a.return)}var p=a.sibling;if(p!==null){p.return=a.return,O=p;break e}O=a.return}}var g=t.current;for(O=g;O!==null;){o=O;var v=o.child;if(o.subtreeFlags&2064&&v!==null)v.return=o,O=v;else e:for(o=g;O!==null;){if(l=O,l.flags&2048)try{switch(l.tag){case 0:case 11:case 15:ka(9,l)}}catch(j){me(l,l.return,j)}if(l===o){O=null;break e}var b=l.sibling;if(b!==null){b.return=l.return,O=b;break e}O=l.return}}if(J=s,Cr(),Lt&&typeof Lt.onPostCommitFiberRoot=="function")try{Lt.onPostCommitFiberRoot(ya,t)}catch{}n=!0}return n}finally{Y=r,gt.transition=e}}return!1}function Bu(t,e,r){e=$n(r,e),e=gf(t,e,1),t=xr(t,e,1),e=qe(),t!==null&&(Js(t,1,e),Xe(t,e))}function me(t,e,r){if(t.tag===3)Bu(t,t,r);else for(;e!==null;){if(e.tag===3){Bu(e,t,r);break}else if(e.tag===1){var n=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(wr===null||!wr.has(n))){t=$n(r,t),t=yf(e,t,1),e=xr(e,t,1),t=qe(),e!==null&&(Js(e,1,t),Xe(e,t));break}}e=e.return}}function Fg(t,e,r){var n=t.pingCache;n!==null&&n.delete(e),e=qe(),t.pingedLanes|=t.suspendedLanes&r,Se===t&&(Re&r)===r&&(be===4||be===3&&(Re&130023424)===Re&&500>ge()-vc?qr(t,0):yc|=r),Xe(t,e)}function Lf(t,e){e===0&&(t.mode&1?(e=ci,ci<<=1,!(ci&130023424)&&(ci=4194304)):e=1);var r=qe();t=Jt(t,e),t!==null&&(Js(t,e,r),Xe(t,r))}function Bg(t){var e=t.memoizedState,r=0;e!==null&&(r=e.retryLane),Lf(t,r)}function qg(t,e){var r=0;switch(t.tag){case 13:var n=t.stateNode,s=t.memoizedState;s!==null&&(r=s.retryLane);break;case 19:n=t.stateNode;break;default:throw Error(E(314))}n!==null&&n.delete(e),Lf(t,r)}var Uf;Uf=function(t,e,r){if(t!==null)if(t.memoizedProps!==e.pendingProps||Qe.current)Je=!0;else{if(!(t.lanes&r)&&!(e.flags&128))return Je=!1,Tg(t,e,r);Je=!!(t.flags&131072)}else Je=!1,oe&&e.flags&1048576&&Fh(e,Xi,e.index);switch(e.lanes=0,e.tag){case 2:var n=e.type;Di(t,e),t=e.pendingProps;var s=Rn(e,ze.current);Cn(e,r),s=dc(null,e,n,t,s,r);var a=hc();return e.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,Ye(n)?(a=!0,Qi(e)):a=!1,e.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,ac(e),s.updater=Na,e.stateNode=s,s._reactInternals=e,nl(e,n,t,r),e=al(null,e,n,!0,a,r)):(e.tag=0,oe&&a&&Zl(e),Be(null,e,s,r),e=e.child),e;case 16:n=e.elementType;e:{switch(Di(t,e),t=e.pendingProps,s=n._init,n=s(n._payload),e.type=n,s=e.tag=Wg(n),t=bt(n,t),s){case 0:e=il(null,e,n,t,r);break e;case 1:e=Ru(null,e,n,t,r);break e;case 11:e=Tu(null,e,n,t,r);break e;case 14:e=Pu(null,e,n,bt(n.type,t),r);break e}throw Error(E(306,n,""))}return e;case 0:return n=e.type,s=e.pendingProps,s=e.elementType===n?s:bt(n,s),il(t,e,n,s,r);case 1:return n=e.type,s=e.pendingProps,s=e.elementType===n?s:bt(n,s),Ru(t,e,n,s,r);case 3:e:{if(_f(e),t===null)throw Error(E(387));n=e.pendingProps,a=e.memoizedState,s=a.element,Kh(t,e),ta(e,n,null,r);var o=e.memoizedState;if(n=o.element,a.isDehydrated)if(a={element:n,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=a,e.memoizedState=a,e.flags&256){s=$n(Error(E(423)),e),e=Ou(t,e,n,r,s);break e}else if(n!==s){s=$n(Error(E(424)),e),e=Ou(t,e,n,r,s);break e}else for(st=vr(e.stateNode.containerInfo.firstChild),it=e,oe=!0,St=null,r=Wh(e,null,n,r),e.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(On(),n===s){e=Qt(t,e,r);break e}Be(t,e,n,r)}e=e.child}return e;case 5:return Gh(e),t===null&&el(e),n=e.type,s=e.pendingProps,a=t!==null?t.memoizedProps:null,o=s.children,Jo(n,s)?o=null:a!==null&&Jo(n,a)&&(e.flags|=32),wf(t,e),Be(t,e,o,r),e.child;case 6:return t===null&&el(e),null;case 13:return bf(t,e,r);case 4:return oc(e,e.stateNode.containerInfo),n=e.pendingProps,t===null?e.child=In(e,null,n,r):Be(t,e,n,r),e.child;case 11:return n=e.type,s=e.pendingProps,s=e.elementType===n?s:bt(n,s),Tu(t,e,n,s,r);case 7:return Be(t,e,e.pendingProps,r),e.child;case 8:return Be(t,e,e.pendingProps.children,r),e.child;case 12:return Be(t,e,e.pendingProps.children,r),e.child;case 10:e:{if(n=e.type._context,s=e.pendingProps,a=e.memoizedProps,o=s.value,re(Zi,n._currentValue),n._currentValue=o,a!==null)if(At(a.value,o)){if(a.children===s.children&&!Qe.current){e=Qt(t,e,r);break e}}else for(a=e.child,a!==null&&(a.return=e);a!==null;){var l=a.dependencies;if(l!==null){o=a.child;for(var c=l.firstContext;c!==null;){if(c.context===n){if(a.tag===1){c=Wt(-1,r&-r),c.tag=2;var u=a.updateQueue;if(u!==null){u=u.shared;var f=u.pending;f===null?c.next=c:(c.next=f.next,f.next=c),u.pending=c}}a.lanes|=r,c=a.alternate,c!==null&&(c.lanes|=r),tl(a.return,r,e),l.lanes|=r;break}c=c.next}}else if(a.tag===10)o=a.type===e.type?null:a.child;else if(a.tag===18){if(o=a.return,o===null)throw Error(E(341));o.lanes|=r,l=o.alternate,l!==null&&(l.lanes|=r),tl(o,r,e),o=a.sibling}else o=a.child;if(o!==null)o.return=a;else for(o=a;o!==null;){if(o===e){o=null;break}if(a=o.sibling,a!==null){a.return=o.return,o=a;break}o=o.return}a=o}Be(t,e,s.children,r),e=e.child}return e;case 9:return s=e.type,n=e.pendingProps.children,Cn(e,r),s=yt(s),n=n(s),e.flags|=1,Be(t,e,n,r),e.child;case 14:return n=e.type,s=bt(n,e.pendingProps),s=bt(n.type,s),Pu(t,e,n,s,r);case 15:return vf(t,e,e.type,e.pendingProps,r);case 17:return n=e.type,s=e.pendingProps,s=e.elementType===n?s:bt(n,s),Di(t,e),e.tag=1,Ye(n)?(t=!0,Qi(e)):t=!1,Cn(e,r),pf(e,n,s),nl(e,n,s,r),al(null,e,n,!0,t,r);case 19:return jf(t,e,r);case 22:return xf(t,e,r)}throw Error(E(156,e.tag))};function Mf(t,e){return dh(t,e)}function Vg(t,e,r,n){this.tag=t,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function pt(t,e,r,n){return new Vg(t,e,r,n)}function bc(t){return t=t.prototype,!(!t||!t.isReactComponent)}function Wg(t){if(typeof t=="function")return bc(t)?1:0;if(t!=null){if(t=t.$$typeof,t===Fl)return 11;if(t===Bl)return 14}return 2}function br(t,e){var r=t.alternate;return r===null?(r=pt(t.tag,e,t.key,t.mode),r.elementType=t.elementType,r.type=t.type,r.stateNode=t.stateNode,r.alternate=t,t.alternate=r):(r.pendingProps=e,r.type=t.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=t.flags&14680064,r.childLanes=t.childLanes,r.lanes=t.lanes,r.child=t.child,r.memoizedProps=t.memoizedProps,r.memoizedState=t.memoizedState,r.updateQueue=t.updateQueue,e=t.dependencies,r.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},r.sibling=t.sibling,r.index=t.index,r.ref=t.ref,r}function Ui(t,e,r,n,s,a){var o=2;if(n=t,typeof t=="function")bc(t)&&(o=1);else if(typeof t=="string")o=5;else e:switch(t){case un:return Vr(r.children,s,a,e);case zl:o=8,s|=8;break;case Co:return t=pt(12,r,e,s|2),t.elementType=Co,t.lanes=a,t;case Eo:return t=pt(13,r,e,s),t.elementType=Eo,t.lanes=a,t;case Ao:return t=pt(19,r,e,s),t.elementType=Ao,t.lanes=a,t;case Gd:return Ca(r,s,a,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case Hd:o=10;break e;case Kd:o=9;break e;case Fl:o=11;break e;case Bl:o=14;break e;case sr:o=16,n=null;break e}throw Error(E(130,t==null?t:typeof t,""))}return e=pt(o,r,e,s),e.elementType=t,e.type=n,e.lanes=a,e}function Vr(t,e,r,n){return t=pt(7,t,n,e),t.lanes=r,t}function Ca(t,e,r,n){return t=pt(22,t,n,e),t.elementType=Gd,t.lanes=r,t.stateNode={isHidden:!1},t}function co(t,e,r){return t=pt(6,t,null,e),t.lanes=r,t}function uo(t,e,r){return e=pt(4,t.children!==null?t.children:[],t.key,e),e.lanes=r,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function Hg(t,e,r,n,s){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Va(0),this.expirationTimes=Va(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Va(0),this.identifierPrefix=n,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function jc(t,e,r,n,s,a,o,l,c){return t=new Hg(t,e,r,l,c),e===1?(e=1,a===!0&&(e|=8)):e=0,a=pt(3,null,null,e),t.current=a,a.stateNode=t,a.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},ac(a),t}function Kg(t,e,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:cn,key:n==null?null:""+n,children:t,containerInfo:e,implementation:r}}function zf(t){if(!t)return Nr;t=t._reactInternals;e:{if(Yr(t)!==t||t.tag!==1)throw Error(E(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(Ye(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(E(171))}if(t.tag===1){var r=t.type;if(Ye(r))return Mh(t,r,e)}return e}function Ff(t,e,r,n,s,a,o,l,c){return t=jc(r,n,!0,t,s,a,o,l,c),t.context=zf(null),r=t.current,n=qe(),s=_r(r),a=Wt(n,s),a.callback=e??null,xr(r,a,s),t.current.lanes=s,Js(t,s,n),Xe(t,n),t}function Ea(t,e,r,n){var s=e.current,a=qe(),o=_r(s);return r=zf(r),e.context===null?e.context=r:e.pendingContext=r,e=Wt(a,o),e.payload={element:t},n=n===void 0?null:n,n!==null&&(e.callback=n),t=xr(s,e,o),t!==null&&(Et(t,s,o,a),Ri(t,s,o)),o}function ca(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function qu(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var r=t.retryLane;t.retryLane=r!==0&&r<e?r:e}}function Nc(t,e){qu(t,e),(t=t.alternate)&&qu(t,e)}function Gg(){return null}var Bf=typeof reportError=="function"?reportError:function(t){console.error(t)};function kc(t){this._internalRoot=t}Aa.prototype.render=kc.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(E(409));Ea(t,e,null,null)};Aa.prototype.unmount=kc.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;Jr(function(){Ea(null,t,null,null)}),e[Gt]=null}};function Aa(t){this._internalRoot=t}Aa.prototype.unstable_scheduleHydration=function(t){if(t){var e=vh();t={blockedOn:null,target:t,priority:e};for(var r=0;r<cr.length&&e!==0&&e<cr[r].priority;r++);cr.splice(r,0,t),r===0&&wh(t)}};function Sc(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function Ta(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function Vu(){}function Jg(t,e,r,n,s){if(s){if(typeof n=="function"){var a=n;n=function(){var u=ca(o);a.call(u)}}var o=Ff(e,n,t,0,null,!1,!1,"",Vu);return t._reactRootContainer=o,t[Gt]=o.current,Ts(t.nodeType===8?t.parentNode:t),Jr(),o}for(;s=t.lastChild;)t.removeChild(s);if(typeof n=="function"){var l=n;n=function(){var u=ca(c);l.call(u)}}var c=jc(t,0,!1,null,null,!1,!1,"",Vu);return t._reactRootContainer=c,t[Gt]=c.current,Ts(t.nodeType===8?t.parentNode:t),Jr(function(){Ea(e,c,r,n)}),c}function Pa(t,e,r,n,s){var a=r._reactRootContainer;if(a){var o=a;if(typeof s=="function"){var l=s;s=function(){var c=ca(o);l.call(c)}}Ea(e,o,t,s)}else o=Jg(r,e,t,s,n);return ca(o)}gh=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var r=ss(e.pendingLanes);r!==0&&(Wl(e,r|1),Xe(e,ge()),!(J&6)&&(Ln=ge()+500,Cr()))}break;case 13:Jr(function(){var n=Jt(t,1);if(n!==null){var s=qe();Et(n,t,1,s)}}),Nc(t,1)}};Hl=function(t){if(t.tag===13){var e=Jt(t,134217728);if(e!==null){var r=qe();Et(e,t,134217728,r)}Nc(t,134217728)}};yh=function(t){if(t.tag===13){var e=_r(t),r=Jt(t,e);if(r!==null){var n=qe();Et(r,t,e,n)}Nc(t,e)}};vh=function(){return Y};xh=function(t,e){var r=Y;try{return Y=t,e()}finally{Y=r}};Mo=function(t,e,r){switch(e){case"input":if(Ro(t,r),e=r.name,r.type==="radio"&&e!=null){for(r=t;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<r.length;e++){var n=r[e];if(n!==t&&n.form===t.form){var s=_a(n);if(!s)throw Error(E(90));Qd(n),Ro(n,s)}}}break;case"textarea":Xd(t,r);break;case"select":e=r.value,e!=null&&jn(t,!!r.multiple,e,!1)}};ih=xc;ah=Jr;var Qg={usingClientEntryPoint:!1,Events:[Ys,mn,_a,nh,sh,xc]},Xn={findFiberByHostInstance:Mr,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},Yg={bundleType:Xn.bundleType,version:Xn.version,rendererPackageName:Xn.rendererPackageName,rendererConfig:Xn.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Yt.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=ch(t),t===null?null:t.stateNode},findFiberByHostInstance:Xn.findFiberByHostInstance||Gg,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var wi=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!wi.isDisabled&&wi.supportsFiber)try{ya=wi.inject(Yg),Lt=wi}catch{}}ot.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Qg;ot.createPortal=function(t,e){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Sc(e))throw Error(E(200));return Kg(t,e,null,r)};ot.createRoot=function(t,e){if(!Sc(t))throw Error(E(299));var r=!1,n="",s=Bf;return e!=null&&(e.unstable_strictMode===!0&&(r=!0),e.identifierPrefix!==void 0&&(n=e.identifierPrefix),e.onRecoverableError!==void 0&&(s=e.onRecoverableError)),e=jc(t,1,!1,null,null,r,!1,n,s),t[Gt]=e.current,Ts(t.nodeType===8?t.parentNode:t),new kc(e)};ot.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(E(188)):(t=Object.keys(t).join(","),Error(E(268,t)));return t=ch(e),t=t===null?null:t.stateNode,t};ot.flushSync=function(t){return Jr(t)};ot.hydrate=function(t,e,r){if(!Ta(e))throw Error(E(200));return Pa(null,t,e,!0,r)};ot.hydrateRoot=function(t,e,r){if(!Sc(t))throw Error(E(405));var n=r!=null&&r.hydratedSources||null,s=!1,a="",o=Bf;if(r!=null&&(r.unstable_strictMode===!0&&(s=!0),r.identifierPrefix!==void 0&&(a=r.identifierPrefix),r.onRecoverableError!==void 0&&(o=r.onRecoverableError)),e=Ff(e,null,t,1,r??null,s,!1,a,o),t[Gt]=e.current,Ts(t),n)for(t=0;t<n.length;t++)r=n[t],s=r._getVersion,s=s(r._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[r,s]:e.mutableSourceEagerHydrationData.push(r,s);return new Aa(e)};ot.render=function(t,e,r){if(!Ta(e))throw Error(E(200));return Pa(null,t,e,!1,r)};ot.unmountComponentAtNode=function(t){if(!Ta(t))throw Error(E(40));return t._reactRootContainer?(Jr(function(){Pa(null,null,t,!1,function(){t._reactRootContainer=null,t[Gt]=null})}),!0):!1};ot.unstable_batchedUpdates=xc;ot.unstable_renderSubtreeIntoContainer=function(t,e,r,n){if(!Ta(r))throw Error(E(200));if(t==null||t._reactInternals===void 0)throw Error(E(38));return Pa(t,e,r,!1,n)};ot.version="18.3.1-next-f1338f8080-20240426";function qf(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(qf)}catch(t){console.error(t)}}qf(),Bd.exports=ot;var Xg=Bd.exports,Wu=Xg;ko.createRoot=Wu.createRoot,ko.hydrateRoot=Wu.hydrateRoot;var Zg={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const e0=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),t0=(t,e)=>{const r=k.forwardRef(({color:n="currentColor",size:s=24,strokeWidth:a=2,absoluteStrokeWidth:o,children:l,...c},u)=>k.createElement("svg",{ref:u,...Zg,width:s,height:s,stroke:n,strokeWidth:o?Number(a)*24/Number(s):a,className:`lucide lucide-${e0(t)}`,...c},[...e.map(([f,m])=>k.createElement(f,m)),...(Array.isArray(l)?l:[l])||[]]));return r.displayName=`${t}`,r};var L=t0;const Ms=L("Activity",[["path",{d:"M22 12h-4l-3 9L9 3l-3 9H2",key:"d5dnw9"}]]),Vf=L("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]),zs=L("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]),ho=L("Award",[["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}],["path",{d:"M15.477 12.89 17 22l-5-3-5 3 1.523-9.11",key:"em7aur"}]]),r0=L("BarChart3",[["path",{d:"M3 3v18h18",key:"1s2lah"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]),n0=L("Building2",[["path",{d:"M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z",key:"1b4qmf"}],["path",{d:"M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2",key:"i71pzd"}],["path",{d:"M18 9h2a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-2",key:"10jefs"}],["path",{d:"M10 6h4",key:"1itunk"}],["path",{d:"M10 10h4",key:"tcdvrf"}],["path",{d:"M10 14h4",key:"kelpxr"}],["path",{d:"M10 18h4",key:"1ulq68"}]]),Hu=L("Building",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",ry:"2",key:"76otgf"}],["path",{d:"M9 22v-4h6v4",key:"r93iot"}],["path",{d:"M8 6h.01",key:"1dz90k"}],["path",{d:"M16 6h.01",key:"1x0f13"}],["path",{d:"M12 6h.01",key:"1vi96p"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M8 14h.01",key:"6423bh"}]]),mt=L("Calendar",[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",ry:"2",key:"eu3xkr"}],["line",{x1:"16",x2:"16",y1:"2",y2:"6",key:"m3sa8f"}],["line",{x1:"8",x2:"8",y1:"2",y2:"6",key:"18kwsl"}],["line",{x1:"3",x2:"21",y1:"10",y2:"10",key:"xt86sb"}]]),s0=L("CheckCircle2",[["path",{d:"M12 22c5.523 0 10-4.477 10-10S17.523 2 12 2 2 6.477 2 12s4.477 10 10 10z",key:"14v8dr"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]),vl=L("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["polyline",{points:"22 4 12 14.01 9 11.01",key:"6xbx8j"}]]),_i=L("Check",[["polyline",{points:"20 6 9 17 4 12",key:"10jjfj"}]]),i0=L("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]),Fs=L("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]),a0=L("CloudOff",[["path",{d:"m2 2 20 20",key:"1ooewy"}],["path",{d:"M5.782 5.782A7 7 0 0 0 9 19h8.5a4.5 4.5 0 0 0 1.307-.193",key:"yfwify"}],["path",{d:"M21.532 16.5A4.5 4.5 0 0 0 17.5 10h-1.79A7.008 7.008 0 0 0 10 5.07",key:"jlfiyv"}]]),Ku=L("Cloud",[["path",{d:"M17.5 19H9a7 7 0 1 1 6.71-9h1.79a4.5 4.5 0 1 1 0 9Z",key:"p7xjir"}]]),fo=L("CreditCard",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]]),o0=L("Database",[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]]),Gu=L("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]),Ju=L("ExternalLink",[["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}],["polyline",{points:"15 3 21 3 21 9",key:"mznyad"}],["line",{x1:"10",x2:"21",y1:"14",y2:"3",key:"18c3s4"}]]),l0=L("EyeOff",[["path",{d:"M9.88 9.88a3 3 0 1 0 4.24 4.24",key:"1jxqfv"}],["path",{d:"M10.73 5.08A10.43 10.43 0 0 1 12 5c7 0 10 7 10 7a13.16 13.16 0 0 1-1.67 2.68",key:"9wicm4"}],["path",{d:"M6.61 6.61A13.526 13.526 0 0 0 2 12s3 7 10 7a9.74 9.74 0 0 0 5.39-1.61",key:"1jreej"}],["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}]]),Wf=L("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),c0=L("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]),dr=L("Gift",[["polyline",{points:"20 12 20 22 4 22 4 12",key:"nda8fc"}],["rect",{width:"20",height:"5",x:"2",y:"7",key:"wkgdzj"}],["line",{x1:"12",x2:"12",y1:"22",y2:"7",key:"1n8zgp"}],["path",{d:"M12 7H7.5a2.5 2.5 0 0 1 0-5C11 2 12 7 12 7z",key:"zighg4"}],["path",{d:"M12 7h4.5a2.5 2.5 0 0 0 0-5C13 2 12 7 12 7z",key:"1pa5tk"}]]),u0=L("Home",[["path",{d:"m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"y5dka4"}],["polyline",{points:"9 22 9 12 15 12 15 22",key:"e2us08"}]]),Qu=L("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]),d0=L("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]),Yu=L("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]),h0=L("LogIn",[["path",{d:"M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4",key:"u53s6r"}],["polyline",{points:"10 17 15 12 10 7",key:"1ail0h"}],["line",{x1:"15",x2:"3",y1:"12",y2:"12",key:"v6grx8"}]]),xl=L("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]),Xu=L("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]]),f0=L("Monitor",[["rect",{width:"20",height:"14",x:"2",y:"3",rx:"2",key:"48i651"}],["line",{x1:"8",x2:"16",y1:"21",y2:"21",key:"1svkeh"}],["line",{x1:"12",x2:"12",y1:"17",y2:"21",key:"vw1qmm"}]]),as=L("PenLine",[["path",{d:"M12 20h9",key:"t2du7b"}],["path",{d:"M16.5 3.5a2.12 2.12 0 0 1 3 3L7 19l-4 1 1-4Z",key:"ymcmye"}]]),ua=L("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]),Zn=L("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]),m0=L("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]),wl=L("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]),Un=L("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]),_l=L("Send",[["path",{d:"m22 2-7 20-4-9-9-4Z",key:"1q3vgg"}],["path",{d:"M22 2 11 13",key:"nzbqef"}]]),da=L("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),Zu=L("Share",[["path",{d:"M4 12v8a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-8",key:"1b2hhj"}],["polyline",{points:"16 6 12 2 8 6",key:"m901s6"}],["line",{x1:"12",x2:"12",y1:"2",y2:"15",key:"1p0rca"}]]),Ht=L("Shield",[["path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z",key:"3xmgem"}]]),ed=L("Smartphone",[["rect",{width:"14",height:"20",x:"5",y:"2",rx:"2",ry:"2",key:"1yt0o3"}],["path",{d:"M12 18h.01",key:"mhygvu"}]]),_n=L("Stethoscope",[["path",{d:"M4.8 2.3A.3.3 0 1 0 5 2H4a2 2 0 0 0-2 2v5a6 6 0 0 0 6 6v0a6 6 0 0 0 6-6V4a2 2 0 0 0-2-2h-1a.2.2 0 1 0 .3.3",key:"1jd90r"}],["path",{d:"M8 15v1a6 6 0 0 0 6 6v0a6 6 0 0 0 6-6v-4",key:"126ukv"}],["circle",{cx:"20",cy:"10",r:"2",key:"ts1r5v"}]]),os=L("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]),p0=L("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]),td=L("UserCheck",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["polyline",{points:"16 11 18 13 22 9",key:"1pwet4"}]]),ha=L("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]),vs=L("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]),rd=L("WifiOff",[["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}],["path",{d:"M8.5 16.5a5 5 0 0 1 7 0",key:"sej527"}],["path",{d:"M2 8.82a15 15 0 0 1 4.17-2.65",key:"11utq1"}],["path",{d:"M10.66 5c4.01-.36 8.14.9 11.34 3.76",key:"hxefdu"}],["path",{d:"M16.85 11.25a10 10 0 0 1 2.22 1.68",key:"q734kn"}],["path",{d:"M5 13a10 10 0 0 1 5.24-2.76",key:"piq4yl"}],["line",{x1:"12",x2:"12.01",y1:"20",y2:"20",key:"of4bc4"}]]),Hf=L("XCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]),tt=L("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),g0=L("Zap",[["polygon",{points:"13 2 3 14 12 14 11 22 21 10 12 10 13 2",key:"45s27k"}]]);class He{static sanitizeInput(e){return typeof e!="string"?"":e.trim().replace(/[<>\"']/g,"").replace(/[\x00-\x1F\x7F]/g,"").slice(0,1e3)}static validateControlNumber(e){const r=this.sanitizeInput(e);return r?/(union|select|insert|update|delete|drop|exec|script)/i.test(r)?(this.logSecurityEvent({type:"SUSPICIOUS_ACTIVITY",ip:"unknown",userAgent:"unknown",severity:"HIGH",details:{input:r,reason:"SQL injection attempt"}}),{valid:!1,message:"Invalid characters detected"}):/^MOC-[\w\d-]+$/.test(r)?r.length>50?{valid:!1,message:"Control number too long"}:{valid:!0}:{valid:!1,message:"Invalid control number format"}:{valid:!1,message:"Control number is required"}}static checkRateLimit(e,r){const n=this.rateLimits.get(e);if(!n)return{allowed:!0};const s=Date.now(),a=`${e}:${r}`,o=this.attempts.get(a);if(!o)return this.attempts.set(a,{count:1,lastAttempt:new Date(s),blocked:!1}),{allowed:!0};if(s-o.lastAttempt.getTime()>n.windowMs)return this.attempts.set(a,{count:1,lastAttempt:new Date(s),blocked:!1}),{allowed:!0};if(o.count>=n.maxRequests){const l=Math.ceil((n.windowMs-(s-o.lastAttempt.getTime()))/1e3);return this.logSecurityEvent({type:"RATE_LIMIT",ip:r,userAgent:"unknown",severity:"MEDIUM",details:{key:e,attempts:o.count,limit:n.maxRequests}}),{allowed:!1,retryAfter:l}}return o.count++,o.lastAttempt=new Date(s),{allowed:!0}}static createSession(e,r){const n={userId:e,userType:r,createdAt:new Date,expiresAt:new Date(Date.now()+this.config.sessionDuration*60*1e3),csrfToken:this.generateSecureToken()},s=this.generateSecureToken();return localStorage.setItem(`mocards_session_${s}`,JSON.stringify(n)),this.logSecurityEvent({type:"LOGIN_ATTEMPT",userId:e,ip:"unknown",userAgent:navigator.userAgent,severity:"LOW",details:{userType:r,sessionToken:s}}),s}static validateSession(e){try{const r=localStorage.getItem(`mocards_session_${e}`);if(!r)return{valid:!1};const n=JSON.parse(r);return new Date>new Date(n.expiresAt)?(this.destroySession(e),{valid:!1}):{valid:!0,userId:n.userId,userType:n.userType}}catch{return{valid:!1}}}static destroySession(e){localStorage.removeItem(`mocards_session_${e}`)}static validatePassword(e){const r=this.sanitizeInput(e);let n=0;if(r.length<this.config.passwordMinLength)return{valid:!1,message:`Password must be at least ${this.config.passwordMinLength} characters`,strength:0};r.length>=8&&(n+=20),r.length>=12&&(n+=10),/[a-z]/.test(r)&&(n+=20),/[A-Z]/.test(r)&&(n+=20),/[0-9]/.test(r)&&(n+=15),/[^a-zA-Z0-9]/.test(r)&&(n+=15);const s=n>=80?"Strong":n>=60?"Good":"Weak";return{valid:n>=60,message:n<60?`Password is too weak (${s})`:void 0,strength:n}}static logSecurityEvent(e){const r={...e,id:this.generateSecureToken(),timestamp:new Date};this.events.push(r),this.events.length>1e3&&(this.events=this.events.slice(-1e3)),(e.severity==="CRITICAL"||e.severity==="HIGH")&&console.warn(" Security Alert:",r),this.sendToMonitoring(r)}static getSecurityEvents(e){return e?this.events.filter(r=>r.severity===e):this.events.slice(-100)}static validateFileUpload(e){return["application/pdf","image/jpeg","image/png","text/csv"].includes(e.type)?e.size>10485760?{valid:!1,message:"File size exceeds 10MB limit"}:{valid:!0}:{valid:!1,message:`File type '${e.type}' is not allowed`}}static generateSecureToken(e=32){const r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";let n="";const s=new Uint8Array(e);crypto.getRandomValues(s);for(let a=0;a<e;a++)n+=r[s[a]%r.length];return n}static sendToMonitoring(e){typeof window<"u"&&console.log(" Security Event:",e.type,e.severity)}static updateConfig(e){this.config={...this.config,...e}}static getConfig(){return{...this.config}}static addRateLimit(e,r){this.rateLimits.set(e,r)}static getSecurityMetrics(){const e={LOW:0,MEDIUM:0,HIGH:0,CRITICAL:0};this.events.forEach(s=>{e[s.severity]++});const r=this.events.filter(s=>s.type==="RATE_LIMIT").length,n=Array.from(this.attempts.values()).filter(s=>s.blocked).length;return{totalEvents:this.events.length,eventsBySeverity:e,recentThreats:this.events.filter(s=>s.severity==="HIGH"||s.severity==="CRITICAL").slice(-10),rateLimitViolations:r,activeBlocks:n}}}rr(He,"config",{maxLoginAttempts:5,lockoutDuration:15,sessionDuration:480,passwordMinLength:8,requireTwoFactor:!1}),rr(He,"rateLimits",new Map([["login",{windowMs:15*60*1e3,maxRequests:5}],["search",{windowMs:60*1e3,maxRequests:30}],["api",{windowMs:60*1e3,maxRequests:100}],["export",{windowMs:60*60*1e3,maxRequests:10}]])),rr(He,"attempts",new Map),rr(He,"events",[]);const y0=()=>`toast-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,Ra=(t,e,r,n)=>({type:t,title:e,message:r,duration:(n==null?void 0:n.duration)??(t==="loading"?void 0:5e3),action:n==null?void 0:n.action,persistent:(n==null?void 0:n.persistent)??t==="loading"}),ee=(t,e,r)=>Ra("success",t,e,{action:r}),Q=(t,e,r)=>Ra("error",t,e,{action:r,duration:7e3}),Pe=(t,e,r)=>Ra("warning",t,e,{action:r}),xs=(t,e,r)=>Ra("info",t,e,{action:r}),Kf=k.createContext(void 0),Er=()=>{const t=k.useContext(Kf);if(!t)throw new Error("useToast must be used within a ToastProvider");return t},v0=({children:t})=>{const[e,r]=k.useState([]),n=k.useCallback(c=>{const u=y0(),f={...c,id:u};return r(m=>[...m,f]),!c.persistent&&c.duration&&setTimeout(()=>{s(u)},c.duration),u},[]),s=k.useCallback(c=>{r(u=>u.filter(f=>f.id!==c))},[]),a=k.useCallback((c,u)=>{r(f=>f.map(m=>m.id===c?{...m,...u}:m))},[]),o=k.useCallback(()=>{r([])},[]),l={toasts:e,addToast:n,removeToast:s,updateToast:a,clearAllToasts:o};return i.jsx(Kf.Provider,{value:l,children:t})},x0=()=>{const[t,e]=k.useState({isBlocked:!1,attempts:0}),{addToast:r}=Er(),n=k.useCallback((d,y)=>{const x=y||w0(),w=He.checkRateLimit(d,x);return w.allowed?!0:(e(C=>({...C,isBlocked:!0,retryAfter:w.retryAfter,attempts:C.attempts+1,lastAttempt:new Date})),r(Pe("Rate Limit Exceeded",`Too many ${d} attempts. Please try again in ${w.retryAfter} seconds.`,{label:"Understand",onClick:()=>{}})),!1)},[r]),s=k.useCallback((d,y="general")=>{switch(y){case"control_number":return He.validateControlNumber(d);default:const x=He.sanitizeInput(d);return{valid:x===d,message:x!==d?"Input contains invalid characters":void 0,sanitized:x}}},[]),a=k.useCallback(d=>{const y=He.validateFileUpload(d);return y.valid||r(Q("File Upload Error",y.message||"Invalid file",{label:"Try Again",onClick:()=>{}})),y},[r]),o=k.useCallback((d,y)=>{const x=He.createSession(d,y);return r(xs("Secure Session Created","Your session is encrypted and will auto-expire for security.",{label:"Got it",onClick:()=>{}})),x},[r]),l=k.useCallback(d=>He.validateSession(d),[]),c=k.useCallback(d=>{He.destroySession(d),r(xs("Session Ended","You have been securely logged out."))},[r]),u=k.useCallback(d=>He.validatePassword(d),[]),f=k.useCallback(()=>He.getSecurityMetrics(),[]),m=k.useCallback(d=>He.getSecurityEvents(d),[]);return k.useEffect(()=>{if(t.isBlocked&&t.retryAfter){const d=setTimeout(()=>{e(y=>({...y,isBlocked:!1,retryAfter:void 0})),r(xs("Access Restored","You can now try again."))},t.retryAfter*1e3);return()=>clearTimeout(d)}},[t.isBlocked,t.retryAfter,r]),{securityState:t,checkRateLimit:n,validateInput:s,validateFileUpload:a,createSecureSession:o,validateSession:l,destroySession:c,validatePassword:u,getSecurityMetrics:f,getSecurityEvents:m}};function w0(){const t=localStorage.getItem("mocards_client_id");if(t)return t;const e=_0();return localStorage.setItem("mocards_client_id",e),e}function _0(){const t=[navigator.userAgent,screen.width+"x"+screen.height,new Date().getTimezoneOffset(),navigator.language].join("|");let e=0;for(let r=0;r<t.length;r++){const n=t.charCodeAt(r);e=(e<<5)-e+n,e=e&e}return Math.abs(e).toString(36)+Date.now().toString(36)}const mo=({className:t="",compact:e=!1})=>{const[r,n]=k.useState(null),[s,a]=k.useState(!1),{getSecurityMetrics:o}=x0();if(k.useEffect(()=>{const m=()=>{const y=o();n(y)};m();const d=setInterval(m,3e4);return()=>clearInterval(d)},[o]),!r)return i.jsx("div",{className:`bg-[#1F2937] rounded-lg border border-[#374151] p-4 ${t}`,children:i.jsxs("div",{className:"animate-pulse",children:[i.jsx("div",{className:"h-6 bg-[#374151] rounded w-48 mb-4"}),i.jsxs("div",{className:"space-y-2",children:[i.jsx("div",{className:"h-4 bg-[#374151] rounded w-full"}),i.jsx("div",{className:"h-4 bg-[#374151] rounded w-3/4"})]})]})});const l=m=>{switch(m.toUpperCase()){case"CRITICAL":return"text-red-400 bg-red-900/20";case"HIGH":return"text-orange-400 bg-orange-900/20";case"MEDIUM":return"text-yellow-400 bg-yellow-900/20";case"LOW":return"text-blue-400 bg-blue-900/20";default:return"text-gray-400 bg-gray-900/20"}},u=(()=>{const{eventsBySeverity:m}=r,d=m.CRITICAL||0,y=m.HIGH||0,x=m.MEDIUM||0;let w=100;return w-=d*20,w-=y*10,w-=x*5,Math.max(w,0)})(),f=u>=80?"text-green-400":u>=60?"text-yellow-400":"text-red-400";return i.jsxs("div",{className:`bg-[#1F2937] rounded-lg border border-[#374151] ${t}`,children:[i.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-[#374151]",children:[i.jsxs("div",{className:"flex items-center",children:[i.jsx(Ht,{className:"h-5 w-5 text-blue-400 mr-2"}),i.jsx("h3",{className:"text-[#E8EAED] font-medium",children:"Security Monitor"}),i.jsxs("div",{className:`ml-3 px-2 py-1 rounded text-xs font-medium ${f.replace("text-","bg-").replace("400","900/20")}`,children:["Score: ",i.jsxs("span",{className:f,children:[u,"/100"]})]})]}),i.jsx("button",{onClick:()=>a(!s),className:"text-[#9AA0A6] hover:text-[#E8EAED] transition-colors",children:i.jsx(Wf,{className:"h-4 w-4"})})]}),i.jsxs("div",{className:"p-4",children:[i.jsxs("div",{className:`grid gap-4 mb-4 ${e?"grid-cols-2":"grid-cols-2 md:grid-cols-4"}`,children:[i.jsxs("div",{className:"bg-[#303134] rounded-lg p-3",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx(Ms,{className:"h-4 w-4 text-blue-400"}),i.jsx("span",{className:"text-xs text-[#9AA0A6]",children:"Total Events"})]}),i.jsx("div",{className:"text-lg font-bold text-[#E8EAED] mt-1",children:r.totalEvents})]}),i.jsxs("div",{className:"bg-[#303134] rounded-lg p-3",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx(zs,{className:"h-4 w-4 text-red-400"}),i.jsx("span",{className:"text-xs text-[#9AA0A6]",children:"Threats"})]}),i.jsx("div",{className:"text-lg font-bold text-[#E8EAED] mt-1",children:(r.eventsBySeverity.HIGH||0)+(r.eventsBySeverity.CRITICAL||0)})]}),i.jsxs("div",{className:"bg-[#303134] rounded-lg p-3",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx(Yu,{className:"h-4 w-4 text-yellow-400"}),i.jsx("span",{className:"text-xs text-[#9AA0A6]",children:"Rate Limits"})]}),i.jsx("div",{className:"text-lg font-bold text-[#E8EAED] mt-1",children:r.rateLimitViolations})]}),i.jsxs("div",{className:"bg-[#303134] rounded-lg p-3",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx(vs,{className:"h-4 w-4 text-purple-400"}),i.jsx("span",{className:"text-xs text-[#9AA0A6]",children:"Blocked"})]}),i.jsx("div",{className:"text-lg font-bold text-[#E8EAED] mt-1",children:r.activeBlocks})]})]}),i.jsxs("div",{className:"mb-4",children:[i.jsx("h4",{className:"text-[#E8EAED] text-sm font-medium mb-2",children:"Event Severity Distribution"}),i.jsx("div",{className:"space-y-2",children:Object.entries(r.eventsBySeverity).map(([m,d])=>i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{className:"flex items-center",children:[i.jsx("div",{className:`w-3 h-3 rounded-full mr-2 ${l(m).split(" ")[1]}`}),i.jsx("span",{className:"text-[#9AA0A6] text-sm capitalize",children:m.toLowerCase()})]}),i.jsx("span",{className:"text-[#E8EAED] font-medium",children:d})]},m))})]})]}),s&&i.jsxs("div",{className:"border-t border-[#374151] p-4",children:[i.jsx("h4",{className:"text-[#E8EAED] text-sm font-medium mb-3",children:"Recent Security Events"}),r.recentThreats.length===0?i.jsxs("div",{className:"text-center py-4",children:[i.jsx(Ht,{className:"h-8 w-8 text-green-400 mx-auto mb-2"}),i.jsx("p",{className:"text-[#9AA0A6] text-sm",children:"No security threats detected"}),i.jsx("p",{className:"text-[#9AA0A6] text-xs",children:"All systems operating normally"})]}):i.jsx("div",{className:"space-y-2",children:r.recentThreats.slice(0,5).map(m=>i.jsx("div",{className:"bg-[#303134] rounded-lg p-3",children:i.jsxs("div",{className:"flex items-start justify-between",children:[i.jsxs("div",{className:"flex-1",children:[i.jsxs("div",{className:"flex items-center mb-1",children:[i.jsx("span",{className:`px-2 py-1 rounded text-xs font-medium ${l(m.severity)}`,children:m.severity}),i.jsx("span",{className:"text-[#9AA0A6] text-sm ml-2",children:m.type.replace("_"," ")})]}),i.jsx("p",{className:"text-[#E8EAED] text-sm",children:m.details.reason||"Security event detected"})]}),i.jsxs("div",{className:"flex items-center text-[#9AA0A6] text-xs",children:[i.jsx(Fs,{className:"h-3 w-3 mr-1"}),new Date(m.timestamp).toLocaleTimeString()]})]})},m.id))}),i.jsxs("div",{className:"mt-4 pt-4 border-t border-[#374151]",children:[i.jsx("h4",{className:"text-[#E8EAED] text-sm font-medium mb-2",children:"Security Recommendations"}),i.jsxs("div",{className:"space-y-2",children:[u<80&&i.jsxs("div",{className:"flex items-start",children:[i.jsx(p0,{className:"h-4 w-4 text-yellow-400 mr-2 mt-0.5 flex-shrink-0"}),i.jsxs("div",{children:[i.jsx("p",{className:"text-[#E8EAED] text-sm",children:"Improve Security Score"}),i.jsx("p",{className:"text-[#9AA0A6] text-xs",children:"Review recent security events and implement additional protections"})]})]}),r.rateLimitViolations>10&&i.jsxs("div",{className:"flex items-start",children:[i.jsx(Yu,{className:"h-4 w-4 text-blue-400 mr-2 mt-0.5 flex-shrink-0"}),i.jsxs("div",{children:[i.jsx("p",{className:"text-[#E8EAED] text-sm",children:"Review Rate Limiting"}),i.jsx("p",{className:"text-[#9AA0A6] text-xs",children:"High number of rate limit violations detected"})]})]}),(r.eventsBySeverity.HIGH||0)+(r.eventsBySeverity.CRITICAL||0)>0&&i.jsxs("div",{className:"flex items-start",children:[i.jsx(zs,{className:"h-4 w-4 text-red-400 mr-2 mt-0.5 flex-shrink-0"}),i.jsxs("div",{children:[i.jsx("p",{className:"text-[#E8EAED] text-sm",children:"Address High Priority Threats"}),i.jsx("p",{className:"text-[#9AA0A6] text-xs",children:"Critical or high severity security events require attention"})]})]}),u>=80&&r.recentThreats.length===0&&i.jsxs("div",{className:"flex items-start",children:[i.jsx(Ht,{className:"h-4 w-4 text-green-400 mr-2 mt-0.5 flex-shrink-0"}),i.jsxs("div",{children:[i.jsx("p",{className:"text-[#E8EAED] text-sm",children:"Security Status Excellent"}),i.jsx("p",{className:"text-[#9AA0A6] text-xs",children:"All security systems operating normally"})]})]})]})]})]})]})},b0=({currentView:t,onViewChange:e,onSecurityToggle:r,showSecurityDashboard:n,navItems:s})=>{var m;const[a,o]=k.useState(!1),c=s||[{id:"card-lookup",label:"Card Lookup",icon:Un,description:"Verify card validity",color:"text-blue-600",bgColor:"bg-blue-50",disabled:!1},{id:"clinic-portal",label:"Clinic Portal",icon:_n,description:"Clinic management",color:"text-green-600",bgColor:"bg-green-50",disabled:!1},{id:"admin-access",label:"Admin Access",icon:Ht,description:"System administration",color:"text-purple-600",bgColor:"bg-purple-50",disabled:!1}],u=(d,y)=>{y||(e(d),o(!1))},f=()=>{o(!a)};return i.jsxs(i.Fragment,{children:[i.jsxs("div",{className:"lg:hidden bg-white shadow-lg border-b border-gray-200 fixed top-0 left-0 right-0 z-50",children:[i.jsxs("div",{className:"flex items-center justify-between px-4 py-3",children:[i.jsxs("div",{className:"flex items-center space-x-3",children:[i.jsx("div",{className:"w-8 h-8 bg-[#1A535C] rounded-lg flex items-center justify-center",children:i.jsx("span",{className:"text-white font-bold text-sm",children:"MC"})}),i.jsxs("div",{children:[i.jsx("h1",{className:"text-lg font-bold text-gray-900",children:"MOCARDS"}),i.jsx("p",{className:"text-xs text-gray-500 -mt-1",children:"Dental Benefits Platform"})]})]}),i.jsxs("div",{className:"flex items-center space-x-2",children:[i.jsx("button",{onClick:r,className:`p-2 rounded-lg transition-colors ${n?"bg-blue-600 text-white":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:i.jsx(Ms,{className:"h-4 w-4"})}),i.jsx("button",{onClick:f,className:"p-2 rounded-lg bg-gray-100 text-gray-600 hover:bg-gray-200 transition-colors",children:a?i.jsx(tt,{className:"h-5 w-5"}):i.jsx(Xu,{className:"h-5 w-5"})})]})]}),i.jsx("div",{className:"px-4 pb-2",children:i.jsxs("div",{className:"flex items-center space-x-2",children:[i.jsx("div",{className:"w-2 h-2 bg-[#1A535C] rounded-full"}),i.jsx("span",{className:"text-sm font-medium text-gray-700",children:(m=c.find(d=>d.id===t))==null?void 0:m.label})]})})]}),i.jsxs("div",{className:`lg:hidden fixed inset-0 z-50 transition-opacity duration-300 ${a?"opacity-100 visible":"opacity-0 invisible"}`,children:[i.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-50",onClick:()=>o(!1)}),i.jsxs("div",{className:`absolute right-0 top-0 h-full w-80 max-w-[85vw] bg-white shadow-xl transform transition-transform duration-300 ${a?"translate-x-0":"translate-x-full"}`,children:[i.jsx("div",{className:"p-6 bg-[#1A535C] text-white",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("h2",{className:"text-xl font-bold",children:"MOCARDS CLOUD"}),i.jsx("button",{onClick:()=>o(!1),className:"p-2 rounded-lg hover:bg-white hover:bg-opacity-20 transition-colors",children:i.jsx(tt,{className:"h-5 w-5"})})]})}),i.jsx("div",{className:"p-4 space-y-2",children:c.map(d=>{const y=d.icon,x=t===d.id,w=d.disabled;return i.jsxs("button",{onClick:()=>u(d.id,w),disabled:w,className:`w-full flex items-center space-x-3 p-4 rounded-xl transition-all duration-200 ${w?"bg-gray-200 text-gray-400 cursor-not-allowed opacity-60":x?"bg-[#1A535C] text-white shadow-lg":"hover:bg-gray-50 text-gray-700"}`,title:w?"Please logout to access this portal":void 0,children:[i.jsx("div",{className:`p-2 rounded-lg ${w?"bg-gray-300":x?"bg-white bg-opacity-20":d.bgColor}`,children:i.jsx(y,{className:`h-5 w-5 ${w?"text-gray-400":x?"text-white":d.color}`})}),i.jsxs("div",{className:"flex-1 text-left",children:[i.jsxs("div",{className:`font-medium ${w?"text-gray-400":x?"text-white":"text-gray-900"}`,children:[d.label,w&&i.jsx("span",{className:"ml-2",children:""})]}),i.jsx("div",{className:`text-sm ${w?"text-gray-500":x?"text-teal-200":"text-gray-500"}`,children:w?"Logout required":d.description})]}),i.jsx(i0,{className:`h-4 w-4 ${w?"text-gray-400":x?"text-white":"text-gray-400"}`})]},d.id)})}),i.jsx("div",{className:"p-4 border-t border-gray-200",children:i.jsxs("button",{onClick:()=>{r(),o(!1)},className:`w-full flex items-center space-x-3 p-4 rounded-xl transition-all duration-200 ${n?"bg-blue-600 text-white":"hover:bg-blue-50 text-gray-700"}`,children:[i.jsx("div",{className:`p-2 rounded-lg ${n?"bg-white bg-opacity-20":"bg-blue-50"}`,children:i.jsx(Ms,{className:`h-5 w-5 ${n?"text-white":"text-blue-600"}`})}),i.jsxs("div",{className:"flex-1 text-left",children:[i.jsx("div",{className:`font-medium ${n?"text-white":"text-gray-900"}`,children:"Security Monitor"}),i.jsx("div",{className:`text-sm ${n?"text-blue-200":"text-gray-500"}`,children:"Live security dashboard"})]}),n&&i.jsx("div",{className:"w-2 h-2 bg-green-400 rounded-full animate-pulse"})]})}),i.jsx("div",{className:"absolute bottom-0 left-0 right-0 p-4 border-t border-gray-200 bg-gray-50",children:i.jsxs("div",{className:"text-center",children:[i.jsx("p",{className:"text-xs text-gray-500",children:"MOCARDS v4.0"}),i.jsx("p",{className:"text-xs text-gray-400",children:" 2025 Dental Group"})]})})]})]}),i.jsx("div",{className:"sm:hidden fixed bottom-0 left-0 right-0 z-40 bg-white border-t border-gray-200 shadow-lg",children:i.jsxs("div",{className:"grid grid-cols-4 py-2",children:[i.jsxs("button",{className:"flex flex-col items-center py-2 text-[#1A535C]",children:[i.jsx(u0,{className:"h-5 w-5 mb-1"}),i.jsx("span",{className:"text-xs font-medium",children:"Home"})]}),c.slice(0,2).map(d=>{const y=d.icon,x=t===d.id;return i.jsxs("button",{onClick:()=>u(d.id),className:`flex flex-col items-center py-2 ${x?"text-[#1A535C]":"text-gray-400"}`,children:[i.jsx(y,{className:"h-5 w-5 mb-1"}),i.jsx("span",{className:"text-xs font-medium",children:d.label.split(" ")[0]})]},d.id)}),i.jsxs("button",{onClick:f,className:"flex flex-col items-center py-2 text-gray-600",children:[i.jsx(Xu,{className:"h-5 w-5 mb-1"}),i.jsx("span",{className:"text-xs font-medium",children:"Menu"})]})]})})]})},j0=()=>{const[t,e]=k.useState(null),[r,n]=k.useState({isSupported:!1,isInstalled:!1,canInstall:!1,isStandalone:!1,platform:"unknown"});k.useEffect(()=>{const c=()=>{const f="serviceWorker"in navigator&&"PushManager"in window,m=window.matchMedia("(display-mode: standalone)").matches||window.navigator.standalone||document.referrer.includes("android-app://"),d=nd(),y=m||N0();n({isSupported:f,isInstalled:y,canInstall:t!==null,isStandalone:m,platform:d})};c();const u=window.matchMedia("(display-mode: standalone)");return u.addListener(c),()=>u.removeListener(c)},[t]),k.useEffect(()=>{const c=f=>{console.log("[PWA] beforeinstallprompt fired"),f.preventDefault(),e(f)},u=()=>{console.log("[PWA] App was installed"),e(null),n(f=>({...f,isInstalled:!0,canInstall:!1}))};return window.addEventListener("beforeinstallprompt",c),window.addEventListener("appinstalled",u),()=>{window.removeEventListener("beforeinstallprompt",c),window.removeEventListener("appinstalled",u)}},[]),k.useEffect(()=>{r.isSupported&&k0()},[r.isSupported]);const s=k.useCallback(async()=>{if(!t)return{success:!1,error:"Installation prompt not available"};try{await t.prompt();const c=await t.userChoice;return console.log("[PWA] User choice:",c.outcome),c.outcome==="accepted"?(e(null),{success:!0,outcome:"accepted"}):{success:!1,outcome:"dismissed"}}catch(c){return console.error("[PWA] Installation failed:",c),{success:!1,error:c instanceof Error?c.message:"Installation failed"}}},[t]),a=k.useCallback(async c=>{const u={title:"MOCARDS Cloud - Dental Benefits Management Platform",text:"Professional dental benefits card management and clinic portal system",url:window.location.origin,...c};if(navigator.share)try{return await navigator.share(u),!0}catch(f){return f.name!=="AbortError"&&console.error("[PWA] Share failed:",f),!1}else try{return await navigator.clipboard.writeText(u.url),!0}catch(f){return console.error("[PWA] Clipboard write failed:",f),!1}},[]),o=k.useCallback(async()=>{if(!("Notification"in window))return console.warn("[PWA] This browser does not support notifications"),!1;if(Notification.permission==="granted")return!0;if(Notification.permission==="denied")return!1;try{return await Notification.requestPermission()==="granted"}catch(c){return console.error("[PWA] Notification permission request failed:",c),!1}},[]),l=k.useCallback(()=>{const c=nd(),u={ios:["Tap the Share button in Safari",'Scroll down and tap "Add to Home Screen"','Tap "Add" to install the app'],android:["Tap the menu button () in Chrome",'Select "Add to Home screen"','Tap "Add" to install the app'],desktop:["Click the install button in your browser's address bar","Or use Ctrl+Shift+A (Cmd+Shift+A on Mac)",'Click "Install" when prompted']};return{platform:c,steps:u[c]||u.desktop}},[]);return{...r,installApp:s,shareApp:a,requestNotificationPermission:o,getInstallInstructions:l,canShare:"share"in navigator||"clipboard"in navigator}};function nd(){const t=navigator.userAgent.toLowerCase();return/iphone|ipad|ipod/.test(t)?"ios":/android/.test(t)?"android":/windows/.test(t)?"windows":/mac/.test(t)?"mac":"desktop"}function N0(){return window.navigator.standalone||window.matchMedia("(display-mode: standalone)").matches||!!window.cordova||!!window.Capacitor||!!window.require}async function k0(){try{const t=await navigator.serviceWorker.register("/sw.js",{scope:"/"});return console.log("[PWA] Service Worker registered:",t),t.addEventListener("updatefound",()=>{const e=t.installing;e&&e.addEventListener("statechange",()=>{e.state==="installed"&&navigator.serviceWorker.controller&&console.log("[PWA] New service worker available")})}),!0}catch(t){return console.error("[PWA] Service Worker registration failed:",t),!1}}const S0=async(t,e)=>"serviceWorker"in navigator&&"PushManager"in window?(await(await navigator.serviceWorker.ready).showNotification(t,{badge:"/icons/badge-72x72.png",icon:"/icons/icon-192x192.png",...e}),null):"Notification"in window&&Notification.permission==="granted"?new Notification(t,{icon:"/icons/icon-192x192.png",badge:"/icons/badge-72x72.png",...e}):null,po=({showPrompt:t=!0,onDismiss:e,compact:r=!1})=>{const[n,s]=k.useState(!1),[a,o]=k.useState(!1),[l,c]=k.useState(!1),{isSupported:u,isInstalled:f,canInstall:m,platform:d,installApp:y,shareApp:x,requestNotificationPermission:w,getInstallInstructions:C,canShare:p}=j0(),{addToast:g}=Er();k.useEffect(()=>{s(t&&u&&!f&&m&&!localStorage.getItem("pwa-prompt-dismissed"))},[t,u,f,m]);const v=async()=>{o(!0);try{const P=await y();if(P.success)g(ee("App Installed Successfully!","MOCARDS is now available on your home screen",{label:"Open App",onClick:()=>window.location.reload()})),s(!1),setTimeout(async()=>{await w()&&S0("Welcome to MOCARDS!",{body:"You'll receive important updates and notifications here.",tag:"welcome"})},2e3);else if(P.outcome==="dismissed")g(xs("Installation Cancelled","You can install MOCARDS anytime from your browser menu"));else throw new Error(P.error||"Installation failed")}catch(P){g(Q("Installation Failed",P instanceof Error?P.message:"Please try again"))}finally{o(!1)}},b=async()=>{try{const P=await x();g(P?ee("Shared Successfully!","MOCARDS link has been shared"):xs("Link Copied","MOCARDS link copied to clipboard"))}catch{g(Q("Share Failed","Unable to share the app"))}},j=()=>{s(!1),localStorage.setItem("pwa-prompt-dismissed","true"),e==null||e()},N=()=>{c(!0)},S=C();return!n&&!r?null:r?i.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:i.jsxs("div",{className:"flex items-start space-x-3",children:[i.jsx("div",{className:"flex-shrink-0",children:i.jsx(ed,{className:"h-6 w-6 text-blue-600"})}),i.jsxs("div",{className:"flex-1",children:[i.jsx("h3",{className:"text-sm font-medium text-blue-900",children:"Install MOCARDS App"}),i.jsx("p",{className:"text-sm text-blue-700 mt-1",children:"Get faster access and offline capabilities"}),i.jsxs("div",{className:"flex items-center space-x-2 mt-3",children:[m?i.jsxs("button",{onClick:v,disabled:a,className:"inline-flex items-center px-3 py-1 bg-blue-600 text-white text-xs font-medium rounded-md hover:bg-blue-700 disabled:opacity-50",children:[i.jsx(Gu,{className:"h-3 w-3 mr-1"}),a?"Installing...":"Install"]}):i.jsxs("button",{onClick:N,className:"inline-flex items-center px-3 py-1 bg-blue-100 text-blue-700 text-xs font-medium rounded-md hover:bg-blue-200",children:[i.jsx(Ju,{className:"h-3 w-3 mr-1"}),"How to Install"]}),p&&i.jsxs("button",{onClick:b,className:"inline-flex items-center px-3 py-1 bg-gray-100 text-gray-700 text-xs font-medium rounded-md hover:bg-gray-200",children:[i.jsx(Zu,{className:"h-3 w-3 mr-1"}),"Share"]})]})]})]})}):i.jsxs(i.Fragment,{children:[n&&i.jsx("div",{className:"fixed bottom-4 left-4 right-4 md:left-auto md:right-4 md:max-w-sm z-50 animate-slide-in-right",children:i.jsxs("div",{className:"bg-white rounded-lg shadow-xl border border-gray-200 p-6",children:[i.jsxs("div",{className:"flex items-start justify-between mb-4",children:[i.jsxs("div",{className:"flex items-center space-x-3",children:[i.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:i.jsx(ed,{className:"h-6 w-6 text-blue-600"})}),i.jsxs("div",{children:[i.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Install MOCARDS"}),i.jsx("p",{className:"text-sm text-gray-600",children:"For better performance & offline access"})]})]}),i.jsx("button",{onClick:j,className:"text-gray-400 hover:text-gray-600 transition-colors",children:i.jsx(tt,{className:"h-5 w-5"})})]}),i.jsxs("div",{className:"space-y-2 mb-6",children:[i.jsxs("div",{className:"flex items-center text-sm text-gray-600",children:[i.jsx(_i,{className:"h-4 w-4 text-green-500 mr-2"}),"Faster loading and performance"]}),i.jsxs("div",{className:"flex items-center text-sm text-gray-600",children:[i.jsx(_i,{className:"h-4 w-4 text-green-500 mr-2"}),"Offline access to core features"]}),i.jsxs("div",{className:"flex items-center text-sm text-gray-600",children:[i.jsx(_i,{className:"h-4 w-4 text-green-500 mr-2"}),"Push notifications for updates"]}),i.jsxs("div",{className:"flex items-center text-sm text-gray-600",children:[i.jsx(_i,{className:"h-4 w-4 text-green-500 mr-2"}),"Home screen shortcut"]})]}),i.jsxs("div",{className:"flex space-x-3",children:[i.jsx("button",{onClick:v,disabled:a,className:"flex-1 flex items-center justify-center px-4 py-2 bg-blue-600 text-white font-medium rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50",children:a?i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-2 border-white border-t-transparent mr-2"}),"Installing..."]}):i.jsxs(i.Fragment,{children:[i.jsx(Gu,{className:"h-4 w-4 mr-2"}),"Install App"]})}),i.jsx("button",{onClick:N,className:"px-3 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 transition-colors",children:i.jsx(Ju,{className:"h-4 w-4"})}),p&&i.jsx("button",{onClick:b,className:"px-3 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 transition-colors",children:i.jsx(Zu,{className:"h-4 w-4"})})]})]})}),l&&i.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:i.jsx("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full",children:i.jsxs("div",{className:"p-6",children:[i.jsxs("div",{className:"flex items-center justify-between mb-4",children:[i.jsxs("div",{className:"flex items-center space-x-3",children:[i.jsx(f0,{className:"h-6 w-6 text-blue-600"}),i.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"How to Install"})]}),i.jsx("button",{onClick:()=>c(!1),className:"text-gray-400 hover:text-gray-600",children:i.jsx(tt,{className:"h-5 w-5"})})]}),i.jsxs("div",{className:"mb-6",children:[i.jsxs("div",{className:"flex items-center mb-3",children:[i.jsx("div",{className:"w-2 h-2 bg-blue-600 rounded-full mr-2"}),i.jsxs("span",{className:"text-sm font-medium text-gray-900",children:["Platform: ",d.charAt(0).toUpperCase()+d.slice(1)]})]}),i.jsx("ol",{className:"space-y-3",children:S.steps.map((P,W)=>i.jsxs("li",{className:"flex items-start",children:[i.jsx("span",{className:"flex-shrink-0 w-6 h-6 bg-blue-100 text-blue-600 text-sm font-medium rounded-full flex items-center justify-center mr-3",children:W+1}),i.jsx("span",{className:"text-sm text-gray-700",children:P})]},W))})]}),i.jsx("div",{className:"bg-amber-50 border border-amber-200 rounded-lg p-3",children:i.jsxs("div",{className:"flex",children:[i.jsx(Vf,{className:"h-5 w-5 text-amber-400 mt-0.5 mr-2"}),i.jsx("div",{children:i.jsxs("p",{className:"text-sm text-amber-800",children:[i.jsx("span",{className:"font-medium",children:"Note:"})," Installation steps may vary depending on your browser and operating system."]})})]})}),i.jsx("div",{className:"flex justify-end mt-6",children:i.jsx("button",{onClick:()=>c(!1),className:"px-4 py-2 bg-blue-600 text-white font-medium rounded-lg hover:bg-blue-700 transition-colors",children:"Got it"})})]})})})]})};function Oa(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(t);s<n.length;s++)e.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(t,n[s])&&(r[n[s]]=t[n[s]]);return r}function C0(t,e,r,n){function s(a){return a instanceof r?a:new r(function(o){o(a)})}return new(r||(r=Promise))(function(a,o){function l(f){try{u(n.next(f))}catch(m){o(m)}}function c(f){try{u(n.throw(f))}catch(m){o(m)}}function u(f){f.done?a(f.value):s(f.value).then(l,c)}u((n=n.apply(t,e||[])).next())})}const E0=t=>t?(...e)=>t(...e):(...e)=>fetch(...e);class Cc extends Error{constructor(e,r="FunctionsError",n){super(e),this.name=r,this.context=n}}class A0 extends Cc{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class sd extends Cc{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class id extends Cc{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var bl;(function(t){t.Any="any",t.ApNortheast1="ap-northeast-1",t.ApNortheast2="ap-northeast-2",t.ApSouth1="ap-south-1",t.ApSoutheast1="ap-southeast-1",t.ApSoutheast2="ap-southeast-2",t.CaCentral1="ca-central-1",t.EuCentral1="eu-central-1",t.EuWest1="eu-west-1",t.EuWest2="eu-west-2",t.EuWest3="eu-west-3",t.SaEast1="sa-east-1",t.UsEast1="us-east-1",t.UsWest1="us-west-1",t.UsWest2="us-west-2"})(bl||(bl={}));class T0{constructor(e,{headers:r={},customFetch:n,region:s=bl.Any}={}){this.url=e,this.headers=r,this.region=s,this.fetch=E0(n)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e){return C0(this,arguments,void 0,function*(r,n={}){var s;let a,o;try{const{headers:l,method:c,body:u,signal:f,timeout:m}=n;let d={},{region:y}=n;y||(y=this.region);const x=new URL(`${this.url}/${r}`);y&&y!=="any"&&(d["x-region"]=y,x.searchParams.set("forceFunctionRegion",y));let w;u&&(l&&!Object.prototype.hasOwnProperty.call(l,"Content-Type")||!l)?typeof Blob<"u"&&u instanceof Blob||u instanceof ArrayBuffer?(d["Content-Type"]="application/octet-stream",w=u):typeof u=="string"?(d["Content-Type"]="text/plain",w=u):typeof FormData<"u"&&u instanceof FormData?w=u:(d["Content-Type"]="application/json",w=JSON.stringify(u)):w=u;let C=f;m&&(o=new AbortController,a=setTimeout(()=>o.abort(),m),f?(C=o.signal,f.addEventListener("abort",()=>o.abort())):C=o.signal);const p=yield this.fetch(x.toString(),{method:c||"POST",headers:Object.assign(Object.assign(Object.assign({},d),this.headers),l),body:w,signal:C}).catch(j=>{throw new A0(j)}),g=p.headers.get("x-relay-error");if(g&&g==="true")throw new sd(p);if(!p.ok)throw new id(p);let v=((s=p.headers.get("Content-Type"))!==null&&s!==void 0?s:"text/plain").split(";")[0].trim(),b;return v==="application/json"?b=yield p.json():v==="application/octet-stream"||v==="application/pdf"?b=yield p.blob():v==="text/event-stream"?b=p:v==="multipart/form-data"?b=yield p.formData():b=yield p.text(),{data:b,error:null,response:p}}catch(l){return{data:null,error:l,response:l instanceof id||l instanceof sd?l.context:void 0}}finally{a&&clearTimeout(a)}})}}var P0=class extends Error{constructor(t){super(t.message),this.name="PostgrestError",this.details=t.details,this.hint=t.hint,this.code=t.code}},R0=class{constructor(t){var e,r;this.shouldThrowOnError=!1,this.method=t.method,this.url=t.url,this.headers=new Headers(t.headers),this.schema=t.schema,this.body=t.body,this.shouldThrowOnError=(e=t.shouldThrowOnError)!==null&&e!==void 0?e:!1,this.signal=t.signal,this.isMaybeSingle=(r=t.isMaybeSingle)!==null&&r!==void 0?r:!1,t.fetch?this.fetch=t.fetch:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(t,e){return this.headers=new Headers(this.headers),this.headers.set(t,e),this}then(t,e){var r=this;this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const n=this.fetch;let s=n(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async a=>{let o=null,l=null,c=null,u=a.status,f=a.statusText;if(a.ok){var m,d;if(r.method!=="HEAD"){var y;const p=await a.text();p===""||(r.headers.get("Accept")==="text/csv"||r.headers.get("Accept")&&(!((y=r.headers.get("Accept"))===null||y===void 0)&&y.includes("application/vnd.pgrst.plan+text"))?l=p:l=JSON.parse(p))}const w=(m=r.headers.get("Prefer"))===null||m===void 0?void 0:m.match(/count=(exact|planned|estimated)/),C=(d=a.headers.get("content-range"))===null||d===void 0?void 0:d.split("/");w&&C&&C.length>1&&(c=parseInt(C[1])),r.isMaybeSingle&&r.method==="GET"&&Array.isArray(l)&&(l.length>1?(o={code:"PGRST116",details:`Results contain ${l.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},l=null,c=null,u=406,f="Not Acceptable"):l.length===1?l=l[0]:l=null)}else{var x;const w=await a.text();try{o=JSON.parse(w),Array.isArray(o)&&a.status===404&&(l=[],o=null,u=200,f="OK")}catch{a.status===404&&w===""?(u=204,f="No Content"):o={message:w}}if(o&&r.isMaybeSingle&&(!(o==null||(x=o.details)===null||x===void 0)&&x.includes("0 rows"))&&(o=null,u=200,f="OK"),o&&r.shouldThrowOnError)throw new P0(o)}return{error:o,data:l,count:c,status:u,statusText:f}});return this.shouldThrowOnError||(s=s.catch(a=>{var o;let l="";const c=a==null?void 0:a.cause;if(c){var u,f,m,d;const x=(u=c==null?void 0:c.message)!==null&&u!==void 0?u:"",w=(f=c==null?void 0:c.code)!==null&&f!==void 0?f:"";l=`${(m=a==null?void 0:a.name)!==null&&m!==void 0?m:"FetchError"}: ${a==null?void 0:a.message}`,l+=`

Caused by: ${(d=c==null?void 0:c.name)!==null&&d!==void 0?d:"Error"}: ${x}`,w&&(l+=` (${w})`),c!=null&&c.stack&&(l+=`
${c.stack}`)}else{var y;l=(y=a==null?void 0:a.stack)!==null&&y!==void 0?y:""}return{error:{message:`${(o=a==null?void 0:a.name)!==null&&o!==void 0?o:"FetchError"}: ${a==null?void 0:a.message}`,details:l,hint:"",code:""},data:null,count:null,status:0,statusText:""}})),s.then(t,e)}returns(){return this}overrideTypes(){return this}},O0=class extends R0{select(t){let e=!1;const r=(t??"*").split("").map(n=>/\s/.test(n)&&!e?"":(n==='"'&&(e=!e),n)).join("");return this.url.searchParams.set("select",r),this.headers.append("Prefer","return=representation"),this}order(t,{ascending:e=!0,nullsFirst:r,foreignTable:n,referencedTable:s=n}={}){const a=s?`${s}.order`:"order",o=this.url.searchParams.get(a);return this.url.searchParams.set(a,`${o?`${o},`:""}${t}.${e?"asc":"desc"}${r===void 0?"":r?".nullsfirst":".nullslast"}`),this}limit(t,{foreignTable:e,referencedTable:r=e}={}){const n=typeof r>"u"?"limit":`${r}.limit`;return this.url.searchParams.set(n,`${t}`),this}range(t,e,{foreignTable:r,referencedTable:n=r}={}){const s=typeof n>"u"?"offset":`${n}.offset`,a=typeof n>"u"?"limit":`${n}.limit`;return this.url.searchParams.set(s,`${t}`),this.url.searchParams.set(a,`${e-t+1}`),this}abortSignal(t){return this.signal=t,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:t=!1,verbose:e=!1,settings:r=!1,buffers:n=!1,wal:s=!1,format:a="text"}={}){var o;const l=[t?"analyze":null,e?"verbose":null,r?"settings":null,n?"buffers":null,s?"wal":null].filter(Boolean).join("|"),c=(o=this.headers.get("Accept"))!==null&&o!==void 0?o:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${a}; for="${c}"; options=${l};`),a==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(t){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${t}`),this}};const ad=new RegExp("[,()]");var an=class extends O0{eq(t,e){return this.url.searchParams.append(t,`eq.${e}`),this}neq(t,e){return this.url.searchParams.append(t,`neq.${e}`),this}gt(t,e){return this.url.searchParams.append(t,`gt.${e}`),this}gte(t,e){return this.url.searchParams.append(t,`gte.${e}`),this}lt(t,e){return this.url.searchParams.append(t,`lt.${e}`),this}lte(t,e){return this.url.searchParams.append(t,`lte.${e}`),this}like(t,e){return this.url.searchParams.append(t,`like.${e}`),this}likeAllOf(t,e){return this.url.searchParams.append(t,`like(all).{${e.join(",")}}`),this}likeAnyOf(t,e){return this.url.searchParams.append(t,`like(any).{${e.join(",")}}`),this}ilike(t,e){return this.url.searchParams.append(t,`ilike.${e}`),this}ilikeAllOf(t,e){return this.url.searchParams.append(t,`ilike(all).{${e.join(",")}}`),this}ilikeAnyOf(t,e){return this.url.searchParams.append(t,`ilike(any).{${e.join(",")}}`),this}regexMatch(t,e){return this.url.searchParams.append(t,`match.${e}`),this}regexIMatch(t,e){return this.url.searchParams.append(t,`imatch.${e}`),this}is(t,e){return this.url.searchParams.append(t,`is.${e}`),this}isDistinct(t,e){return this.url.searchParams.append(t,`isdistinct.${e}`),this}in(t,e){const r=Array.from(new Set(e)).map(n=>typeof n=="string"&&ad.test(n)?`"${n}"`:`${n}`).join(",");return this.url.searchParams.append(t,`in.(${r})`),this}notIn(t,e){const r=Array.from(new Set(e)).map(n=>typeof n=="string"&&ad.test(n)?`"${n}"`:`${n}`).join(",");return this.url.searchParams.append(t,`not.in.(${r})`),this}contains(t,e){return typeof e=="string"?this.url.searchParams.append(t,`cs.${e}`):Array.isArray(e)?this.url.searchParams.append(t,`cs.{${e.join(",")}}`):this.url.searchParams.append(t,`cs.${JSON.stringify(e)}`),this}containedBy(t,e){return typeof e=="string"?this.url.searchParams.append(t,`cd.${e}`):Array.isArray(e)?this.url.searchParams.append(t,`cd.{${e.join(",")}}`):this.url.searchParams.append(t,`cd.${JSON.stringify(e)}`),this}rangeGt(t,e){return this.url.searchParams.append(t,`sr.${e}`),this}rangeGte(t,e){return this.url.searchParams.append(t,`nxl.${e}`),this}rangeLt(t,e){return this.url.searchParams.append(t,`sl.${e}`),this}rangeLte(t,e){return this.url.searchParams.append(t,`nxr.${e}`),this}rangeAdjacent(t,e){return this.url.searchParams.append(t,`adj.${e}`),this}overlaps(t,e){return typeof e=="string"?this.url.searchParams.append(t,`ov.${e}`):this.url.searchParams.append(t,`ov.{${e.join(",")}}`),this}textSearch(t,e,{config:r,type:n}={}){let s="";n==="plain"?s="pl":n==="phrase"?s="ph":n==="websearch"&&(s="w");const a=r===void 0?"":`(${r})`;return this.url.searchParams.append(t,`${s}fts${a}.${e}`),this}match(t){return Object.entries(t).forEach(([e,r])=>{this.url.searchParams.append(e,`eq.${r}`)}),this}not(t,e,r){return this.url.searchParams.append(t,`not.${e}.${r}`),this}or(t,{foreignTable:e,referencedTable:r=e}={}){const n=r?`${r}.or`:"or";return this.url.searchParams.append(n,`(${t})`),this}filter(t,e,r){return this.url.searchParams.append(t,`${e}.${r}`),this}},I0=class{constructor(t,{headers:e={},schema:r,fetch:n}){this.url=t,this.headers=new Headers(e),this.schema=r,this.fetch=n}select(t,e){const{head:r=!1,count:n}=e??{},s=r?"HEAD":"GET";let a=!1;const o=(t??"*").split("").map(l=>/\s/.test(l)&&!a?"":(l==='"'&&(a=!a),l)).join("");return this.url.searchParams.set("select",o),n&&this.headers.append("Prefer",`count=${n}`),new an({method:s,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch})}insert(t,{count:e,defaultToNull:r=!0}={}){var n;const s="POST";if(e&&this.headers.append("Prefer",`count=${e}`),r||this.headers.append("Prefer","missing=default"),Array.isArray(t)){const a=t.reduce((o,l)=>o.concat(Object.keys(l)),[]);if(a.length>0){const o=[...new Set(a)].map(l=>`"${l}"`);this.url.searchParams.set("columns",o.join(","))}}return new an({method:s,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:(n=this.fetch)!==null&&n!==void 0?n:fetch})}upsert(t,{onConflict:e,ignoreDuplicates:r=!1,count:n,defaultToNull:s=!0}={}){var a;const o="POST";if(this.headers.append("Prefer",`resolution=${r?"ignore":"merge"}-duplicates`),e!==void 0&&this.url.searchParams.set("on_conflict",e),n&&this.headers.append("Prefer",`count=${n}`),s||this.headers.append("Prefer","missing=default"),Array.isArray(t)){const l=t.reduce((c,u)=>c.concat(Object.keys(u)),[]);if(l.length>0){const c=[...new Set(l)].map(u=>`"${u}"`);this.url.searchParams.set("columns",c.join(","))}}return new an({method:o,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:(a=this.fetch)!==null&&a!==void 0?a:fetch})}update(t,{count:e}={}){var r;const n="PATCH";return e&&this.headers.append("Prefer",`count=${e}`),new an({method:n,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:(r=this.fetch)!==null&&r!==void 0?r:fetch})}delete({count:t}={}){var e;const r="DELETE";return t&&this.headers.append("Prefer",`count=${t}`),new an({method:r,url:this.url,headers:this.headers,schema:this.schema,fetch:(e=this.fetch)!==null&&e!==void 0?e:fetch})}},D0=class Gf{constructor(e,{headers:r={},schema:n,fetch:s}={}){this.url=e,this.headers=new Headers(r),this.schemaName=n,this.fetch=s}from(e){if(!e||typeof e!="string"||e.trim()==="")throw new Error("Invalid relation name: relation must be a non-empty string.");return new I0(new URL(`${this.url}/${e}`),{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(e){return new Gf(this.url,{headers:this.headers,schema:e,fetch:this.fetch})}rpc(e,r={},{head:n=!1,get:s=!1,count:a}={}){var o;let l;const c=new URL(`${this.url}/rpc/${e}`);let u;n||s?(l=n?"HEAD":"GET",Object.entries(r).filter(([m,d])=>d!==void 0).map(([m,d])=>[m,Array.isArray(d)?`{${d.join(",")}}`:`${d}`]).forEach(([m,d])=>{c.searchParams.append(m,d)})):(l="POST",u=r);const f=new Headers(this.headers);return a&&f.set("Prefer",`count=${a}`),new an({method:l,url:c,headers:f,schema:this.schemaName,body:u,fetch:(o=this.fetch)!==null&&o!==void 0?o:fetch})}};class $0{constructor(){}static detectEnvironment(){var e;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((e=navigator.userAgent)===null||e===void 0)&&e.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};if(typeof process<"u"){const r=process.versions;if(r&&r.node){const n=r.node,s=parseInt(n.replace(/^v/,"").split(".")[0]);return s>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${s} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${s} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const e=this.detectEnvironment();if(e.constructor)return e.constructor;let r=e.error||"WebSocket not supported in this environment.";throw e.workaround&&(r+=`

Suggested solution: ${e.workaround}`),new Error(r)}static createWebSocket(e,r){const n=this.getWebSocketConstructor();return new n(e,r)}static isWebSocketSupported(){try{const e=this.detectEnvironment();return e.type==="native"||e.type==="ws"}catch{return!1}}}const L0="2.89.0",U0=`realtime-js/${L0}`,Jf="1.0.0",M0="2.0.0",od=Jf,jl=1e4,z0=1e3,F0=100;var ar;(function(t){t[t.connecting=0]="connecting",t[t.open=1]="open",t[t.closing=2]="closing",t[t.closed=3]="closed"})(ar||(ar={}));var we;(function(t){t.closed="closed",t.errored="errored",t.joined="joined",t.joining="joining",t.leaving="leaving"})(we||(we={}));var kt;(function(t){t.close="phx_close",t.error="phx_error",t.join="phx_join",t.reply="phx_reply",t.leave="phx_leave",t.access_token="access_token"})(kt||(kt={}));var Nl;(function(t){t.websocket="websocket"})(Nl||(Nl={}));var Lr;(function(t){t.Connecting="connecting",t.Open="open",t.Closing="closing",t.Closed="closed"})(Lr||(Lr={}));class B0{constructor(e){this.HEADER_LENGTH=1,this.USER_BROADCAST_PUSH_META_LENGTH=6,this.KINDS={userBroadcastPush:3,userBroadcast:4},this.BINARY_ENCODING=0,this.JSON_ENCODING=1,this.BROADCAST_EVENT="broadcast",this.allowedMetadataKeys=[],this.allowedMetadataKeys=e??[]}encode(e,r){if(e.event===this.BROADCAST_EVENT&&!(e.payload instanceof ArrayBuffer)&&typeof e.payload.event=="string")return r(this._binaryEncodeUserBroadcastPush(e));let n=[e.join_ref,e.ref,e.topic,e.event,e.payload];return r(JSON.stringify(n))}_binaryEncodeUserBroadcastPush(e){var r;return this._isArrayBuffer((r=e.payload)===null||r===void 0?void 0:r.payload)?this._encodeBinaryUserBroadcastPush(e):this._encodeJsonUserBroadcastPush(e)}_encodeBinaryUserBroadcastPush(e){var r,n;const s=(n=(r=e.payload)===null||r===void 0?void 0:r.payload)!==null&&n!==void 0?n:new ArrayBuffer(0);return this._encodeUserBroadcastPush(e,this.BINARY_ENCODING,s)}_encodeJsonUserBroadcastPush(e){var r,n;const s=(n=(r=e.payload)===null||r===void 0?void 0:r.payload)!==null&&n!==void 0?n:{},o=new TextEncoder().encode(JSON.stringify(s)).buffer;return this._encodeUserBroadcastPush(e,this.JSON_ENCODING,o)}_encodeUserBroadcastPush(e,r,n){var s,a;const o=e.topic,l=(s=e.ref)!==null&&s!==void 0?s:"",c=(a=e.join_ref)!==null&&a!==void 0?a:"",u=e.payload.event,f=this.allowedMetadataKeys?this._pick(e.payload,this.allowedMetadataKeys):{},m=Object.keys(f).length===0?"":JSON.stringify(f);if(c.length>255)throw new Error(`joinRef length ${c.length} exceeds maximum of 255`);if(l.length>255)throw new Error(`ref length ${l.length} exceeds maximum of 255`);if(o.length>255)throw new Error(`topic length ${o.length} exceeds maximum of 255`);if(u.length>255)throw new Error(`userEvent length ${u.length} exceeds maximum of 255`);if(m.length>255)throw new Error(`metadata length ${m.length} exceeds maximum of 255`);const d=this.USER_BROADCAST_PUSH_META_LENGTH+c.length+l.length+o.length+u.length+m.length,y=new ArrayBuffer(this.HEADER_LENGTH+d);let x=new DataView(y),w=0;x.setUint8(w++,this.KINDS.userBroadcastPush),x.setUint8(w++,c.length),x.setUint8(w++,l.length),x.setUint8(w++,o.length),x.setUint8(w++,u.length),x.setUint8(w++,m.length),x.setUint8(w++,r),Array.from(c,p=>x.setUint8(w++,p.charCodeAt(0))),Array.from(l,p=>x.setUint8(w++,p.charCodeAt(0))),Array.from(o,p=>x.setUint8(w++,p.charCodeAt(0))),Array.from(u,p=>x.setUint8(w++,p.charCodeAt(0))),Array.from(m,p=>x.setUint8(w++,p.charCodeAt(0)));var C=new Uint8Array(y.byteLength+n.byteLength);return C.set(new Uint8Array(y),0),C.set(new Uint8Array(n),y.byteLength),C.buffer}decode(e,r){if(this._isArrayBuffer(e)){let n=this._binaryDecode(e);return r(n)}if(typeof e=="string"){const n=JSON.parse(e),[s,a,o,l,c]=n;return r({join_ref:s,ref:a,topic:o,event:l,payload:c})}return r({})}_binaryDecode(e){const r=new DataView(e),n=r.getUint8(0),s=new TextDecoder;switch(n){case this.KINDS.userBroadcast:return this._decodeUserBroadcast(e,r,s)}}_decodeUserBroadcast(e,r,n){const s=r.getUint8(1),a=r.getUint8(2),o=r.getUint8(3),l=r.getUint8(4);let c=this.HEADER_LENGTH+4;const u=n.decode(e.slice(c,c+s));c=c+s;const f=n.decode(e.slice(c,c+a));c=c+a;const m=n.decode(e.slice(c,c+o));c=c+o;const d=e.slice(c,e.byteLength),y=l===this.JSON_ENCODING?JSON.parse(n.decode(d)):d,x={type:this.BROADCAST_EVENT,event:f,payload:y};return o>0&&(x.meta=JSON.parse(m)),{join_ref:null,ref:null,topic:u,event:this.BROADCAST_EVENT,payload:x}}_isArrayBuffer(e){var r;return e instanceof ArrayBuffer||((r=e==null?void 0:e.constructor)===null||r===void 0?void 0:r.name)==="ArrayBuffer"}_pick(e,r){return!e||typeof e!="object"?{}:Object.fromEntries(Object.entries(e).filter(([n])=>r.includes(n)))}}class Qf{constructor(e,r){this.callback=e,this.timerCalc=r,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=r}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var te;(function(t){t.abstime="abstime",t.bool="bool",t.date="date",t.daterange="daterange",t.float4="float4",t.float8="float8",t.int2="int2",t.int4="int4",t.int4range="int4range",t.int8="int8",t.int8range="int8range",t.json="json",t.jsonb="jsonb",t.money="money",t.numeric="numeric",t.oid="oid",t.reltime="reltime",t.text="text",t.time="time",t.timestamp="timestamp",t.timestamptz="timestamptz",t.timetz="timetz",t.tsrange="tsrange",t.tstzrange="tstzrange"})(te||(te={}));const ld=(t,e,r={})=>{var n;const s=(n=r.skipTypes)!==null&&n!==void 0?n:[];return e?Object.keys(e).reduce((a,o)=>(a[o]=q0(o,t,e,s),a),{}):{}},q0=(t,e,r,n)=>{const s=e.find(l=>l.name===t),a=s==null?void 0:s.type,o=r[t];return a&&!n.includes(a)?Yf(a,o):kl(o)},Yf=(t,e)=>{if(t.charAt(0)==="_"){const r=t.slice(1,t.length);return K0(e,r)}switch(t){case te.bool:return V0(e);case te.float4:case te.float8:case te.int2:case te.int4:case te.int8:case te.numeric:case te.oid:return W0(e);case te.json:case te.jsonb:return H0(e);case te.timestamp:return G0(e);case te.abstime:case te.date:case te.daterange:case te.int4range:case te.int8range:case te.money:case te.reltime:case te.text:case te.time:case te.timestamptz:case te.timetz:case te.tsrange:case te.tstzrange:return kl(e);default:return kl(e)}},kl=t=>t,V0=t=>{switch(t){case"t":return!0;case"f":return!1;default:return t}},W0=t=>{if(typeof t=="string"){const e=parseFloat(t);if(!Number.isNaN(e))return e}return t},H0=t=>{if(typeof t=="string")try{return JSON.parse(t)}catch{return t}return t},K0=(t,e)=>{if(typeof t!="string")return t;const r=t.length-1,n=t[r];if(t[0]==="{"&&n==="}"){let a;const o=t.slice(1,r);try{a=JSON.parse("["+o+"]")}catch{a=o?o.split(","):[]}return a.map(l=>Yf(e,l))}return t},G0=t=>typeof t=="string"?t.replace(" ","T"):t,Xf=t=>{const e=new URL(t);return e.protocol=e.protocol.replace(/^ws/i,"http"),e.pathname=e.pathname.replace(/\/+$/,"").replace(/\/socket\/websocket$/i,"").replace(/\/socket$/i,"").replace(/\/websocket$/i,""),e.pathname===""||e.pathname==="/"?e.pathname="/api/broadcast":e.pathname=e.pathname+"/api/broadcast",e.href};class go{constructor(e,r,n={},s=jl){this.channel=e,this.event=r,this.payload=n,this.timeout=s,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,r){var n;return this._hasReceived(e)&&r((n=this.receivedResp)===null||n===void 0?void 0:n.response),this.recHooks.push({status:e,callback:r}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const e=r=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=r,this._matchReceive(r)};this.channel._on(this.refEvent,{},e),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,r){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:r})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:r}){this.recHooks.filter(n=>n.status===e).forEach(n=>n.callback(r))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var cd;(function(t){t.SYNC="sync",t.JOIN="join",t.LEAVE="leave"})(cd||(cd={}));class ws{constructor(e,r){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const n=(r==null?void 0:r.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(n.state,{},s=>{const{onJoin:a,onLeave:o,onSync:l}=this.caller;this.joinRef=this.channel._joinRef(),this.state=ws.syncState(this.state,s,a,o),this.pendingDiffs.forEach(c=>{this.state=ws.syncDiff(this.state,c,a,o)}),this.pendingDiffs=[],l()}),this.channel._on(n.diff,{},s=>{const{onJoin:a,onLeave:o,onSync:l}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(s):(this.state=ws.syncDiff(this.state,s,a,o),l())}),this.onJoin((s,a,o)=>{this.channel._trigger("presence",{event:"join",key:s,currentPresences:a,newPresences:o})}),this.onLeave((s,a,o)=>{this.channel._trigger("presence",{event:"leave",key:s,currentPresences:a,leftPresences:o})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,r,n,s){const a=this.cloneDeep(e),o=this.transformState(r),l={},c={};return this.map(a,(u,f)=>{o[u]||(c[u]=f)}),this.map(o,(u,f)=>{const m=a[u];if(m){const d=f.map(C=>C.presence_ref),y=m.map(C=>C.presence_ref),x=f.filter(C=>y.indexOf(C.presence_ref)<0),w=m.filter(C=>d.indexOf(C.presence_ref)<0);x.length>0&&(l[u]=x),w.length>0&&(c[u]=w)}else l[u]=f}),this.syncDiff(a,{joins:l,leaves:c},n,s)}static syncDiff(e,r,n,s){const{joins:a,leaves:o}={joins:this.transformState(r.joins),leaves:this.transformState(r.leaves)};return n||(n=()=>{}),s||(s=()=>{}),this.map(a,(l,c)=>{var u;const f=(u=e[l])!==null&&u!==void 0?u:[];if(e[l]=this.cloneDeep(c),f.length>0){const m=e[l].map(y=>y.presence_ref),d=f.filter(y=>m.indexOf(y.presence_ref)<0);e[l].unshift(...d)}n(l,f,c)}),this.map(o,(l,c)=>{let u=e[l];if(!u)return;const f=c.map(m=>m.presence_ref);u=u.filter(m=>f.indexOf(m.presence_ref)<0),e[l]=u,s(l,u,c),u.length===0&&delete e[l]}),e}static map(e,r){return Object.getOwnPropertyNames(e).map(n=>r(n,e[n]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((r,n)=>{const s=e[n];return"metas"in s?r[n]=s.metas.map(a=>(a.presence_ref=a.phx_ref,delete a.phx_ref,delete a.phx_ref_prev,a)):r[n]=s,r},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var ud;(function(t){t.ALL="*",t.INSERT="INSERT",t.UPDATE="UPDATE",t.DELETE="DELETE"})(ud||(ud={}));var _s;(function(t){t.BROADCAST="broadcast",t.PRESENCE="presence",t.POSTGRES_CHANGES="postgres_changes",t.SYSTEM="system"})(_s||(_s={}));var zt;(function(t){t.SUBSCRIBED="SUBSCRIBED",t.TIMED_OUT="TIMED_OUT",t.CLOSED="CLOSED",t.CHANNEL_ERROR="CHANNEL_ERROR"})(zt||(zt={}));class bn{constructor(e,r={config:{}},n){var s,a;if(this.topic=e,this.params=r,this.socket=n,this.bindings={},this.state=we.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},r.config),this.timeout=this.socket.timeout,this.joinPush=new go(this,kt.join,this.params,this.timeout),this.rejoinTimer=new Qf(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=we.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(o=>o.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=we.closed,this.socket._remove(this)}),this._onError(o=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,o),this.state=we.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=we.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",o=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,o),this.state=we.errored,this.rejoinTimer.scheduleTimeout())}),this._on(kt.reply,{},(o,l)=>{this._trigger(this._replyEventName(l),o)}),this.presence=new ws(this),this.broadcastEndpointURL=Xf(this.socket.endPoint),this.private=this.params.config.private||!1,!this.private&&(!((a=(s=this.params.config)===null||s===void 0?void 0:s.broadcast)===null||a===void 0)&&a.replay))throw`tried to use replay on public channel '${this.topic}'. It must be a private channel.`}subscribe(e,r=this.timeout){var n,s,a;if(this.socket.isConnected()||this.socket.connect(),this.state==we.closed){const{config:{broadcast:o,presence:l,private:c}}=this.params,u=(s=(n=this.bindings.postgres_changes)===null||n===void 0?void 0:n.map(y=>y.filter))!==null&&s!==void 0?s:[],f=!!this.bindings[_s.PRESENCE]&&this.bindings[_s.PRESENCE].length>0||((a=this.params.config.presence)===null||a===void 0?void 0:a.enabled)===!0,m={},d={broadcast:o,presence:Object.assign(Object.assign({},l),{enabled:f}),postgres_changes:u,private:c};this.socket.accessTokenValue&&(m.access_token=this.socket.accessTokenValue),this._onError(y=>e==null?void 0:e(zt.CHANNEL_ERROR,y)),this._onClose(()=>e==null?void 0:e(zt.CLOSED)),this.updateJoinPayload(Object.assign({config:d},m)),this.joinedOnce=!0,this._rejoin(r),this.joinPush.receive("ok",async({postgres_changes:y})=>{var x;if(this.socket._isManualToken()||this.socket.setAuth(),y===void 0){e==null||e(zt.SUBSCRIBED);return}else{const w=this.bindings.postgres_changes,C=(x=w==null?void 0:w.length)!==null&&x!==void 0?x:0,p=[];for(let g=0;g<C;g++){const v=w[g],{filter:{event:b,schema:j,table:N,filter:S}}=v,P=y&&y[g];if(P&&P.event===b&&bn.isFilterValueEqual(P.schema,j)&&bn.isFilterValueEqual(P.table,N)&&bn.isFilterValueEqual(P.filter,S))p.push(Object.assign(Object.assign({},v),{id:P.id}));else{this.unsubscribe(),this.state=we.errored,e==null||e(zt.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=p,e&&e(zt.SUBSCRIBED);return}}).receive("error",y=>{this.state=we.errored,e==null||e(zt.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(y).join(", ")||"error")))}).receive("timeout",()=>{e==null||e(zt.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(e,r={}){return await this.send({type:"presence",event:"track",payload:e},r.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,r,n){return this.state===we.joined&&e===_s.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(async()=>await this.subscribe())),this._on(e,r,n)}async httpSend(e,r,n={}){var s;if(r==null)return Promise.reject("Payload is required for httpSend()");const a={apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"};this.socket.accessTokenValue&&(a.Authorization=`Bearer ${this.socket.accessTokenValue}`);const o={method:"POST",headers:a,body:JSON.stringify({messages:[{topic:this.subTopic,event:e,payload:r,private:this.private}]})},l=await this._fetchWithTimeout(this.broadcastEndpointURL,o,(s=n.timeout)!==null&&s!==void 0?s:this.timeout);if(l.status===202)return{success:!0};let c=l.statusText;try{const u=await l.json();c=u.error||u.message||c}catch{}return Promise.reject(new Error(c))}async send(e,r={}){var n,s;if(!this._canPush()&&e.type==="broadcast"){console.warn("Realtime send() is automatically falling back to REST API. This behavior will be deprecated in the future. Please use httpSend() explicitly for REST delivery.");const{event:a,payload:o}=e,l={apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"};this.socket.accessTokenValue&&(l.Authorization=`Bearer ${this.socket.accessTokenValue}`);const c={method:"POST",headers:l,body:JSON.stringify({messages:[{topic:this.subTopic,event:a,payload:o,private:this.private}]})};try{const u=await this._fetchWithTimeout(this.broadcastEndpointURL,c,(n=r.timeout)!==null&&n!==void 0?n:this.timeout);return await((s=u.body)===null||s===void 0?void 0:s.cancel()),u.ok?"ok":"error"}catch(u){return u.name==="AbortError"?"timed out":"error"}}else return new Promise(a=>{var o,l,c;const u=this._push(e.type,e,r.timeout||this.timeout);e.type==="broadcast"&&!(!((c=(l=(o=this.params)===null||o===void 0?void 0:o.config)===null||l===void 0?void 0:l.broadcast)===null||c===void 0)&&c.ack)&&a("ok"),u.receive("ok",()=>a("ok")),u.receive("error",()=>a("error")),u.receive("timeout",()=>a("timed out"))})}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=we.leaving;const r=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(kt.close,"leave",this._joinRef())};this.joinPush.destroy();let n=null;return new Promise(s=>{n=new go(this,kt.leave,{},e),n.receive("ok",()=>{r(),s("ok")}).receive("timeout",()=>{r(),s("timed out")}).receive("error",()=>{s("error")}),n.send(),this._canPush()||n.trigger("ok",{})}).finally(()=>{n==null||n.destroy()})}teardown(){this.pushBuffer.forEach(e=>e.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=we.closed,this.bindings={}}async _fetchWithTimeout(e,r,n){const s=new AbortController,a=setTimeout(()=>s.abort(),n),o=await this.socket.fetch(e,Object.assign(Object.assign({},r),{signal:s.signal}));return clearTimeout(a),o}_push(e,r,n=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let s=new go(this,e,r,n);return this._canPush()?s.send():this._addToPushBuffer(s),s}_addToPushBuffer(e){if(e.startTimeout(),this.pushBuffer.push(e),this.pushBuffer.length>F0){const r=this.pushBuffer.shift();r&&(r.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${r.event}`,r.payload))}}_onMessage(e,r,n){return r}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,r,n){var s,a;const o=e.toLocaleLowerCase(),{close:l,error:c,leave:u,join:f}=kt;if(n&&[l,c,u,f].indexOf(o)>=0&&n!==this._joinRef())return;let d=this._onMessage(o,r,n);if(r&&!d)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(o)?(s=this.bindings.postgres_changes)===null||s===void 0||s.filter(y=>{var x,w,C;return((x=y.filter)===null||x===void 0?void 0:x.event)==="*"||((C=(w=y.filter)===null||w===void 0?void 0:w.event)===null||C===void 0?void 0:C.toLocaleLowerCase())===o}).map(y=>y.callback(d,n)):(a=this.bindings[o])===null||a===void 0||a.filter(y=>{var x,w,C,p,g,v;if(["broadcast","presence","postgres_changes"].includes(o))if("id"in y){const b=y.id,j=(x=y.filter)===null||x===void 0?void 0:x.event;return b&&((w=r.ids)===null||w===void 0?void 0:w.includes(b))&&(j==="*"||(j==null?void 0:j.toLocaleLowerCase())===((C=r.data)===null||C===void 0?void 0:C.type.toLocaleLowerCase()))}else{const b=(g=(p=y==null?void 0:y.filter)===null||p===void 0?void 0:p.event)===null||g===void 0?void 0:g.toLocaleLowerCase();return b==="*"||b===((v=r==null?void 0:r.event)===null||v===void 0?void 0:v.toLocaleLowerCase())}else return y.type.toLocaleLowerCase()===o}).map(y=>{if(typeof d=="object"&&"ids"in d){const x=d.data,{schema:w,table:C,commit_timestamp:p,type:g,errors:v}=x;d=Object.assign(Object.assign({},{schema:w,table:C,commit_timestamp:p,eventType:g,new:{},old:{},errors:v}),this._getPayloadRecords(x))}y.callback(d,n)})}_isClosed(){return this.state===we.closed}_isJoined(){return this.state===we.joined}_isJoining(){return this.state===we.joining}_isLeaving(){return this.state===we.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,r,n){const s=e.toLocaleLowerCase(),a={type:s,filter:r,callback:n};return this.bindings[s]?this.bindings[s].push(a):this.bindings[s]=[a],this}_off(e,r){const n=e.toLocaleLowerCase();return this.bindings[n]&&(this.bindings[n]=this.bindings[n].filter(s=>{var a;return!(((a=s.type)===null||a===void 0?void 0:a.toLocaleLowerCase())===n&&bn.isEqual(s.filter,r))})),this}static isEqual(e,r){if(Object.keys(e).length!==Object.keys(r).length)return!1;for(const n in e)if(e[n]!==r[n])return!1;return!0}static isFilterValueEqual(e,r){return(e??void 0)===(r??void 0)}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(kt.close,{},e)}_onError(e){this._on(kt.error,{},r=>e(r))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=we.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const r={new:{},old:{}};return(e.type==="INSERT"||e.type==="UPDATE")&&(r.new=ld(e.columns,e.record)),(e.type==="UPDATE"||e.type==="DELETE")&&(r.old=ld(e.columns,e.old_record)),r}}const yo=()=>{},bi={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},J0=[1e3,2e3,5e3,1e4],Q0=1e4,Y0=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class X0{constructor(e,r){var n;if(this.accessTokenValue=null,this.apiKey=null,this._manuallySetToken=!1,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=jl,this.transport=null,this.heartbeatIntervalMs=bi.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=yo,this.ref=0,this.reconnectTimer=null,this.vsn=od,this.logger=yo,this.conn=null,this.sendBuffer=[],this.serializer=new B0,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._resolveFetch=s=>s?(...a)=>s(...a):(...a)=>fetch(...a),!(!((n=r==null?void 0:r.params)===null||n===void 0)&&n.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=r.params.apikey,this.endPoint=`${e}/${Nl.websocket}`,this.httpEndpoint=Xf(e),this._initializeOptions(r),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(r==null?void 0:r.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this.accessToken&&!this._authPromise&&this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=$0.createWebSocket(this.endpointURL())}catch(e){this._setConnectionState("disconnected");const r=e.message;throw r.includes("Node.js")?new Error(`${r}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${r}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:this.vsn}))}disconnect(e,r){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const n=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(n),this._setConnectionState("disconnected")},typeof this.conn.close=="function"&&(e?this.conn.close(e,r??""):this.conn.close()),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(e){const r=await e.unsubscribe();return this.channels.length===0&&this.disconnect(),r}async removeAllChannels(){const e=await Promise.all(this.channels.map(r=>r.unsubscribe()));return this.channels=[],this.disconnect(),e}log(e,r,n){this.logger(e,r,n)}connectionState(){switch(this.conn&&this.conn.readyState){case ar.connecting:return Lr.Connecting;case ar.open:return Lr.Open;case ar.closing:return Lr.Closing;default:return Lr.Closed}}isConnected(){return this.connectionState()===Lr.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(e,r={config:{}}){const n=`realtime:${e}`,s=this.getChannels().find(a=>a.topic===n);if(s)return s;{const a=new bn(`realtime:${e}`,r,this);return this.channels.push(a),a}}push(e){const{topic:r,event:n,payload:s,ref:a}=e,o=()=>{this.encode(e,l=>{var c;(c=this.conn)===null||c===void 0||c.send(l)})};this.log("push",`${r} ${n} (${a})`,s),this.isConnected()?o():this.sendBuffer.push(o)}async setAuth(e=null){this._authPromise=this._performAuth(e);try{await this._authPromise}finally{this._authPromise=null}}_isManualToken(){return this._manuallySetToken}async sendHeartbeat(){var e;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(r){this.log("error","error in heartbeat callback",r)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(r){this.log("error","error in heartbeat callback",r)}this._wasManualDisconnect=!1,(e=this.conn)===null||e===void 0||e.close(z0,"heartbeat timeout"),setTimeout(()=>{var r;this.isConnected()||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout()},bi.HEARTBEAT_TIMEOUT_FALLBACK);return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(r){this.log("error","error in heartbeat callback",r)}this._setAuthSafely("heartbeat")}onHeartbeat(e){this.heartbeatCallback=e}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let r=this.channels.find(n=>n.topic===e&&(n._isJoined()||n._isJoining()));r&&(this.log("transport",`leaving duplicate topic "${e}"`),r.unsubscribe())}_remove(e){this.channels=this.channels.filter(r=>r.topic!==e.topic)}_onConnMessage(e){this.decode(e.data,r=>{if(r.topic==="phoenix"&&r.event==="phx_reply")try{this.heartbeatCallback(r.payload.status==="ok"?"ok":"error")}catch(u){this.log("error","error in heartbeat callback",u)}r.ref&&r.ref===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null);const{topic:n,event:s,payload:a,ref:o}=r,l=o?`(${o})`:"",c=a.status||"";this.log("receive",`${c} ${n} ${s} ${l}`.trim(),a),this.channels.filter(u=>u._isMember(n)).forEach(u=>u._trigger(s,a,o)),this._triggerStateCallbacks("message",r)})}_clearTimer(e){var r;e==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):e==="reconnect"&&((r=this.reconnectTimer)===null||r===void 0||r.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e),this.conn.readyState===ar.open&&this._onConnOpen())}_teardownConnection(){if(this.conn){if(this.conn.readyState===ar.open||this.conn.readyState===ar.connecting)try{this.conn.close()}catch(e){this.log("error","Error closing connection",e)}this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null}this._clearAllTimers(),this._terminateWorker(),this.channels.forEach(e=>e.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),(this._authPromise||(this.accessToken&&!this.accessTokenValue?this.setAuth():Promise.resolve())).then(()=>{this.flushSendBuffer()}).catch(r=>{this.log("error","error waiting for auth on connect",r),this.flushSendBuffer()}),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=r=>{this.log("worker","worker error",r.message),this._terminateWorker()},this.workerRef.onmessage=r=>{r.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_terminateWorker(){this.workerRef&&(this.log("worker","terminating worker"),this.workerRef.terminate(),this.workerRef=void 0)}_onConnClose(e){var r;this._setConnectionState("disconnected"),this.log("transport","close",e),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout(),this._triggerStateCallbacks("close",e)}_onConnError(e){this._setConnectionState("disconnected"),this.log("transport",`${e}`),this._triggerChanError(),this._triggerStateCallbacks("error",e)}_triggerChanError(){this.channels.forEach(e=>e._trigger(kt.error))}_appendParams(e,r){if(Object.keys(r).length===0)return e;const n=e.match(/\?/)?"&":"?",s=new URLSearchParams(r);return`${e}${n}${s}`}_workerObjectUrl(e){let r;if(e)r=e;else{const n=new Blob([Y0],{type:"application/javascript"});r=URL.createObjectURL(n)}return r}_setConnectionState(e,r=!1){this._connectionState=e,e==="connecting"?this._wasManualDisconnect=!1:e==="disconnecting"&&(this._wasManualDisconnect=r)}async _performAuth(e=null){let r,n=!1;if(e)r=e,n=!0;else if(this.accessToken)try{r=await this.accessToken()}catch(s){this.log("error","Error fetching access token from callback",s),r=this.accessTokenValue}else r=this.accessTokenValue;n?this._manuallySetToken=!0:this.accessToken&&(this._manuallySetToken=!1),this.accessTokenValue!=r&&(this.accessTokenValue=r,this.channels.forEach(s=>{const a={access_token:r,version:U0};r&&s.updateJoinPayload(a),s.joinedOnce&&s._isJoined()&&s._push(kt.access_token,{access_token:r})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(e="general"){this._isManualToken()||this.setAuth().catch(r=>{this.log("error",`Error setting auth in ${e}`,r)})}_triggerStateCallbacks(e,r){try{this.stateChangeCallbacks[e].forEach(n=>{try{n(r)}catch(s){this.log("error",`error in ${e} callback`,s)}})}catch(n){this.log("error",`error triggering ${e} callbacks`,n)}}_setupReconnectionTimer(){this.reconnectTimer=new Qf(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},bi.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(e){var r,n,s,a,o,l,c,u,f,m,d,y;switch(this.transport=(r=e==null?void 0:e.transport)!==null&&r!==void 0?r:null,this.timeout=(n=e==null?void 0:e.timeout)!==null&&n!==void 0?n:jl,this.heartbeatIntervalMs=(s=e==null?void 0:e.heartbeatIntervalMs)!==null&&s!==void 0?s:bi.HEARTBEAT_INTERVAL,this.worker=(a=e==null?void 0:e.worker)!==null&&a!==void 0?a:!1,this.accessToken=(o=e==null?void 0:e.accessToken)!==null&&o!==void 0?o:null,this.heartbeatCallback=(l=e==null?void 0:e.heartbeatCallback)!==null&&l!==void 0?l:yo,this.vsn=(c=e==null?void 0:e.vsn)!==null&&c!==void 0?c:od,e!=null&&e.params&&(this.params=e.params),e!=null&&e.logger&&(this.logger=e.logger),(e!=null&&e.logLevel||e!=null&&e.log_level)&&(this.logLevel=e.logLevel||e.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(u=e==null?void 0:e.reconnectAfterMs)!==null&&u!==void 0?u:x=>J0[x-1]||Q0,this.vsn){case Jf:this.encode=(f=e==null?void 0:e.encode)!==null&&f!==void 0?f:(x,w)=>w(JSON.stringify(x)),this.decode=(m=e==null?void 0:e.decode)!==null&&m!==void 0?m:(x,w)=>w(JSON.parse(x));break;case M0:this.encode=(d=e==null?void 0:e.encode)!==null&&d!==void 0?d:this.serializer.encode.bind(this.serializer),this.decode=(y=e==null?void 0:e.decode)!==null&&y!==void 0?y:this.serializer.decode.bind(this.serializer);break;default:throw new Error(`Unsupported serializer version: ${this.vsn}`)}if(this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=e==null?void 0:e.workerUrl}}}var Bs=class extends Error{constructor(t,e){var r;super(t),this.name="IcebergError",this.status=e.status,this.icebergType=e.icebergType,this.icebergCode=e.icebergCode,this.details=e.details,this.isCommitStateUnknown=e.icebergType==="CommitStateUnknownException"||[500,502,504].includes(e.status)&&((r=e.icebergType)==null?void 0:r.includes("CommitState"))===!0}isNotFound(){return this.status===404}isConflict(){return this.status===409}isAuthenticationTimeout(){return this.status===419}};function Z0(t,e,r){const n=new URL(e,t);if(r)for(const[s,a]of Object.entries(r))a!==void 0&&n.searchParams.set(s,a);return n.toString()}async function ey(t){return!t||t.type==="none"?{}:t.type==="bearer"?{Authorization:`Bearer ${t.token}`}:t.type==="header"?{[t.name]:t.value}:t.type==="custom"?await t.getHeaders():{}}function ty(t){const e=t.fetchImpl??globalThis.fetch;return{async request({method:r,path:n,query:s,body:a,headers:o}){const l=Z0(t.baseUrl,n,s),c=await ey(t.auth),u=await e(l,{method:r,headers:{...a?{"Content-Type":"application/json"}:{},...c,...o},body:a?JSON.stringify(a):void 0}),f=await u.text(),m=(u.headers.get("content-type")||"").includes("application/json"),d=m&&f?JSON.parse(f):f;if(!u.ok){const y=m?d:void 0,x=y==null?void 0:y.error;throw new Bs((x==null?void 0:x.message)??`Request failed with status ${u.status}`,{status:u.status,icebergType:x==null?void 0:x.type,icebergCode:x==null?void 0:x.code,details:y})}return{status:u.status,headers:u.headers,data:d}}}}function ji(t){return t.join("")}var ry=class{constructor(t,e=""){this.client=t,this.prefix=e}async listNamespaces(t){const e=t?{parent:ji(t.namespace)}:void 0;return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces`,query:e})).data.namespaces.map(n=>({namespace:n}))}async createNamespace(t,e){const r={namespace:t.namespace,properties:e==null?void 0:e.properties};return(await this.client.request({method:"POST",path:`${this.prefix}/namespaces`,body:r})).data}async dropNamespace(t){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${ji(t.namespace)}`})}async loadNamespaceMetadata(t){return{properties:(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${ji(t.namespace)}`})).data.properties}}async namespaceExists(t){try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${ji(t.namespace)}`}),!0}catch(e){if(e instanceof Bs&&e.status===404)return!1;throw e}}async createNamespaceIfNotExists(t,e){try{return await this.createNamespace(t,e)}catch(r){if(r instanceof Bs&&r.status===409)return;throw r}}};function Zr(t){return t.join("")}var ny=class{constructor(t,e="",r){this.client=t,this.prefix=e,this.accessDelegation=r}async listTables(t){return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${Zr(t.namespace)}/tables`})).data.identifiers}async createTable(t,e){const r={};return this.accessDelegation&&(r["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${Zr(t.namespace)}/tables`,body:e,headers:r})).data.metadata}async updateTable(t,e){const r=await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${Zr(t.namespace)}/tables/${t.name}`,body:e});return{"metadata-location":r.data["metadata-location"],metadata:r.data.metadata}}async dropTable(t,e){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${Zr(t.namespace)}/tables/${t.name}`,query:{purgeRequested:String((e==null?void 0:e.purge)??!1)}})}async loadTable(t){const e={};return this.accessDelegation&&(e["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${Zr(t.namespace)}/tables/${t.name}`,headers:e})).data.metadata}async tableExists(t){const e={};this.accessDelegation&&(e["X-Iceberg-Access-Delegation"]=this.accessDelegation);try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${Zr(t.namespace)}/tables/${t.name}`,headers:e}),!0}catch(r){if(r instanceof Bs&&r.status===404)return!1;throw r}}async createTableIfNotExists(t,e){try{return await this.createTable(t,e)}catch(r){if(r instanceof Bs&&r.status===409)return await this.loadTable({namespace:t.namespace,name:e.name});throw r}}},sy=class{constructor(t){var n;let e="v1";t.catalogName&&(e+=`/${t.catalogName}`);const r=t.baseUrl.endsWith("/")?t.baseUrl:`${t.baseUrl}/`;this.client=ty({baseUrl:r,auth:t.auth,fetchImpl:t.fetch}),this.accessDelegation=(n=t.accessDelegation)==null?void 0:n.join(","),this.namespaceOps=new ry(this.client,e),this.tableOps=new ny(this.client,e,this.accessDelegation)}async listNamespaces(t){return this.namespaceOps.listNamespaces(t)}async createNamespace(t,e){return this.namespaceOps.createNamespace(t,e)}async dropNamespace(t){await this.namespaceOps.dropNamespace(t)}async loadNamespaceMetadata(t){return this.namespaceOps.loadNamespaceMetadata(t)}async listTables(t){return this.tableOps.listTables(t)}async createTable(t,e){return this.tableOps.createTable(t,e)}async updateTable(t,e){return this.tableOps.updateTable(t,e)}async dropTable(t,e){await this.tableOps.dropTable(t,e)}async loadTable(t){return this.tableOps.loadTable(t)}async namespaceExists(t){return this.namespaceOps.namespaceExists(t)}async tableExists(t){return this.tableOps.tableExists(t)}async createNamespaceIfNotExists(t,e){return this.namespaceOps.createNamespaceIfNotExists(t,e)}async createTableIfNotExists(t,e){return this.tableOps.createTableIfNotExists(t,e)}},Ia=class extends Error{constructor(t){super(t),this.__isStorageError=!0,this.name="StorageError"}};function ce(t){return typeof t=="object"&&t!==null&&"__isStorageError"in t}var iy=class extends Ia{constructor(t,e,r){super(t),this.name="StorageApiError",this.status=e,this.statusCode=r}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}},Sl=class extends Ia{constructor(t,e){super(t),this.name="StorageUnknownError",this.originalError=e}};const Ec=t=>t?(...e)=>t(...e):(...e)=>fetch(...e),ay=()=>Response,Cl=t=>{if(Array.isArray(t))return t.map(r=>Cl(r));if(typeof t=="function"||t!==Object(t))return t;const e={};return Object.entries(t).forEach(([r,n])=>{const s=r.replace(/([-_][a-z])/gi,a=>a.toUpperCase().replace(/[-_]/g,""));e[s]=Cl(n)}),e},oy=t=>{if(typeof t!="object"||t===null)return!1;const e=Object.getPrototypeOf(t);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in t)&&!(Symbol.iterator in t)},ly=t=>!t||typeof t!="string"||t.length===0||t.length>100||t.trim()!==t||t.includes("/")||t.includes("\\")?!1:/^[\w!.\*'() &$@=;:+,?-]+$/.test(t);function qs(t){"@babel/helpers - typeof";return qs=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},qs(t)}function cy(t,e){if(qs(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(qs(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function uy(t){var e=cy(t,"string");return qs(e)=="symbol"?e:e+""}function dy(t,e,r){return(e=uy(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function dd(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable})),r.push.apply(r,n)}return r}function M(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?dd(Object(r),!0).forEach(function(n){dy(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):dd(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}const vo=t=>{var e;return t.msg||t.message||t.error_description||(typeof t.error=="string"?t.error:(e=t.error)===null||e===void 0?void 0:e.message)||JSON.stringify(t)},hy=async(t,e,r)=>{t instanceof await ay()&&!(r!=null&&r.noResolveJson)?t.json().then(n=>{const s=t.status||500,a=(n==null?void 0:n.statusCode)||s+"";e(new iy(vo(n),s,a))}).catch(n=>{e(new Sl(vo(n),n))}):e(new Sl(vo(t),t))},fy=(t,e,r,n)=>{const s={method:t,headers:(e==null?void 0:e.headers)||{}};return t==="GET"||!n?s:(oy(n)?(s.headers=M({"Content-Type":"application/json"},e==null?void 0:e.headers),s.body=JSON.stringify(n)):s.body=n,e!=null&&e.duplex&&(s.duplex=e.duplex),M(M({},s),r))};async function Zs(t,e,r,n,s,a){return new Promise((o,l)=>{t(r,fy(e,n,s,a)).then(c=>{if(!c.ok)throw c;return n!=null&&n.noResolveJson?c:c.json()}).then(c=>o(c)).catch(c=>hy(c,l,n))})}async function Vs(t,e,r,n){return Zs(t,"GET",e,r,n)}async function jt(t,e,r,n,s){return Zs(t,"POST",e,n,s,r)}async function El(t,e,r,n,s){return Zs(t,"PUT",e,n,s,r)}async function my(t,e,r,n){return Zs(t,"HEAD",e,M(M({},r),{},{noResolveJson:!0}),n)}async function Ac(t,e,r,n,s){return Zs(t,"DELETE",e,n,s,r)}var py=class{constructor(t,e){this.downloadFn=t,this.shouldThrowOnError=e}then(t,e){return this.execute().then(t,e)}async execute(){var t=this;try{return{data:(await t.downloadFn()).body,error:null}}catch(e){if(t.shouldThrowOnError)throw e;if(ce(e))return{data:null,error:e};throw e}}};let Zf;Zf=Symbol.toStringTag;var gy=class{constructor(t,e){this.downloadFn=t,this.shouldThrowOnError=e,this[Zf]="BlobDownloadBuilder",this.promise=null}asStream(){return new py(this.downloadFn,this.shouldThrowOnError)}then(t,e){return this.getPromise().then(t,e)}catch(t){return this.getPromise().catch(t)}finally(t){return this.getPromise().finally(t)}getPromise(){return this.promise||(this.promise=this.execute()),this.promise}async execute(){var t=this;try{return{data:await(await t.downloadFn()).blob(),error:null}}catch(e){if(t.shouldThrowOnError)throw e;if(ce(e))return{data:null,error:e};throw e}}};const yy={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},hd={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};var vy=class{constructor(t,e={},r,n){this.shouldThrowOnError=!1,this.url=t,this.headers=e,this.bucketId=r,this.fetch=Ec(n)}throwOnError(){return this.shouldThrowOnError=!0,this}async uploadOrUpdate(t,e,r,n){var s=this;try{let a;const o=M(M({},hd),n);let l=M(M({},s.headers),t==="POST"&&{"x-upsert":String(o.upsert)});const c=o.metadata;typeof Blob<"u"&&r instanceof Blob?(a=new FormData,a.append("cacheControl",o.cacheControl),c&&a.append("metadata",s.encodeMetadata(c)),a.append("",r)):typeof FormData<"u"&&r instanceof FormData?(a=r,a.has("cacheControl")||a.append("cacheControl",o.cacheControl),c&&!a.has("metadata")&&a.append("metadata",s.encodeMetadata(c))):(a=r,l["cache-control"]=`max-age=${o.cacheControl}`,l["content-type"]=o.contentType,c&&(l["x-metadata"]=s.toBase64(s.encodeMetadata(c))),(typeof ReadableStream<"u"&&a instanceof ReadableStream||a&&typeof a=="object"&&"pipe"in a&&typeof a.pipe=="function")&&!o.duplex&&(o.duplex="half")),n!=null&&n.headers&&(l=M(M({},l),n.headers));const u=s._removeEmptyFolders(e),f=s._getFinalPath(u),m=await(t=="PUT"?El:jt)(s.fetch,`${s.url}/object/${f}`,a,M({headers:l},o!=null&&o.duplex?{duplex:o.duplex}:{}));return{data:{path:u,id:m.Id,fullPath:m.Key},error:null}}catch(a){if(s.shouldThrowOnError)throw a;if(ce(a))return{data:null,error:a};throw a}}async upload(t,e,r){return this.uploadOrUpdate("POST",t,e,r)}async uploadToSignedUrl(t,e,r,n){var s=this;const a=s._removeEmptyFolders(t),o=s._getFinalPath(a),l=new URL(s.url+`/object/upload/sign/${o}`);l.searchParams.set("token",e);try{let c;const u=M({upsert:hd.upsert},n),f=M(M({},s.headers),{"x-upsert":String(u.upsert)});return typeof Blob<"u"&&r instanceof Blob?(c=new FormData,c.append("cacheControl",u.cacheControl),c.append("",r)):typeof FormData<"u"&&r instanceof FormData?(c=r,c.append("cacheControl",u.cacheControl)):(c=r,f["cache-control"]=`max-age=${u.cacheControl}`,f["content-type"]=u.contentType),{data:{path:a,fullPath:(await El(s.fetch,l.toString(),c,{headers:f})).Key},error:null}}catch(c){if(s.shouldThrowOnError)throw c;if(ce(c))return{data:null,error:c};throw c}}async createSignedUploadUrl(t,e){var r=this;try{let n=r._getFinalPath(t);const s=M({},r.headers);e!=null&&e.upsert&&(s["x-upsert"]="true");const a=await jt(r.fetch,`${r.url}/object/upload/sign/${n}`,{},{headers:s}),o=new URL(r.url+a.url),l=o.searchParams.get("token");if(!l)throw new Ia("No token returned by API");return{data:{signedUrl:o.toString(),path:t,token:l},error:null}}catch(n){if(r.shouldThrowOnError)throw n;if(ce(n))return{data:null,error:n};throw n}}async update(t,e,r){return this.uploadOrUpdate("PUT",t,e,r)}async move(t,e,r){var n=this;try{return{data:await jt(n.fetch,`${n.url}/object/move`,{bucketId:n.bucketId,sourceKey:t,destinationKey:e,destinationBucket:r==null?void 0:r.destinationBucket},{headers:n.headers}),error:null}}catch(s){if(n.shouldThrowOnError)throw s;if(ce(s))return{data:null,error:s};throw s}}async copy(t,e,r){var n=this;try{return{data:{path:(await jt(n.fetch,`${n.url}/object/copy`,{bucketId:n.bucketId,sourceKey:t,destinationKey:e,destinationBucket:r==null?void 0:r.destinationBucket},{headers:n.headers})).Key},error:null}}catch(s){if(n.shouldThrowOnError)throw s;if(ce(s))return{data:null,error:s};throw s}}async createSignedUrl(t,e,r){var n=this;try{let s=n._getFinalPath(t),a=await jt(n.fetch,`${n.url}/object/sign/${s}`,M({expiresIn:e},r!=null&&r.transform?{transform:r.transform}:{}),{headers:n.headers});const o=r!=null&&r.download?`&download=${r.download===!0?"":r.download}`:"";return a={signedUrl:encodeURI(`${n.url}${a.signedURL}${o}`)},{data:a,error:null}}catch(s){if(n.shouldThrowOnError)throw s;if(ce(s))return{data:null,error:s};throw s}}async createSignedUrls(t,e,r){var n=this;try{const s=await jt(n.fetch,`${n.url}/object/sign/${n.bucketId}`,{expiresIn:e,paths:t},{headers:n.headers}),a=r!=null&&r.download?`&download=${r.download===!0?"":r.download}`:"";return{data:s.map(o=>M(M({},o),{},{signedUrl:o.signedURL?encodeURI(`${n.url}${o.signedURL}${a}`):null})),error:null}}catch(s){if(n.shouldThrowOnError)throw s;if(ce(s))return{data:null,error:s};throw s}}download(t,e){const r=typeof(e==null?void 0:e.transform)<"u"?"render/image/authenticated":"object",n=this.transformOptsToQueryString((e==null?void 0:e.transform)||{}),s=n?`?${n}`:"",a=this._getFinalPath(t),o=()=>Vs(this.fetch,`${this.url}/${r}/${a}${s}`,{headers:this.headers,noResolveJson:!0});return new gy(o,this.shouldThrowOnError)}async info(t){var e=this;const r=e._getFinalPath(t);try{return{data:Cl(await Vs(e.fetch,`${e.url}/object/info/${r}`,{headers:e.headers})),error:null}}catch(n){if(e.shouldThrowOnError)throw n;if(ce(n))return{data:null,error:n};throw n}}async exists(t){var e=this;const r=e._getFinalPath(t);try{return await my(e.fetch,`${e.url}/object/${r}`,{headers:e.headers}),{data:!0,error:null}}catch(n){if(e.shouldThrowOnError)throw n;if(ce(n)&&n instanceof Sl){const s=n.originalError;if([400,404].includes(s==null?void 0:s.status))return{data:!1,error:n}}throw n}}getPublicUrl(t,e){const r=this._getFinalPath(t),n=[],s=e!=null&&e.download?`download=${e.download===!0?"":e.download}`:"";s!==""&&n.push(s);const a=typeof(e==null?void 0:e.transform)<"u"?"render/image":"object",o=this.transformOptsToQueryString((e==null?void 0:e.transform)||{});o!==""&&n.push(o);let l=n.join("&");return l!==""&&(l=`?${l}`),{data:{publicUrl:encodeURI(`${this.url}/${a}/public/${r}${l}`)}}}async remove(t){var e=this;try{return{data:await Ac(e.fetch,`${e.url}/object/${e.bucketId}`,{prefixes:t},{headers:e.headers}),error:null}}catch(r){if(e.shouldThrowOnError)throw r;if(ce(r))return{data:null,error:r};throw r}}async list(t,e,r){var n=this;try{const s=M(M(M({},yy),e),{},{prefix:t||""});return{data:await jt(n.fetch,`${n.url}/object/list/${n.bucketId}`,s,{headers:n.headers},r),error:null}}catch(s){if(n.shouldThrowOnError)throw s;if(ce(s))return{data:null,error:s};throw s}}async listV2(t,e){var r=this;try{const n=M({},t);return{data:await jt(r.fetch,`${r.url}/object/list-v2/${r.bucketId}`,n,{headers:r.headers},e),error:null}}catch(n){if(r.shouldThrowOnError)throw n;if(ce(n))return{data:null,error:n};throw n}}encodeMetadata(t){return JSON.stringify(t)}toBase64(t){return typeof Buffer<"u"?Buffer.from(t).toString("base64"):btoa(t)}_getFinalPath(t){return`${this.bucketId}/${t.replace(/^\/+/,"")}`}_removeEmptyFolders(t){return t.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(t){const e=[];return t.width&&e.push(`width=${t.width}`),t.height&&e.push(`height=${t.height}`),t.resize&&e.push(`resize=${t.resize}`),t.format&&e.push(`format=${t.format}`),t.quality&&e.push(`quality=${t.quality}`),e.join("&")}};const em="2.89.0",tm={"X-Client-Info":`storage-js/${em}`};var xy=class{constructor(t,e={},r,n){this.shouldThrowOnError=!1;const s=new URL(t);n!=null&&n.useNewHostname&&/supabase\.(co|in|red)$/.test(s.hostname)&&!s.hostname.includes("storage.supabase.")&&(s.hostname=s.hostname.replace("supabase.","storage.supabase.")),this.url=s.href.replace(/\/$/,""),this.headers=M(M({},tm),e),this.fetch=Ec(r)}throwOnError(){return this.shouldThrowOnError=!0,this}async listBuckets(t){var e=this;try{const r=e.listBucketOptionsToQueryString(t);return{data:await Vs(e.fetch,`${e.url}/bucket${r}`,{headers:e.headers}),error:null}}catch(r){if(e.shouldThrowOnError)throw r;if(ce(r))return{data:null,error:r};throw r}}async getBucket(t){var e=this;try{return{data:await Vs(e.fetch,`${e.url}/bucket/${t}`,{headers:e.headers}),error:null}}catch(r){if(e.shouldThrowOnError)throw r;if(ce(r))return{data:null,error:r};throw r}}async createBucket(t,e={public:!1}){var r=this;try{return{data:await jt(r.fetch,`${r.url}/bucket`,{id:t,name:t,type:e.type,public:e.public,file_size_limit:e.fileSizeLimit,allowed_mime_types:e.allowedMimeTypes},{headers:r.headers}),error:null}}catch(n){if(r.shouldThrowOnError)throw n;if(ce(n))return{data:null,error:n};throw n}}async updateBucket(t,e){var r=this;try{return{data:await El(r.fetch,`${r.url}/bucket/${t}`,{id:t,name:t,public:e.public,file_size_limit:e.fileSizeLimit,allowed_mime_types:e.allowedMimeTypes},{headers:r.headers}),error:null}}catch(n){if(r.shouldThrowOnError)throw n;if(ce(n))return{data:null,error:n};throw n}}async emptyBucket(t){var e=this;try{return{data:await jt(e.fetch,`${e.url}/bucket/${t}/empty`,{},{headers:e.headers}),error:null}}catch(r){if(e.shouldThrowOnError)throw r;if(ce(r))return{data:null,error:r};throw r}}async deleteBucket(t){var e=this;try{return{data:await Ac(e.fetch,`${e.url}/bucket/${t}`,{},{headers:e.headers}),error:null}}catch(r){if(e.shouldThrowOnError)throw r;if(ce(r))return{data:null,error:r};throw r}}listBucketOptionsToQueryString(t){const e={};return t&&("limit"in t&&(e.limit=String(t.limit)),"offset"in t&&(e.offset=String(t.offset)),t.search&&(e.search=t.search),t.sortColumn&&(e.sortColumn=t.sortColumn),t.sortOrder&&(e.sortOrder=t.sortOrder)),Object.keys(e).length>0?"?"+new URLSearchParams(e).toString():""}},wy=class{constructor(t,e={},r){this.shouldThrowOnError=!1,this.url=t.replace(/\/$/,""),this.headers=M(M({},tm),e),this.fetch=Ec(r)}throwOnError(){return this.shouldThrowOnError=!0,this}async createBucket(t){var e=this;try{return{data:await jt(e.fetch,`${e.url}/bucket`,{name:t},{headers:e.headers}),error:null}}catch(r){if(e.shouldThrowOnError)throw r;if(ce(r))return{data:null,error:r};throw r}}async listBuckets(t){var e=this;try{const r=new URLSearchParams;(t==null?void 0:t.limit)!==void 0&&r.set("limit",t.limit.toString()),(t==null?void 0:t.offset)!==void 0&&r.set("offset",t.offset.toString()),t!=null&&t.sortColumn&&r.set("sortColumn",t.sortColumn),t!=null&&t.sortOrder&&r.set("sortOrder",t.sortOrder),t!=null&&t.search&&r.set("search",t.search);const n=r.toString(),s=n?`${e.url}/bucket?${n}`:`${e.url}/bucket`;return{data:await Vs(e.fetch,s,{headers:e.headers}),error:null}}catch(r){if(e.shouldThrowOnError)throw r;if(ce(r))return{data:null,error:r};throw r}}async deleteBucket(t){var e=this;try{return{data:await Ac(e.fetch,`${e.url}/bucket/${t}`,{},{headers:e.headers}),error:null}}catch(r){if(e.shouldThrowOnError)throw r;if(ce(r))return{data:null,error:r};throw r}}from(t){var e=this;if(!ly(t))throw new Ia("Invalid bucket name: File, folder, and bucket names must follow AWS object key naming guidelines and should avoid the use of any other characters.");const r=new sy({baseUrl:this.url,catalogName:t,auth:{type:"custom",getHeaders:async()=>e.headers},fetch:this.fetch}),n=this.shouldThrowOnError;return new Proxy(r,{get(s,a){const o=s[a];return typeof o!="function"?o:async(...l)=>{try{return{data:await o.apply(s,l),error:null}}catch(c){if(n)throw c;return{data:null,error:c}}}}})}};const Tc={"X-Client-Info":`storage-js/${em}`,"Content-Type":"application/json"};var rm=class extends Error{constructor(t){super(t),this.__isStorageVectorsError=!0,this.name="StorageVectorsError"}};function rt(t){return typeof t=="object"&&t!==null&&"__isStorageVectorsError"in t}var xo=class extends rm{constructor(t,e,r){super(t),this.name="StorageVectorsApiError",this.status=e,this.statusCode=r}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}},_y=class extends rm{constructor(t,e){super(t),this.name="StorageVectorsUnknownError",this.originalError=e}};const Pc=t=>t?(...e)=>t(...e):(...e)=>fetch(...e),by=t=>{if(typeof t!="object"||t===null)return!1;const e=Object.getPrototypeOf(t);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in t)&&!(Symbol.iterator in t)},fd=t=>t.msg||t.message||t.error_description||t.error||JSON.stringify(t),jy=async(t,e,r)=>{if(t&&typeof t=="object"&&"status"in t&&"ok"in t&&typeof t.status=="number"&&!(r!=null&&r.noResolveJson)){const n=t.status||500,s=t;if(typeof s.json=="function")s.json().then(a=>{const o=(a==null?void 0:a.statusCode)||(a==null?void 0:a.code)||n+"";e(new xo(fd(a),n,o))}).catch(()=>{const a=n+"";e(new xo(s.statusText||`HTTP ${n} error`,n,a))});else{const a=n+"";e(new xo(s.statusText||`HTTP ${n} error`,n,a))}}else e(new _y(fd(t),t))},Ny=(t,e,r,n)=>{const s={method:t,headers:(e==null?void 0:e.headers)||{}};return t==="GET"||!n?s:(by(n)?(s.headers=M({"Content-Type":"application/json"},e==null?void 0:e.headers),s.body=JSON.stringify(n)):s.body=n,M(M({},s),r))};async function ky(t,e,r,n,s,a){return new Promise((o,l)=>{t(r,Ny(e,n,s,a)).then(c=>{if(!c.ok)throw c;if(n!=null&&n.noResolveJson)return c;const u=c.headers.get("content-type");return!u||!u.includes("application/json")?{}:c.json()}).then(c=>o(c)).catch(c=>jy(c,l,n))})}async function nt(t,e,r,n,s){return ky(t,"POST",e,n,s,r)}var Sy=class{constructor(t,e={},r){this.shouldThrowOnError=!1,this.url=t.replace(/\/$/,""),this.headers=M(M({},Tc),e),this.fetch=Pc(r)}throwOnError(){return this.shouldThrowOnError=!0,this}async createIndex(t){var e=this;try{return{data:await nt(e.fetch,`${e.url}/CreateIndex`,t,{headers:e.headers})||{},error:null}}catch(r){if(e.shouldThrowOnError)throw r;if(rt(r))return{data:null,error:r};throw r}}async getIndex(t,e){var r=this;try{return{data:await nt(r.fetch,`${r.url}/GetIndex`,{vectorBucketName:t,indexName:e},{headers:r.headers}),error:null}}catch(n){if(r.shouldThrowOnError)throw n;if(rt(n))return{data:null,error:n};throw n}}async listIndexes(t){var e=this;try{return{data:await nt(e.fetch,`${e.url}/ListIndexes`,t,{headers:e.headers}),error:null}}catch(r){if(e.shouldThrowOnError)throw r;if(rt(r))return{data:null,error:r};throw r}}async deleteIndex(t,e){var r=this;try{return{data:await nt(r.fetch,`${r.url}/DeleteIndex`,{vectorBucketName:t,indexName:e},{headers:r.headers})||{},error:null}}catch(n){if(r.shouldThrowOnError)throw n;if(rt(n))return{data:null,error:n};throw n}}},Cy=class{constructor(t,e={},r){this.shouldThrowOnError=!1,this.url=t.replace(/\/$/,""),this.headers=M(M({},Tc),e),this.fetch=Pc(r)}throwOnError(){return this.shouldThrowOnError=!0,this}async putVectors(t){var e=this;try{if(t.vectors.length<1||t.vectors.length>500)throw new Error("Vector batch size must be between 1 and 500 items");return{data:await nt(e.fetch,`${e.url}/PutVectors`,t,{headers:e.headers})||{},error:null}}catch(r){if(e.shouldThrowOnError)throw r;if(rt(r))return{data:null,error:r};throw r}}async getVectors(t){var e=this;try{return{data:await nt(e.fetch,`${e.url}/GetVectors`,t,{headers:e.headers}),error:null}}catch(r){if(e.shouldThrowOnError)throw r;if(rt(r))return{data:null,error:r};throw r}}async listVectors(t){var e=this;try{if(t.segmentCount!==void 0){if(t.segmentCount<1||t.segmentCount>16)throw new Error("segmentCount must be between 1 and 16");if(t.segmentIndex!==void 0&&(t.segmentIndex<0||t.segmentIndex>=t.segmentCount))throw new Error(`segmentIndex must be between 0 and ${t.segmentCount-1}`)}return{data:await nt(e.fetch,`${e.url}/ListVectors`,t,{headers:e.headers}),error:null}}catch(r){if(e.shouldThrowOnError)throw r;if(rt(r))return{data:null,error:r};throw r}}async queryVectors(t){var e=this;try{return{data:await nt(e.fetch,`${e.url}/QueryVectors`,t,{headers:e.headers}),error:null}}catch(r){if(e.shouldThrowOnError)throw r;if(rt(r))return{data:null,error:r};throw r}}async deleteVectors(t){var e=this;try{if(t.keys.length<1||t.keys.length>500)throw new Error("Keys batch size must be between 1 and 500 items");return{data:await nt(e.fetch,`${e.url}/DeleteVectors`,t,{headers:e.headers})||{},error:null}}catch(r){if(e.shouldThrowOnError)throw r;if(rt(r))return{data:null,error:r};throw r}}},Ey=class{constructor(t,e={},r){this.shouldThrowOnError=!1,this.url=t.replace(/\/$/,""),this.headers=M(M({},Tc),e),this.fetch=Pc(r)}throwOnError(){return this.shouldThrowOnError=!0,this}async createBucket(t){var e=this;try{return{data:await nt(e.fetch,`${e.url}/CreateVectorBucket`,{vectorBucketName:t},{headers:e.headers})||{},error:null}}catch(r){if(e.shouldThrowOnError)throw r;if(rt(r))return{data:null,error:r};throw r}}async getBucket(t){var e=this;try{return{data:await nt(e.fetch,`${e.url}/GetVectorBucket`,{vectorBucketName:t},{headers:e.headers}),error:null}}catch(r){if(e.shouldThrowOnError)throw r;if(rt(r))return{data:null,error:r};throw r}}async listBuckets(t={}){var e=this;try{return{data:await nt(e.fetch,`${e.url}/ListVectorBuckets`,t,{headers:e.headers}),error:null}}catch(r){if(e.shouldThrowOnError)throw r;if(rt(r))return{data:null,error:r};throw r}}async deleteBucket(t){var e=this;try{return{data:await nt(e.fetch,`${e.url}/DeleteVectorBucket`,{vectorBucketName:t},{headers:e.headers})||{},error:null}}catch(r){if(e.shouldThrowOnError)throw r;if(rt(r))return{data:null,error:r};throw r}}},Ay=class extends Ey{constructor(t,e={}){super(t,e.headers||{},e.fetch)}from(t){return new Ty(this.url,this.headers,t,this.fetch)}async createBucket(t){var e=()=>super.createBucket,r=this;return e().call(r,t)}async getBucket(t){var e=()=>super.getBucket,r=this;return e().call(r,t)}async listBuckets(t={}){var e=()=>super.listBuckets,r=this;return e().call(r,t)}async deleteBucket(t){var e=()=>super.deleteBucket,r=this;return e().call(r,t)}},Ty=class extends Sy{constructor(t,e,r,n){super(t,e,n),this.vectorBucketName=r}async createIndex(t){var e=()=>super.createIndex,r=this;return e().call(r,M(M({},t),{},{vectorBucketName:r.vectorBucketName}))}async listIndexes(t={}){var e=()=>super.listIndexes,r=this;return e().call(r,M(M({},t),{},{vectorBucketName:r.vectorBucketName}))}async getIndex(t){var e=()=>super.getIndex,r=this;return e().call(r,r.vectorBucketName,t)}async deleteIndex(t){var e=()=>super.deleteIndex,r=this;return e().call(r,r.vectorBucketName,t)}index(t){return new Py(this.url,this.headers,this.vectorBucketName,t,this.fetch)}},Py=class extends Cy{constructor(t,e,r,n,s){super(t,e,s),this.vectorBucketName=r,this.indexName=n}async putVectors(t){var e=()=>super.putVectors,r=this;return e().call(r,M(M({},t),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}async getVectors(t){var e=()=>super.getVectors,r=this;return e().call(r,M(M({},t),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}async listVectors(t={}){var e=()=>super.listVectors,r=this;return e().call(r,M(M({},t),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}async queryVectors(t){var e=()=>super.queryVectors,r=this;return e().call(r,M(M({},t),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}async deleteVectors(t){var e=()=>super.deleteVectors,r=this;return e().call(r,M(M({},t),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}},Ry=class extends xy{constructor(t,e={},r,n){super(t,e,r,n)}from(t){return new vy(this.url,this.headers,t,this.fetch)}get vectors(){return new Ay(this.url+"/vector",{headers:this.headers,fetch:this.fetch})}get analytics(){return new wy(this.url+"/iceberg",this.headers,this.fetch)}};const nm="2.89.0",on=30*1e3,Al=3,wo=Al*on,Oy="http://localhost:9999",Iy="supabase.auth.token",Dy={"X-Client-Info":`gotrue-js/${nm}`},Tl="X-Supabase-Api-Version",sm={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},$y=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,Ly=10*60*1e3;class Ws extends Error{constructor(e,r,n){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=r,this.code=n}}function D(t){return typeof t=="object"&&t!==null&&"__isAuthError"in t}class Uy extends Ws{constructor(e,r,n){super(e,r,n),this.name="AuthApiError",this.status=r,this.code=n}}function My(t){return D(t)&&t.name==="AuthApiError"}class Ur extends Ws{constructor(e,r){super(e),this.name="AuthUnknownError",this.originalError=r}}class Xt extends Ws{constructor(e,r,n,s){super(e,n,s),this.name=r,this.status=n}}class Ze extends Xt{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function zy(t){return D(t)&&t.name==="AuthSessionMissingError"}class en extends Xt{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class Ni extends Xt{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class ki extends Xt{constructor(e,r=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function Fy(t){return D(t)&&t.name==="AuthImplicitGrantRedirectError"}class md extends Xt{constructor(e,r=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class By extends Xt{constructor(){super("PKCE code verifier not found in storage. This can happen if the auth flow was initiated in a different browser or device, or if the storage was cleared. For SSR frameworks (Next.js, SvelteKit, etc.), use @supabase/ssr on both the server and client to store the code verifier in cookies.","AuthPKCECodeVerifierMissingError",400,"pkce_code_verifier_not_found")}}class Pl extends Xt{constructor(e,r){super(e,"AuthRetryableFetchError",r,void 0)}}function _o(t){return D(t)&&t.name==="AuthRetryableFetchError"}class pd extends Xt{constructor(e,r,n){super(e,"AuthWeakPasswordError",r,"weak_password"),this.reasons=n}}class Rl extends Xt{constructor(e){super(e,"AuthInvalidJwtError",400,"invalid_jwt")}}const fa="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),gd=` 	
\r=`.split(""),qy=(()=>{const t=new Array(128);for(let e=0;e<t.length;e+=1)t[e]=-1;for(let e=0;e<gd.length;e+=1)t[gd[e].charCodeAt(0)]=-2;for(let e=0;e<fa.length;e+=1)t[fa[e].charCodeAt(0)]=e;return t})();function yd(t,e,r){if(t!==null)for(e.queue=e.queue<<8|t,e.queuedBits+=8;e.queuedBits>=6;){const n=e.queue>>e.queuedBits-6&63;r(fa[n]),e.queuedBits-=6}else if(e.queuedBits>0)for(e.queue=e.queue<<6-e.queuedBits,e.queuedBits=6;e.queuedBits>=6;){const n=e.queue>>e.queuedBits-6&63;r(fa[n]),e.queuedBits-=6}}function im(t,e,r){const n=qy[t];if(n>-1)for(e.queue=e.queue<<6|n,e.queuedBits+=6;e.queuedBits>=8;)r(e.queue>>e.queuedBits-8&255),e.queuedBits-=8;else{if(n===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(t)}"`)}}function vd(t){const e=[],r=o=>{e.push(String.fromCodePoint(o))},n={utf8seq:0,codepoint:0},s={queue:0,queuedBits:0},a=o=>{Hy(o,n,r)};for(let o=0;o<t.length;o+=1)im(t.charCodeAt(o),s,a);return e.join("")}function Vy(t,e){if(t<=127){e(t);return}else if(t<=2047){e(192|t>>6),e(128|t&63);return}else if(t<=65535){e(224|t>>12),e(128|t>>6&63),e(128|t&63);return}else if(t<=1114111){e(240|t>>18),e(128|t>>12&63),e(128|t>>6&63),e(128|t&63);return}throw new Error(`Unrecognized Unicode codepoint: ${t.toString(16)}`)}function Wy(t,e){for(let r=0;r<t.length;r+=1){let n=t.charCodeAt(r);if(n>55295&&n<=56319){const s=(n-55296)*1024&65535;n=(t.charCodeAt(r+1)-56320&65535|s)+65536,r+=1}Vy(n,e)}}function Hy(t,e,r){if(e.utf8seq===0){if(t<=127){r(t);return}for(let n=1;n<6;n+=1)if(!(t>>7-n&1)){e.utf8seq=n;break}if(e.utf8seq===2)e.codepoint=t&31;else if(e.utf8seq===3)e.codepoint=t&15;else if(e.utf8seq===4)e.codepoint=t&7;else throw new Error("Invalid UTF-8 sequence");e.utf8seq-=1}else if(e.utf8seq>0){if(t<=127)throw new Error("Invalid UTF-8 sequence");e.codepoint=e.codepoint<<6|t&63,e.utf8seq-=1,e.utf8seq===0&&r(e.codepoint)}}function An(t){const e=[],r={queue:0,queuedBits:0},n=s=>{e.push(s)};for(let s=0;s<t.length;s+=1)im(t.charCodeAt(s),r,n);return new Uint8Array(e)}function Ky(t){const e=[];return Wy(t,r=>e.push(r)),new Uint8Array(e)}function Br(t){const e=[],r={queue:0,queuedBits:0},n=s=>{e.push(s)};return t.forEach(s=>yd(s,r,n)),yd(null,r,n),e.join("")}function Gy(t){return Math.round(Date.now()/1e3)+t}function Jy(){return Symbol("auth-callback")}const Ae=()=>typeof window<"u"&&typeof document<"u",Pr={tested:!1,writable:!1},am=()=>{if(!Ae())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(Pr.tested)return Pr.writable;const t=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(t,t),globalThis.localStorage.removeItem(t),Pr.tested=!0,Pr.writable=!0}catch{Pr.tested=!0,Pr.writable=!1}return Pr.writable};function Qy(t){const e={},r=new URL(t);if(r.hash&&r.hash[0]==="#")try{new URLSearchParams(r.hash.substring(1)).forEach((s,a)=>{e[a]=s})}catch{}return r.searchParams.forEach((n,s)=>{e[s]=n}),e}const om=t=>t?(...e)=>t(...e):(...e)=>fetch(...e),Yy=t=>typeof t=="object"&&t!==null&&"status"in t&&"ok"in t&&"json"in t&&typeof t.json=="function",ln=async(t,e,r)=>{await t.setItem(e,JSON.stringify(r))},Rr=async(t,e)=>{const r=await t.getItem(e);if(!r)return null;try{return JSON.parse(r)}catch{return r}},Ee=async(t,e)=>{await t.removeItem(e)};class Da{constructor(){this.promise=new Da.promiseConstructor((e,r)=>{this.resolve=e,this.reject=r})}}Da.promiseConstructor=Promise;function bo(t){const e=t.split(".");if(e.length!==3)throw new Rl("Invalid JWT structure");for(let n=0;n<e.length;n++)if(!$y.test(e[n]))throw new Rl("JWT not in base64url format");return{header:JSON.parse(vd(e[0])),payload:JSON.parse(vd(e[1])),signature:An(e[2]),raw:{header:e[0],payload:e[1]}}}async function Xy(t){return await new Promise(e=>{setTimeout(()=>e(null),t)})}function Zy(t,e){return new Promise((n,s)=>{(async()=>{for(let a=0;a<1/0;a++)try{const o=await t(a);if(!e(a,null,o)){n(o);return}}catch(o){if(!e(a,o)){s(o);return}}})()})}function ev(t){return("0"+t.toString(16)).substr(-2)}function tv(){const e=new Uint32Array(56);if(typeof crypto>"u"){const r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",n=r.length;let s="";for(let a=0;a<56;a++)s+=r.charAt(Math.floor(Math.random()*n));return s}return crypto.getRandomValues(e),Array.from(e,ev).join("")}async function rv(t){const r=new TextEncoder().encode(t),n=await crypto.subtle.digest("SHA-256",r),s=new Uint8Array(n);return Array.from(s).map(a=>String.fromCharCode(a)).join("")}async function nv(t){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),t;const r=await rv(t);return btoa(r).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function tn(t,e,r=!1){const n=tv();let s=n;r&&(s+="/PASSWORD_RECOVERY"),await ln(t,`${e}-code-verifier`,s);const a=await nv(n);return[a,n===a?"plain":"s256"]}const sv=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function iv(t){const e=t.headers.get(Tl);if(!e||!e.match(sv))return null;try{return new Date(`${e}T00:00:00.0Z`)}catch{return null}}function av(t){if(!t)throw new Error("Missing exp claim");const e=Math.floor(Date.now()/1e3);if(t<=e)throw new Error("JWT has expired")}function ov(t){switch(t){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const lv=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function rn(t){if(!lv.test(t))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function jo(){const t={};return new Proxy(t,{get:(e,r)=>{if(r==="__isUserNotAvailableProxy")return!0;if(typeof r=="symbol"){const n=r.toString();if(n==="Symbol(Symbol.toPrimitive)"||n==="Symbol(Symbol.toStringTag)"||n==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${r}" property of the session object is not supported. Please use getUser() instead.`)},set:(e,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(e,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function cv(t,e){return new Proxy(t,{get:(r,n,s)=>{if(n==="__isInsecureUserWarningProxy")return!0;if(typeof n=="symbol"){const a=n.toString();if(a==="Symbol(Symbol.toPrimitive)"||a==="Symbol(Symbol.toStringTag)"||a==="Symbol(util.inspect.custom)"||a==="Symbol(nodejs.util.inspect.custom)")return Reflect.get(r,n,s)}return!e.value&&typeof n=="string"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),e.value=!0),Reflect.get(r,n,s)}})}function xd(t){return JSON.parse(JSON.stringify(t))}const $r=t=>t.msg||t.message||t.error_description||t.error||JSON.stringify(t),uv=[502,503,504];async function wd(t){var e;if(!Yy(t))throw new Pl($r(t),0);if(uv.includes(t.status))throw new Pl($r(t),t.status);let r;try{r=await t.json()}catch(a){throw new Ur($r(a),a)}let n;const s=iv(t);if(s&&s.getTime()>=sm["2024-01-01"].timestamp&&typeof r=="object"&&r&&typeof r.code=="string"?n=r.code:typeof r=="object"&&r&&typeof r.error_code=="string"&&(n=r.error_code),n){if(n==="weak_password")throw new pd($r(r),t.status,((e=r.weak_password)===null||e===void 0?void 0:e.reasons)||[]);if(n==="session_not_found")throw new Ze}else if(typeof r=="object"&&r&&typeof r.weak_password=="object"&&r.weak_password&&Array.isArray(r.weak_password.reasons)&&r.weak_password.reasons.length&&r.weak_password.reasons.reduce((a,o)=>a&&typeof o=="string",!0))throw new pd($r(r),t.status,r.weak_password.reasons);throw new Uy($r(r),t.status||500,n)}const dv=(t,e,r,n)=>{const s={method:t,headers:(e==null?void 0:e.headers)||{}};return t==="GET"?s:(s.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},e==null?void 0:e.headers),s.body=JSON.stringify(n),Object.assign(Object.assign({},s),r))};async function U(t,e,r,n){var s;const a=Object.assign({},n==null?void 0:n.headers);a[Tl]||(a[Tl]=sm["2024-01-01"].name),n!=null&&n.jwt&&(a.Authorization=`Bearer ${n.jwt}`);const o=(s=n==null?void 0:n.query)!==null&&s!==void 0?s:{};n!=null&&n.redirectTo&&(o.redirect_to=n.redirectTo);const l=Object.keys(o).length?"?"+new URLSearchParams(o).toString():"",c=await hv(t,e,r+l,{headers:a,noResolveJson:n==null?void 0:n.noResolveJson},{},n==null?void 0:n.body);return n!=null&&n.xform?n==null?void 0:n.xform(c):{data:Object.assign({},c),error:null}}async function hv(t,e,r,n,s,a){const o=dv(e,n,s,a);let l;try{l=await t(r,Object.assign({},o))}catch(c){throw console.error(c),new Pl($r(c),0)}if(l.ok||await wd(l),n!=null&&n.noResolveJson)return l;try{return await l.json()}catch(c){await wd(c)}}function _t(t){var e;let r=null;pv(t)&&(r=Object.assign({},t),t.expires_at||(r.expires_at=Gy(t.expires_in)));const n=(e=t.user)!==null&&e!==void 0?e:t;return{data:{session:r,user:n},error:null}}function _d(t){const e=_t(t);return!e.error&&t.weak_password&&typeof t.weak_password=="object"&&Array.isArray(t.weak_password.reasons)&&t.weak_password.reasons.length&&t.weak_password.message&&typeof t.weak_password.message=="string"&&t.weak_password.reasons.reduce((r,n)=>r&&typeof n=="string",!0)&&(e.data.weak_password=t.weak_password),e}function hr(t){var e;return{data:{user:(e=t.user)!==null&&e!==void 0?e:t},error:null}}function fv(t){return{data:t,error:null}}function mv(t){const{action_link:e,email_otp:r,hashed_token:n,redirect_to:s,verification_type:a}=t,o=Oa(t,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),l={action_link:e,email_otp:r,hashed_token:n,redirect_to:s,verification_type:a},c=Object.assign({},o);return{data:{properties:l,user:c},error:null}}function bd(t){return t}function pv(t){return t.access_token&&t.refresh_token&&t.expires_in}const No=["global","local","others"];class gv{constructor({url:e="",headers:r={},fetch:n}){this.url=e,this.headers=r,this.fetch=om(n),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)},this.oauth={listClients:this._listOAuthClients.bind(this),createClient:this._createOAuthClient.bind(this),getClient:this._getOAuthClient.bind(this),updateClient:this._updateOAuthClient.bind(this),deleteClient:this._deleteOAuthClient.bind(this),regenerateClientSecret:this._regenerateOAuthClientSecret.bind(this)}}async signOut(e,r=No[0]){if(No.indexOf(r)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${No.join(", ")}`);try{return await U(this.fetch,"POST",`${this.url}/logout?scope=${r}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(n){if(D(n))return{data:null,error:n};throw n}}async inviteUserByEmail(e,r={}){try{return await U(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:r.data},headers:this.headers,redirectTo:r.redirectTo,xform:hr})}catch(n){if(D(n))return{data:{user:null},error:n};throw n}}async generateLink(e){try{const{options:r}=e,n=Oa(e,["options"]),s=Object.assign(Object.assign({},n),r);return"newEmail"in n&&(s.new_email=n==null?void 0:n.newEmail,delete s.newEmail),await U(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:s,headers:this.headers,xform:mv,redirectTo:r==null?void 0:r.redirectTo})}catch(r){if(D(r))return{data:{properties:null,user:null},error:r};throw r}}async createUser(e){try{return await U(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:hr})}catch(r){if(D(r))return{data:{user:null},error:r};throw r}}async listUsers(e){var r,n,s,a,o,l,c;try{const u={nextPage:null,lastPage:0,total:0},f=await U(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(n=(r=e==null?void 0:e.page)===null||r===void 0?void 0:r.toString())!==null&&n!==void 0?n:"",per_page:(a=(s=e==null?void 0:e.perPage)===null||s===void 0?void 0:s.toString())!==null&&a!==void 0?a:""},xform:bd});if(f.error)throw f.error;const m=await f.json(),d=(o=f.headers.get("x-total-count"))!==null&&o!==void 0?o:0,y=(c=(l=f.headers.get("link"))===null||l===void 0?void 0:l.split(","))!==null&&c!==void 0?c:[];return y.length>0&&(y.forEach(x=>{const w=parseInt(x.split(";")[0].split("=")[1].substring(0,1)),C=JSON.parse(x.split(";")[1].split("=")[1]);u[`${C}Page`]=w}),u.total=parseInt(d)),{data:Object.assign(Object.assign({},m),u),error:null}}catch(u){if(D(u))return{data:{users:[]},error:u};throw u}}async getUserById(e){rn(e);try{return await U(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:hr})}catch(r){if(D(r))return{data:{user:null},error:r};throw r}}async updateUserById(e,r){rn(e);try{return await U(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:r,headers:this.headers,xform:hr})}catch(n){if(D(n))return{data:{user:null},error:n};throw n}}async deleteUser(e,r=!1){rn(e);try{return await U(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:r},xform:hr})}catch(n){if(D(n))return{data:{user:null},error:n};throw n}}async _listFactors(e){rn(e.userId);try{const{data:r,error:n}=await U(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:s=>({data:{factors:s},error:null})});return{data:r,error:n}}catch(r){if(D(r))return{data:null,error:r};throw r}}async _deleteFactor(e){rn(e.userId),rn(e.id);try{return{data:await U(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(r){if(D(r))return{data:null,error:r};throw r}}async _listOAuthClients(e){var r,n,s,a,o,l,c;try{const u={nextPage:null,lastPage:0,total:0},f=await U(this.fetch,"GET",`${this.url}/admin/oauth/clients`,{headers:this.headers,noResolveJson:!0,query:{page:(n=(r=e==null?void 0:e.page)===null||r===void 0?void 0:r.toString())!==null&&n!==void 0?n:"",per_page:(a=(s=e==null?void 0:e.perPage)===null||s===void 0?void 0:s.toString())!==null&&a!==void 0?a:""},xform:bd});if(f.error)throw f.error;const m=await f.json(),d=(o=f.headers.get("x-total-count"))!==null&&o!==void 0?o:0,y=(c=(l=f.headers.get("link"))===null||l===void 0?void 0:l.split(","))!==null&&c!==void 0?c:[];return y.length>0&&(y.forEach(x=>{const w=parseInt(x.split(";")[0].split("=")[1].substring(0,1)),C=JSON.parse(x.split(";")[1].split("=")[1]);u[`${C}Page`]=w}),u.total=parseInt(d)),{data:Object.assign(Object.assign({},m),u),error:null}}catch(u){if(D(u))return{data:{clients:[]},error:u};throw u}}async _createOAuthClient(e){try{return await U(this.fetch,"POST",`${this.url}/admin/oauth/clients`,{body:e,headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(D(r))return{data:null,error:r};throw r}}async _getOAuthClient(e){try{return await U(this.fetch,"GET",`${this.url}/admin/oauth/clients/${e}`,{headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(D(r))return{data:null,error:r};throw r}}async _updateOAuthClient(e,r){try{return await U(this.fetch,"PUT",`${this.url}/admin/oauth/clients/${e}`,{body:r,headers:this.headers,xform:n=>({data:n,error:null})})}catch(n){if(D(n))return{data:null,error:n};throw n}}async _deleteOAuthClient(e){try{return await U(this.fetch,"DELETE",`${this.url}/admin/oauth/clients/${e}`,{headers:this.headers,noResolveJson:!0}),{data:null,error:null}}catch(r){if(D(r))return{data:null,error:r};throw r}}async _regenerateOAuthClientSecret(e){try{return await U(this.fetch,"POST",`${this.url}/admin/oauth/clients/${e}/regenerate_secret`,{headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(D(r))return{data:null,error:r};throw r}}}function jd(t={}){return{getItem:e=>t[e]||null,setItem:(e,r)=>{t[e]=r},removeItem:e=>{delete t[e]}}}const nn={debug:!!(globalThis&&am()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class lm extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class yv extends lm{}async function vv(t,e,r){nn.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",t,e);const n=new globalThis.AbortController;return e>0&&setTimeout(()=>{n.abort(),nn.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",t)},e),await Promise.resolve().then(()=>globalThis.navigator.locks.request(t,e===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:n.signal},async s=>{if(s){nn.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",t,s.name);try{return await r()}finally{nn.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",t,s.name)}}else{if(e===0)throw nn.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",t),new yv(`Acquiring an exclusive Navigator LockManager lock "${t}" immediately failed`);if(nn.debug)try{const a=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(a,null,"  "))}catch(a){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",a)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await r()}}))}function xv(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}function cm(t){if(!/^0x[a-fA-F0-9]{40}$/.test(t))throw new Error(`@supabase/auth-js: Address "${t}" is invalid.`);return t.toLowerCase()}function wv(t){return parseInt(t,16)}function _v(t){const e=new TextEncoder().encode(t);return"0x"+Array.from(e,n=>n.toString(16).padStart(2,"0")).join("")}function bv(t){var e;const{chainId:r,domain:n,expirationTime:s,issuedAt:a=new Date,nonce:o,notBefore:l,requestId:c,resources:u,scheme:f,uri:m,version:d}=t;{if(!Number.isInteger(r))throw new Error(`@supabase/auth-js: Invalid SIWE message field "chainId". Chain ID must be a EIP-155 chain ID. Provided value: ${r}`);if(!n)throw new Error('@supabase/auth-js: Invalid SIWE message field "domain". Domain must be provided.');if(o&&o.length<8)throw new Error(`@supabase/auth-js: Invalid SIWE message field "nonce". Nonce must be at least 8 characters. Provided value: ${o}`);if(!m)throw new Error('@supabase/auth-js: Invalid SIWE message field "uri". URI must be provided.');if(d!=="1")throw new Error(`@supabase/auth-js: Invalid SIWE message field "version". Version must be '1'. Provided value: ${d}`);if(!((e=t.statement)===null||e===void 0)&&e.includes(`
`))throw new Error(`@supabase/auth-js: Invalid SIWE message field "statement". Statement must not include '\\n'. Provided value: ${t.statement}`)}const y=cm(t.address),x=f?`${f}://${n}`:n,w=t.statement?`${t.statement}
`:"",C=`${x} wants you to sign in with your Ethereum account:
${y}

${w}`;let p=`URI: ${m}
Version: ${d}
Chain ID: ${r}${o?`
Nonce: ${o}`:""}
Issued At: ${a.toISOString()}`;if(s&&(p+=`
Expiration Time: ${s.toISOString()}`),l&&(p+=`
Not Before: ${l.toISOString()}`),c&&(p+=`
Request ID: ${c}`),u){let g=`
Resources:`;for(const v of u){if(!v||typeof v!="string")throw new Error(`@supabase/auth-js: Invalid SIWE message field "resources". Every resource must be a valid string. Provided value: ${v}`);g+=`
- ${v}`}p+=g}return`${C}
${p}`}class ye extends Error{constructor({message:e,code:r,cause:n,name:s}){var a;super(e,{cause:n}),this.__isWebAuthnError=!0,this.name=(a=s??(n instanceof Error?n.name:void 0))!==null&&a!==void 0?a:"Unknown Error",this.code=r}}class ma extends ye{constructor(e,r){super({code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:r,message:e}),this.name="WebAuthnUnknownError",this.originalError=r}}function jv({error:t,options:e}){var r,n,s;const{publicKey:a}=e;if(!a)throw Error("options was missing required publicKey property");if(t.name==="AbortError"){if(e.signal instanceof AbortSignal)return new ye({message:"Registration ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:t})}else if(t.name==="ConstraintError"){if(((r=a.authenticatorSelection)===null||r===void 0?void 0:r.requireResidentKey)===!0)return new ye({message:"Discoverable credentials were required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_DISCOVERABLE_CREDENTIAL_SUPPORT",cause:t});if(e.mediation==="conditional"&&((n=a.authenticatorSelection)===null||n===void 0?void 0:n.userVerification)==="required")return new ye({message:"User verification was required during automatic registration but it could not be performed",code:"ERROR_AUTO_REGISTER_USER_VERIFICATION_FAILURE",cause:t});if(((s=a.authenticatorSelection)===null||s===void 0?void 0:s.userVerification)==="required")return new ye({message:"User verification was required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_USER_VERIFICATION_SUPPORT",cause:t})}else{if(t.name==="InvalidStateError")return new ye({message:"The authenticator was previously registered",code:"ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED",cause:t});if(t.name==="NotAllowedError")return new ye({message:t.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t});if(t.name==="NotSupportedError")return a.pubKeyCredParams.filter(l=>l.type==="public-key").length===0?new ye({message:'No entry in pubKeyCredParams was of type "public-key"',code:"ERROR_MALFORMED_PUBKEYCREDPARAMS",cause:t}):new ye({message:"No available authenticator supported any of the specified pubKeyCredParams algorithms",code:"ERROR_AUTHENTICATOR_NO_SUPPORTED_PUBKEYCREDPARAMS_ALG",cause:t});if(t.name==="SecurityError"){const o=window.location.hostname;if(um(o)){if(a.rp.id!==o)return new ye({message:`The RP ID "${a.rp.id}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:t})}else return new ye({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:t})}else if(t.name==="TypeError"){if(a.user.id.byteLength<1||a.user.id.byteLength>64)return new ye({message:"User ID was not between 1 and 64 characters",code:"ERROR_INVALID_USER_ID_LENGTH",cause:t})}else if(t.name==="UnknownError")return new ye({message:"The authenticator was unable to process the specified options, or could not create a new credential",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:t})}return new ye({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t})}function Nv({error:t,options:e}){const{publicKey:r}=e;if(!r)throw Error("options was missing required publicKey property");if(t.name==="AbortError"){if(e.signal instanceof AbortSignal)return new ye({message:"Authentication ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:t})}else{if(t.name==="NotAllowedError")return new ye({message:t.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t});if(t.name==="SecurityError"){const n=window.location.hostname;if(um(n)){if(r.rpId!==n)return new ye({message:`The RP ID "${r.rpId}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:t})}else return new ye({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:t})}else if(t.name==="UnknownError")return new ye({message:"The authenticator was unable to process the specified options, or could not create a new assertion signature",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:t})}return new ye({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t})}class kv{createNewAbortSignal(){if(this.controller){const r=new Error("Cancelling existing WebAuthn API call for new one");r.name="AbortError",this.controller.abort(r)}const e=new AbortController;return this.controller=e,e.signal}cancelCeremony(){if(this.controller){const e=new Error("Manually cancelling existing WebAuthn API call");e.name="AbortError",this.controller.abort(e),this.controller=void 0}}}const Sv=new kv;function Cv(t){if(!t)throw new Error("Credential creation options are required");if(typeof PublicKeyCredential<"u"&&"parseCreationOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseCreationOptionsFromJSON=="function")return PublicKeyCredential.parseCreationOptionsFromJSON(t);const{challenge:e,user:r,excludeCredentials:n}=t,s=Oa(t,["challenge","user","excludeCredentials"]),a=An(e).buffer,o=Object.assign(Object.assign({},r),{id:An(r.id).buffer}),l=Object.assign(Object.assign({},s),{challenge:a,user:o});if(n&&n.length>0){l.excludeCredentials=new Array(n.length);for(let c=0;c<n.length;c++){const u=n[c];l.excludeCredentials[c]=Object.assign(Object.assign({},u),{id:An(u.id).buffer,type:u.type||"public-key",transports:u.transports})}}return l}function Ev(t){if(!t)throw new Error("Credential request options are required");if(typeof PublicKeyCredential<"u"&&"parseRequestOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseRequestOptionsFromJSON=="function")return PublicKeyCredential.parseRequestOptionsFromJSON(t);const{challenge:e,allowCredentials:r}=t,n=Oa(t,["challenge","allowCredentials"]),s=An(e).buffer,a=Object.assign(Object.assign({},n),{challenge:s});if(r&&r.length>0){a.allowCredentials=new Array(r.length);for(let o=0;o<r.length;o++){const l=r[o];a.allowCredentials[o]=Object.assign(Object.assign({},l),{id:An(l.id).buffer,type:l.type||"public-key",transports:l.transports})}}return a}function Av(t){var e;if("toJSON"in t&&typeof t.toJSON=="function")return t.toJSON();const r=t;return{id:t.id,rawId:t.id,response:{attestationObject:Br(new Uint8Array(t.response.attestationObject)),clientDataJSON:Br(new Uint8Array(t.response.clientDataJSON))},type:"public-key",clientExtensionResults:t.getClientExtensionResults(),authenticatorAttachment:(e=r.authenticatorAttachment)!==null&&e!==void 0?e:void 0}}function Tv(t){var e;if("toJSON"in t&&typeof t.toJSON=="function")return t.toJSON();const r=t,n=t.getClientExtensionResults(),s=t.response;return{id:t.id,rawId:t.id,response:{authenticatorData:Br(new Uint8Array(s.authenticatorData)),clientDataJSON:Br(new Uint8Array(s.clientDataJSON)),signature:Br(new Uint8Array(s.signature)),userHandle:s.userHandle?Br(new Uint8Array(s.userHandle)):void 0},type:"public-key",clientExtensionResults:n,authenticatorAttachment:(e=r.authenticatorAttachment)!==null&&e!==void 0?e:void 0}}function um(t){return t==="localhost"||/^([a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,}$/i.test(t)}function Nd(){var t,e;return!!(Ae()&&"PublicKeyCredential"in window&&window.PublicKeyCredential&&"credentials"in navigator&&typeof((t=navigator==null?void 0:navigator.credentials)===null||t===void 0?void 0:t.create)=="function"&&typeof((e=navigator==null?void 0:navigator.credentials)===null||e===void 0?void 0:e.get)=="function")}async function Pv(t){try{const e=await navigator.credentials.create(t);return e?e instanceof PublicKeyCredential?{data:e,error:null}:{data:null,error:new ma("Browser returned unexpected credential type",e)}:{data:null,error:new ma("Empty credential response",e)}}catch(e){return{data:null,error:jv({error:e,options:t})}}}async function Rv(t){try{const e=await navigator.credentials.get(t);return e?e instanceof PublicKeyCredential?{data:e,error:null}:{data:null,error:new ma("Browser returned unexpected credential type",e)}:{data:null,error:new ma("Empty credential response",e)}}catch(e){return{data:null,error:Nv({error:e,options:t})}}}const Ov={hints:["security-key"],authenticatorSelection:{authenticatorAttachment:"cross-platform",requireResidentKey:!1,userVerification:"preferred",residentKey:"discouraged"},attestation:"direct"},Iv={userVerification:"preferred",hints:["security-key"],attestation:"direct"};function pa(...t){const e=s=>s!==null&&typeof s=="object"&&!Array.isArray(s),r=s=>s instanceof ArrayBuffer||ArrayBuffer.isView(s),n={};for(const s of t)if(s)for(const a in s){const o=s[a];if(o!==void 0)if(Array.isArray(o))n[a]=o;else if(r(o))n[a]=o;else if(e(o)){const l=n[a];e(l)?n[a]=pa(l,o):n[a]=pa(o)}else n[a]=o}return n}function Dv(t,e){return pa(Ov,t,e||{})}function $v(t,e){return pa(Iv,t,e||{})}class Lv{constructor(e){this.client=e,this.enroll=this._enroll.bind(this),this.challenge=this._challenge.bind(this),this.verify=this._verify.bind(this),this.authenticate=this._authenticate.bind(this),this.register=this._register.bind(this)}async _enroll(e){return this.client.mfa.enroll(Object.assign(Object.assign({},e),{factorType:"webauthn"}))}async _challenge({factorId:e,webauthn:r,friendlyName:n,signal:s},a){try{const{data:o,error:l}=await this.client.mfa.challenge({factorId:e,webauthn:r});if(!o)return{data:null,error:l};const c=s??Sv.createNewAbortSignal();if(o.webauthn.type==="create"){const{user:u}=o.webauthn.credential_options.publicKey;u.name||(u.name=`${u.id}:${n}`),u.displayName||(u.displayName=u.name)}switch(o.webauthn.type){case"create":{const u=Dv(o.webauthn.credential_options.publicKey,a==null?void 0:a.create),{data:f,error:m}=await Pv({publicKey:u,signal:c});return f?{data:{factorId:e,challengeId:o.id,webauthn:{type:o.webauthn.type,credential_response:f}},error:null}:{data:null,error:m}}case"request":{const u=$v(o.webauthn.credential_options.publicKey,a==null?void 0:a.request),{data:f,error:m}=await Rv(Object.assign(Object.assign({},o.webauthn.credential_options),{publicKey:u,signal:c}));return f?{data:{factorId:e,challengeId:o.id,webauthn:{type:o.webauthn.type,credential_response:f}},error:null}:{data:null,error:m}}}}catch(o){return D(o)?{data:null,error:o}:{data:null,error:new Ur("Unexpected error in challenge",o)}}}async _verify({challengeId:e,factorId:r,webauthn:n}){return this.client.mfa.verify({factorId:r,challengeId:e,webauthn:n})}async _authenticate({factorId:e,webauthn:{rpId:r=typeof window<"u"?window.location.hostname:void 0,rpOrigins:n=typeof window<"u"?[window.location.origin]:void 0,signal:s}={}},a){if(!r)return{data:null,error:new Ws("rpId is required for WebAuthn authentication")};try{if(!Nd())return{data:null,error:new Ur("Browser does not support WebAuthn",null)};const{data:o,error:l}=await this.challenge({factorId:e,webauthn:{rpId:r,rpOrigins:n},signal:s},{request:a});if(!o)return{data:null,error:l};const{webauthn:c}=o;return this._verify({factorId:e,challengeId:o.challengeId,webauthn:{type:c.type,rpId:r,rpOrigins:n,credential_response:c.credential_response}})}catch(o){return D(o)?{data:null,error:o}:{data:null,error:new Ur("Unexpected error in authenticate",o)}}}async _register({friendlyName:e,webauthn:{rpId:r=typeof window<"u"?window.location.hostname:void 0,rpOrigins:n=typeof window<"u"?[window.location.origin]:void 0,signal:s}={}},a){if(!r)return{data:null,error:new Ws("rpId is required for WebAuthn registration")};try{if(!Nd())return{data:null,error:new Ur("Browser does not support WebAuthn",null)};const{data:o,error:l}=await this._enroll({friendlyName:e});if(!o)return await this.client.mfa.listFactors().then(f=>{var m;return(m=f.data)===null||m===void 0?void 0:m.all.find(d=>d.factor_type==="webauthn"&&d.friendly_name===e&&d.status!=="unverified")}).then(f=>f?this.client.mfa.unenroll({factorId:f==null?void 0:f.id}):void 0),{data:null,error:l};const{data:c,error:u}=await this._challenge({factorId:o.id,friendlyName:o.friendly_name,webauthn:{rpId:r,rpOrigins:n},signal:s},{create:a});return c?this._verify({factorId:o.id,challengeId:c.challengeId,webauthn:{rpId:r,rpOrigins:n,type:c.webauthn.type,credential_response:c.webauthn.credential_response}}):{data:null,error:u}}catch(o){return D(o)?{data:null,error:o}:{data:null,error:new Ur("Unexpected error in register",o)}}}}xv();const Uv={url:Oy,storageKey:Iy,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:Dy,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1,throwOnError:!1};async function kd(t,e,r){return await r()}const sn={};class Hs{get jwks(){var e,r;return(r=(e=sn[this.storageKey])===null||e===void 0?void 0:e.jwks)!==null&&r!==void 0?r:{keys:[]}}set jwks(e){sn[this.storageKey]=Object.assign(Object.assign({},sn[this.storageKey]),{jwks:e})}get jwks_cached_at(){var e,r;return(r=(e=sn[this.storageKey])===null||e===void 0?void 0:e.cachedAt)!==null&&r!==void 0?r:Number.MIN_SAFE_INTEGER}set jwks_cached_at(e){sn[this.storageKey]=Object.assign(Object.assign({},sn[this.storageKey]),{cachedAt:e})}constructor(e){var r,n,s;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log;const a=Object.assign(Object.assign({},Uv),e);if(this.storageKey=a.storageKey,this.instanceID=(r=Hs.nextInstanceID[this.storageKey])!==null&&r!==void 0?r:0,Hs.nextInstanceID[this.storageKey]=this.instanceID+1,this.logDebugMessages=!!a.debug,typeof a.debug=="function"&&(this.logger=a.debug),this.instanceID>0&&Ae()){const o=`${this._logPrefix()} Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.`;console.warn(o),this.logDebugMessages&&console.trace(o)}if(this.persistSession=a.persistSession,this.autoRefreshToken=a.autoRefreshToken,this.admin=new gv({url:a.url,headers:a.headers,fetch:a.fetch}),this.url=a.url,this.headers=a.headers,this.fetch=om(a.fetch),this.lock=a.lock||kd,this.detectSessionInUrl=a.detectSessionInUrl,this.flowType=a.flowType,this.hasCustomAuthorizationHeader=a.hasCustomAuthorizationHeader,this.throwOnError=a.throwOnError,a.lock?this.lock=a.lock:this.persistSession&&Ae()&&(!((n=globalThis==null?void 0:globalThis.navigator)===null||n===void 0)&&n.locks)?this.lock=vv:this.lock=kd,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this),webauthn:new Lv(this)},this.oauth={getAuthorizationDetails:this._getAuthorizationDetails.bind(this),approveAuthorization:this._approveAuthorization.bind(this),denyAuthorization:this._denyAuthorization.bind(this),listGrants:this._listOAuthGrants.bind(this),revokeGrant:this._revokeOAuthGrant.bind(this)},this.persistSession?(a.storage?this.storage=a.storage:am()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=jd(this.memoryStorage)),a.userStorage&&(this.userStorage=a.userStorage)):(this.memoryStorage={},this.storage=jd(this.memoryStorage)),Ae()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(o){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",o)}(s=this.broadcastChannel)===null||s===void 0||s.addEventListener("message",async o=>{this._debug("received broadcast notification from other tab or client",o),await this._notifyAllSubscribers(o.data.event,o.data.session,!1)})}this.initialize()}isThrowOnErrorEnabled(){return this.throwOnError}_returnResult(e){if(this.throwOnError&&e&&e.error)throw e.error;return e}_logPrefix(){return`GoTrueClient@${this.storageKey}:${this.instanceID} (${nm}) ${new Date().toISOString()}`}_debug(...e){return this.logDebugMessages&&this.logger(this._logPrefix(),...e),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var e;try{let r={},n="none";if(Ae()&&(r=Qy(window.location.href),this._isImplicitGrantCallback(r)?n="implicit":await this._isPKCECallback(r)&&(n="pkce")),Ae()&&this.detectSessionInUrl&&n!=="none"){const{data:s,error:a}=await this._getSessionFromURL(r,n);if(a){if(this._debug("#_initialize()","error detecting session from URL",a),Fy(a)){const c=(e=a.details)===null||e===void 0?void 0:e.code;if(c==="identity_already_exists"||c==="identity_not_found"||c==="single_identity_not_deletable")return{error:a}}return await this._removeSession(),{error:a}}const{session:o,redirectType:l}=s;return this._debug("#_initialize()","detected session in URL",o,"redirect type",l),await this._saveSession(o),setTimeout(async()=>{l==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",o):await this._notifyAllSubscribers("SIGNED_IN",o)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(r){return D(r)?this._returnResult({error:r}):this._returnResult({error:new Ur("Unexpected error during initialization",r)})}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var r,n,s;try{const a=await U(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(n=(r=e==null?void 0:e.options)===null||r===void 0?void 0:r.data)!==null&&n!==void 0?n:{},gotrue_meta_security:{captcha_token:(s=e==null?void 0:e.options)===null||s===void 0?void 0:s.captchaToken}},xform:_t}),{data:o,error:l}=a;if(l||!o)return this._returnResult({data:{user:null,session:null},error:l});const c=o.session,u=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",c)),this._returnResult({data:{user:u,session:c},error:null})}catch(a){if(D(a))return this._returnResult({data:{user:null,session:null},error:a});throw a}}async signUp(e){var r,n,s;try{let a;if("email"in e){const{email:f,password:m,options:d}=e;let y=null,x=null;this.flowType==="pkce"&&([y,x]=await tn(this.storage,this.storageKey)),a=await U(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:d==null?void 0:d.emailRedirectTo,body:{email:f,password:m,data:(r=d==null?void 0:d.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:d==null?void 0:d.captchaToken},code_challenge:y,code_challenge_method:x},xform:_t})}else if("phone"in e){const{phone:f,password:m,options:d}=e;a=await U(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:f,password:m,data:(n=d==null?void 0:d.data)!==null&&n!==void 0?n:{},channel:(s=d==null?void 0:d.channel)!==null&&s!==void 0?s:"sms",gotrue_meta_security:{captcha_token:d==null?void 0:d.captchaToken}},xform:_t})}else throw new Ni("You must provide either an email or phone number and a password");const{data:o,error:l}=a;if(l||!o)return await Ee(this.storage,`${this.storageKey}-code-verifier`),this._returnResult({data:{user:null,session:null},error:l});const c=o.session,u=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",c)),this._returnResult({data:{user:u,session:c},error:null})}catch(a){if(await Ee(this.storage,`${this.storageKey}-code-verifier`),D(a))return this._returnResult({data:{user:null,session:null},error:a});throw a}}async signInWithPassword(e){try{let r;if("email"in e){const{email:a,password:o,options:l}=e;r=await U(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:a,password:o,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}},xform:_d})}else if("phone"in e){const{phone:a,password:o,options:l}=e;r=await U(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:a,password:o,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}},xform:_d})}else throw new Ni("You must provide either an email or phone number and a password");const{data:n,error:s}=r;if(s)return this._returnResult({data:{user:null,session:null},error:s});if(!n||!n.session||!n.user){const a=new en;return this._returnResult({data:{user:null,session:null},error:a})}return n.session&&(await this._saveSession(n.session),await this._notifyAllSubscribers("SIGNED_IN",n.session)),this._returnResult({data:Object.assign({user:n.user,session:n.session},n.weak_password?{weakPassword:n.weak_password}:null),error:s})}catch(r){if(D(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async signInWithOAuth(e){var r,n,s,a;return await this._handleProviderSignIn(e.provider,{redirectTo:(r=e.options)===null||r===void 0?void 0:r.redirectTo,scopes:(n=e.options)===null||n===void 0?void 0:n.scopes,queryParams:(s=e.options)===null||s===void 0?void 0:s.queryParams,skipBrowserRedirect:(a=e.options)===null||a===void 0?void 0:a.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(e))}async signInWithWeb3(e){const{chain:r}=e;switch(r){case"ethereum":return await this.signInWithEthereum(e);case"solana":return await this.signInWithSolana(e);default:throw new Error(`@supabase/auth-js: Unsupported chain "${r}"`)}}async signInWithEthereum(e){var r,n,s,a,o,l,c,u,f,m,d;let y,x;if("message"in e)y=e.message,x=e.signature;else{const{chain:w,wallet:C,statement:p,options:g}=e;let v;if(Ae())if(typeof C=="object")v=C;else{const W=window;if("ethereum"in W&&typeof W.ethereum=="object"&&"request"in W.ethereum&&typeof W.ethereum.request=="function")v=W.ethereum;else throw new Error("@supabase/auth-js: No compatible Ethereum wallet interface on the window object (window.ethereum) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'ethereum', wallet: resolvedUserWallet }) instead.")}else{if(typeof C!="object"||!(g!=null&&g.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");v=C}const b=new URL((r=g==null?void 0:g.url)!==null&&r!==void 0?r:window.location.href),j=await v.request({method:"eth_requestAccounts"}).then(W=>W).catch(()=>{throw new Error("@supabase/auth-js: Wallet method eth_requestAccounts is missing or invalid")});if(!j||j.length===0)throw new Error("@supabase/auth-js: No accounts available. Please ensure the wallet is connected.");const N=cm(j[0]);let S=(n=g==null?void 0:g.signInWithEthereum)===null||n===void 0?void 0:n.chainId;if(!S){const W=await v.request({method:"eth_chainId"});S=wv(W)}const P={domain:b.host,address:N,statement:p,uri:b.href,version:"1",chainId:S,nonce:(s=g==null?void 0:g.signInWithEthereum)===null||s===void 0?void 0:s.nonce,issuedAt:(o=(a=g==null?void 0:g.signInWithEthereum)===null||a===void 0?void 0:a.issuedAt)!==null&&o!==void 0?o:new Date,expirationTime:(l=g==null?void 0:g.signInWithEthereum)===null||l===void 0?void 0:l.expirationTime,notBefore:(c=g==null?void 0:g.signInWithEthereum)===null||c===void 0?void 0:c.notBefore,requestId:(u=g==null?void 0:g.signInWithEthereum)===null||u===void 0?void 0:u.requestId,resources:(f=g==null?void 0:g.signInWithEthereum)===null||f===void 0?void 0:f.resources};y=bv(P),x=await v.request({method:"personal_sign",params:[_v(y),N]})}try{const{data:w,error:C}=await U(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"ethereum",message:y,signature:x},!((m=e.options)===null||m===void 0)&&m.captchaToken?{gotrue_meta_security:{captcha_token:(d=e.options)===null||d===void 0?void 0:d.captchaToken}}:null),xform:_t});if(C)throw C;if(!w||!w.session||!w.user){const p=new en;return this._returnResult({data:{user:null,session:null},error:p})}return w.session&&(await this._saveSession(w.session),await this._notifyAllSubscribers("SIGNED_IN",w.session)),this._returnResult({data:Object.assign({},w),error:C})}catch(w){if(D(w))return this._returnResult({data:{user:null,session:null},error:w});throw w}}async signInWithSolana(e){var r,n,s,a,o,l,c,u,f,m,d,y;let x,w;if("message"in e)x=e.message,w=e.signature;else{const{chain:C,wallet:p,statement:g,options:v}=e;let b;if(Ae())if(typeof p=="object")b=p;else{const N=window;if("solana"in N&&typeof N.solana=="object"&&("signIn"in N.solana&&typeof N.solana.signIn=="function"||"signMessage"in N.solana&&typeof N.solana.signMessage=="function"))b=N.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof p!="object"||!(v!=null&&v.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");b=p}const j=new URL((r=v==null?void 0:v.url)!==null&&r!==void 0?r:window.location.href);if("signIn"in b&&b.signIn){const N=await b.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},v==null?void 0:v.signInWithSolana),{version:"1",domain:j.host,uri:j.href}),g?{statement:g}:null));let S;if(Array.isArray(N)&&N[0]&&typeof N[0]=="object")S=N[0];else if(N&&typeof N=="object"&&"signedMessage"in N&&"signature"in N)S=N;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in S&&"signature"in S&&(typeof S.signedMessage=="string"||S.signedMessage instanceof Uint8Array)&&S.signature instanceof Uint8Array)x=typeof S.signedMessage=="string"?S.signedMessage:new TextDecoder().decode(S.signedMessage),w=S.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in b)||typeof b.signMessage!="function"||!("publicKey"in b)||typeof b!="object"||!b.publicKey||!("toBase58"in b.publicKey)||typeof b.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");x=[`${j.host} wants you to sign in with your Solana account:`,b.publicKey.toBase58(),...g?["",g,""]:[""],"Version: 1",`URI: ${j.href}`,`Issued At: ${(s=(n=v==null?void 0:v.signInWithSolana)===null||n===void 0?void 0:n.issuedAt)!==null&&s!==void 0?s:new Date().toISOString()}`,...!((a=v==null?void 0:v.signInWithSolana)===null||a===void 0)&&a.notBefore?[`Not Before: ${v.signInWithSolana.notBefore}`]:[],...!((o=v==null?void 0:v.signInWithSolana)===null||o===void 0)&&o.expirationTime?[`Expiration Time: ${v.signInWithSolana.expirationTime}`]:[],...!((l=v==null?void 0:v.signInWithSolana)===null||l===void 0)&&l.chainId?[`Chain ID: ${v.signInWithSolana.chainId}`]:[],...!((c=v==null?void 0:v.signInWithSolana)===null||c===void 0)&&c.nonce?[`Nonce: ${v.signInWithSolana.nonce}`]:[],...!((u=v==null?void 0:v.signInWithSolana)===null||u===void 0)&&u.requestId?[`Request ID: ${v.signInWithSolana.requestId}`]:[],...!((m=(f=v==null?void 0:v.signInWithSolana)===null||f===void 0?void 0:f.resources)===null||m===void 0)&&m.length?["Resources",...v.signInWithSolana.resources.map(S=>`- ${S}`)]:[]].join(`
`);const N=await b.signMessage(new TextEncoder().encode(x),"utf8");if(!N||!(N instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");w=N}}try{const{data:C,error:p}=await U(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:x,signature:Br(w)},!((d=e.options)===null||d===void 0)&&d.captchaToken?{gotrue_meta_security:{captcha_token:(y=e.options)===null||y===void 0?void 0:y.captchaToken}}:null),xform:_t});if(p)throw p;if(!C||!C.session||!C.user){const g=new en;return this._returnResult({data:{user:null,session:null},error:g})}return C.session&&(await this._saveSession(C.session),await this._notifyAllSubscribers("SIGNED_IN",C.session)),this._returnResult({data:Object.assign({},C),error:p})}catch(C){if(D(C))return this._returnResult({data:{user:null,session:null},error:C});throw C}}async _exchangeCodeForSession(e){const r=await Rr(this.storage,`${this.storageKey}-code-verifier`),[n,s]=(r??"").split("/");try{if(!n&&this.flowType==="pkce")throw new By;const{data:a,error:o}=await U(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:n},xform:_t});if(await Ee(this.storage,`${this.storageKey}-code-verifier`),o)throw o;if(!a||!a.session||!a.user){const l=new en;return this._returnResult({data:{user:null,session:null,redirectType:null},error:l})}return a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",a.session)),this._returnResult({data:Object.assign(Object.assign({},a),{redirectType:s??null}),error:o})}catch(a){if(await Ee(this.storage,`${this.storageKey}-code-verifier`),D(a))return this._returnResult({data:{user:null,session:null,redirectType:null},error:a});throw a}}async signInWithIdToken(e){try{const{options:r,provider:n,token:s,access_token:a,nonce:o}=e,l=await U(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:n,id_token:s,access_token:a,nonce:o,gotrue_meta_security:{captcha_token:r==null?void 0:r.captchaToken}},xform:_t}),{data:c,error:u}=l;if(u)return this._returnResult({data:{user:null,session:null},error:u});if(!c||!c.session||!c.user){const f=new en;return this._returnResult({data:{user:null,session:null},error:f})}return c.session&&(await this._saveSession(c.session),await this._notifyAllSubscribers("SIGNED_IN",c.session)),this._returnResult({data:c,error:u})}catch(r){if(D(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async signInWithOtp(e){var r,n,s,a,o;try{if("email"in e){const{email:l,options:c}=e;let u=null,f=null;this.flowType==="pkce"&&([u,f]=await tn(this.storage,this.storageKey));const{error:m}=await U(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:l,data:(r=c==null?void 0:c.data)!==null&&r!==void 0?r:{},create_user:(n=c==null?void 0:c.shouldCreateUser)!==null&&n!==void 0?n:!0,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken},code_challenge:u,code_challenge_method:f},redirectTo:c==null?void 0:c.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:m})}if("phone"in e){const{phone:l,options:c}=e,{data:u,error:f}=await U(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:l,data:(s=c==null?void 0:c.data)!==null&&s!==void 0?s:{},create_user:(a=c==null?void 0:c.shouldCreateUser)!==null&&a!==void 0?a:!0,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken},channel:(o=c==null?void 0:c.channel)!==null&&o!==void 0?o:"sms"}});return this._returnResult({data:{user:null,session:null,messageId:u==null?void 0:u.message_id},error:f})}throw new Ni("You must provide either an email or phone number.")}catch(l){if(await Ee(this.storage,`${this.storageKey}-code-verifier`),D(l))return this._returnResult({data:{user:null,session:null},error:l});throw l}}async verifyOtp(e){var r,n;try{let s,a;"options"in e&&(s=(r=e.options)===null||r===void 0?void 0:r.redirectTo,a=(n=e.options)===null||n===void 0?void 0:n.captchaToken);const{data:o,error:l}=await U(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:a}}),redirectTo:s,xform:_t});if(l)throw l;if(!o)throw new Error("An error occurred on token verification.");const c=o.session,u=o.user;return c!=null&&c.access_token&&(await this._saveSession(c),await this._notifyAllSubscribers(e.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",c)),this._returnResult({data:{user:u,session:c},error:null})}catch(s){if(D(s))return this._returnResult({data:{user:null,session:null},error:s});throw s}}async signInWithSSO(e){var r,n,s,a,o;try{let l=null,c=null;this.flowType==="pkce"&&([l,c]=await tn(this.storage,this.storageKey));const u=await U(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:(n=(r=e.options)===null||r===void 0?void 0:r.redirectTo)!==null&&n!==void 0?n:void 0}),!((s=e==null?void 0:e.options)===null||s===void 0)&&s.captchaToken?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:l,code_challenge_method:c}),headers:this.headers,xform:fv});return!((a=u.data)===null||a===void 0)&&a.url&&Ae()&&!(!((o=e.options)===null||o===void 0)&&o.skipBrowserRedirect)&&window.location.assign(u.data.url),this._returnResult(u)}catch(l){if(await Ee(this.storage,`${this.storageKey}-code-verifier`),D(l))return this._returnResult({data:null,error:l});throw l}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{const{data:{session:r},error:n}=e;if(n)throw n;if(!r)throw new Ze;const{error:s}=await U(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:r.access_token});return this._returnResult({data:{user:null,session:null},error:s})})}catch(e){if(D(e))return this._returnResult({data:{user:null,session:null},error:e});throw e}}async resend(e){try{const r=`${this.url}/resend`;if("email"in e){const{email:n,type:s,options:a}=e,{error:o}=await U(this.fetch,"POST",r,{headers:this.headers,body:{email:n,type:s,gotrue_meta_security:{captcha_token:a==null?void 0:a.captchaToken}},redirectTo:a==null?void 0:a.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:o})}else if("phone"in e){const{phone:n,type:s,options:a}=e,{data:o,error:l}=await U(this.fetch,"POST",r,{headers:this.headers,body:{phone:n,type:s,gotrue_meta_security:{captcha_token:a==null?void 0:a.captchaToken}}});return this._returnResult({data:{user:null,session:null,messageId:o==null?void 0:o.message_id},error:l})}throw new Ni("You must provide either an email or phone number and a type")}catch(r){if(D(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async r=>r))}async _acquireLock(e,r){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const n=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),s=(async()=>(await n,await r()))();return this.pendingInLock.push((async()=>{try{await s}catch{}})()),s}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const n=r();for(this.pendingInLock.push((async()=>{try{await n}catch{}})()),await n;this.pendingInLock.length;){const s=[...this.pendingInLock];await Promise.all(s),this.pendingInLock.splice(0,s.length)}return await n}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const r=await this.__loadSession();return await e(r)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let e=null;const r=await Rr(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",r),r!==null&&(this._isValidSession(r)?e=r:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const n=e.expires_at?e.expires_at*1e3-Date.now()<wo:!1;if(this._debug("#__loadSession()",`session has${n?"":" not"} expired`,"expires_at",e.expires_at),!n){if(this.userStorage){const o=await Rr(this.userStorage,this.storageKey+"-user");o!=null&&o.user?e.user=o.user:e.user=jo()}if(this.storage.isServer&&e.user&&!e.user.__isUserNotAvailableProxy){const o={value:this.suppressGetSessionWarning};e.user=cv(e.user,o),o.value&&(this.suppressGetSessionWarning=!0)}return{data:{session:e},error:null}}const{data:s,error:a}=await this._callRefreshToken(e.refresh_token);return a?this._returnResult({data:{session:null},error:a}):this._returnResult({data:{session:s},error:null})}finally{this._debug("#__loadSession()","end")}}async getUser(e){if(e)return await this._getUser(e);await this.initializePromise;const r=await this._acquireLock(-1,async()=>await this._getUser());return r.data.user&&(this.suppressGetSessionWarning=!0),r}async _getUser(e){try{return e?await U(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:hr}):await this._useSession(async r=>{var n,s,a;const{data:o,error:l}=r;if(l)throw l;return!(!((n=o.session)===null||n===void 0)&&n.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new Ze}:await U(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(a=(s=o.session)===null||s===void 0?void 0:s.access_token)!==null&&a!==void 0?a:void 0,xform:hr})})}catch(r){if(D(r))return zy(r)&&(await this._removeSession(),await Ee(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({data:{user:null},error:r});throw r}}async updateUser(e,r={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(e,r))}async _updateUser(e,r={}){try{return await this._useSession(async n=>{const{data:s,error:a}=n;if(a)throw a;if(!s.session)throw new Ze;const o=s.session;let l=null,c=null;this.flowType==="pkce"&&e.email!=null&&([l,c]=await tn(this.storage,this.storageKey));const{data:u,error:f}=await U(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:r==null?void 0:r.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:l,code_challenge_method:c}),jwt:o.access_token,xform:hr});if(f)throw f;return o.user=u.user,await this._saveSession(o),await this._notifyAllSubscribers("USER_UPDATED",o),this._returnResult({data:{user:o.user},error:null})})}catch(n){if(await Ee(this.storage,`${this.storageKey}-code-verifier`),D(n))return this._returnResult({data:{user:null},error:n});throw n}}async setSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new Ze;const r=Date.now()/1e3;let n=r,s=!0,a=null;const{payload:o}=bo(e.access_token);if(o.exp&&(n=o.exp,s=n<=r),s){const{data:l,error:c}=await this._callRefreshToken(e.refresh_token);if(c)return this._returnResult({data:{user:null,session:null},error:c});if(!l)return{data:{user:null,session:null},error:null};a=l}else{const{data:l,error:c}=await this._getUser(e.access_token);if(c)throw c;a={access_token:e.access_token,refresh_token:e.refresh_token,user:l.user,token_type:"bearer",expires_in:n-r,expires_at:n},await this._saveSession(a),await this._notifyAllSubscribers("SIGNED_IN",a)}return this._returnResult({data:{user:a.user,session:a},error:null})}catch(r){if(D(r))return this._returnResult({data:{session:null,user:null},error:r});throw r}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async r=>{var n;if(!e){const{data:o,error:l}=r;if(l)throw l;e=(n=o.session)!==null&&n!==void 0?n:void 0}if(!(e!=null&&e.refresh_token))throw new Ze;const{data:s,error:a}=await this._callRefreshToken(e.refresh_token);return a?this._returnResult({data:{user:null,session:null},error:a}):s?this._returnResult({data:{user:s.user,session:s},error:null}):this._returnResult({data:{user:null,session:null},error:null})})}catch(r){if(D(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async _getSessionFromURL(e,r){try{if(!Ae())throw new ki("No browser detected.");if(e.error||e.error_description||e.error_code)throw new ki(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(r){case"implicit":if(this.flowType==="pkce")throw new md("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new ki("Not a valid implicit grant flow url.");break;default:}if(r==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new md("No code detected.");const{data:g,error:v}=await this._exchangeCodeForSession(e.code);if(v)throw v;const b=new URL(window.location.href);return b.searchParams.delete("code"),window.history.replaceState(window.history.state,"",b.toString()),{data:{session:g.session,redirectType:null},error:null}}const{provider_token:n,provider_refresh_token:s,access_token:a,refresh_token:o,expires_in:l,expires_at:c,token_type:u}=e;if(!a||!l||!o||!u)throw new ki("No session defined in URL");const f=Math.round(Date.now()/1e3),m=parseInt(l);let d=f+m;c&&(d=parseInt(c));const y=d-f;y*1e3<=on&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${y}s, should have been closer to ${m}s`);const x=d-m;f-x>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",x,d,f):f-x<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",x,d,f);const{data:w,error:C}=await this._getUser(a);if(C)throw C;const p={provider_token:n,provider_refresh_token:s,access_token:a,expires_in:m,expires_at:d,refresh_token:o,token_type:u,user:w.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),this._returnResult({data:{session:p,redirectType:e.type},error:null})}catch(n){if(D(n))return this._returnResult({data:{session:null,redirectType:null},error:n});throw n}}_isImplicitGrantCallback(e){return typeof this.detectSessionInUrl=="function"?this.detectSessionInUrl(new URL(window.location.href),e):!!(e.access_token||e.error_description)}async _isPKCECallback(e){const r=await Rr(this.storage,`${this.storageKey}-code-verifier`);return!!(e.code&&r)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async r=>{var n;const{data:s,error:a}=r;if(a)return this._returnResult({error:a});const o=(n=s.session)===null||n===void 0?void 0:n.access_token;if(o){const{error:l}=await this.admin.signOut(o,e);if(l&&!(My(l)&&(l.status===404||l.status===401||l.status===403)))return this._returnResult({error:l})}return e!=="others"&&(await this._removeSession(),await Ee(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({error:null})})}onAuthStateChange(e){const r=Jy(),n={id:r,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",r),this.stateChangeEmitters.delete(r)}};return this._debug("#onAuthStateChange()","registered callback with id",r),this.stateChangeEmitters.set(r,n),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(r)})))(),{data:{subscription:n}}}async _emitInitialSession(e){return await this._useSession(async r=>{var n,s;try{const{data:{session:a},error:o}=r;if(o)throw o;await((n=this.stateChangeEmitters.get(e))===null||n===void 0?void 0:n.callback("INITIAL_SESSION",a)),this._debug("INITIAL_SESSION","callback id",e,"session",a)}catch(a){await((s=this.stateChangeEmitters.get(e))===null||s===void 0?void 0:s.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",a),console.error(a)}})}async resetPasswordForEmail(e,r={}){let n=null,s=null;this.flowType==="pkce"&&([n,s]=await tn(this.storage,this.storageKey,!0));try{return await U(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:n,code_challenge_method:s,gotrue_meta_security:{captcha_token:r.captchaToken}},headers:this.headers,redirectTo:r.redirectTo})}catch(a){if(await Ee(this.storage,`${this.storageKey}-code-verifier`),D(a))return this._returnResult({data:null,error:a});throw a}}async getUserIdentities(){var e;try{const{data:r,error:n}=await this.getUser();if(n)throw n;return this._returnResult({data:{identities:(e=r.user.identities)!==null&&e!==void 0?e:[]},error:null})}catch(r){if(D(r))return this._returnResult({data:null,error:r});throw r}}async linkIdentity(e){return"token"in e?this.linkIdentityIdToken(e):this.linkIdentityOAuth(e)}async linkIdentityOAuth(e){var r;try{const{data:n,error:s}=await this._useSession(async a=>{var o,l,c,u,f;const{data:m,error:d}=a;if(d)throw d;const y=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:(o=e.options)===null||o===void 0?void 0:o.redirectTo,scopes:(l=e.options)===null||l===void 0?void 0:l.scopes,queryParams:(c=e.options)===null||c===void 0?void 0:c.queryParams,skipBrowserRedirect:!0});return await U(this.fetch,"GET",y,{headers:this.headers,jwt:(f=(u=m.session)===null||u===void 0?void 0:u.access_token)!==null&&f!==void 0?f:void 0})});if(s)throw s;return Ae()&&!(!((r=e.options)===null||r===void 0)&&r.skipBrowserRedirect)&&window.location.assign(n==null?void 0:n.url),this._returnResult({data:{provider:e.provider,url:n==null?void 0:n.url},error:null})}catch(n){if(D(n))return this._returnResult({data:{provider:e.provider,url:null},error:n});throw n}}async linkIdentityIdToken(e){return await this._useSession(async r=>{var n;try{const{error:s,data:{session:a}}=r;if(s)throw s;const{options:o,provider:l,token:c,access_token:u,nonce:f}=e,m=await U(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,jwt:(n=a==null?void 0:a.access_token)!==null&&n!==void 0?n:void 0,body:{provider:l,id_token:c,access_token:u,nonce:f,link_identity:!0,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}},xform:_t}),{data:d,error:y}=m;return y?this._returnResult({data:{user:null,session:null},error:y}):!d||!d.session||!d.user?this._returnResult({data:{user:null,session:null},error:new en}):(d.session&&(await this._saveSession(d.session),await this._notifyAllSubscribers("USER_UPDATED",d.session)),this._returnResult({data:d,error:y}))}catch(s){if(await Ee(this.storage,`${this.storageKey}-code-verifier`),D(s))return this._returnResult({data:{user:null,session:null},error:s});throw s}})}async unlinkIdentity(e){try{return await this._useSession(async r=>{var n,s;const{data:a,error:o}=r;if(o)throw o;return await U(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:(s=(n=a.session)===null||n===void 0?void 0:n.access_token)!==null&&s!==void 0?s:void 0})})}catch(r){if(D(r))return this._returnResult({data:null,error:r});throw r}}async _refreshAccessToken(e){const r=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(r,"begin");try{const n=Date.now();return await Zy(async s=>(s>0&&await Xy(200*Math.pow(2,s-1)),this._debug(r,"refreshing attempt",s),await U(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:_t})),(s,a)=>{const o=200*Math.pow(2,s);return a&&_o(a)&&Date.now()+o-n<on})}catch(n){if(this._debug(r,"error",n),D(n))return this._returnResult({data:{session:null,user:null},error:n});throw n}finally{this._debug(r,"end")}}_isValidSession(e){return typeof e=="object"&&e!==null&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,r){const n=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:r.redirectTo,scopes:r.scopes,queryParams:r.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",r,"url",n),Ae()&&!r.skipBrowserRedirect&&window.location.assign(n),{data:{provider:e,url:n},error:null}}async _recoverAndRefresh(){var e,r;const n="#_recoverAndRefresh()";this._debug(n,"begin");try{const s=await Rr(this.storage,this.storageKey);if(s&&this.userStorage){let o=await Rr(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!o&&(o={user:s.user},await ln(this.userStorage,this.storageKey+"-user",o)),s.user=(e=o==null?void 0:o.user)!==null&&e!==void 0?e:jo()}else if(s&&!s.user&&!s.user){const o=await Rr(this.storage,this.storageKey+"-user");o&&(o!=null&&o.user)?(s.user=o.user,await Ee(this.storage,this.storageKey+"-user"),await ln(this.storage,this.storageKey,s)):s.user=jo()}if(this._debug(n,"session from storage",s),!this._isValidSession(s)){this._debug(n,"session is not valid"),s!==null&&await this._removeSession();return}const a=((r=s.expires_at)!==null&&r!==void 0?r:1/0)*1e3-Date.now()<wo;if(this._debug(n,`session has${a?"":" not"} expired with margin of ${wo}s`),a){if(this.autoRefreshToken&&s.refresh_token){const{error:o}=await this._callRefreshToken(s.refresh_token);o&&(console.error(o),_o(o)||(this._debug(n,"refresh failed with a non-retryable error, removing the session",o),await this._removeSession()))}}else if(s.user&&s.user.__isUserNotAvailableProxy===!0)try{const{data:o,error:l}=await this._getUser(s.access_token);!l&&(o!=null&&o.user)?(s.user=o.user,await this._saveSession(s),await this._notifyAllSubscribers("SIGNED_IN",s)):this._debug(n,"could not get user data, skipping SIGNED_IN notification")}catch(o){console.error("Error getting user data:",o),this._debug(n,"error getting user data, skipping SIGNED_IN notification",o)}else await this._notifyAllSubscribers("SIGNED_IN",s)}catch(s){this._debug(n,"error",s),console.error(s);return}finally{this._debug(n,"end")}}async _callRefreshToken(e){var r,n;if(!e)throw new Ze;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const s=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(s,"begin");try{this.refreshingDeferred=new Da;const{data:a,error:o}=await this._refreshAccessToken(e);if(o)throw o;if(!a.session)throw new Ze;await this._saveSession(a.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",a.session);const l={data:a.session,error:null};return this.refreshingDeferred.resolve(l),l}catch(a){if(this._debug(s,"error",a),D(a)){const o={data:null,error:a};return _o(a)||await this._removeSession(),(r=this.refreshingDeferred)===null||r===void 0||r.resolve(o),o}throw(n=this.refreshingDeferred)===null||n===void 0||n.reject(a),a}finally{this.refreshingDeferred=null,this._debug(s,"end")}}async _notifyAllSubscribers(e,r,n=!0){const s=`#_notifyAllSubscribers(${e})`;this._debug(s,"begin",r,`broadcast = ${n}`);try{this.broadcastChannel&&n&&this.broadcastChannel.postMessage({event:e,session:r});const a=[],o=Array.from(this.stateChangeEmitters.values()).map(async l=>{try{await l.callback(e,r)}catch(c){a.push(c)}});if(await Promise.all(o),a.length>0){for(let l=0;l<a.length;l+=1)console.error(a[l]);throw a[0]}}finally{this._debug(s,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0,await Ee(this.storage,`${this.storageKey}-code-verifier`);const r=Object.assign({},e),n=r.user&&r.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!n&&r.user&&await ln(this.userStorage,this.storageKey+"-user",{user:r.user});const s=Object.assign({},r);delete s.user;const a=xd(s);await ln(this.storage,this.storageKey,a)}else{const s=xd(r);await ln(this.storage,this.storageKey,s)}}async _removeSession(){this._debug("#_removeSession()"),this.suppressGetSessionWarning=!1,await Ee(this.storage,this.storageKey),await Ee(this.storage,this.storageKey+"-code-verifier"),await Ee(this.storage,this.storageKey+"-user"),this.userStorage&&await Ee(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&Ae()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",e)}catch(r){console.error("removing visibilitychange callback failed",r)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),on);this.autoRefreshTicker=e,e&&typeof e=="object"&&typeof e.unref=="function"?e.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(e),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const e=Date.now();try{return await this._useSession(async r=>{const{data:{session:n}}=r;if(!n||!n.refresh_token||!n.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const s=Math.floor((n.expires_at*1e3-e)/on);this._debug("#_autoRefreshTokenTick()",`access token expires in ${s} ticks, a tick lasts ${on}ms, refresh threshold is ${Al} ticks`),s<=Al&&await this._callRefreshToken(n.refresh_token)})}catch(r){console.error("Auto refresh tick failed with error. This is likely a transient error.",r)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(e.isAcquireTimeout||e instanceof lm)this._debug("auto refresh token tick lock not available");else throw e}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!Ae()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const r=`#_onVisibilityChanged(${e})`;this._debug(r,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(r,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,r,n){const s=[`provider=${encodeURIComponent(r)}`];if(n!=null&&n.redirectTo&&s.push(`redirect_to=${encodeURIComponent(n.redirectTo)}`),n!=null&&n.scopes&&s.push(`scopes=${encodeURIComponent(n.scopes)}`),this.flowType==="pkce"){const[a,o]=await tn(this.storage,this.storageKey),l=new URLSearchParams({code_challenge:`${encodeURIComponent(a)}`,code_challenge_method:`${encodeURIComponent(o)}`});s.push(l.toString())}if(n!=null&&n.queryParams){const a=new URLSearchParams(n.queryParams);s.push(a.toString())}return n!=null&&n.skipBrowserRedirect&&s.push(`skip_http_redirect=${n.skipBrowserRedirect}`),`${e}?${s.join("&")}`}async _unenroll(e){try{return await this._useSession(async r=>{var n;const{data:s,error:a}=r;return a?this._returnResult({data:null,error:a}):await U(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:(n=s==null?void 0:s.session)===null||n===void 0?void 0:n.access_token})})}catch(r){if(D(r))return this._returnResult({data:null,error:r});throw r}}async _enroll(e){try{return await this._useSession(async r=>{var n,s;const{data:a,error:o}=r;if(o)return this._returnResult({data:null,error:o});const l=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},e.factorType==="phone"?{phone:e.phone}:e.factorType==="totp"?{issuer:e.issuer}:{}),{data:c,error:u}=await U(this.fetch,"POST",`${this.url}/factors`,{body:l,headers:this.headers,jwt:(n=a==null?void 0:a.session)===null||n===void 0?void 0:n.access_token});return u?this._returnResult({data:null,error:u}):(e.factorType==="totp"&&c.type==="totp"&&(!((s=c==null?void 0:c.totp)===null||s===void 0)&&s.qr_code)&&(c.totp.qr_code=`data:image/svg+xml;utf-8,${c.totp.qr_code}`),this._returnResult({data:c,error:null}))})}catch(r){if(D(r))return this._returnResult({data:null,error:r});throw r}}async _verify(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var n;const{data:s,error:a}=r;if(a)return this._returnResult({data:null,error:a});const o=Object.assign({challenge_id:e.challengeId},"webauthn"in e?{webauthn:Object.assign(Object.assign({},e.webauthn),{credential_response:e.webauthn.type==="create"?Av(e.webauthn.credential_response):Tv(e.webauthn.credential_response)})}:{code:e.code}),{data:l,error:c}=await U(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:o,headers:this.headers,jwt:(n=s==null?void 0:s.session)===null||n===void 0?void 0:n.access_token});return c?this._returnResult({data:null,error:c}):(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+l.expires_in},l)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",l),this._returnResult({data:l,error:c}))})}catch(r){if(D(r))return this._returnResult({data:null,error:r});throw r}})}async _challenge(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var n;const{data:s,error:a}=r;if(a)return this._returnResult({data:null,error:a});const o=await U(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{body:e,headers:this.headers,jwt:(n=s==null?void 0:s.session)===null||n===void 0?void 0:n.access_token});if(o.error)return o;const{data:l}=o;if(l.type!=="webauthn")return{data:l,error:null};switch(l.webauthn.type){case"create":return{data:Object.assign(Object.assign({},l),{webauthn:Object.assign(Object.assign({},l.webauthn),{credential_options:Object.assign(Object.assign({},l.webauthn.credential_options),{publicKey:Cv(l.webauthn.credential_options.publicKey)})})}),error:null};case"request":return{data:Object.assign(Object.assign({},l),{webauthn:Object.assign(Object.assign({},l.webauthn),{credential_options:Object.assign(Object.assign({},l.webauthn.credential_options),{publicKey:Ev(l.webauthn.credential_options.publicKey)})})}),error:null}}})}catch(r){if(D(r))return this._returnResult({data:null,error:r});throw r}})}async _challengeAndVerify(e){const{data:r,error:n}=await this._challenge({factorId:e.factorId});return n?this._returnResult({data:null,error:n}):await this._verify({factorId:e.factorId,challengeId:r.id,code:e.code})}async _listFactors(){var e;const{data:{user:r},error:n}=await this.getUser();if(n)return{data:null,error:n};const s={all:[],phone:[],totp:[],webauthn:[]};for(const a of(e=r==null?void 0:r.factors)!==null&&e!==void 0?e:[])s.all.push(a),a.status==="verified"&&s[a.factor_type].push(a);return{data:s,error:null}}async _getAuthenticatorAssuranceLevel(){var e,r;const{data:{session:n},error:s}=await this.getSession();if(s)return this._returnResult({data:null,error:s});if(!n)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:a}=bo(n.access_token);let o=null;a.aal&&(o=a.aal);let l=o;((r=(e=n.user.factors)===null||e===void 0?void 0:e.filter(f=>f.status==="verified"))!==null&&r!==void 0?r:[]).length>0&&(l="aal2");const u=a.amr||[];return{data:{currentLevel:o,nextLevel:l,currentAuthenticationMethods:u},error:null}}async _getAuthorizationDetails(e){try{return await this._useSession(async r=>{const{data:{session:n},error:s}=r;return s?this._returnResult({data:null,error:s}):n?await U(this.fetch,"GET",`${this.url}/oauth/authorizations/${e}`,{headers:this.headers,jwt:n.access_token,xform:a=>({data:a,error:null})}):this._returnResult({data:null,error:new Ze})})}catch(r){if(D(r))return this._returnResult({data:null,error:r});throw r}}async _approveAuthorization(e,r){try{return await this._useSession(async n=>{const{data:{session:s},error:a}=n;if(a)return this._returnResult({data:null,error:a});if(!s)return this._returnResult({data:null,error:new Ze});const o=await U(this.fetch,"POST",`${this.url}/oauth/authorizations/${e}/consent`,{headers:this.headers,jwt:s.access_token,body:{action:"approve"},xform:l=>({data:l,error:null})});return o.data&&o.data.redirect_url&&Ae()&&!(r!=null&&r.skipBrowserRedirect)&&window.location.assign(o.data.redirect_url),o})}catch(n){if(D(n))return this._returnResult({data:null,error:n});throw n}}async _denyAuthorization(e,r){try{return await this._useSession(async n=>{const{data:{session:s},error:a}=n;if(a)return this._returnResult({data:null,error:a});if(!s)return this._returnResult({data:null,error:new Ze});const o=await U(this.fetch,"POST",`${this.url}/oauth/authorizations/${e}/consent`,{headers:this.headers,jwt:s.access_token,body:{action:"deny"},xform:l=>({data:l,error:null})});return o.data&&o.data.redirect_url&&Ae()&&!(r!=null&&r.skipBrowserRedirect)&&window.location.assign(o.data.redirect_url),o})}catch(n){if(D(n))return this._returnResult({data:null,error:n});throw n}}async _listOAuthGrants(){try{return await this._useSession(async e=>{const{data:{session:r},error:n}=e;return n?this._returnResult({data:null,error:n}):r?await U(this.fetch,"GET",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:r.access_token,xform:s=>({data:s,error:null})}):this._returnResult({data:null,error:new Ze})})}catch(e){if(D(e))return this._returnResult({data:null,error:e});throw e}}async _revokeOAuthGrant(e){try{return await this._useSession(async r=>{const{data:{session:n},error:s}=r;return s?this._returnResult({data:null,error:s}):n?(await U(this.fetch,"DELETE",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:n.access_token,query:{client_id:e.clientId},noResolveJson:!0}),{data:{},error:null}):this._returnResult({data:null,error:new Ze})})}catch(r){if(D(r))return this._returnResult({data:null,error:r});throw r}}async fetchJwk(e,r={keys:[]}){let n=r.keys.find(l=>l.kid===e);if(n)return n;const s=Date.now();if(n=this.jwks.keys.find(l=>l.kid===e),n&&this.jwks_cached_at+Ly>s)return n;const{data:a,error:o}=await U(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(o)throw o;return!a.keys||a.keys.length===0||(this.jwks=a,this.jwks_cached_at=s,n=a.keys.find(l=>l.kid===e),!n)?null:n}async getClaims(e,r={}){try{let n=e;if(!n){const{data:y,error:x}=await this.getSession();if(x||!y.session)return this._returnResult({data:null,error:x});n=y.session.access_token}const{header:s,payload:a,signature:o,raw:{header:l,payload:c}}=bo(n);r!=null&&r.allowExpired||av(a.exp);const u=!s.alg||s.alg.startsWith("HS")||!s.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(s.kid,r!=null&&r.keys?{keys:r.keys}:r==null?void 0:r.jwks);if(!u){const{error:y}=await this.getUser(n);if(y)throw y;return{data:{claims:a,header:s,signature:o},error:null}}const f=ov(s.alg),m=await crypto.subtle.importKey("jwk",u,f,!0,["verify"]);if(!await crypto.subtle.verify(f,m,o,Ky(`${l}.${c}`)))throw new Rl("Invalid JWT signature");return{data:{claims:a,header:s,signature:o},error:null}}catch(n){if(D(n))return this._returnResult({data:null,error:n});throw n}}}Hs.nextInstanceID={};const Mv=Hs,zv="2.89.0";let ls="";typeof Deno<"u"?ls="deno":typeof document<"u"?ls="web":typeof navigator<"u"&&navigator.product==="ReactNative"?ls="react-native":ls="node";const Fv={"X-Client-Info":`supabase-js-${ls}/${zv}`},Bv={headers:Fv},qv={schema:"public"},Vv={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},Wv={};function Ks(t){"@babel/helpers - typeof";return Ks=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ks(t)}function Hv(t,e){if(Ks(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Ks(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Kv(t){var e=Hv(t,"string");return Ks(e)=="symbol"?e:e+""}function Gv(t,e,r){return(e=Kv(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Sd(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable})),r.push.apply(r,n)}return r}function fe(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Sd(Object(r),!0).forEach(function(n){Gv(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Sd(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}const Jv=t=>t?(...e)=>t(...e):(...e)=>fetch(...e),Qv=()=>Headers,Yv=(t,e,r)=>{const n=Jv(r),s=Qv();return async(a,o)=>{var l;const c=(l=await e())!==null&&l!==void 0?l:t;let u=new s(o==null?void 0:o.headers);return u.has("apikey")||u.set("apikey",t),u.has("Authorization")||u.set("Authorization",`Bearer ${c}`),n(a,fe(fe({},o),{},{headers:u}))}};function Xv(t){return t.endsWith("/")?t:t+"/"}function Zv(t,e){var r,n;const{db:s,auth:a,realtime:o,global:l}=t,{db:c,auth:u,realtime:f,global:m}=e,d={db:fe(fe({},c),s),auth:fe(fe({},u),a),realtime:fe(fe({},f),o),storage:{},global:fe(fe(fe({},m),l),{},{headers:fe(fe({},(r=m==null?void 0:m.headers)!==null&&r!==void 0?r:{}),(n=l==null?void 0:l.headers)!==null&&n!==void 0?n:{})}),accessToken:async()=>""};return t.accessToken?d.accessToken=t.accessToken:delete d.accessToken,d}function ex(t){const e=t==null?void 0:t.trim();if(!e)throw new Error("supabaseUrl is required.");if(!e.match(/^https?:\/\//i))throw new Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL(Xv(e))}catch{throw Error("Invalid supabaseUrl: Provided URL is malformed.")}}var tx=class extends Mv{constructor(t){super(t)}},rx=class{constructor(t,e,r){var n,s;this.supabaseUrl=t,this.supabaseKey=e;const a=ex(t);if(!e)throw new Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",a),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",a),this.storageUrl=new URL("storage/v1",a),this.functionsUrl=new URL("functions/v1",a);const o=`sb-${a.hostname.split(".")[0]}-auth-token`,l={db:qv,realtime:Wv,auth:fe(fe({},Vv),{},{storageKey:o}),global:Bv},c=Zv(r??{},l);if(this.storageKey=(n=c.auth.storageKey)!==null&&n!==void 0?n:"",this.headers=(s=c.global.headers)!==null&&s!==void 0?s:{},c.accessToken)this.accessToken=c.accessToken,this.auth=new Proxy({},{get:(f,m)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(m)} is not possible`)}});else{var u;this.auth=this._initSupabaseAuthClient((u=c.auth)!==null&&u!==void 0?u:{},this.headers,c.global.fetch)}this.fetch=Yv(e,this._getAccessToken.bind(this),c.global.fetch),this.realtime=this._initRealtimeClient(fe({headers:this.headers,accessToken:this._getAccessToken.bind(this)},c.realtime)),this.accessToken&&this.accessToken().then(f=>this.realtime.setAuth(f)).catch(f=>console.warn("Failed to set initial Realtime auth token:",f)),this.rest=new D0(new URL("rest/v1",a).href,{headers:this.headers,schema:c.db.schema,fetch:this.fetch}),this.storage=new Ry(this.storageUrl.href,this.headers,this.fetch,r==null?void 0:r.storage),c.accessToken||this._listenForAuthEvents()}get functions(){return new T0(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(t){return this.rest.from(t)}schema(t){return this.rest.schema(t)}rpc(t,e={},r={head:!1,get:!1,count:void 0}){return this.rest.rpc(t,e,r)}channel(t,e={config:{}}){return this.realtime.channel(t,e)}getChannels(){return this.realtime.getChannels()}removeChannel(t){return this.realtime.removeChannel(t)}removeAllChannels(){return this.realtime.removeAllChannels()}async _getAccessToken(){var t=this,e,r;if(t.accessToken)return await t.accessToken();const{data:n}=await t.auth.getSession();return(e=(r=n.session)===null||r===void 0?void 0:r.access_token)!==null&&e!==void 0?e:t.supabaseKey}_initSupabaseAuthClient({autoRefreshToken:t,persistSession:e,detectSessionInUrl:r,storage:n,userStorage:s,storageKey:a,flowType:o,lock:l,debug:c,throwOnError:u},f,m){const d={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new tx({url:this.authUrl.href,headers:fe(fe({},d),f),storageKey:a,autoRefreshToken:t,persistSession:e,detectSessionInUrl:r,storage:n,userStorage:s,flowType:o,lock:l,debug:c,throwOnError:u,fetch:m,hasCustomAuthorizationHeader:Object.keys(this.headers).some(y=>y.toLowerCase()==="authorization")})}_initRealtimeClient(t){return new X0(this.realtimeUrl.href,fe(fe({},t),{},{params:fe(fe({},{apikey:this.supabaseKey}),t==null?void 0:t.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((t,e)=>{this._handleTokenChanged(t,"CLIENT",e==null?void 0:e.access_token)})}_handleTokenChanged(t,e,r){(t==="TOKEN_REFRESHED"||t==="SIGNED_IN")&&this.changedAccessToken!==r?(this.changedAccessToken=r,this.realtime.setAuth(r)):t==="SIGNED_OUT"&&(this.realtime.setAuth(),e=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}};const nx=(t,e,r)=>new rx(t,e,r);function sx(){if(typeof window<"u"||typeof process>"u")return!1;const t=process.version;if(t==null)return!1;const e=t.match(/^v(\d+)\./);return e?parseInt(e[1],10)<=18:!1}sx()&&console.warn("  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const ix="https://lxyexybnotixgpzflota.supabase.co",ax="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imx4eWV4eWJub3RpeGdwemZsb3RhIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjAyMDcwODIsImV4cCI6MjA3NTc4MzA4Mn0.TSbnvPKWiDdEFbyOh38qj_L87LZ75p3FiOW05hzEBlM",A=nx(ix,ax),Cd={async createCardBatch(t){const{data:e,error:r}=await A.from("card_batches").insert(t).select().single();if(r)throw r;return e},async createCard(t){const{data:e,error:r}=await A.from("cards").insert(t).select().single();if(r)throw r;return e},async getCardByControlNumber(t,e){const r=/^\d{5}$/,n=/^\d{1,5}$/,s=r.test(t),a=n.test(t);let o=A.from("cards").select(`
        *,
        clinic:mocards_clinics(*),
        perks:card_perks(*)
      `);if(s||a){const u=parseInt(t.replace(/^0+/,"")||"0"),f=t.padStart(5,"0");o=o.or(`control_number.like.%${f},control_number_v2.like.%${f},unified_control_number.like.%${f},card_number.eq.${u},display_card_number.eq.${u+9999}`)}else o=o.or(`control_number.eq.${t},control_number_v2.eq.${t},unified_control_number.eq.${t}`);o=o.gte("card_number",1).lte("card_number",1e4),e&&(o=o.eq("passcode",e));const{data:l,error:c}=await o.single();if(c)throw c;return l},async searchCards(t,e=10){const{data:r,error:n}=await A.rpc("search_card_universal",{search_term:t}).limit(e);if(n)throw n;return r},getPrimaryControlNumber(t){return t.unified_control_number||t.control_number_v2||t.control_number||`Card #${t.card_number}`},getDisplayCardNumber(t){return t.display_card_number||(t.card_number||0)+9999},async activateCard(t,e,r="16"){const{data:n}=await A.from("mocards_clinics").select("clinic_code").eq("id",e).single(),s=(n==null?void 0:n.clinic_code)||null,{data:a,error:o}=await A.from("cards").update({is_activated:!0,status:"activated",assigned_clinic_id:e,activated_at:new Date().toISOString(),expires_at:new Date(Date.now()+365*24*60*60*1e3).toISOString(),location_code_v2:r,clinic_code_v2:s,updated_at:new Date().toISOString()}).eq("id",t).select().single();if(o)throw o;return a},async claimPerk(t,e){const{data:r,error:n}=await A.from("card_perks").update({claimed:!0,claimed_at:new Date().toISOString(),claimed_by_clinic:e}).eq("id",t).eq("claimed",!1).select().single();if(n)throw n;return r},async createClinic(t){const{data:e,error:r}=await A.from("mocards_clinics").insert({...t,created_at:new Date().toISOString(),updated_at:new Date().toISOString()}).select().single();if(r)throw r;return e},async getClinicByCode(t){const{data:e,error:r}=await A.from("mocards_clinics").select("*").eq("clinic_code",t).single();if(r)throw r;return e},async getClinicCards(t){const{data:e,error:r}=await A.from("cards").select(`
        *,
        perks:card_perks(*)
      `).eq("assigned_clinic_id",t);if(r)throw r;return e},async logTransaction(t){const{data:e,error:r}=await A.from("card_transactions").insert({...t,created_at:new Date().toISOString()}).select().single();if(r)throw r;return e},async createAdminUser(t){const{data:e,error:r}=await A.from("mocards_admin_users").insert({...t,created_at:new Date().toISOString()}).select().single();if(r)throw r;return e},async getAdminByUsername(t){const{data:e,error:r}=await A.from("mocards_admin_users").select("*").eq("username",t).single();if(r)throw r;return e},async createAppointment(t){const{data:e,error:r}=await A.from("appointments").insert({...t,created_at:new Date().toISOString(),updated_at:new Date().toISOString()}).select().single();if(r)throw r;return e},async getAppointments(t){let e=A.from("appointments").select(`
        *,
        clinic:mocards_clinics(*),
        card:cards(*)
      `).order("created_at",{ascending:!1});t!=null&&t.status&&(e=e.eq("status",t.status)),t!=null&&t.clinic_id&&(e=e.eq("assigned_clinic_id",t.clinic_id)),t!=null&&t.admin_id&&(e=e.eq("booked_by_admin_id",t.admin_id)),t!=null&&t.date_from&&(e=e.gte("appointment_date",t.date_from)),t!=null&&t.date_to&&(e=e.lte("appointment_date",t.date_to));const{data:r,error:n}=await e;if(n)throw n;return r},async getAppointmentById(t){const{data:e,error:r}=await A.from("appointments").select(`
        *,
        clinic:mocards_clinics(*),
        card:cards(*)
      `).eq("id",t).single();if(r)throw r;return e},async updateAppointmentStatus(t,e,r,n,s){const{data:a,error:o}=await A.rpc("update_appointment_status",{p_appointment_id:t,p_new_status:e,p_changed_by:r,p_changed_by_id:n,p_reason:s});if(o)throw o;return a},async rescheduleAppointment(t,e,r,n,s,a){const{data:o,error:l}=await A.rpc("reschedule_appointment",{p_appointment_id:t,p_new_date:e,p_new_time:r,p_reschedule_reason:n,p_changed_by:s,p_changed_by_id:a});if(l)throw l;return o},async getAppointmentHistory(t){const{data:e,error:r}=await A.from("appointment_status_history").select("*").eq("appointment_id",t).order("created_at",{ascending:!0});if(r)throw r;return e},async createAppointmentNotification(t){const{data:e,error:r}=await A.from("appointment_notifications").insert({...t,created_at:new Date().toISOString()}).select().single();if(r)throw r;return e},async getUnreadNotifications(t,e){let r=A.from("appointment_notifications").select("*").eq("recipient_type",t).is("read_at",null).order("created_at",{ascending:!1});e&&(r=r.eq("recipient_id",e));const{data:n,error:s}=await r;if(s)throw s;return n},async markNotificationAsRead(t){const{data:e,error:r}=await A.from("appointment_notifications").update({read_at:new Date().toISOString()}).eq("id",t).select().single();if(r)throw r;return e},async getAllClinics(){const{data:t,error:e}=await A.from("mocards_clinics").select("*").eq("status","active").order("clinic_name");if(e)throw e;return t},async createPerkdatalate(t){const{data:e,error:r}=await A.from("perk_datalates").insert({...t,created_at:new Date().toISOString(),updated_at:new Date().toISOString()}).select().single();if(r)throw r;return e},async getAllPerkdatalates(){const{data:t,error:e}=await A.from("perk_datalates").select("*").order("category",{ascending:!0}).order("name",{ascending:!0});if(e)throw e;return t},async getActivePerkdatalates(){const{data:t,error:e}=await A.from("perk_datalates").select("*").eq("is_active",!0).order("category",{ascending:!0}).order("name",{ascending:!0});if(e)throw e;return t},async getPerkdatalateById(t){const{data:e,error:r}=await A.from("perk_datalates").select("*").eq("id",t).single();if(r)throw r;return e},async updatePerkdatalate(t,e){const{data:r,error:n}=await A.from("perk_datalates").update({...e,updated_at:new Date().toISOString()}).eq("id",t).select().single();if(n)throw n;return r},async deletePerkdatalate(t){if((await this.getPerkdatalateById(t)).is_system_default)throw new Error("System default perks cannot be deleted");const{data:r,error:n}=await A.from("perk_datalates").delete().eq("id",t).eq("is_system_default",!1).select().single();if(n)throw n;return r},async getAllPerkCategories(){const{data:t,error:e}=await A.from("perk_categories").select("*").order("display_order",{ascending:!0});if(e)throw e;return t},async createPerkCategory(t){const{data:e,error:r}=await A.from("perk_categories").insert({...t,created_at:new Date().toISOString()}).select().single();if(r)throw r;return e},async updatePerkCategory(t,e){const{data:r,error:n}=await A.from("perk_categories").update(e).eq("id",t).select().single();if(n)throw n;return r},async getClinicPerkCustomizations(t){const{data:e,error:r}=await A.from("clinic_perk_customizations").select(`
        *,
        perk_datalate:perk_datalates(*)
      `).eq("clinic_id",t).order("created_at",{ascending:!1});if(r)throw r;return e},async getActiveClinicPerkCustomizations(t){const{data:e,error:r}=await A.from("clinic_perk_customizations").select(`
        *,
        perk_datalate:perk_datalates(*)
      `).eq("clinic_id",t).eq("is_enabled",!0).order("created_at",{ascending:!1});if(r)throw r;return e},async updateClinicPerkCustomization(t,e){const{data:r,error:n}=await A.from("clinic_perk_customizations").update({...e,updated_at:new Date().toISOString()}).eq("id",t).select().single();if(n)throw n;return r},async createClinicPerkCustomization(t){const{data:e,error:r}=await A.from("clinic_perk_customizations").insert({...t,created_at:new Date().toISOString(),updated_at:new Date().toISOString()}).select().single();if(r)throw r;return e},async recordPerkUsage(t){const e=new Date(t.redemption_date),r=`${e.getFullYear()}-${(e.getMonth()+1).toString().padStart(2,"0")}`,{data:n,error:s}=await A.from("perk_usage_analytics").insert({...t,month_year:r,created_at:new Date().toISOString()}).select().single();if(s)throw s;return n},async getClinicPerkAnalytics(t,e){let r=A.from("perk_usage_analytics").select("*").eq("clinic_id",t);e&&(r=r.eq("month_year",e));const{data:n,error:s}=await r.order("redemption_date",{ascending:!1});if(s)throw s;return n},async getPerkdatalateUsageStats(t,e){let r=A.from("perk_usage_analytics").select("*").eq("perk_datalate_id",t);e&&(r=r.eq("month_year",e));const{data:n,error:s}=await r;if(s)throw s;return n},async getCodeGenerationSettings(){const{data:t,error:e}=await A.from("code_generation_settings").select("*").order("setting_type",{ascending:!0}).order("generation_mode",{ascending:!0});if(e)throw e;return t},async updateCodeGenerationSetting(t,e){const{data:r,error:n}=await A.from("code_generation_settings").update({...e,updated_at:new Date().toISOString()}).eq("id",t).select().single();if(n)throw n;return r},async createCodeGenerationSetting(t){const{data:e,error:r}=await A.from("code_generation_settings").insert({...t,created_at:new Date().toISOString(),updated_at:new Date().toISOString()}).select().single();if(r)throw r;return e},async getLocationCodes(){const{data:t,error:e}=await A.from("location_codes").select("*").eq("is_active",!0).order("sort_order",{ascending:!0});if(e)throw e;return t},async getAllLocationCodes(){const{data:t,error:e}=await A.from("location_codes").select("*").order("sort_order",{ascending:!0});if(e)throw e;return t},async createLocationCode(t){const{data:e,error:r}=await A.from("location_codes").insert({...t,created_at:new Date().toISOString(),updated_at:new Date().toISOString()}).select().single();if(r)throw r;return e},async updateLocationCode(t,e){const{data:r,error:n}=await A.from("location_codes").update({...e,updated_at:new Date().toISOString()}).eq("id",t).select().single();if(n)throw n;return r},async generateBatchNumber(t,e,r){const{data:n,error:s}=await A.rpc("generate_batch_number",{generation_mode:t,custom_input:e,location_prefix:r||"PHL"});if(s)throw s;return n},async generateControlNumber(t,e,r="auto",n){const{data:s,error:a}=await A.rpc("generate_control_number",{batch_prefix:t,card_index:e,generation_mode:r,custom_format:n});if(a)throw a;return s},async generatePasscode(t,e="auto",r){const{data:n,error:s}=await A.rpc("generate_passcode",{location_code:t,generation_mode:e,custom_passcode:r});if(s)throw s;return n},async normalizeCode(t,e){const{data:r,error:n}=await A.rpc("normalize_code",{input_code:t,code_type:e});if(n)throw n;return r},async getCardByControlNumberNormalized(t,e){const r=await this.normalizeCode(t,"control"),n=e?await this.normalizeCode(e,"passcode"):void 0;return this.getCardByControlNumber(r,n)},async getCardCodeHistory(t){const{data:e,error:r}=await A.from("card_code_history").select("*").eq("card_id",t).order("created_at",{ascending:!1});if(r)throw r;return e},async recordCardCodeChange(t,e,r,n,s,a,o){const{data:l,error:c}=await A.from("card_code_history").insert({card_id:t,change_type:e,field_name:r,old_value:n,new_value:s,changed_by:a,change_reason:o,metadata:{},created_at:new Date().toISOString()}).select().single();if(c)throw c;return l},async getSystemVersions(){const{data:t,error:e}=await A.from("system_versions").select("*").order("component",{ascending:!0});if(e)throw e;return t},async getComponentVersion(t){const{data:e,error:r}=await A.from("system_versions").select("*").eq("component",t).single();if(r)throw r;return e},async saveUserSessionState(t,e,r,n,s){const{data:a,error:o}=await A.from("user_session_state").upsert({user_id:t,user_type:e,component_name:r,form_data:n,draft_state:s,last_saved:new Date().toISOString(),expires_at:new Date(Date.now()+864e5).toISOString()}).select().single();if(o)throw o;return a},async getUserSessionState(t,e){const{data:r,error:n}=await A.from("user_session_state").select("*").eq("user_id",t).eq("component_name",e).single();if(n&&n.code!=="PGRST116")throw n;return r},async clearExpiredSessions(){const{error:t}=await A.from("user_session_state").delete().lt("expires_at",new Date().toISOString());if(t)throw t},async updateCardCodes(t,e,r){const n=await A.from("cards").select("control_number, passcode, location_code").eq("id",t).single();if(n.error)throw n.error;const{data:s,error:a}=await A.from("cards").update({...e,admin_override:!0,last_modified_by:r,last_modified_at:new Date().toISOString()}).eq("id",t).select().single();if(a)throw a;for(const[o,l]of Object.entries(e))if(o in n.data&&l!==void 0){const c=n.data[o];c!==l&&await this.recordCardCodeChange(t,o.includes("control")?"control_updated":o.includes("passcode")?"passcode_updated":"batch_updated",o,c,l,r,"Admin manual update")}return s},async getCardBatchById(t){const{data:e,error:r}=await A.from("card_batches").select("*").eq("id",t).single();if(r)throw r;return e},async generateCardsWithSettings(t,e,r,n){const s=[],a=await this.getCardBatchById(t);for(let c=0;c<e;c++){const u=(r.startIndex||1)+c,f=await this.generateControlNumber(a.batch_number,u,r.generationMode,r.customPrefix?`${r.customPrefix}-${u.toString().padStart(3,"0")}`:void 0),m=await this.generatePasscode(r.locationCode,r.generationMode),d={batch_id:t,control_number:f,passcode:m,location_code:r.locationCode,status:"unactivated",generation_method:r.generationMode,admin_override:r.generationMode!=="auto",last_modified_by:n,created_at:new Date().toISOString(),updated_at:new Date().toISOString()};s.push(d)}const{data:o,error:l}=await A.from("cards").insert(s).select();if(l)throw l;for(const c of o)await this.recordCardCodeChange(c.id,"created","card_created","",`Control: ${c.control_number}, Passcode: ${c.passcode}`,n,`Batch generation with ${r.generationMode} mode`);return o},async getAllCardBatches(){const{data:t,error:e}=await A.from("card_batches").select("*").order("created_at",{ascending:!1});if(e)throw e;return t}},Tn={starter:{limit:500,price:299,name:"Starter Plan",features:["Up to 500 cards","Basic reporting","Email support"]},growth:{limit:1e3,price:499,name:"Growth Plan",features:["Up to 1,000 cards","Advanced reporting","Priority support","Custom perks"]},pro:{limit:2e3,price:799,name:"Pro Plan",features:["Up to 2,000 cards","Full analytics","24/7 support","API access","Custom branding"]}},Dt={starter:Tn.starter.limit,growth:Tn.growth.limit,pro:Tn.pro.limit},or={starter:Tn.starter.price,growth:Tn.growth.price,pro:Tn.pro.price},es=[{code:"01",name:"Ilocos Region (Region 1)"},{code:"02",name:"Cagayan Valley (Region 2)"},{code:"03",name:"Central Luzon (Region 3)"},{code:"4A",name:"Calabarzon (Region 4A)"},{code:"4B",name:"Mimaropa (Region 4B)"},{code:"05",name:"Bicol Region (Region 5)"},{code:"06",name:"Western Visayas (Region 6)"},{code:"07",name:"Central Visayas (Region 7)"},{code:"08",name:"Eastern Visayas (Region 8)"},{code:"09",name:"Zamboanga Peninsula (Region 9)"},{code:"10",name:"Northern Mindanao (Region 10)"},{code:"11",name:"Davao Region (Region 11)"},{code:"12",name:"Soccsksargen (Region 12)"},{code:"13",name:"Caraga Region (Region 13)"},{code:"NCR",name:"National Capital Region (NCR)"},{code:"CAR",name:"Cordillera Administrative Region (CAR)"}],Ed=["CVT001","CVT002","CVT003","CVT004","CVT005","CVT006","CVT007","CVT008","CVT009","CVT010","BTG001","BTG002","BTG003","BTG004","BTG005","BTG006","BTG007","BTG008","BTG009","BTG010","LGN001","LGN002","LGN003","LGN004","LGN005","LGN006","LGN007","LGN008","LGN009","LGN010","Others","Custom"],ox=[{type:"dental_cleaning",name:"Free Dental Cleaning",description:"Complete professional dental cleaning service",value:1500,isActive:!0,validFor:365,requiresApproval:!1},{type:"consultation",name:"Free Dental Consultation",description:"Comprehensive dental consultation and check-up",value:500,isActive:!0,validFor:365,requiresApproval:!1},{type:"xray",name:"X-Ray Imaging Service",description:"Digital X-ray imaging for diagnosis",value:800,isActive:!0,validFor:365,requiresApproval:!0},{type:"treatment",name:"Treatment Discount",description:"20% discount on dental treatments and procedures",value:20,isActive:!0,validFor:365,requiresApproval:!0},{type:"discount",name:"General Service Discount",description:"10% discount on all dental services",value:10,isActive:!0,validFor:365,requiresApproval:!1}];class lx{constructor(){rr(this,"syncStatus","synced");rr(this,"lastSync",null);rr(this,"subscriptions",[]);this.setupRealTimeSubscriptions(),this.checkConnection()}async checkConnection(){try{const{error:e}=await A.from("cards").select("id").limit(1);if(e)throw e;return this.setSyncStatus("synced"),!0}catch(e){return console.error("[SupabaseCloudSync] Connection failed:",e),this.setSyncStatus("offline"),!1}}setSyncStatus(e){this.syncStatus=e,e==="synced"&&(this.lastSync=new Date)}setupRealTimeSubscriptions(){const e=A.channel("cards-changes").on("postgres_changes",{event:"*",schema:"public",table:"cards"},o=>{console.log("[SupabaseCloudSync] Cards changed:",o),this.lastSync=new Date}).subscribe(),r=A.channel("clinics-changes").on("postgres_changes",{event:"*",schema:"public",table:"clinics"},o=>{console.log("[SupabaseCloudSync] Clinics changed:",o),this.lastSync=new Date}).subscribe(),n=A.channel("appointments-changes").on("postgres_changes",{event:"*",schema:"public",table:"appointments"},o=>{console.log("[SupabaseCloudSync] Appointments changed:",o),this.lastSync=new Date}).subscribe(),s=A.channel("perks-changes").on("postgres_changes",{event:"*",schema:"public",table:"perks"},o=>{console.log("[SupabaseCloudSync] Perks changed:",o),this.lastSync=new Date}).subscribe(),a=A.channel("redemptions-changes").on("postgres_changes",{event:"*",schema:"public",table:"perk_redemptions"},o=>{console.log("[SupabaseCloudSync] Perk redemptions changed:",o),this.lastSync=new Date}).subscribe();this.subscriptions=[e,r,n,s,a]}async getAllCards(){try{this.setSyncStatus("syncing");const{data:e,error:r}=await A.from("cards").select(`
          *,
          clinic:mocards_clinics(*),
          perks:card_perks(*)
        `).order("created_at",{ascending:!1});if(r)throw r;const n=(e||[]).map(s=>{var a,o;return{id:s.id,controlNumber:s.control_number||s.unified_control_number||`${s.card_number}`,fullName:"",status:s.status==="activated"?"active":"inactive",perksTotal:5,perksUsed:((a=s.perks)==null?void 0:a.filter(l=>l.claimed).length)||0,clinicId:s.assigned_clinic_id||"",expiryDate:((o=s.expires_at)==null?void 0:o.split("T")[0])||"2025-12-31",createdAt:s.created_at,updatedAt:s.updated_at||s.created_at}});return this.setSyncStatus("synced"),n}catch(e){return console.error("[SupabaseCloudSync] Error getting cards:",e),this.setSyncStatus("error"),[]}}async createCard(e){var r;try{this.setSyncStatus("syncing");const n={control_number:e.controlNumber,status:e.status==="active"?"activated":"unactivated",assigned_clinic_id:e.clinicId||null,expires_at:e.expiryDate+"T23:59:59Z",card_number:parseInt(e.controlNumber.replace(/[^\d]/g,""))||1},{data:s,error:a}=await A.from("cards").insert(n).select().single();if(a)throw a;const o={id:s.id,controlNumber:s.control_number,fullName:e.fullName,status:s.status==="activated"?"active":"inactive",perksTotal:e.perksTotal,perksUsed:e.perksUsed,clinicId:s.assigned_clinic_id||"",expiryDate:((r=s.expires_at)==null?void 0:r.split("T")[0])||"2025-12-31",createdAt:s.created_at,updatedAt:s.updated_at||s.created_at};return this.setSyncStatus("synced"),o}catch(n){throw console.error("[SupabaseCloudSync] Error creating card:",n),this.setSyncStatus("error"),n}}async updateCard(e,r){try{this.setSyncStatus("syncing");const n={};r.status!==void 0&&(n.status=r.status==="active"?"activated":"unactivated"),r.clinicId!==void 0&&(n.assigned_clinic_id=r.clinicId||null),r.expiryDate!==void 0&&(n.expires_at=r.expiryDate+"T23:59:59Z"),n.updated_at=new Date().toISOString();const{error:s}=await A.from("cards").update(n).eq("id",e);if(s)throw s;return this.setSyncStatus("synced"),!0}catch(n){return console.error("[SupabaseCloudSync] Error updating card:",n),this.setSyncStatus("error"),!1}}async getAllClinics(){try{this.setSyncStatus("syncing");const{data:e,error:r}=await A.from("clinics").select("*").order("created_at",{ascending:!1});if(r)throw r;const n=(e||[]).map(s=>({id:s.id,name:s.clinic_name,code:s.clinic_code,password:"clinic123",plan:"starter",maxCards:500,region:s.region||"NCR",address:s.address,email:s.contact_email,contactNumber:s.contact_phone,subscriptionStatus:s.status==="active"?"active":"suspended",subscriptionStartDate:s.created_at.split("T")[0],subscriptionPrice:or.starter,createdAt:s.created_at,updatedAt:s.updated_at,isActive:s.status==="active"}));return this.setSyncStatus("synced"),n}catch(e){return console.error("[SupabaseCloudSync] Error getting clinics:",e),this.setSyncStatus("error"),[]}}async createClinic(e){try{this.setSyncStatus("syncing");const r={clinic_name:e.name,clinic_code:e.code,password_hash:e.password,region:e.region,address:e.address,contact_email:e.email,contact_phone:e.contactNumber,status:e.isActive!==!1?"active":"inactive"},{data:n,error:s}=await A.from("clinics").insert(r).select().single();if(s)throw s;const a={id:n.id,name:n.clinic_name,code:n.clinic_code,password:e.password,plan:e.plan,maxCards:e.maxCards,region:n.region,address:n.address,email:n.contact_email,contactNumber:n.contact_phone,subscriptionStatus:n.status==="active"?"active":"suspended",subscriptionStartDate:n.created_at.split("T")[0],subscriptionPrice:or[e.plan],createdAt:n.created_at,updatedAt:n.updated_at,isActive:n.status==="active"};return this.setSyncStatus("synced"),a}catch(r){throw console.error("[SupabaseCloudSync] Error creating clinic:",r),this.setSyncStatus("error"),r}}async getAllAppointments(){try{this.setSyncStatus("syncing");const{data:e,error:r}=await A.from("appointments").select(`
          *,
          clinic:mocards_clinics(*),
          card:cards(*)
        `).order("created_at",{ascending:!1});if(r)throw r;const n=(e||[]).map(s=>({id:s.id,cardControlNumber:s.control_number,clinicId:s.assigned_clinic_id||"",patientName:s.patient_name||"Unknown Patient",patientEmail:s.patient_email||"patient@example.com",patientPhone:s.patient_phone||"+63 000 000 0000",preferredDate:s.appointment_date,preferredTime:s.appointment_time,serviceType:s.service_type||"General Consultation",perkRequested:s.perk_type,status:this.mapAppointmentStatus(s.status),notes:s.cardholder_notes,createdAt:s.created_at}));return this.setSyncStatus("synced"),n}catch(e){return console.error("[SupabaseCloudSync] Error getting appointments:",e),this.setSyncStatus("error"),[]}}async createAppointment(e){try{this.setSyncStatus("syncing");const r={control_number:e.cardControlNumber,assigned_clinic_id:e.clinicId,appointment_date:e.preferredDate,appointment_time:e.preferredTime,perk_type:e.perkRequested||e.serviceType,cardholder_notes:e.notes,status:"waiting_for_approval",patient_name:e.patientName,patient_email:e.patientEmail,patient_phone:e.patientPhone,service_type:e.serviceType},{data:n,error:s}=await A.from("appointments").insert(r).select().single();if(s)throw s;const a={id:n.id,cardControlNumber:n.control_number,clinicId:n.assigned_clinic_id,patientName:n.patient_name,patientEmail:n.patient_email,patientPhone:n.patient_phone,preferredDate:n.appointment_date,preferredTime:n.appointment_time,serviceType:n.service_type,perkRequested:n.perk_type,status:this.mapAppointmentStatus(n.status),notes:n.cardholder_notes,createdAt:n.created_at};return this.setSyncStatus("synced"),a}catch(r){throw console.error("[SupabaseCloudSync] Error creating appointment:",r),this.setSyncStatus("error"),r}}async updateAppointment(e,r){try{this.setSyncStatus("syncing");const n={};r.status!==void 0&&(n.status=this.mapAppointmentStatusToSupabase(r.status)),r.notes!==void 0&&(n.cardholder_notes=r.notes),n.updated_at=new Date().toISOString();const{error:s}=await A.from("appointments").update(n).eq("id",e);if(s)throw s;return this.setSyncStatus("synced"),!0}catch(n){return console.error("[SupabaseCloudSync] Error updating appointment:",n),this.setSyncStatus("error"),!1}}async getAllPerks(){try{this.setSyncStatus("syncing");const{data:e,error:r}=await A.from("perk_datalates").select("*").eq("is_active",!0).order("created_at",{ascending:!1});if(r)throw r;const n=(e||[]).map(s=>({id:s.id,type:this.mapPerkType(s.type),name:s.name,description:s.description||"",value:s.value||0,isActive:s.is_active,validFor:365,requiresApproval:!1,createdAt:s.created_at,updatedAt:s.updated_at}));return this.setSyncStatus("synced"),n}catch(e){return console.error("[SupabaseCloudSync] Error getting perks:",e),this.setSyncStatus("error"),[]}}async getAllPerkRedemptions(){try{this.setSyncStatus("syncing");const{data:e,error:r}=await A.from("perk_usage_analytics").select("*").order("redemption_date",{ascending:!1});if(r)throw r;const n=(e||[]).map(s=>({id:s.id,cardControlNumber:"Unknown",perkId:s.perk_datalate_id,perkName:"Unknown Perk",clinicId:s.clinic_id,claimantName:"Unknown Patient",handledBy:"System",serviceType:"General Service",usedAt:s.redeemed_at,value:s.value_redeemed,notes:""}));return this.setSyncStatus("synced"),n}catch(e){return console.error("[SupabaseCloudSync] Error getting perk redemptions:",e),this.setSyncStatus("error"),[]}}mapAppointmentStatus(e){return{waiting_for_approval:"pending",approved:"accepted",pending_reschedule:"rescheduled",approved_reschedule:"accepted",cancelled:"cancelled",completed:"completed"}[e]||"pending"}mapAppointmentStatusToSupabase(e){return{pending:"waiting_for_approval",accepted:"approved",declined:"cancelled",rescheduled:"pending_reschedule",completed:"completed",cancelled:"cancelled"}[e]||"waiting_for_approval"}mapPerkType(e){return{consultation:"consultation",cleaning:"dental_cleaning",xray:"xray",discount:"discount",service:"treatment"}[e]||"consultation"}getSyncStatus(){return this.syncStatus}getLastSync(){return this.lastSync}async forceSync(){return await this.checkConnection()}cleanup(){this.subscriptions.forEach(e=>{A.removeChannel(e)}),this.subscriptions=[]}}const Ue=new lx,F={cards:{getAll:()=>Ue.getAllCards(),save:async t=>(console.warn("[CloudOperations] Batch save not implemented for Supabase"),!0),add:async t=>{try{return await Ue.createCard(t),!0}catch(e){return console.error("[CloudOperations] Error adding card:",e),!1}},update:async(t,e)=>await Ue.updateCard(t,e),remove:async t=>{try{const{error:e}=await A.from("cards").delete().eq("id",t);return!e}catch(e){return console.error("[CloudOperations] Error removing card:",e),!1}}},clinics:{getAll:()=>Ue.getAllClinics(),save:async t=>(console.warn("[CloudOperations] Batch save not implemented for Supabase"),!0),add:async t=>{try{return await Ue.createClinic(t),!0}catch(e){return console.error("[CloudOperations] Error adding clinic:",e),!1}},update:async(t,e)=>{try{const{error:r}=await A.from("clinics").update({clinic_name:e.name,contact_email:e.email,contact_phone:e.contactNumber,updated_at:new Date().toISOString()}).eq("id",t);return!r}catch(r){return console.error("[CloudOperations] Error updating clinic:",r),!1}},remove:async t=>{try{const{error:e}=await A.from("mocards_clinics").delete().eq("id",t);return!e}catch(e){return console.error("[CloudOperations] Error removing clinic:",e),!1}}},appointments:{getAll:()=>Ue.getAllAppointments(),save:async t=>(console.warn("[CloudOperations] Batch save not implemented for Supabase"),!0),add:async t=>{try{return await Ue.createAppointment(t),!0}catch(e){return console.error("[CloudOperations] Error adding appointment:",e),!1}},update:async(t,e)=>await Ue.updateAppointment(t,e),remove:async t=>{try{const{error:e}=await A.from("appointments").delete().eq("id",t);return!e}catch(e){return console.error("[CloudOperations] Error removing appointment:",e),!1}}},perks:{getAll:()=>Ue.getAllPerks(),save:async t=>(console.warn("[CloudOperations] Batch save not implemented for Supabase"),!0),add:async t=>{try{const{error:e}=await A.from("perks").insert({name:t.name,description:t.description,type:t.type,value:t.value,is_active:t.isActive,is_system_default:!1});return!e}catch(e){return console.error("[CloudOperations] Error adding perk:",e),!1}},update:async(t,e)=>{try{const{error:r}=await A.from("perks").update({name:e.name,description:e.description,default_value:e.value,is_active:e.isActive,updated_at:new Date().toISOString()}).eq("id",t);return!r}catch(r){return console.error("[CloudOperations] Error updating perk:",r),!1}},remove:async t=>{try{const{error:e}=await A.from("perk_datalates").delete().eq("id",t);return!e}catch(e){return console.error("[CloudOperations] Error removing perk:",e),!1}}},perkRedemptions:{getAll:()=>Ue.getAllPerkRedemptions(),save:async t=>(console.warn("[CloudOperations] Batch save not implemented for Supabase"),!0),add:async t=>{try{const{error:e}=await A.from("perk_redemptions").insert({perk_id:t.perkId,clinic_id:t.clinicId,card_control_number:t.cardControlNumber,redeemed_at:t.usedAt,value_redeemed:t.value,notes:t.notes||null});return!e}catch(e){return console.error("[CloudOperations] Error adding perk redemption:",e),!1}}},sync:{getStatus:()=>Ue.getSyncStatus(),getLastSync:()=>Ue.getLastSync(),forceSync:()=>Ue.forceSync()}},cx=()=>({status:Ue.getSyncStatus(),lastSync:Ue.getLastSync(),forceSync:Ue.forceSync}),ux=({compact:t=!1,showText:e=!0,className:r=""})=>{const{status:n,lastSync:s,forceSync:a}=cx(),[o,l]=k.useState(typeof navigator<"u"?navigator.onLine:!0);k.useEffect(()=>{const y=()=>l(!0),x=()=>l(!1);if(typeof window<"u")return window.addEventListener("online",y),window.addEventListener("offline",x),()=>{window.removeEventListener("online",y),window.removeEventListener("offline",x)}},[]);const u=((y,x)=>{if(!x)return{icon:rd,color:"text-gray-500",bgColor:"bg-gray-100",text:"Offline",description:"Working offline. Will sync when connection is restored."};switch(y){case"synced":return{icon:Ku,color:"text-green-600",bgColor:"bg-green-100",text:"Synced",description:"All data is synced across devices"};case"syncing":return{icon:m0,color:"text-blue-600",bgColor:"bg-blue-100",text:"Syncing...",description:"Syncing data across devices",animate:"animate-spin"};case"error":return{icon:Vf,color:"text-red-600",bgColor:"bg-red-100",text:"Sync Error",description:"Failed to sync. Click to retry."};case"offline":return{icon:a0,color:"text-gray-500",bgColor:"bg-gray-100",text:"Offline",description:"Working offline"};default:return{icon:Ku,color:"text-gray-600",bgColor:"bg-gray-100",text:"Unknown",description:"Sync status unknown"}}})(n,o),f=u.icon,m=async()=>{(n==="error"||!o&&o)&&await a()},d=()=>{if(!s)return"Never synced";const x=new Date().getTime()-s.getTime();return x<6e4?"Just now":x<36e5?`${Math.floor(x/6e4)}m ago`:x<864e5?`${Math.floor(x/36e5)}h ago`:s.toLocaleDateString()};return t?i.jsxs("button",{onClick:m,className:`flex items-center space-x-1 px-2 py-1 rounded-md ${u.bgColor} hover:opacity-80 transition-opacity ${r}`,title:`${u.description}. Last sync: ${d()}`,children:[i.jsx(f,{className:`h-3 w-3 ${u.color} ${u.animate||""}`}),e&&i.jsx("span",{className:`text-xs font-medium ${u.color}`,children:u.text})]}):i.jsxs("div",{className:`flex items-center space-x-3 p-3 rounded-lg ${u.bgColor} ${r}`,children:[i.jsx("div",{className:"p-2 rounded-full bg-white",children:i.jsx(f,{className:`h-4 w-4 ${u.color} ${u.animate||""}`})}),i.jsxs("div",{className:"flex-1 min-w-0",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("h4",{className:`text-sm font-semibold ${u.color}`,children:["Cloud Sync ",u.text]}),n==="error"&&i.jsx("button",{onClick:m,className:"text-xs text-red-600 hover:text-red-800 font-medium",children:"Retry"})]}),i.jsx("p",{className:"text-xs text-gray-600 mt-1",children:u.description}),s&&i.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Last sync: ",d()]})]}),!o&&i.jsxs("div",{className:"flex items-center space-x-1 text-gray-500",children:[i.jsx(rd,{className:"h-3 w-3"}),i.jsx("span",{className:"text-xs",children:"Offline"})]})]})},Si=t=>{const[e,r]=k.useState(!1);return k.useEffect(()=>{const n=window.matchMedia(t);r(n.matches);const s=a=>{r(a.matches)};return n.addEventListener?n.addEventListener("change",s):n.addListener(s),()=>{n.removeEventListener?n.removeEventListener("change",s):n.removeListener(s)}},[t]),e},dx=()=>{const t=Si("(max-width: 640px)"),e=Si("(max-width: 1024px)"),r=Si("(min-width: 1024px)"),n=Si("(min-width: 1280px)");return{isMobile:t,isTablet:e,isDesktop:r,isLargeDesktop:n,isMobileOrTablet:t||e,isDesktopOrLarger:r}},hx=()=>{const[t,e]=k.useState({width:typeof window<"u"?window.innerWidth:0,height:typeof window<"u"?window.innerHeight:0});return k.useEffect(()=>{const r=()=>{e({width:window.innerWidth,height:window.innerHeight})};return window.addEventListener("resize",r),r(),()=>window.removeEventListener("resize",r)},[]),{...t,isLandscape:t.width>t.height,isPortrait:t.height>t.width,isSmallMobile:t.width<375,isMobile:t.width<640,isTablet:t.width>=640&&t.width<1024,isDesktop:t.width>=1024,isHighDensity:typeof window<"u"?window.devicePixelRatio>1.5:!1}};function fx({currentView:t,onViewChange:e,children:r,isAuthenticated:n,userType:s}){const[a,o]=k.useState(!1),{isMobile:l,isTablet:c}=dx(),{height:u}=hx();k.useEffect(()=>{l&&u<600&&o(!1)},[l,u]);const f=d=>!n||!s?!1:s==="admin"&&d==="clinic-portal"||s==="clinic"&&d==="admin-access",m=[{id:"card-lookup",label:"Card Lookup",icon:Un,description:"Verify card validity",disabled:!1},{id:"clinic-portal",label:"Clinic Portal",icon:_n,description:"Clinic management",disabled:f("clinic-portal")},{id:"admin-access",label:"Admin Access",icon:Ht,description:"System administration",disabled:f("admin-access")}];return l?i.jsxs("div",{className:"min-h-screen bg-gray-50 pb-16",children:[i.jsx(b0,{currentView:t,onViewChange:e,onSecurityToggle:()=>o(!a),showSecurityDashboard:a,navItems:m}),i.jsx("div",{className:"pt-20 px-4 pb-4",children:i.jsx("div",{className:"max-w-full mx-auto",children:r})}),a&&i.jsx("div",{className:"fixed inset-x-4 top-24 z-40 animate-slide-in-down",children:i.jsxs("div",{className:"bg-white rounded-lg shadow-xl border border-gray-200 max-h-[70vh] overflow-y-auto",children:[i.jsx("div",{className:"p-3 border-b border-gray-200 bg-blue-600 text-white rounded-t-lg",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("h3",{className:"font-semibold",children:"Security Monitor"}),i.jsx("button",{onClick:()=>o(!1),className:"text-white hover:bg-white hover:bg-opacity-20 rounded p-1 transition-colors",children:""})]})}),i.jsx("div",{className:"p-4",children:i.jsx(mo,{compact:!0})})]})}),i.jsx(po,{})]}):c?i.jsxs("div",{className:"min-h-screen flex flex-col",children:[i.jsxs("div",{className:"bg-[#1A535C] text-white shadow-lg",children:[i.jsxs("div",{className:"flex items-center justify-between px-6 py-4",children:[i.jsxs("div",{className:"flex items-center space-x-3",children:[i.jsx("div",{className:"w-10 h-10 bg-white bg-opacity-20 rounded-lg flex items-center justify-center",children:i.jsx("span",{className:"text-white font-bold text-lg",children:"MC"})}),i.jsx("div",{children:i.jsx("h1",{className:"text-xl font-bold text-white",children:"MOCARDS CLOUD"})})]}),i.jsxs("button",{onClick:()=>o(!a),className:`flex items-center space-x-2 px-4 py-2 rounded-xl transition-all duration-200 ${a?"bg-blue-600 text-white shadow-lg":"bg-white bg-opacity-20 text-teal-100 hover:bg-opacity-30"}`,children:[i.jsx(Ms,{className:"h-4 w-4"}),i.jsx("span",{className:"text-sm font-medium",children:"Security"})]})]}),i.jsx("div",{className:"px-6 pb-4",children:i.jsx("div",{className:"flex space-x-2",children:m.map(d=>{const y=d.icon,x=t===d.id,w=d.disabled;return i.jsxs("button",{onClick:()=>!w&&e(d.id),disabled:w,className:`flex items-center space-x-2 px-4 py-2 rounded-xl transition-all duration-200 ${w?"bg-gray-400 bg-opacity-20 text-gray-500 cursor-not-allowed opacity-50":x?"bg-white text-[#1A535C] shadow-lg":"bg-white bg-opacity-10 text-teal-100 hover:bg-opacity-20"}`,title:w?"Please logout to access this portal":void 0,children:[i.jsx(y,{className:"h-4 w-4"}),i.jsx("span",{className:"text-sm font-medium",children:d.label}),w&&i.jsx("span",{className:"text-xs",children:""})]},d.id)})})})]}),i.jsxs("div",{className:"flex-1 bg-gray-50 relative",children:[i.jsx("div",{className:"p-6",children:r}),a&&i.jsx("div",{className:"fixed bottom-4 right-4 z-50 w-80 animate-slide-in-right",children:i.jsx(mo,{})}),i.jsx(po,{})]})]}):i.jsxs("div",{className:"min-h-screen flex",children:[i.jsxs("div",{className:"w-64 bg-[#1A535C] text-white flex flex-col fixed h-full z-10",children:[i.jsx("div",{className:"p-6 border-b border-teal-600",children:i.jsx("h1",{className:"text-xl font-bold text-white",children:"MOCARDS CLOUD"})}),i.jsx("nav",{className:"flex-1 p-4",children:i.jsx("ul",{className:"space-y-2",children:m.map(d=>{const y=d.icon,x=t===d.id,w=d.disabled;return i.jsx("li",{children:i.jsxs("button",{onClick:()=>!w&&e(d.id),disabled:w,className:`w-full flex items-center space-x-3 px-4 py-3 rounded-xl transition-all duration-200 ${w?"bg-gray-600 bg-opacity-20 text-gray-400 cursor-not-allowed opacity-60":x?"bg-white text-[#1A535C] shadow-lg":"text-teal-100 hover:bg-teal-600 hover:text-white"}`,title:w?"Please logout to access this portal":void 0,children:[i.jsx(y,{className:`h-5 w-5 ${w?"text-gray-400":x?"text-[#1A535C]":""}`}),i.jsxs("div",{className:"text-left flex-1",children:[i.jsxs("div",{className:`font-medium ${w?"text-gray-400":x?"text-[#1A535C]":""}`,children:[d.label,w&&i.jsx("span",{className:"ml-2",children:""})]}),i.jsx("div",{className:`text-xs ${w?"text-gray-500":x?"text-teal-600":"text-teal-300"}`,children:w?"Logout required":d.description})]})]})},d.id)})})}),i.jsxs("div",{className:"p-4 border-t border-teal-600",children:[i.jsxs("button",{onClick:()=>o(!a),className:`w-full flex items-center justify-center space-x-2 px-4 py-3 rounded-xl transition-all duration-200 ${a?"bg-blue-600 text-white shadow-lg":"text-teal-100 hover:bg-teal-600 hover:text-white"}`,children:[i.jsx(Ms,{className:"h-4 w-4"}),i.jsx("span",{className:"text-sm font-medium",children:"Security Monitor"})]}),i.jsx("div",{className:"mt-4",children:i.jsx(ux,{compact:!0,className:"w-full"})}),i.jsxs("div",{className:"text-xs text-teal-300 text-center mt-3",children:["MOCARDS v4.0 Cloud",i.jsx("br",{})," 2025 Dental Group"]})]})]}),i.jsx("div",{className:"flex-1 ml-64 bg-gray-50 min-h-screen",children:r}),a&&i.jsx("div",{className:"fixed bottom-4 right-4 z-50 w-96 animate-slide-in-right",children:i.jsx(mo,{})}),i.jsx(po,{})]})}const mx=t=>new Date(t).toLocaleDateString("en-PH"),dm=(t,e,r)=>`MOC-${t.toString().padStart(5,"0")}-${e}-${r}`,px=async t=>{const r=(await F.clinics.getAll()).map(s=>s.code);let n=1;if(t==="Custom"||t==="Others"){for(;r.includes(`CVT${n.toString().padStart(3,"0")}`);)n++;return`CVT${n.toString().padStart(3,"0")}`}return t},Ft={getAll:async()=>await F.cards.getAll(),getByControlNumber:async t=>(await F.cards.getAll()).find(r=>r.controlNumber===t)||null,getByClinicId:async t=>(await F.cards.getAll()).filter(r=>r.clinicId===t),create:async t=>{const e={...t,id:`card_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()};try{if(!await F.cards.add(e))throw new Error("Failed to save card to cloud database");return e}catch(r){throw console.error("Failed to create card:",r),r}},createBatch:async(t,e,r,n,s=5)=>{const a=await F.cards.getAll(),o=[],l=new Date().toISOString();for(let u=t;u<=e;u++){const f={id:`card_${Date.now()}_${u}_${Math.random().toString(36).substr(2,9)}`,controlNumber:dm(u,r,n),fullName:"",status:"inactive",perksTotal:s,perksUsed:0,clinicId:"",expiryDate:"2025-12-31",createdAt:l,updatedAt:l};o.push(f)}const c=[...a,...o];return await F.cards.save(c),o},updateStatus:async(t,e)=>{const n=(await F.cards.getAll()).find(s=>s.controlNumber===t);return n?(await F.cards.update(n.id,{status:e}),!0):!1},assignToClinic:async(t,e)=>{const r=await F.clinics.getAll(),n=await F.cards.getAll(),s=r.find(l=>l.id===e);if(!s)return!1;const a=n.filter(l=>l.clinicId===e).length,o=Dt[s.plan];return a+t.length>o?!1:(await Promise.all(t.map(async l=>{const c=n.find(u=>u.controlNumber===l);c&&await F.cards.update(c.id,{clinicId:e})})),!0)},updatePerks:async(t,e)=>{const n=(await F.cards.getAll()).find(s=>s.controlNumber===t);if(n){const s=Math.min(e,n.perksTotal);return await F.cards.update(n.id,{perksUsed:s}),!0}return!1},delete:async t=>{const r=(await F.cards.getAll()).find(n=>n.controlNumber===t);return r?(await F.cards.remove(r.id),!0):!1}},lr={getAll:async()=>await F.perks.getAll(),getById:async t=>(await F.perks.getAll()).find(r=>r.id===t)||null,getByType:async t=>(await F.perks.getAll()).filter(r=>r.type===t),getActive:async()=>(await F.perks.getAll()).filter(e=>e.isActive),create:async t=>{const e={...t,id:`perk_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()};return await F.perks.add(e),e},update:async(t,e)=>{if((await F.perks.getAll()).find(s=>s.id===t)){const s={...e,updatedAt:new Date().toISOString()};return await F.perks.update(t,s),!0}return!1},delete:async t=>(await F.perks.remove(t),!0),initializeDefaults:async()=>{(await F.perks.getAll()).length===0&&await Promise.all(ox.map(async e=>{await lr.create(e)}))}},Ke={getAll:async()=>await F.clinics.getAll(),getById:async t=>(await F.clinics.getAll()).find(r=>r.id===t)||null,getByCode:async t=>(await F.clinics.getAll()).find(r=>r.code===t)||null,authenticate:async(t,e)=>(await F.clinics.getAll()).find(n=>n.code===t&&n.password===e)||null,create:async t=>{const e={...t,id:`clinic_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,subscriptionStatus:"active",subscriptionStartDate:new Date().toISOString(),maxCards:Dt[t.plan],createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),isActive:!0};return await F.clinics.add(e),e},update:async(t,e)=>(await F.clinics.getAll()).find(s=>s.id===t)?(await F.clinics.update(t,e),!0):!1,delete:async t=>(await F.clinics.remove(t),!0),getAssignedCardsCount:async t=>(await F.cards.getAll()).filter(r=>r.clinicId===t).length,getPlanLimit:async t=>{const r=(await F.clinics.getAll()).find(n=>n.id===t);return r?Dt[r.plan]:0}},Mi={getAll:async()=>await F.appointments.getAll(),getByClinicId:async t=>(await F.appointments.getAll()).filter(r=>r.clinicId===t),create:async t=>{const e={...t,id:`appointment_${Date.now()}_${Math.random().toString(36).substr(2,9)}`};return await F.appointments.add(e),e},updateStatus:async(t,e)=>(await F.appointments.getAll()).find(s=>s.id===t)?(await F.appointments.update(t,{status:e}),!0):!1},Ad={getAll:async()=>await F.perkRedemptions.getAll(),getByCardNumber:async t=>(await F.perkRedemptions.getAll()).filter(r=>r.cardControlNumber===t),getByClinicId:async t=>(await F.perkRedemptions.getAll()).filter(r=>r.clinicId===t),create:async t=>{const e={...t,id:`redemption_${Date.now()}_${Math.random().toString(36).substr(2,9)}`};return await F.perkRedemptions.add(e),e},getByPerkType:async(t,e)=>(await F.perkRedemptions.getAll()).filter(n=>n.cardControlNumber===t&&n.perkName.toLowerCase().includes(e.toLowerCase()))};function Td(){const[t,e]=k.useState(""),[r,n]=k.useState(null),[s,a]=k.useState(!1),[o,l]=k.useState(!1),[c,u]=k.useState([]),[f,m]=k.useState(!1),[d,y]=k.useState({patientName:"",patientEmail:"",patientPhone:"",preferredDate:"",preferredTime:"",serviceType:"",perkRequested:"",notes:""}),{addToast:x}=Er();k.useEffect(()=>{(async()=>{try{const N=await Ke.getAll();u(N)}catch(N){console.error("Failed to load clinics:",N)}})()},[]);const w=async()=>{var j,N;if(!t.trim()){x(Pe("Empty Search","Please enter a MOC card number"));return}a(!0),l(!1),n(null),await new Promise(S=>setTimeout(S,800));try{const S=await Cd.getCardByControlNumber(t.trim());if(S){const P={id:S.id,controlNumber:S.control_number||S.unified_control_number||`${S.card_number}`,fullName:"",status:S.status==="activated"?"active":"inactive",perksTotal:5,perksUsed:((j=S.perks)==null?void 0:j.filter(W=>W.claimed).length)||0,clinicId:S.assigned_clinic_id||"",expiryDate:((N=S.expires_at)==null?void 0:N.split("T")[0])||"2025-12-31",createdAt:S.created_at,updatedAt:S.updated_at||S.created_at};n(P),x(ee("Card Found","Card information retrieved successfully"))}else l(!0),x(Pe("Card Not Found","No MOC card found with this number"))}catch{x(Q("Search Error","Failed to search for card"))}finally{a(!1)}},C=j=>{j.key==="Enter"&&w()},p=j=>{const N=c.find(S=>S.id===j);return(N==null?void 0:N.name)||"No clinic assigned"},g=()=>{if(!r){x(Pe("No Card Selected","Please search for a valid MOC card first"));return}m(!0)},v=async()=>{if(!d.patientName||!d.patientEmail||!d.preferredDate||!d.preferredTime||!d.serviceType){x(Pe("Missing Information","Please fill in all required fields"));return}if(!r||!r.clinicId){x(Q("No Clinic Assigned","This card is not assigned to any clinic yet. Please contact MOCARDS admin."));return}const j=c.find(N=>N.id===r.clinicId);if(!j){x(Q("Clinic Not Found","The assigned clinic was not found. Please contact MOCARDS admin."));return}try{await Cd.createAppointment({control_number:r.controlNumber,assigned_clinic_id:r.clinicId,appointment_date:d.preferredDate,appointment_time:d.preferredTime,perk_type:d.perkRequested||d.serviceType,cardholder_notes:d.notes,cardholder_email:d.patientEmail,cardholder_phone:d.patientPhone,status:"waiting_for_approval",passcode:"default-passcode"}),x(ee("Request Sent to Clinic",`Your appointment request has been sent directly to ${j.name}. The clinic will contact you within 24 hours to confirm your appointment.`))}catch{x(Q("Request Failed","Failed to submit appointment request. Please try again."));return}y({patientName:"",patientEmail:"",patientPhone:"",preferredDate:"",preferredTime:"",serviceType:"",perkRequested:"",notes:""}),m(!1)},b=[{value:"dental_cleaning",label:"Free Dental Cleaning"},{value:"consultation",label:"Free Consultation"},{value:"xray",label:"X-Ray (50% discount)"},{value:"treatment",label:"Treatment (20% discount)"},{value:"general_discount",label:"General Discount (10%)"}];return i.jsxs("div",{className:"dark-search-container min-h-screen",children:[i.jsxs("div",{className:"flex flex-col items-center pt-20 pb-8",children:[i.jsx("h1",{className:"text-6xl font-normal text-white mb-8 select-none",children:"MOCARDS"}),i.jsx("div",{className:"relative w-full max-w-xl mb-8",children:i.jsxs("div",{className:"flex items-center dark-search-bar",children:[i.jsx(Un,{className:"h-5 w-5 text-gray-400 mr-4"}),i.jsx("input",{type:"text",value:t,onChange:j=>e(j.target.value),onKeyPress:C,placeholder:"Enter MOC control number",className:"flex-1 bg-transparent text-white outline-none",disabled:s}),i.jsx("div",{className:"flex items-center space-x-2 ml-4",children:i.jsx("button",{onClick:w,disabled:s,className:"p-1 rounded hover:bg-gray-700 transition-colors disabled:opacity-50",children:i.jsx(_l,{className:"h-5 w-5 text-gray-400 hover:text-gray-300"})})})]})}),i.jsx("div",{className:"flex space-x-4",children:i.jsx("button",{onClick:w,disabled:s,className:"px-6 py-3 bg-gray-100 hover:bg-gray-200 text-gray-900 font-medium rounded-lg transition-colors disabled:opacity-50",children:s?"Searching...":"MOCARDS Search"})})]}),(r||o||s)&&i.jsxs("div",{className:"max-w-4xl mx-auto px-6 pb-20",children:[s&&i.jsxs("div",{className:"dark-card p-8 text-center",children:[i.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-2 border-gray-600 border-t-blue-500 mx-auto mb-4"}),i.jsx("p",{className:"text-gray-300",children:"Searching MOCARDS registry..."})]}),r&&!s&&i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{className:"dark-card p-8",children:[i.jsxs("div",{className:"bg-gradient-to-r from-teal-600 to-teal-800 rounded-2xl p-6 text-white mb-6",children:[i.jsxs("div",{className:"flex justify-between items-start mb-6",children:[i.jsxs("div",{children:[i.jsx("h2",{className:"text-2xl font-bold",children:"MOCARDS"}),i.jsx("p",{className:"text-teal-100",children:"Philippines Dental Benefits Card"})]}),i.jsx("div",{className:`px-3 py-1 rounded-full text-sm font-medium ${r.status==="active"?"bg-green-400 text-green-900":"bg-red-400 text-red-900"}`,children:r.status==="active"?" ACTIVE":" INACTIVE"})]}),i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{children:[i.jsx("p",{className:"text-teal-200 text-sm",children:"Control Number"}),i.jsx("p",{className:"text-2xl font-mono font-bold",children:r.controlNumber})]}),i.jsxs("div",{className:"grid grid-cols-2 gap-6",children:[i.jsxs("div",{children:[i.jsx("p",{className:"text-teal-200 text-sm",children:"Cardholder Name"}),i.jsx("p",{className:"text-lg font-semibold",children:r.fullName})]}),i.jsxs("div",{children:[i.jsx("p",{className:"text-teal-200 text-sm",children:"Expires"}),i.jsx("p",{className:"text-lg font-semibold",children:mx(r.expiryDate)})]})]})]})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 text-gray-300",children:[i.jsxs("div",{className:"space-y-4",children:[i.jsx("h3",{className:"text-lg font-semibold text-white mb-4",children:"Cardholder Information"}),i.jsxs("div",{className:"flex items-center space-x-3",children:[i.jsx(ha,{className:"h-5 w-5 text-gray-400"}),i.jsxs("div",{children:[i.jsx("p",{className:"text-xs text-gray-400",children:"Full Name"}),i.jsx("p",{className:"text-white",children:r.fullName})]})]}),i.jsxs("div",{className:"flex items-center space-x-3",children:[i.jsx(Ht,{className:"h-5 w-5 text-gray-400"}),i.jsxs("div",{children:[i.jsx("p",{className:"text-xs text-gray-400",children:"Assigned Clinic"}),i.jsx("p",{className:"text-white",children:p(r.clinicId)})]})]}),i.jsxs("div",{className:"flex items-center space-x-3",children:[i.jsx(mt,{className:"h-5 w-5 text-gray-400"}),i.jsxs("div",{children:[i.jsx("p",{className:"text-xs text-gray-400",children:"Card Status"}),i.jsx("p",{className:`capitalize ${r.status==="active"?"text-green-400":"text-red-400"}`,children:r.status})]})]})]}),i.jsxs("div",{className:"space-y-4",children:[i.jsx("h3",{className:"text-lg font-semibold text-white mb-4",children:"Dental Benefits"}),i.jsxs("div",{className:"flex items-center space-x-3",children:[i.jsx(dr,{className:"h-5 w-5 text-gray-400"}),i.jsxs("div",{children:[i.jsx("p",{className:"text-xs text-gray-400",children:"Total Perks"}),i.jsxs("p",{className:"text-white",children:[r.perksTotal," benefits"]})]})]}),i.jsxs("div",{className:"flex items-center space-x-3",children:[i.jsx(dr,{className:"h-5 w-5 text-gray-400"}),i.jsxs("div",{children:[i.jsx("p",{className:"text-xs text-gray-400",children:"Used Perks"}),i.jsxs("p",{className:"text-white",children:[r.perksUsed," utilized"]})]})]}),i.jsxs("div",{className:"flex items-center space-x-3",children:[i.jsx(dr,{className:"h-5 w-5 text-gray-400"}),i.jsxs("div",{children:[i.jsx("p",{className:"text-xs text-gray-400",children:"Available Perks"}),i.jsxs("p",{className:"text-green-400 font-semibold",children:[r.perksTotal-r.perksUsed," remaining"]})]})]}),i.jsxs("div",{className:"mt-4",children:[i.jsxs("div",{className:"flex justify-between text-xs text-gray-400 mb-1",children:[i.jsx("span",{children:"Benefits Usage"}),i.jsxs("span",{children:[r.perksUsed,"/",r.perksTotal]})]}),i.jsx("div",{className:"w-full bg-gray-700 rounded-full h-2",children:i.jsx("div",{className:"bg-gradient-to-r from-teal-500 to-teal-600 h-2 rounded-full transition-all duration-300",style:{width:`${r.perksUsed/r.perksTotal*100}%`}})})]})]})]})]}),r.status==="active"&&i.jsxs("div",{className:"dark-card p-6",children:[i.jsxs("div",{className:"flex items-center justify-between mb-4",children:[i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx(mt,{className:"h-6 w-6 text-teal-400"}),i.jsx("h3",{className:"text-lg font-semibold text-white",children:"Schedule Appointment"})]}),!f&&i.jsxs("button",{onClick:g,className:"px-4 py-2 bg-teal-600 hover:bg-teal-700 text-white rounded-lg transition-colors flex items-center gap-2",children:[i.jsx(mt,{className:"h-4 w-4"}),"Request Appointment"]})]}),i.jsx("p",{className:"text-gray-300 text-sm mb-4",children:"Request an appointment directly with your assigned clinic to claim your dental benefits."}),f&&i.jsxs("div",{className:"space-y-4 border-t border-gray-600 pt-4",children:[i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Full Name *"}),i.jsx("input",{type:"text",value:d.patientName,onChange:j=>y(N=>({...N,patientName:j.target.value})),className:"w-full px-4 py-3 bg-gray-700 border border-gray-600 rounded-lg text-white focus:ring-2 focus:ring-teal-500 focus:border-transparent",placeholder:"Enter your full name"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Email Address *"}),i.jsxs("div",{className:"relative",children:[i.jsx(xl,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),i.jsx("input",{type:"email",value:d.patientEmail,onChange:j=>y(N=>({...N,patientEmail:j.target.value})),className:"w-full pl-10 pr-4 py-3 bg-gray-700 border border-gray-600 rounded-lg text-white focus:ring-2 focus:ring-teal-500 focus:border-transparent",placeholder:"your.email@example.com"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Phone Number"}),i.jsxs("div",{className:"relative",children:[i.jsx(ua,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),i.jsx("input",{type:"tel",value:d.patientPhone,onChange:j=>y(N=>({...N,patientPhone:j.target.value})),className:"w-full pl-10 pr-4 py-3 bg-gray-700 border border-gray-600 rounded-lg text-white focus:ring-2 focus:ring-teal-500 focus:border-transparent",placeholder:"+63917123456"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Service Type *"}),i.jsx("input",{type:"text",value:d.serviceType,onChange:j=>y(N=>({...N,serviceType:j.target.value})),className:"w-full px-4 py-3 bg-gray-700 border border-gray-600 rounded-lg text-white focus:ring-2 focus:ring-teal-500 focus:border-transparent",placeholder:"e.g., Dental Cleaning, Consultation"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Preferred Benefit"}),i.jsxs("select",{value:d.perkRequested,onChange:j=>y(N=>({...N,perkRequested:j.target.value})),className:"w-full px-4 py-3 bg-gray-700 border border-gray-600 rounded-lg text-white focus:ring-2 focus:ring-teal-500 focus:border-transparent",children:[i.jsx("option",{value:"",children:"Select a benefit (optional)"}),b.map(j=>i.jsx("option",{value:j.label,children:j.label},j.value))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Preferred Date *"}),i.jsxs("div",{className:"relative",children:[i.jsx(mt,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),i.jsx("input",{type:"date",value:d.preferredDate,onChange:j=>y(N=>({...N,preferredDate:j.target.value})),min:new Date().toISOString().split("T")[0],className:"w-full pl-10 pr-4 py-3 bg-gray-700 border border-gray-600 rounded-lg text-white focus:ring-2 focus:ring-teal-500 focus:border-transparent"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Preferred Time *"}),i.jsxs("div",{className:"relative",children:[i.jsx(Fs,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),i.jsx("input",{type:"time",value:d.preferredTime,onChange:j=>y(N=>({...N,preferredTime:j.target.value})),className:"w-full pl-10 pr-4 py-3 bg-gray-700 border border-gray-600 rounded-lg text-white focus:ring-2 focus:ring-teal-500 focus:border-transparent"})]})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Additional Notes"}),i.jsx("textarea",{value:d.notes,onChange:j=>y(N=>({...N,notes:j.target.value})),rows:3,className:"w-full px-4 py-3 bg-gray-700 border border-gray-600 rounded-lg text-white focus:ring-2 focus:ring-teal-500 focus:border-transparent",placeholder:"Any specific requests or health concerns..."})]}),i.jsxs("div",{className:"flex gap-3 pt-4",children:[i.jsxs("button",{onClick:v,className:"px-6 py-3 bg-teal-600 hover:bg-teal-700 text-white rounded-lg font-medium transition-colors flex items-center gap-2",children:[i.jsx(_l,{className:"h-4 w-4"}),"Submit Request"]}),i.jsx("button",{onClick:()=>m(!1),className:"px-6 py-3 bg-gray-600 hover:bg-gray-700 text-white rounded-lg font-medium transition-colors",children:"Cancel"})]}),i.jsx("div",{className:"bg-teal-900/30 border border-teal-600/50 rounded-lg p-4 mt-4",children:i.jsxs("div",{className:"flex items-start gap-3",children:[i.jsx(mt,{className:"h-5 w-5 text-teal-400 mt-0.5 flex-shrink-0"}),i.jsxs("div",{className:"text-sm",children:[i.jsx("p",{className:"text-teal-300 font-medium mb-1",children:"Next Steps:"}),i.jsxs("ol",{className:"text-teal-100 space-y-1",children:[i.jsxs("li",{children:["1. Request sent directly to ",r?p(r.clinicId):"your assigned clinic"]}),i.jsx("li",{children:"2. Clinic will review and process your request"}),i.jsx("li",{children:"3. Clinic will contact you within 24 hours to confirm, decline, or reschedule"})]})]})]})})]})]})]}),o&&!s&&i.jsxs("div",{className:"dark-card p-8 text-center",children:[i.jsx("div",{className:"w-16 h-16 bg-gray-700 rounded-full flex items-center justify-center mx-auto mb-4",children:i.jsx(Un,{className:"h-8 w-8 text-gray-400"})}),i.jsx("h3",{className:"text-xl font-semibold text-white mb-2",children:"No card found"}),i.jsxs("p",{className:"text-gray-300 mb-4",children:['No MOC card found with the number "',t,'"']}),i.jsx("button",{onClick:()=>{e(""),l(!1)},className:"px-6 py-2 bg-gray-600 hover:bg-gray-500 text-white rounded-lg transition-colors",children:"Try another search"})]})]})]})}const gx=15*60*1e3,Or="mocards_auth_session",ts="mocards_last_activity",Rc=()=>{const[t,e]=k.useState(!1),[r,n]=k.useState(null),s=k.useCallback(()=>{const c=Date.now();if(localStorage.setItem(ts,c.toString()),r){const u={...r,lastActivity:c};n(u),localStorage.setItem(Or,JSON.stringify(u))}},[r]),a=k.useCallback(c=>Date.now()-c.lastActivity<gx,[]),o=k.useCallback((c,u)=>{const f=Date.now(),m={type:c,username:u.username||u.code,clinicId:u.id,clinicCode:u.code,loginTime:f,lastActivity:f};n(m),e(!0),localStorage.setItem(Or,JSON.stringify(m)),localStorage.setItem(ts,f.toString()),window.dispatchEvent(new CustomEvent("auth-state-change",{detail:{type:"login",user:m}}))},[]),l=k.useCallback(()=>{n(null),e(!1),localStorage.removeItem(Or),localStorage.removeItem(ts),window.dispatchEvent(new CustomEvent("auth-state-change",{detail:{type:"logout"}}))},[]);return k.useEffect(()=>{(()=>{try{const m=localStorage.getItem(Or);if(m){const d=JSON.parse(m);a(d)?(n(d),e(!0),s()):(localStorage.removeItem(Or),localStorage.removeItem(ts))}}catch(m){console.error("Error checking session:",m),localStorage.removeItem(Or),localStorage.removeItem(ts)}})();const u=m=>{const{type:d,user:y}=m.detail;d==="login"&&y?(n(y),e(!0)):d==="logout"&&(n(null),e(!1))},f=m=>{if(m.key===Or)if(m.newValue)try{const d=JSON.parse(m.newValue);a(d)&&(n(d),e(!0))}catch(d){console.error("Error parsing stored user data:",d)}else n(null),e(!1)};return window.addEventListener("auth-state-change",u),window.addEventListener("storage",f),()=>{window.removeEventListener("auth-state-change",u),window.removeEventListener("storage",f)}},[a,s]),k.useEffect(()=>{if(!t||!r)return;const u=setInterval(()=>{r&&!a(r)&&l()},60*1e3);return()=>clearInterval(u)},[t,r,a,l]),k.useEffect(()=>{if(!t)return;const c=["mousedown","mousemove","keypress","scroll","touchstart","click"],u=()=>{s()};let f;const m=()=>{clearTimeout(f),f=setTimeout(u,1e3)};return c.forEach(d=>{document.addEventListener(d,m,!0)}),()=>{clearTimeout(f),c.forEach(d=>{document.removeEventListener(d,m,!0)})}},[t,s]),{isAuthenticated:t,user:r,login:o,logout:l,updateActivity:s}},hm=(t={})=>{const{enabled:e=!0,checkInterval:r=3e4,showNotifications:n=!0}=t,{addToast:s}=Er(),a=k.useRef(null),o=k.useRef(!1),l=async()=>{try{{const m=await(await fetch("/index.html",{cache:"no-cache",headers:{"Cache-Control":"no-cache"}})).text(),d=m.match(/<script[^>]*src="[^"]*assets[^"]*\.js"[^>]*>/),y=m.match(/<meta name="version" content="([^"]*)">/);return y?y[1]:d?d[0]:null}}catch(f){return console.warn("Failed to check for app updates:",f),null}},c=async()=>{if(!(o.current||!e)){o.current=!0;try{const f=await l();if(f&&a.current){if(f!==a.current){n&&s(Pe("App Updated","A new version is available. The page will refresh automatically.")),setTimeout(()=>{window.location.reload()},2e3);return}}else f&&!a.current&&(a.current=f)}catch(f){console.warn("Update check failed:",f)}finally{o.current=!1}}};return k.useEffect(()=>{if(!e)return;l().then(y=>{a.current=y});const f=setInterval(c,r),m=()=>{document.hidden||setTimeout(c,1e3)};document.addEventListener("visibilitychange",m);const d=()=>{setTimeout(c,1e3)};return window.addEventListener("online",d),()=>{clearInterval(f),document.removeEventListener("visibilitychange",m),window.removeEventListener("online",d)}},[e,r,n]),{forceRefresh:()=>{n&&s(ee("Refreshing","Updating to the latest version...")),setTimeout(()=>{window.location.reload()},500)},checkForUpdates:c}};function yx(){const{isAuthenticated:t,user:e,login:r,logout:n}=Rc();hm({enabled:!0,showNotifications:!0});const[s,a]=k.useState(null),[o,l]=k.useState({code:"",password:""}),[c,u]=k.useState(!1),[f,m]=k.useState(null),[d,y]=k.useState(""),[x,w]=k.useState("dashboard"),[C,p]=k.useState([]),[g,v]=k.useState([]),[b,j]=k.useState(null),[N,S]=k.useState(!1),[P,W]=k.useState([]),[q,V]=k.useState([]),[pe,Tt]=k.useState(0),[Zt,Ie]=k.useState(!0),[je,xt]=k.useState(null),[T,$]=k.useState({preferredDate:"",preferredTime:"",serviceType:"",clinicNotes:"",patientPhone:"",patientEmail:""}),[B,X]=k.useState(!1),[G,Ne]=k.useState({currentPassword:"",newPassword:"",confirmPassword:""}),{addToast:ne}=Er();k.useEffect(()=>{(async()=>{if(t&&e&&e.type==="clinic"&&e.clinicId&&!s)try{const R=await Ke.getById(e.clinicId);R?a(R):console.error("Clinic not found for ID:",e.clinicId)}catch(R){console.error("Failed to load clinic:",R)}})()},[t,e,s]),k.useEffect(()=>{(async()=>{if(s)try{Ie(!0);const Z=(await Mi.getByClinicId(s.id)).map(De=>({id:De.id,cardControlNumber:De.cardControlNumber,patientName:De.patientName,patientEmail:De.patientEmail,patientPhone:De.patientPhone,preferredDate:De.preferredDate,preferredTime:De.preferredTime,serviceType:De.serviceType,perkRequested:De.perkRequested||"",status:De.status,adminNotes:De.notes,clinicNotes:"",forwardedAt:De.createdAt,processedAt:void 0}));p(Z);const xe=await Ad.getByClinicId(s.id);v(xe);const er=await Ft.getByClinicId(s.id);W(er);const Rt=await lr.getAll();V(Rt);const Vn=await Ke.getPlanLimit(s.id);Tt(Vn)}catch(R){console.error("Failed to load clinic data:",R)}finally{Ie(!1)}})()},[s]);const Ce=async(_,R)=>{await Mi.updateStatus(_,"accepted"),p(Z=>Z.map(xe=>xe.id===_?{...xe,status:"accepted",clinicNotes:R||"",processedAt:new Date().toISOString()}:xe)),ne(ee("Appointment Accepted","Patient will be notified of the confirmation"))},ct=async(_,R)=>{await Mi.updateStatus(_,"declined"),p(Z=>Z.map(xe=>xe.id===_?{...xe,status:"declined",clinicNotes:R,processedAt:new Date().toISOString()}:xe)),ne(Pe("Appointment Declined","Patient will be notified with the reason"))},Fe=(_,R,Z,xe)=>{p(er=>er.map(Rt=>Rt.id===_?{...Rt,status:"rescheduled",preferredDate:R,preferredTime:Z,clinicNotes:xe||"Rescheduled by clinic",processedAt:new Date().toISOString()}:Rt)),ne(ee("Appointment Rescheduled","Patient will be contacted with new schedule"))},ei=_=>{const R=C.find(Z=>Z.id===_);R&&($({preferredDate:R.preferredDate,preferredTime:R.preferredTime,serviceType:R.serviceType,clinicNotes:R.clinicNotes||"",patientPhone:R.patientPhone,patientEmail:R.patientEmail}),xt(_))},Bn=_=>{p(R=>R.map(Z=>Z.id===_?{...Z,preferredDate:T.preferredDate,preferredTime:T.preferredTime,serviceType:T.serviceType,clinicNotes:T.clinicNotes,patientPhone:T.patientPhone,patientEmail:T.patientEmail}:Z)),xt(null),ne(ee("Appointment Updated","Appointment details have been updated"))},ti=_=>{window.confirm("Are you sure you want to delete this appointment? This action cannot be undone.")&&(p(R=>R.filter(Z=>Z.id!==_)),ne(ee("Appointment Deleted","Appointment has been removed")))},$a=async _=>{_.preventDefault();const R=await Ke.authenticate(o.code,o.password);R?(a(R),r("clinic",R),ne(ee("Welcome",`Logged in to ${R.name}`))):ne(Q("Login Failed","Invalid clinic code or password"))},ri=()=>{n(),a(null),l({code:"",password:""})},qn=async _=>{if(_.preventDefault(),!s)return;if(G.currentPassword!==s.password){ne(Q("Invalid Password","Current password is incorrect"));return}if(G.newPassword.length<8){ne(Q("Password Too Short","New password must be at least 8 characters long"));return}if(G.newPassword!==G.confirmPassword){ne(Q("Passwords Do Not Match","Please confirm your new password correctly"));return}const R={...s,password:G.newPassword};await Ke.update(s.id,{password:G.newPassword}),a(R),Ne({currentPassword:"",newPassword:"",confirmPassword:""}),X(!1),ne(ee("Password Changed","Your clinic password has been updated successfully"))},La=async _=>{if(_.preventDefault(),!f||!d||!s)return;const R=P.find(Tr=>Tr.controlNumber===f),Z=q.find(Tr=>Tr.id===d);if(!R||!Z){ne(Q("Error","Card or perk not found"));return}if(R.perksUsed>=R.perksTotal){ne(Q("No Perks Available","This card has no available perks to redeem"));return}const xe=prompt("Patient name (claimant):"),er=prompt("Staff member handling this redemption:"),Rt=prompt("Service type provided:"),Vn=prompt("Additional notes (optional):");if(!xe||!er||!Rt){ne(Q("Missing Information","Please provide all required details for tracking"));return}const De=await Ad.create({cardControlNumber:f,perkId:d,perkName:Z.name,clinicId:s.id,claimantName:xe,handledBy:er,serviceType:Rt,usedAt:new Date().toISOString(),value:Z.value||0,notes:Vn||void 0});await Ft.updatePerks(f,R.perksUsed+1),v(Tr=>[...Tr,De]),u(!1),m(null),y(""),ne(ee("Perk Redeemed",`${Z.name} has been successfully redeemed and tracked for ${xe}`))};if(!t)return i.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:i.jsxs("div",{className:"light-card p-8 w-full max-w-md",children:[i.jsxs("div",{className:"text-center mb-8",children:[i.jsx("div",{className:"w-16 h-16 bg-blue-100 rounded-2xl flex items-center justify-center mx-auto mb-4",children:i.jsx(_n,{className:"h-8 w-8 text-blue-600"})}),i.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Clinic Portal Login"}),i.jsx("p",{className:"text-gray-600",children:"Please authenticate with your clinic credentials"})]}),i.jsxs("form",{onSubmit:$a,className:"space-y-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Clinic Code"}),i.jsx("input",{type:"text",value:o.code,onChange:_=>l({...o,code:_.target.value}),className:"light-input",placeholder:"Enter clinic code (e.g., CVT001)",required:!0})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Password"}),i.jsx("input",{type:"password",value:o.password,onChange:_=>l({...o,password:_.target.value}),className:"light-input",placeholder:"Enter clinic password",required:!0})]}),i.jsxs("button",{type:"submit",className:"light-button-primary w-full flex items-center justify-center",children:[i.jsx(h0,{className:"h-4 w-4 mr-2"}),"Access Clinic Portal"]})]})]})});if(!s)return i.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:i.jsxs("div",{className:"light-card p-8 w-full max-w-md text-center",children:[i.jsx("div",{className:"w-16 h-16 bg-blue-100 rounded-2xl flex items-center justify-center mx-auto mb-4",children:i.jsx(_n,{className:"h-8 w-8 text-blue-600"})}),i.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-2 border-blue-200 border-t-blue-600 mx-auto mb-4"}),i.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Loading Clinic Portal"}),i.jsx("p",{className:"text-gray-600",children:"Please wait while we load your clinic information..."})]})});if(Zt)return i.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:i.jsxs("div",{className:"light-card p-8 w-full max-w-md text-center",children:[i.jsx("div",{className:"w-16 h-16 bg-blue-100 rounded-2xl flex items-center justify-center mx-auto mb-4",children:i.jsx(_n,{className:"h-8 w-8 text-blue-600"})}),i.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-2 border-blue-200 border-t-blue-600 mx-auto mb-4"}),i.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Loading Clinic Data"}),i.jsx("p",{className:"text-gray-600",children:"Please wait while we load your cards, appointments, and redemption history..."})]})});const ut=P,ni=ut.filter(_=>_.status==="active"),le=pe>0?ut.length/pe*100:0,Pt=C.filter(_=>_.status==="pending"),dt=[],Ar=[{id:"dashboard",name:"Dashboard",icon:r0},{id:"appointments",name:`Appointments (${Pt.length})`,icon:mt},{id:"perks",name:"Perk History",icon:dr},{id:"cards",name:"Assigned Cards",icon:vs},{id:"settings",name:"Settings",icon:da}];return i.jsxs("div",{className:"min-h-screen bg-gray-50",children:[i.jsx("div",{className:"light-card mb-6",children:i.jsx("div",{className:"p-6",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{className:"flex items-center space-x-4",children:[i.jsx("div",{className:"w-12 h-12 bg-blue-100 rounded-2xl flex items-center justify-center",children:i.jsx(_n,{className:"h-6 w-6 text-blue-600"})}),i.jsxs("div",{children:[i.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:s.name}),i.jsxs("p",{className:"text-gray-600",children:[s.address,"  ",s.code]})]})]}),i.jsxs("button",{onClick:ri,className:"light-button-secondary flex items-center space-x-2",children:[i.jsx(da,{className:"h-4 w-4"}),i.jsx("span",{children:"Logout"})]})]})})}),i.jsx("div",{className:"light-card mb-6",children:i.jsx("div",{className:"p-2",children:i.jsx("div",{className:"flex space-x-2",children:Ar.map(_=>{const R=_.icon;return i.jsxs("button",{onClick:()=>w(_.id),className:`flex items-center space-x-2 px-4 py-3 rounded-xl font-medium transition-colors ${x===_.id?"bg-blue-100 text-blue-700":"text-gray-600 hover:bg-gray-100"}`,children:[i.jsx(R,{className:"h-4 w-4"}),i.jsx("span",{children:_.name})]},_.id)})})})}),x==="dashboard"&&i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"light-card mb-6",children:i.jsxs("div",{className:"p-6",children:[i.jsxs("div",{className:"flex items-center justify-between mb-4",children:[i.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Subscription Status"}),i.jsxs("span",{className:`plan-${s.plan} capitalize`,children:[s.plan," Plan"]})]}),i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{className:"flex justify-between text-sm",children:[i.jsx("span",{className:"text-gray-600",children:"Cards Assigned"}),i.jsxs("span",{className:"font-medium",children:[ut.length," / ",pe]})]}),i.jsx("div",{className:"w-full bg-gray-200 rounded-full h-3",children:i.jsx("div",{className:`h-3 rounded-full transition-all duration-300 ${le>90?"bg-red-500":le>70?"bg-yellow-500":"bg-green-500"}`,style:{width:`${Math.min(le,100)}%`}})}),i.jsxs("div",{className:"grid grid-cols-3 gap-4 text-center",children:[i.jsxs("div",{children:[i.jsx("p",{className:"text-2xl font-bold text-gray-900",children:ut.length}),i.jsx("p",{className:"text-xs text-gray-600",children:"Total Cards"})]}),i.jsxs("div",{children:[i.jsx("p",{className:"text-2xl font-bold text-green-600",children:ni.length}),i.jsx("p",{className:"text-xs text-gray-600",children:"Active Cards"})]}),i.jsxs("div",{children:[i.jsx("p",{className:"text-2xl font-bold text-gray-400",children:ut.length-ni.length}),i.jsx("p",{className:"text-xs text-gray-600",children:"Inactive Cards"})]})]})]})]})}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-6",children:[i.jsx("div",{className:"light-stat-card",children:i.jsxs("div",{className:"flex items-center space-x-4",children:[i.jsx("div",{className:"w-12 h-12 bg-blue-100 rounded-2xl flex items-center justify-center",children:i.jsx(vs,{className:"h-6 w-6 text-blue-600"})}),i.jsxs("div",{children:[i.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Today's Patients"}),i.jsx("p",{className:"text-2xl font-bold text-gray-900",children:C.filter(_=>new Date(_.preferredDate).toDateString()===new Date().toDateString()).length})]})]})}),i.jsx("div",{className:"light-stat-card",children:i.jsxs("div",{className:"flex items-center space-x-4",children:[i.jsx("div",{className:"w-12 h-12 bg-yellow-100 rounded-2xl flex items-center justify-center",children:i.jsx(Fs,{className:"h-6 w-6 text-yellow-600"})}),i.jsxs("div",{children:[i.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Pending Appointments"}),i.jsx("p",{className:"text-2xl font-bold text-gray-900",children:Pt.length})]})]})}),i.jsx("div",{className:"light-stat-card",children:i.jsxs("div",{className:"flex items-center space-x-4",children:[i.jsx("div",{className:"w-12 h-12 bg-green-100 rounded-2xl flex items-center justify-center",children:i.jsx(dr,{className:"h-6 w-6 text-green-600"})}),i.jsxs("div",{children:[i.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Pending Perks"}),i.jsx("p",{className:"text-2xl font-bold text-gray-900",children:dt.length})]})]})})]})]}),x==="appointments"&&i.jsx("div",{className:"light-card",children:i.jsxs("div",{className:"p-6",children:[i.jsxs("div",{className:"flex items-center justify-between mb-6",children:[i.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Appointment Requests"}),i.jsxs("span",{className:"text-sm text-gray-600",children:[C.length," total requests"]})]}),C.length===0?i.jsxs("div",{className:"text-center py-12",children:[i.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:i.jsx(mt,{className:"h-8 w-8 text-gray-400"})}),i.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No Appointment Requests"}),i.jsx("p",{className:"text-gray-600",children:"No appointment requests have been forwarded to your clinic yet."})]}):i.jsx("div",{className:"space-y-4",children:C.map(_=>i.jsxs("div",{className:"border border-gray-200 rounded-xl p-6",children:[i.jsxs("div",{className:"flex items-start justify-between mb-4",children:[i.jsxs("div",{className:"flex items-center space-x-3",children:[i.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center",children:i.jsx(ha,{className:"h-5 w-5 text-blue-600"})}),i.jsxs("div",{children:[i.jsx("h3",{className:"font-medium text-gray-900",children:_.patientName}),i.jsx("p",{className:"text-sm text-gray-600",children:_.cardControlNumber})]})]}),i.jsx("span",{className:`px-3 py-1 rounded-full text-sm font-medium ${_.status==="pending"?"bg-yellow-100 text-yellow-800":_.status==="accepted"?"bg-green-100 text-green-800":_.status==="declined"?"bg-red-100 text-red-800":"bg-blue-100 text-blue-800"}`,children:_.status})]}),i.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-4 mb-4",children:[i.jsxs("div",{children:[i.jsx("p",{className:"text-sm text-gray-600",children:"Preferred Date"}),je===_.id?i.jsx("input",{type:"date",value:T.preferredDate,onChange:R=>$({...T,preferredDate:R.target.value}),className:"light-input text-sm mt-1"}):i.jsx("p",{className:"font-medium",children:new Date(_.preferredDate).toLocaleDateString()})]}),i.jsxs("div",{children:[i.jsx("p",{className:"text-sm text-gray-600",children:"Preferred Time"}),je===_.id?i.jsx("input",{type:"time",value:T.preferredTime,onChange:R=>$({...T,preferredTime:R.target.value}),className:"light-input text-sm mt-1"}):i.jsx("p",{className:"font-medium",children:_.preferredTime})]}),i.jsxs("div",{children:[i.jsx("p",{className:"text-sm text-gray-600",children:"Service"}),je===_.id?i.jsx("input",{type:"text",value:T.serviceType,onChange:R=>$({...T,serviceType:R.target.value}),className:"light-input text-sm mt-1"}):i.jsx("p",{className:"font-medium",children:_.serviceType})]}),i.jsxs("div",{children:[i.jsx("p",{className:"text-sm text-gray-600",children:"Contact"}),je===_.id?i.jsx("input",{type:"tel",value:T.patientPhone,onChange:R=>$({...T,patientPhone:R.target.value}),className:"light-input text-sm mt-1"}):i.jsx("p",{className:"font-medium",children:_.patientPhone})]}),i.jsxs("div",{children:[i.jsx("p",{className:"text-sm text-gray-600",children:"Email"}),je===_.id?i.jsx("input",{type:"email",value:T.patientEmail,onChange:R=>$({...T,patientEmail:R.target.value}),className:"light-input text-sm mt-1"}):i.jsx("p",{className:"font-medium",children:_.patientEmail})]}),i.jsxs("div",{children:[i.jsx("p",{className:"text-sm text-gray-600",children:"Perk"}),i.jsx("p",{className:"font-medium",children:_.perkRequested})]})]}),_.adminNotes&&i.jsx("div",{className:"bg-blue-50 p-3 rounded-lg mb-4",children:i.jsxs("p",{className:"text-sm text-blue-800",children:[i.jsx("strong",{children:"Admin Notes:"})," ",_.adminNotes]})}),(_.clinicNotes||je===_.id)&&i.jsx("div",{className:"bg-gray-50 p-3 rounded-lg mb-4",children:je===_.id?i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Clinic Notes:"}),i.jsx("textarea",{value:T.clinicNotes,onChange:R=>$({...T,clinicNotes:R.target.value}),placeholder:"Add clinic notes...",className:"light-input text-sm resize-none",rows:2})]}):i.jsxs("p",{className:"text-sm text-gray-700",children:[i.jsx("strong",{children:"Clinic Notes:"})," ",_.clinicNotes]})}),i.jsxs("div",{className:"flex flex-wrap gap-2",children:[_.status==="pending"&&i.jsxs(i.Fragment,{children:[i.jsxs("button",{onClick:async()=>{const R=prompt("Add any notes for the patient (optional):");await Ce(_.id,R||void 0)},className:"flex items-center space-x-2 px-4 py-2 bg-green-100 text-green-700 rounded-lg hover:bg-green-200 transition-colors",children:[i.jsx(vl,{className:"h-4 w-4"}),i.jsx("span",{children:"Accept"})]}),i.jsxs("button",{onClick:async()=>{const R=prompt("Please provide a reason for declining:");R&&await ct(_.id,R)},className:"flex items-center space-x-2 px-4 py-2 bg-red-100 text-red-700 rounded-lg hover:bg-red-200 transition-colors",children:[i.jsx(Hf,{className:"h-4 w-4"}),i.jsx("span",{children:"Decline"})]}),i.jsxs("button",{onClick:()=>{const R=prompt("New preferred date (YYYY-MM-DD):"),Z=prompt("New preferred time (HH:MM):"),xe=prompt("Notes for the patient:");R&&Z&&Fe(_.id,R,Z,xe||void 0)},className:"flex items-center space-x-2 px-4 py-2 bg-blue-100 text-blue-700 rounded-lg hover:bg-blue-200 transition-colors",children:[i.jsx(mt,{className:"h-4 w-4"}),i.jsx("span",{children:"Reschedule"})]}),i.jsxs("a",{href:`tel:${_.patientPhone}`,className:"flex items-center space-x-2 px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors",children:[i.jsx(ua,{className:"h-4 w-4"}),i.jsx("span",{children:"Call Patient"})]})]}),je===_.id?i.jsxs(i.Fragment,{children:[i.jsx("button",{onClick:()=>Bn(_.id),className:"flex items-center space-x-2 px-3 py-1 bg-green-100 text-green-700 rounded-lg hover:bg-green-200 transition-colors",title:"Save changes",children:i.jsx(wl,{className:"h-4 w-4"})}),i.jsx("button",{onClick:()=>xt(null),className:"flex items-center space-x-2 px-3 py-1 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors",title:"Cancel",children:i.jsx(tt,{className:"h-4 w-4"})})]}):i.jsxs(i.Fragment,{children:[i.jsx("button",{onClick:()=>ei(_.id),className:"flex items-center space-x-2 px-3 py-1 bg-blue-100 text-blue-700 rounded-lg hover:bg-blue-200 transition-colors",title:"Edit appointment",children:i.jsx(as,{className:"h-4 w-4"})}),i.jsx("button",{onClick:()=>ti(_.id),className:"flex items-center space-x-2 px-3 py-1 bg-red-100 text-red-700 rounded-lg hover:bg-red-200 transition-colors",title:"Delete appointment",children:i.jsx(os,{className:"h-4 w-4"})})]})]}),i.jsxs("div",{className:"text-xs text-gray-500 mt-4",children:["Forwarded: ",new Date(_.forwardedAt).toLocaleString(),_.processedAt&&i.jsxs("span",{children:["  Processed: ",new Date(_.processedAt).toLocaleString()]})]})]},_.id))})]})}),x==="perks"&&i.jsx("div",{className:"light-card",children:i.jsxs("div",{className:"p-6",children:[i.jsxs("div",{className:"flex items-center justify-between mb-6",children:[i.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Perk Redemption History"}),i.jsxs("span",{className:"text-sm text-gray-600",children:[g.length," total redemptions"]})]}),g.length===0?i.jsxs("div",{className:"text-center py-12",children:[i.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:i.jsx(dr,{className:"h-8 w-8 text-gray-400"})}),i.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No Perk Redemptions"}),i.jsx("p",{className:"text-gray-600",children:"No perks have been redeemed at this clinic yet."})]}):i.jsx("div",{className:"space-y-4",children:g.map(_=>i.jsxs("div",{className:"border border-gray-200 rounded-xl p-6 bg-green-50",children:[i.jsxs("div",{className:"flex items-start justify-between mb-4",children:[i.jsxs("div",{className:"flex items-center space-x-3",children:[i.jsx("div",{className:"w-10 h-10 bg-green-100 rounded-full flex items-center justify-center",children:i.jsx(dr,{className:"h-5 w-5 text-green-600"})}),i.jsxs("div",{children:[i.jsx("h3",{className:"font-medium text-gray-900",children:_.claimantName}),i.jsx("p",{className:"text-sm text-gray-600",children:_.cardControlNumber})]})]}),i.jsx("span",{className:"px-3 py-1 rounded-full text-sm font-medium bg-green-100 text-green-800",children:"Redeemed"})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 text-sm mb-4",children:[i.jsxs("div",{children:[i.jsx("span",{className:"text-gray-600 font-medium",children:"Perk:"}),i.jsx("p",{className:"text-gray-900 mt-1",children:_.perkName})]}),i.jsxs("div",{children:[i.jsx("span",{className:"text-gray-600 font-medium",children:"Service Type:"}),i.jsx("p",{className:"text-gray-900 mt-1",children:_.serviceType})]}),i.jsxs("div",{children:[i.jsx("span",{className:"text-gray-600 font-medium",children:"Handled By:"}),i.jsx("p",{className:"text-gray-900 mt-1",children:_.handledBy})]}),i.jsxs("div",{children:[i.jsx("span",{className:"text-gray-600 font-medium",children:"Value:"}),i.jsxs("p",{className:"text-gray-900 mt-1",children:["",_.value.toFixed(2)]})]})]}),_.notes&&i.jsxs("div",{className:"bg-blue-50 p-3 rounded-lg mb-4",children:[i.jsx("span",{className:"text-blue-800 font-medium text-sm",children:"Notes:"}),i.jsx("p",{className:"text-blue-700 text-sm mt-1",children:_.notes})]}),i.jsxs("div",{className:"text-xs text-gray-500 mt-4",children:["Redeemed: ",new Date(_.usedAt).toLocaleString("en-PH")]})]},_.id))})]})}),x==="cards"&&i.jsx("div",{className:"light-card",children:i.jsxs("div",{className:"p-6",children:[i.jsxs("div",{className:"flex items-center justify-between mb-6",children:[i.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Assigned Cards"}),i.jsxs("span",{className:"text-sm text-gray-600",children:[ut.length," cards assigned to this clinic"]})]}),ut.length===0?i.jsxs("div",{className:"text-center py-12",children:[i.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:i.jsx(vs,{className:"h-8 w-8 text-gray-400"})}),i.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No Cards Assigned"}),i.jsx("p",{className:"text-gray-600",children:"No MOC cards have been assigned to your clinic yet. Contact the administrator to get cards assigned."})]}):i.jsx("div",{className:"light-table",children:i.jsxs("table",{className:"w-full",children:[i.jsx("thead",{className:"light-table-header",children:i.jsxs("tr",{children:[i.jsx("th",{className:"text-left p-4",children:"Control Number"}),i.jsx("th",{className:"text-left p-4",children:"Patient Name"}),i.jsx("th",{className:"text-left p-4",children:"Status"}),i.jsx("th",{className:"text-left p-4",children:"Perks Available"}),i.jsx("th",{className:"text-left p-4",children:"Expiry"}),i.jsx("th",{className:"text-left p-4",children:"Actions"})]})}),i.jsx("tbody",{children:ut.map(_=>i.jsxs("tr",{className:"light-table-row",children:[i.jsx("td",{className:"p-4 font-mono text-sm",children:_.controlNumber}),i.jsx("td",{className:"p-4",children:i.jsxs("div",{className:"flex items-center space-x-3",children:[i.jsx("div",{className:"w-8 h-8 bg-gray-200 rounded-full flex items-center justify-center",children:i.jsx(ha,{className:"h-4 w-4 text-gray-600"})}),i.jsx("span",{className:"font-medium",children:_.fullName})]})}),i.jsx("td",{className:"p-4",children:i.jsx("span",{className:_.status==="active"?"status-active":"status-inactive",children:_.status})}),i.jsx("td",{className:"p-4",children:i.jsxs("div",{className:"flex items-center space-x-2",children:[i.jsx("div",{className:"w-16 bg-gray-200 rounded-full h-2",children:i.jsx("div",{className:"bg-blue-500 h-2 rounded-full",style:{width:`${(_.perksTotal-_.perksUsed)/_.perksTotal*100}%`}})}),i.jsxs("span",{className:"text-sm text-gray-600",children:[_.perksTotal-_.perksUsed,"/",_.perksTotal]})]})}),i.jsx("td",{className:"p-4 text-gray-600",children:new Date(_.expiryDate).toLocaleDateString()}),i.jsx("td",{className:"p-4",children:i.jsxs("div",{className:"flex gap-2",children:[i.jsxs("button",{onClick:()=>{m(_.controlNumber),u(!0)},disabled:_.perksUsed>=_.perksTotal,className:"btn-primary text-sm px-3 py-1 disabled:opacity-50 disabled:cursor-not-allowed",children:[i.jsx(ho,{className:"h-4 w-4 mr-1"}),"Redeem Perk"]}),i.jsx("button",{onClick:()=>{j(_.controlNumber),S(!0)},className:"light-button-secondary text-sm px-3 py-1",title:"View perk redemption history",children:"History"})]})})]},_.controlNumber))})]})})]})}),x==="settings"&&i.jsx("div",{className:"light-card",children:i.jsxs("div",{className:"p-6",children:[i.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-6",children:"Clinic Settings"}),i.jsxs("div",{className:"mb-8",children:[i.jsxs("div",{className:"flex items-center justify-between mb-4",children:[i.jsxs("div",{children:[i.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Password Management"}),i.jsx("p",{className:"text-sm text-gray-600",children:"Change your clinic password for security"})]}),i.jsx("button",{onClick:()=>X(!B),className:"light-button-primary",children:"Change Password"})]}),B&&i.jsx("div",{className:"border-t border-gray-200 pt-4",children:i.jsxs("form",{onSubmit:qn,className:"space-y-4 max-w-md",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Current Password"}),i.jsx("input",{type:"password",value:G.currentPassword,onChange:_=>Ne({...G,currentPassword:_.target.value}),className:"light-input",placeholder:"Enter current password",required:!0})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"New Password"}),i.jsx("input",{type:"password",value:G.newPassword,onChange:_=>Ne({...G,newPassword:_.target.value}),className:"light-input",placeholder:"Enter new password (min 8 characters)",minLength:8,required:!0})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Confirm New Password"}),i.jsx("input",{type:"password",value:G.confirmPassword,onChange:_=>Ne({...G,confirmPassword:_.target.value}),className:"light-input",placeholder:"Confirm new password",required:!0})]}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx("button",{type:"submit",className:"light-button-primary",children:"Update Password"}),i.jsx("button",{type:"button",onClick:()=>{X(!1),Ne({currentPassword:"",newPassword:"",confirmPassword:""})},className:"light-button-secondary",children:"Cancel"})]})]})})]}),i.jsxs("div",{className:"border-t border-gray-200 pt-6",children:[i.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Clinic Information"}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",children:[i.jsxs("div",{children:[i.jsx("span",{className:"font-medium text-gray-700",children:"Clinic Name:"}),i.jsx("span",{className:"ml-2 text-gray-600",children:s.name})]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-medium text-gray-700",children:"Clinic Code:"}),i.jsx("span",{className:"ml-2 text-gray-600",children:s.code})]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-medium text-gray-700",children:"Plan:"}),i.jsx("span",{className:"ml-2 text-gray-600 capitalize",children:s.plan})]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-medium text-gray-700",children:"Region:"}),i.jsx("span",{className:"ml-2 text-gray-600",children:s.region})]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-medium text-gray-700",children:"Email:"}),i.jsx("span",{className:"ml-2 text-gray-600",children:s.email})]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-medium text-gray-700",children:"Contact:"}),i.jsx("span",{className:"ml-2 text-gray-600",children:s.contactNumber})]}),i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("span",{className:"font-medium text-gray-700",children:"Address:"}),i.jsx("span",{className:"ml-2 text-gray-600",children:s.address})]})]})]}),i.jsxs("div",{className:"border-t border-gray-200 pt-6 mt-6",children:[i.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Support"}),i.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg",children:[i.jsxs("p",{className:"text-sm text-gray-700",children:[i.jsx("strong",{children:"Need Help?"})," Contact MOCARDS support at"," ",i.jsx("a",{href:"mailto:admin@mocards.cloud",className:"text-blue-600 hover:text-blue-700",children:"admin@mocards.cloud"})]}),i.jsx("p",{className:"text-xs text-gray-500 mt-2",children:"For password reset assistance, please include your clinic code and name in your message."})]})]})]})}),c&&i.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:i.jsx("div",{className:"bg-white rounded-xl shadow-xl w-full max-w-md mx-4",children:i.jsxs("div",{className:"p-6",children:[i.jsxs("div",{className:"flex items-center justify-between mb-6",children:[i.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Redeem Perk"}),i.jsx("button",{onClick:()=>{u(!1),m(null),y("")},className:"text-gray-400 hover:text-gray-600",children:i.jsx(tt,{className:"h-6 w-6"})})]}),i.jsxs("form",{onSubmit:La,className:"space-y-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Card Control Number"}),i.jsx("input",{type:"text",value:f||"",disabled:!0,className:"light-input bg-gray-50"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Select Perk to Redeem"}),i.jsxs("select",{value:d,onChange:_=>y(_.target.value),className:"light-select",required:!0,children:[i.jsx("option",{value:"",children:"Choose a perk..."}),q.filter(_=>_.isActive).map(_=>i.jsxs("option",{value:_.id,children:[_.name," - ",_.description]},_.id))]})]}),i.jsxs("div",{className:"flex gap-3 pt-4",children:[i.jsxs("button",{type:"submit",className:"btn-primary flex-1",disabled:!d,children:[i.jsx(ho,{className:"h-4 w-4 mr-2"}),"Redeem Perk"]}),i.jsx("button",{type:"button",onClick:()=>{u(!1),m(null),y("")},className:"btn-secondary",children:"Cancel"})]})]})]})})}),N&&b&&i.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:i.jsxs("div",{className:"bg-white rounded-xl shadow-xl w-full max-w-4xl mx-4 max-h-[90vh] overflow-hidden",children:[i.jsx("div",{className:"p-6 border-b border-gray-200",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Perk Redemption History"}),i.jsxs("p",{className:"text-sm text-gray-600",children:["Card: ",b]})]}),i.jsx("button",{onClick:()=>{S(!1),j(null)},className:"text-gray-400 hover:text-gray-600",children:i.jsx(tt,{className:"h-6 w-6"})})]})}),i.jsx("div",{className:"p-6 overflow-y-auto max-h-[70vh]",children:(()=>{const _=g.filter(R=>R.cardControlNumber===b);return _.length===0?i.jsxs("div",{className:"text-center py-12",children:[i.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:i.jsx(dr,{className:"h-8 w-8 text-gray-400"})}),i.jsx("h4",{className:"text-lg font-medium text-gray-900 mb-2",children:"No Redemption History"}),i.jsx("p",{className:"text-gray-600",children:"This card has not been used to redeem any perks yet."})]}):i.jsxs("div",{className:"space-y-4",children:[_.map((R,Z)=>i.jsxs("div",{className:"border border-gray-200 rounded-xl p-6 bg-gray-50",children:[i.jsxs("div",{className:"flex items-start justify-between mb-4",children:[i.jsxs("div",{className:"flex items-center space-x-3",children:[i.jsx("div",{className:"w-8 h-8 bg-green-100 rounded-full flex items-center justify-center",children:i.jsxs("span",{className:"text-green-600 font-bold text-sm",children:["#",_.length-Z]})}),i.jsxs("div",{children:[i.jsx("h4",{className:"font-semibold text-gray-900",children:R.perkName}),i.jsxs("p",{className:"text-sm text-gray-600",children:["Service: ",R.serviceType]})]})]}),i.jsxs("div",{className:"text-right",children:[i.jsx("p",{className:"text-sm font-medium text-gray-900",children:new Date(R.usedAt).toLocaleDateString()}),i.jsx("p",{className:"text-xs text-gray-500",children:new Date(R.usedAt).toLocaleTimeString()})]})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 text-sm",children:[i.jsxs("div",{children:[i.jsx("span",{className:"text-gray-600 font-medium",children:"Claimant Name:"}),i.jsx("p",{className:"text-gray-900 mt-1",children:R.claimantName})]}),i.jsxs("div",{children:[i.jsx("span",{className:"text-gray-600 font-medium",children:"Handled By:"}),i.jsx("p",{className:"text-gray-900 mt-1",children:R.handledBy})]}),i.jsxs("div",{children:[i.jsx("span",{className:"text-gray-600 font-medium",children:"Value:"}),i.jsxs("p",{className:"text-gray-900 mt-1",children:["",R.value.toFixed(2)]})]})]}),R.notes&&i.jsxs("div",{className:"mt-4 p-3 bg-blue-50 rounded-lg",children:[i.jsx("span",{className:"text-blue-800 font-medium text-sm",children:"Notes:"}),i.jsx("p",{className:"text-blue-700 text-sm mt-1",children:R.notes})]}),i.jsx("div",{className:"mt-4 pt-4 border-t border-gray-200",children:i.jsxs("p",{className:"text-xs text-gray-500",children:["Redeemed on ",new Date(R.usedAt).toLocaleDateString("en-PH",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"})]})})]},R.id)),i.jsxs("div",{className:"mt-6 p-4 bg-blue-50 rounded-lg",children:[i.jsxs("div",{className:"flex items-center space-x-2",children:[i.jsx(ho,{className:"h-5 w-5 text-blue-600"}),i.jsxs("span",{className:"font-semibold text-blue-900",children:["Total Redemptions: ",_.length]})]}),i.jsx("p",{className:"text-sm text-blue-700 mt-2",children:"This record provides proof of perk usage to prevent misuse and duplicate claims."})]})]})})()})]})})]})}function vx(){const{isAuthenticated:t,login:e,logout:r}=Rc();hm({enabled:!0,showNotifications:!0});const[n,s]=k.useState({username:"",password:""}),[a,o]=k.useState("generator"),[l,c]=k.useState({mode:"single",region:"",areaCode:"",customAreaCode:"",startId:"",endId:"",perksTotal:5}),[u,f]=k.useState({showModal:!1,editingPerk:null,form:{type:"dental_cleaning",name:"",description:"",value:0,isActive:!0,validFor:365,requiresApproval:!1}}),[m,d]=k.useState(""),[y,x]=k.useState(null),[w,C]=k.useState({clinicId:"",startRange:"",endRange:""}),[p,g]=k.useState({name:"",region:"",plan:"starter",areaCode:"",customAreaCode:"",address:"",adminClinic:"",email:"",contactNumber:"",password:""}),[v,b]=k.useState(!1),[j,N]=k.useState(null),[S,P]=k.useState([]),[W,q]=k.useState(!1),[V,pe]=k.useState({cardControlNumber:"",patientName:"",patientEmail:"",patientPhone:"",preferredDate:"",preferredTime:"",serviceType:"",perkRequested:"",clinicId:"",adminNotes:""}),[Tt,Zt]=k.useState(!1),[Ie,je]=k.useState({currentPassword:"",newPassword:"",confirmPassword:""}),[xt,T]=k.useState({username:"admin",password:"admin123"}),[$,B]=k.useState("cards"),[X,G]=k.useState(null),[Ne,ne]=k.useState(""),[Ce,ct]=k.useState([]),[Fe,ei]=k.useState([]),[Bn,ti]=k.useState([]),[$a,ri]=k.useState(!0),[qn,La]=k.useState("all"),[ut,ni]=k.useState(null),[le,Pt]=k.useState({fullName:"",status:"inactive",perksTotal:5,perksUsed:0,clinicId:"",expiryDate:"",notes:""}),[dt,Ar]=k.useState({name:"",region:"",plan:"starter",address:"",adminClinic:"",email:"",contactNumber:"",password:""}),{addToast:_}=Er();k.useEffect(()=>{(async()=>{await lr.initializeDefaults()})()},[]),k.useEffect(()=>{t&&(async()=>{try{ri(!0);const[I,z,H]=await Promise.all([Ft.getAll(),Ke.getAll(),lr.getAll()]);ct(I),ei(z),ti(H)}catch(I){console.error("Failed to load data:",I),_(Q("Error","Failed to load data"))}finally{ri(!1)}})()},[t]);const R=async()=>{try{const[h,I,z]=await Promise.all([Ft.getAll(),Ke.getAll(),lr.getAll()]);ct(h),ei(I),ti(z)}catch(h){console.error("Failed to reload data:",h),_(Q("Error","Failed to reload data"))}},Z=h=>{h.preventDefault(),n.username==="admin"&&n.password==="admin123"?(e("admin",{username:n.username}),_(ee("Welcome","Admin access granted"))):_(Q("Login Failed","Invalid credentials"))},xe=h=>{if(h.preventDefault(),Ie.currentPassword!==xt.password){_(Q("Invalid Password","Current password is incorrect"));return}if(Ie.newPassword.length<8){_(Q("Password Too Short","New password must be at least 8 characters long"));return}if(Ie.newPassword!==Ie.confirmPassword){_(Q("Passwords Do Not Match","Please confirm your new password correctly"));return}T({...xt,password:Ie.newPassword}),je({currentPassword:"",newPassword:"",confirmPassword:""}),Zt(!1),_(ee("Password Changed","Admin password has been updated successfully"))},er=async()=>{if(l.mode==="single"){if(!l.region||!l.areaCode){_(Pe("Missing Fields","Please fill all required fields"));return}let h=l.areaCode;l.areaCode==="Custom"&&l.customAreaCode&&(h=l.customAreaCode);const I=Ce.length+1,z=dm(I,l.region,h),H={controlNumber:z,fullName:"",status:"inactive",perksTotal:l.perksTotal,perksUsed:0,clinicId:"",expiryDate:"2025-12-31"};await Ft.create(H),_(ee("Card Generated",`Created ${z} with ${l.perksTotal} perks`)),await R()}else{const h=parseInt(l.startId),I=parseInt(l.endId);if(!h||!I||h>I){_(Pe("Invalid Range","Please enter a valid ID range"));return}let z=l.areaCode;l.areaCode==="Custom"&&l.customAreaCode&&(z=l.customAreaCode);const H=await Ft.createBatch(h,I,l.region,z,l.perksTotal);_(ee("Batch Generated",`Created ${H.length} cards with ${l.perksTotal} perks each`)),await R()}},Rt=async()=>{if(!u.form.name||!u.form.description){_(Pe("Missing Fields","Please fill all required fields"));return}u.editingPerk?(await lr.update(u.editingPerk.id,u.form),_(ee("Perk Updated",`Updated ${u.form.name}`))):(await lr.create(u.form),_(ee("Perk Created",`Created ${u.form.name}`))),await R(),f({showModal:!1,editingPerk:null,form:{type:"dental_cleaning",name:"",description:"",value:0,isActive:!0,validFor:365,requiresApproval:!1}})},Vn=h=>{f({showModal:!0,editingPerk:h,form:{type:h.type,name:h.name,description:h.description,value:h.value,isActive:h.isActive,validFor:h.validFor,requiresApproval:h.requiresApproval}})},De=async h=>{await lr.delete(h.id),_(ee("Perk Deleted",`Deleted ${h.name}`)),await R()},Tr=[{value:"dental_cleaning",label:"Dental Cleaning"},{value:"consultation",label:"Consultation"},{value:"xray",label:"X-Ray"},{value:"treatment",label:"Treatment"},{value:"discount",label:"Discount"}],fm=()=>{if(!m.trim())return;const h=Ce.find(I=>I.controlNumber===m);x(h||null),h||_(Pe("Card Not Found","No card found with this number"))},mm=async()=>{if(!y)return;const h=y.status==="active"?"inactive":"active";await Ft.updateStatus(y.controlNumber,h)&&(x({...y,status:h}),_(ee("Status Updated",`Card is now ${h}`)))},pm=async()=>{if(!w.clinicId||!w.startRange||!w.endRange){_(Pe("Missing Fields","Please fill all fields"));return}const h=await Ke.getById(w.clinicId);if(!h){_(Q("Invalid Clinic","Clinic not found"));return}const z=Ce.filter(tr=>tr.controlNumber>=w.startRange&&tr.controlNumber<=w.endRange&&!tr.clinicId);if(z.length===0){_(Pe("No Cards","No unassigned cards found in this range"));return}const H=await Ke.getAssignedCardsCount(h.id),ae=Dt[h.plan];if(H+z.length>ae){_(Q("Plan Limit Exceeded",`This would exceed the ${h.plan} plan limit of ${ae} cards. Current: ${H}`));return}await Ft.assignToClinic(z.map(tr=>tr.controlNumber),h.id)&&(_(ee("Cards Assigned",`Assigned ${z.length} cards to ${h.name}`)),C({clinicId:"",startRange:"",endRange:""}))},gm=async()=>{if(!p.name||!p.region||!p.plan||!p.areaCode||!p.password){_(Pe("Missing Required Fields","Please fill all required fields"));return}let h=p.areaCode;p.areaCode==="Custom"&&p.customAreaCode&&(h=p.customAreaCode);const I=await px(h);try{const z={name:p.name,region:p.region,plan:p.plan,code:I,address:p.address||void 0,adminClinic:p.adminClinic||void 0,email:p.email||void 0,contactNumber:p.contactNumber||void 0,password:p.password,subscriptionPrice:or[p.plan]},H=await Ke.create(z);_(ee("Clinic Created",`${H.name} created successfully with code ${H.code}`)),g({name:"",region:"",plan:"starter",areaCode:"",customAreaCode:"",address:"",adminClinic:"",email:"",contactNumber:"",password:""}),await R()}catch{_(Q("Creation Failed","Failed to create clinic"))}},Oc=h=>{N(h),g({name:h.name,region:h.region,plan:h.plan,areaCode:h.code.substring(0,3),customAreaCode:"",address:h.address||"",adminClinic:h.adminClinic||"",email:h.email||"",contactNumber:h.contactNumber||"",password:""}),b(!0)},Ic=async()=>{if(j){if(!p.name||!p.region||!p.plan){_(Pe("Missing Required Fields","Please fill all required fields"));return}try{const h={name:p.name,region:p.region,plan:p.plan,address:p.address||void 0,adminClinic:p.adminClinic||void 0,email:p.email||void 0,contactNumber:p.contactNumber||void 0,maxCards:Dt[p.plan],updatedAt:new Date().toISOString()};p.password.trim()&&(h.password=p.password),await Ke.update(j.id,h)?(_(ee("Clinic Updated",`${p.name} has been updated successfully`)),b(!1),N(null),g({name:"",region:"",plan:"starter",areaCode:"",customAreaCode:"",password:"",address:"",adminClinic:"",email:"",contactNumber:""})):_(Q("Update Failed","Could not update clinic"))}catch{_(Q("Update Failed","Failed to update clinic"))}}},Dc=async h=>{const I=await Ke.getById(h);if(!I)return;const z=await Ke.getAssignedCardsCount(h);if(z>0){_(Pe("Cannot Delete",`This clinic has ${z} assigned cards. Please reassign them first.`));return}if(confirm(`Are you sure you want to delete "${I.name}"? This action cannot be undone.`)){const H=await Ke.delete(h);_(H?ee("Clinic Deleted",`${I.name} has been deleted`):Q("Delete Failed","Could not delete clinic"))}},ym=async h=>{const I=new Date().toISOString(),z=await Mi.create({cardControlNumber:h.cardControlNumber,clinicId:h.clinicId,patientName:h.patientName,patientEmail:h.patientEmail,patientPhone:h.patientPhone,preferredDate:h.preferredDate,preferredTime:h.preferredTime,status:"pending",serviceType:h.serviceType,notes:h.adminNotes,createdAt:I,updatedAt:I});P(H=>[...H,z]),_(ee("Manual Appointment Created","Appointment request sent to clinic for processing"))},vm=h=>{const I=Ce.find(z=>z.controlNumber===h);I&&(Pt({fullName:I.fullName,status:I.status,perksTotal:I.perksTotal,perksUsed:I.perksUsed,clinicId:I.clinicId,expiryDate:I.expiryDate,notes:I.notes||""}),G(h))},xm=async h=>{const I=Ce.find(z=>z.controlNumber===h);if(I)try{const z={fullName:le.fullName,status:le.status,perksTotal:le.perksTotal,perksUsed:le.perksUsed,clinicId:le.clinicId,expiryDate:le.expiryDate,notes:le.notes,updatedAt:new Date().toISOString()};Object.assign(I,z),G(null),_(ee("Card Updated",`Updated ${h} successfully`)),await R()}catch{_(Q("Update Failed","Failed to update card"))}},wm=async h=>{if(window.confirm(`Are you sure you want to delete card ${h}? This action cannot be undone.`))try{await Ft.delete(h)?(_(ee("Card Deleted",`Card ${h} has been deleted`)),await R()):_(Q("Delete Failed","Could not delete card"))}catch{_(Q("Delete Failed","Could not delete card"))}},_m=[{id:"generator",label:"Generator",icon:Zn,color:"emerald"},{id:"activation",label:"Activation",icon:g0,color:"blue"},{id:"appointments",label:"Appointments",icon:mt,color:"rose"},{id:"clinic-management",label:"Manage Clinics",icon:Hu,color:"indigo"},{id:"endorsement",label:"Endorsement",icon:td,color:"orange"},{id:"master-list",label:"Master List",icon:o0,color:"purple"},{id:"settings",label:"Settings",icon:da,color:"gray"}];if(!t)return i.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:i.jsxs("div",{className:"light-card p-8 w-full max-w-md",children:[i.jsxs("div",{className:"text-center mb-8",children:[i.jsx("div",{className:"w-16 h-16 bg-red-100 rounded-2xl flex items-center justify-center mx-auto mb-4",children:i.jsx(Ht,{className:"h-8 w-8 text-red-600"})}),i.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Admin Access Required"}),i.jsx("p",{className:"text-gray-600",children:"Please authenticate to continue"})]}),i.jsxs("form",{onSubmit:Z,className:"space-y-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Username"}),i.jsx("input",{type:"text",value:n.username,onChange:h=>s({...n,username:h.target.value}),className:"light-input",placeholder:"Enter admin username",required:!0})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Password"}),i.jsx("input",{type:"password",value:n.password,onChange:h=>s({...n,password:h.target.value}),className:"light-input",placeholder:"Enter admin password",required:!0})]}),i.jsx("button",{type:"submit",className:"light-button-primary w-full",children:"Access Admin Portal"})]})]})});const bm=[{label:"Total Cards",value:Ce.length,icon:fo,color:"blue"},{label:"Active Clinics",value:Fe.length,icon:vs,color:"green"},{label:"Active Cards",value:Ce.filter(h=>h.status==="active").length,icon:vl,color:"emerald"},{label:"Pending Cards",value:Ce.filter(h=>h.status==="inactive").length,icon:zs,color:"yellow"}];return $a?i.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:i.jsx("div",{className:"light-card p-8",children:i.jsxs("div",{className:"flex items-center space-x-4",children:[i.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-red-600"}),i.jsx("p",{className:"text-gray-600",children:"Loading admin data..."})]})})}):i.jsxs("div",{className:"min-h-screen bg-gray-50",children:[i.jsx("div",{className:"light-card mb-6",children:i.jsx("div",{className:"p-6",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{className:"flex items-center space-x-4",children:[i.jsx("div",{className:"w-12 h-12 bg-red-100 rounded-2xl flex items-center justify-center",children:i.jsx(Ht,{className:"h-6 w-6 text-red-600"})}),i.jsxs("div",{children:[i.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Admin Control Room"}),i.jsx("p",{className:"text-gray-600",children:"MOCARDS System Administration"})]})]}),i.jsxs("button",{onClick:r,className:"light-button-secondary flex items-center space-x-2",children:[i.jsx(da,{className:"h-4 w-4"}),i.jsx("span",{children:"Logout"})]})]})})}),i.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-6",children:bm.map((h,I)=>{const z=h.icon;return i.jsx("div",{className:"light-stat-card",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("p",{className:"text-sm font-medium text-gray-600",children:h.label}),i.jsx("p",{className:"text-3xl font-bold text-gray-900",children:h.value})]}),i.jsx("div",{className:`w-12 h-12 bg-${h.color}-100 rounded-2xl flex items-center justify-center`,children:i.jsx(z,{className:`h-6 w-6 text-${h.color}-600`})})]})},I)})}),i.jsx("div",{className:"light-card mb-6",children:i.jsx("div",{className:"p-6",children:i.jsx("div",{className:"flex space-x-1 bg-gray-100 p-1 rounded-xl",children:_m.map(h=>{const I=h.icon,z=a===h.id;return i.jsxs("button",{onClick:()=>o(h.id),className:`flex-1 flex items-center justify-center space-x-2 py-3 px-4 rounded-lg transition-all duration-200 ${z?"light-tab-active":"light-tab"}`,children:[i.jsx(I,{className:"h-4 w-4"}),i.jsx("span",{className:"font-medium",children:h.label})]},h.id)})})})}),i.jsx("div",{className:"light-card",children:i.jsxs("div",{className:"p-6",children:[a==="generator"&&i.jsxs("div",{className:"space-y-6",children:[i.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"Card Generator"}),i.jsxs("div",{className:"flex space-x-1 bg-gray-100 p-1 rounded-lg w-fit",children:[i.jsx("button",{onClick:()=>c({...l,mode:"single"}),className:`px-4 py-2 rounded-md font-medium transition-colors ${l.mode==="single"?"bg-white text-gray-900 shadow-sm":"text-gray-600"}`,children:"Single Card"}),i.jsx("button",{onClick:()=>c({...l,mode:"batch"}),className:`px-4 py-2 rounded-md font-medium transition-colors ${l.mode==="batch"?"bg-white text-gray-900 shadow-sm":"text-gray-600"}`,children:"Batch Mode"})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Region"}),i.jsxs("select",{value:l.region,onChange:h=>c({...l,region:h.target.value}),className:"light-select",children:[i.jsx("option",{value:"",children:"Select Region"}),es.map(h=>i.jsx("option",{value:h.code,children:h.name},h.code))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Area Code"}),i.jsxs("select",{value:l.areaCode,onChange:h=>c({...l,areaCode:h.target.value}),className:"light-select",children:[i.jsx("option",{value:"",children:"Select Area Code"}),Ed.map(h=>i.jsx("option",{value:h,children:h},h))]})]}),l.areaCode==="Custom"&&i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Custom Area Code"}),i.jsx("input",{type:"text",value:l.customAreaCode,onChange:h=>c({...l,customAreaCode:h.target.value}),className:"light-input",placeholder:"Enter custom area code (e.g., XYZ001)"})]}),i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Perks per Card"}),i.jsxs("div",{className:"flex items-center space-x-4",children:[i.jsx("input",{type:"number",min:"1",max:"20",value:l.perksTotal,onChange:h=>c({...l,perksTotal:parseInt(h.target.value)||1}),className:"light-input w-20"}),i.jsx("span",{className:"text-sm text-gray-600",children:"benefits/perks per card"}),i.jsxs("button",{onClick:()=>f({...u,showModal:!0}),className:"flex items-center space-x-2 bg-gradient-to-r from-blue-600 to-indigo-600 text-white font-semibold px-4 py-2 rounded-lg shadow-lg hover:from-blue-700 hover:to-indigo-700 hover:shadow-xl transform hover:scale-105 transition-all duration-200",children:[i.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})}),i.jsx("span",{children:"Manage Perks"})]})]}),i.jsxs("div",{className:"mt-2 text-sm",children:[i.jsx("span",{className:"text-gray-600",children:"Available Perks: "}),Bn.filter(h=>h.isActive).length>0?i.jsx("span",{className:"text-green-600 font-medium",children:Bn.filter(h=>h.isActive).map(h=>h.name).join(", ")}):i.jsx("span",{className:"text-orange-600",children:"No active perks configured"})]})]}),l.mode==="batch"&&i.jsxs(i.Fragment,{children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Start ID"}),i.jsx("input",{type:"number",value:l.startId,onChange:h=>c({...l,startId:h.target.value}),className:"light-input",placeholder:"1"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"End ID"}),i.jsx("input",{type:"number",value:l.endId,onChange:h=>c({...l,endId:h.target.value}),className:"light-input",placeholder:"100"})]})]})]}),i.jsx("button",{onClick:er,className:"light-button-primary",children:l.mode==="single"?"Generate Card":"Generate Batch"})]}),a==="activation"&&i.jsxs("div",{className:"space-y-6",children:[i.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"Card Activation"}),i.jsxs("div",{className:"flex space-x-3",children:[i.jsx("div",{className:"flex-1",children:i.jsx("input",{type:"text",value:m,onChange:h=>d(h.target.value),className:"light-input",placeholder:"Enter control number to activate"})}),i.jsxs("button",{onClick:fm,className:"light-button-primary",children:[i.jsx(Un,{className:"h-4 w-4 mr-2"}),"Search"]})]}),y&&i.jsxs("div",{className:"bg-gray-50 rounded-2xl p-6",children:[i.jsxs("div",{className:"flex justify-between items-start mb-4",children:[i.jsxs("div",{children:[i.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:y.fullName}),i.jsx("p",{className:"text-gray-600",children:y.controlNumber})]}),i.jsx("span",{className:y.status==="active"?"status-active":"status-inactive",children:y.status})]}),i.jsxs("button",{onClick:mm,className:"light-button-primary",children:[y.status==="active"?"Deactivate":"Activate"," Card"]})]})]}),a==="clinic-management"&&i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"Manage Clinics"}),i.jsx("p",{className:"text-gray-600",children:"Comprehensive clinic management with subscription plans and monitoring"})]}),i.jsxs("button",{onClick:()=>{b(!v),N(null),g({name:"",region:"",plan:"starter",areaCode:"",customAreaCode:"",address:"",adminClinic:"",email:"",contactNumber:"",password:""})},className:"light-button-primary flex items-center gap-2",children:[i.jsx(Zn,{className:"h-4 w-4"}),"Add New Clinic"]})]}),v&&i.jsx("div",{className:"light-card",children:i.jsxs("div",{className:"p-6",children:[i.jsxs("div",{className:"flex items-center justify-between mb-4",children:[i.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:j?`Edit Clinic: ${j.name}`:"Add New Clinic"}),i.jsx("button",{onClick:()=>{b(!1),N(null)},className:"p-2 text-gray-400 hover:text-gray-600",children:i.jsx(tt,{className:"h-5 w-5"})})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[i.jsxs("div",{children:[i.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Clinic Name ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsx("input",{type:"text",value:p.name,onChange:h=>g({...p,name:h.target.value}),className:"light-input",placeholder:"Enter clinic name"})]}),i.jsxs("div",{children:[i.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Region ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsxs("select",{value:p.region,onChange:h=>g({...p,region:h.target.value}),className:"light-select",children:[i.jsx("option",{value:"",children:"Select Region"}),es.map(h=>i.jsx("option",{value:h.code,children:h.name},h.code))]})]}),i.jsxs("div",{children:[i.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Subscription Plan ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsxs("select",{value:p.plan,onChange:h=>g({...p,plan:h.target.value}),className:"light-select",children:[i.jsxs("option",{value:"starter",children:["Starter Plan - ",or.starter,"/month (up to ",Dt.starter," cards)"]}),i.jsxs("option",{value:"growth",children:["Growth Plan - ",or.growth,"/month (up to ",Dt.growth," cards)"]}),i.jsxs("option",{value:"pro",children:["Pro Plan - ",or.pro,"/month (up to ",Dt.pro," cards)"]})]})]}),i.jsxs("div",{children:[i.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Area Code ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsxs("select",{value:p.areaCode,onChange:h=>g({...p,areaCode:h.target.value}),className:"light-select",children:[i.jsx("option",{value:"",children:"Select Area Code"}),Ed.map(h=>i.jsx("option",{value:h,children:h},h))]})]}),p.areaCode==="Custom"&&i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Custom Area Code"}),i.jsx("input",{type:"text",value:p.customAreaCode,onChange:h=>g({...p,customAreaCode:h.target.value}),className:"light-input",placeholder:"Enter custom area code (e.g., XYZ001)"})]}),i.jsxs("div",{children:[i.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Clinic Password ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsx("input",{type:"password",value:p.password,onChange:h=>g({...p,password:h.target.value}),className:"light-input",placeholder:"Enter clinic login password"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Address (Optional)"}),i.jsx("input",{type:"text",value:p.address,onChange:h=>g({...p,address:h.target.value}),className:"light-input",placeholder:"Enter clinic address"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Admin Contact (Optional)"}),i.jsx("input",{type:"text",value:p.adminClinic,onChange:h=>g({...p,adminClinic:h.target.value}),className:"light-input",placeholder:"Enter admin contact name"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email (Optional)"}),i.jsx("input",{type:"email",value:p.email,onChange:h=>g({...p,email:h.target.value}),className:"light-input",placeholder:"Enter clinic email"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Contact Number (Optional)"}),i.jsx("input",{type:"tel",value:p.contactNumber,onChange:h=>g({...p,contactNumber:h.target.value}),className:"light-input",placeholder:"+63917123456"})]})]}),i.jsxs("div",{className:"bg-blue-50 p-4 rounded-xl mt-6",children:[i.jsx("h3",{className:"font-medium text-blue-900 mb-2",children:"Subscription Summary"}),i.jsxs("div",{className:"text-sm text-blue-800",children:[i.jsxs("p",{children:[i.jsxs("strong",{children:[p.plan.charAt(0).toUpperCase()+p.plan.slice(1)," Plan:"]})," ",or[p.plan]||0,"/month"]}),i.jsxs("p",{children:[i.jsx("strong",{children:"Card Limit:"})," Up to ",Dt[p.plan]||0," cards"]}),i.jsx("p",{className:"text-blue-600 mt-2",children:"* Required fields must be filled. Optional fields can be updated later."})]})]}),i.jsxs("div",{className:"flex justify-end gap-3 mt-6",children:[i.jsx("button",{onClick:()=>{b(!1),N(null)},className:"px-4 py-2 text-gray-600 border border-gray-300 rounded-lg hover:bg-gray-50",children:"Cancel"}),i.jsx("button",{onClick:j?Ic:gm,className:"light-button-primary",children:j?"Update Clinic":"Create Clinic Profile"})]})]})}),i.jsx("div",{className:"light-card",children:i.jsx("div",{className:"p-6",children:Fe.length===0?i.jsxs("div",{className:"text-center py-12",children:[i.jsx(n0,{className:"h-12 w-12 text-gray-300 mx-auto mb-4"}),i.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No Clinics Found"}),i.jsx("p",{className:"text-gray-600 mb-6",children:"Get started by adding your first clinic to the system"}),i.jsxs("button",{onClick:()=>b(!0),className:"light-button-primary flex items-center gap-2 mx-auto",children:[i.jsx(Zn,{className:"h-4 w-4"}),"Add First Clinic"]})]}):i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"w-full",children:[i.jsx("thead",{className:"border-b border-gray-200",children:i.jsxs("tr",{children:[i.jsx("th",{className:"text-left p-4 font-medium text-gray-900",children:"Clinic Details"}),i.jsx("th",{className:"text-left p-4 font-medium text-gray-900",children:"Plan & Usage"}),i.jsx("th",{className:"text-left p-4 font-medium text-gray-900",children:"Contact Info"}),i.jsx("th",{className:"text-left p-4 font-medium text-gray-900",children:"Status"}),i.jsx("th",{className:"text-left p-4 font-medium text-gray-900",children:"Actions"})]})}),i.jsx("tbody",{children:Fe.map(h=>{var tr;const I=Ce.filter(Ua=>Ua.clinicId===h.id),z=I.length,H=Dt[h.plan],ae=z/H*100,$c=((tr=es.find(Ua=>Ua.code===h.region))==null?void 0:tr.name)||h.region;return i.jsxs("tr",{className:"border-b border-gray-100 hover:bg-gray-50",children:[i.jsx("td",{className:"p-4",children:i.jsxs("div",{className:"space-y-1",children:[i.jsx("div",{className:"font-medium text-gray-900",children:h.name}),i.jsx("div",{className:"text-sm text-gray-600 font-mono",children:h.code}),i.jsx("div",{className:"text-sm text-gray-500",children:$c})]})}),i.jsx("td",{className:"p-4",children:i.jsxs("div",{className:"space-y-2",children:[i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("span",{className:`px-2 py-1 rounded text-xs font-medium ${h.plan==="starter"?"bg-blue-100 text-blue-700":h.plan==="growth"?"bg-green-100 text-green-700":"bg-purple-100 text-purple-700"}`,children:h.plan.toUpperCase()}),i.jsxs("span",{className:"text-sm text-gray-600",children:["",or[h.plan],"/mo"]})]}),i.jsxs("div",{className:"space-y-1",children:[i.jsxs("div",{className:"flex justify-between text-sm",children:[i.jsx("span",{children:"Card Usage"}),i.jsxs("span",{className:"font-medium",children:[z,"/",H]})]}),i.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:i.jsx("div",{className:`h-2 rounded-full transition-all ${ae>=90?"bg-red-500":ae>=70?"bg-yellow-500":"bg-green-500"}`,style:{width:`${Math.min(ae,100)}%`}})})]})]})}),i.jsx("td",{className:"p-4",children:i.jsxs("div",{className:"space-y-1 text-sm",children:[h.email&&i.jsxs("div",{className:"flex items-center gap-2 text-gray-600",children:[i.jsx(xl,{className:"h-3 w-3"}),i.jsx("span",{children:h.email})]}),h.contactNumber&&i.jsxs("div",{className:"flex items-center gap-2 text-gray-600",children:[i.jsx(ua,{className:"h-3 w-3"}),i.jsx("span",{children:h.contactNumber})]}),h.adminClinic&&i.jsxs("div",{className:"flex items-center gap-2 text-gray-600",children:[i.jsx(ha,{className:"h-3 w-3"}),i.jsx("span",{children:h.adminClinic})]}),!h.email&&!h.contactNumber&&!h.adminClinic&&i.jsx("span",{className:"text-gray-400 italic",children:"No contact info"})]})}),i.jsx("td",{className:"p-4",children:i.jsx("span",{className:"px-2 py-1 rounded-full text-xs font-medium bg-green-100 text-green-700",children:"Active"})}),i.jsx("td",{className:"p-4",children:i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("button",{onClick:()=>{Oc(h),b(!0)},className:"p-2 text-blue-600 hover:bg-blue-50 rounded",title:"Edit clinic",children:i.jsx(as,{className:"h-4 w-4"})}),i.jsx("button",{onClick:()=>Dc(h.id),className:"p-2 text-red-600 hover:bg-red-50 rounded",title:"Delete clinic",disabled:I.length>0,children:i.jsx(os,{className:"h-4 w-4"})})]})})]},h.id)})})]})})})})]}),a==="appointments"&&i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"Appointment Status Monitor"}),i.jsx("p",{className:"text-sm text-gray-600",children:"View all appointment requests and their processing status"})]}),i.jsxs("div",{className:"flex items-center gap-4",children:[i.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[i.jsx(mt,{className:"h-4 w-4"}),i.jsxs("span",{children:[S.length," total requests"]})]}),i.jsxs("button",{onClick:()=>q(!0),className:"light-button-primary flex items-center gap-2",children:[i.jsx(Zn,{className:"h-4 w-4"}),"Create Manual Appointment"]})]})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[i.jsx("div",{className:"light-stat-card",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("p",{className:"text-sm text-gray-600",children:"Pending Review"}),i.jsx("p",{className:"text-2xl font-bold text-orange-600",children:S.filter(h=>h.status==="pending").length})]}),i.jsx(Fs,{className:"h-8 w-8 text-orange-600"})]})}),i.jsx("div",{className:"light-stat-card",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("p",{className:"text-sm text-gray-600",children:"Pending"}),i.jsx("p",{className:"text-2xl font-bold text-blue-600",children:S.filter(h=>h.status==="pending").length})]}),i.jsx(td,{className:"h-8 w-8 text-blue-600"})]})}),i.jsx("div",{className:"light-stat-card",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("p",{className:"text-sm text-gray-600",children:"Accepted"}),i.jsx("p",{className:"text-2xl font-bold text-emerald-600",children:S.filter(h=>h.status==="accepted").length})]}),i.jsx(vl,{className:"h-8 w-8 text-emerald-600"})]})}),i.jsx("div",{className:"light-stat-card",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("p",{className:"text-sm text-gray-600",children:"Rejected"}),i.jsx("p",{className:"text-2xl font-bold text-red-600",children:S.filter(h=>h.status==="rejected").length})]}),i.jsx(zs,{className:"h-8 w-8 text-red-600"})]})})]}),W&&i.jsxs("div",{className:"light-card p-6 border-l-4 border-blue-500",children:[i.jsxs("div",{className:"flex items-center justify-between mb-6",children:[i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx(Zn,{className:"h-6 w-6 text-blue-600"}),i.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Create Manual Appointment"})]}),i.jsx("button",{onClick:()=>q(!1),className:"text-gray-400 hover:text-gray-600",children:i.jsx(tt,{className:"h-5 w-5"})})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Card Control Number *"}),i.jsx("input",{type:"text",value:V.cardControlNumber,onChange:h=>pe({...V,cardControlNumber:h.target.value}),className:"light-input",placeholder:"MOC-00000-XX-XXX000"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Clinic *"}),i.jsxs("select",{value:V.clinicId,onChange:h=>pe({...V,clinicId:h.target.value}),className:"light-select",children:[i.jsx("option",{value:"",children:"Select Clinic"}),Fe.map(h=>i.jsxs("option",{value:h.id,children:[h.name," (",h.code,")"]},h.id))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Patient Name *"}),i.jsx("input",{type:"text",value:V.patientName,onChange:h=>pe({...V,patientName:h.target.value}),className:"light-input",placeholder:"Patient's full name"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email *"}),i.jsx("input",{type:"email",value:V.patientEmail,onChange:h=>pe({...V,patientEmail:h.target.value}),className:"light-input",placeholder:"patient@email.com"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Phone"}),i.jsx("input",{type:"tel",value:V.patientPhone,onChange:h=>pe({...V,patientPhone:h.target.value}),className:"light-input",placeholder:"+63917123456"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Service Type *"}),i.jsx("input",{type:"text",value:V.serviceType,onChange:h=>pe({...V,serviceType:h.target.value}),className:"light-input",placeholder:"e.g., Dental Cleaning, Consultation"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Preferred Date *"}),i.jsx("input",{type:"date",value:V.preferredDate,onChange:h=>pe({...V,preferredDate:h.target.value}),min:new Date().toISOString().split("T")[0],className:"light-input"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Preferred Time *"}),i.jsx("input",{type:"time",value:V.preferredTime,onChange:h=>pe({...V,preferredTime:h.target.value}),className:"light-input"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Perk Requested"}),i.jsx("input",{type:"text",value:V.perkRequested,onChange:h=>pe({...V,perkRequested:h.target.value}),className:"light-input",placeholder:"e.g., Free Dental Cleaning"})]}),i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Admin Notes"}),i.jsx("textarea",{value:V.adminNotes,onChange:h=>pe({...V,adminNotes:h.target.value}),rows:3,className:"light-input resize-none",placeholder:"Any additional notes or instructions..."})]})]}),i.jsxs("div",{className:"flex gap-3 pt-4 border-t border-gray-200 mt-6",children:[i.jsxs("button",{onClick:()=>{if(!V.cardControlNumber||!V.patientName||!V.patientEmail||!V.preferredDate||!V.preferredTime||!V.serviceType||!V.clinicId){_(Pe("Missing Fields","Please fill in all required fields"));return}ym(V),pe({cardControlNumber:"",patientName:"",patientEmail:"",patientPhone:"",preferredDate:"",preferredTime:"",serviceType:"",perkRequested:"",clinicId:"",adminNotes:""}),q(!1)},className:"light-button-primary flex items-center gap-2",children:[i.jsx(_l,{className:"h-4 w-4"}),"Send to Clinic"]}),i.jsx("button",{onClick:()=>q(!1),className:"light-button-secondary",children:"Cancel"})]})]}),i.jsx("div",{className:"space-y-4",children:S.length===0?i.jsxs("div",{className:"light-card p-8 text-center",children:[i.jsx(mt,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),i.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No Appointment Requests"}),i.jsx("p",{className:"text-gray-600",children:"When cardholders request appointments, they will appear here."})]}):S.map(h=>i.jsx("div",{className:"light-card p-6",children:i.jsxs("div",{className:"flex items-start justify-between",children:[i.jsxs("div",{className:"flex-1",children:[i.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx(fo,{className:"h-5 w-5 text-[#1A535C]"}),i.jsx("span",{className:"font-mono text-sm bg-gray-100 px-2 py-1 rounded",children:h.cardControlNumber})]}),i.jsx("div",{className:`px-2 py-1 rounded-full text-xs font-medium ${h.status==="pending"?"bg-orange-100 text-orange-700":h.status==="accepted"?"bg-emerald-100 text-emerald-700":h.status==="rejected"?"bg-red-100 text-red-700":"bg-blue-100 text-blue-700"}`,children:h.status.replace(/_/g," ").toUpperCase()})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:[i.jsxs("div",{children:[i.jsx("h4",{className:"font-semibold text-gray-900",children:h.patientName}),i.jsxs("div",{className:"text-sm text-gray-600 space-y-1 mt-1",children:[i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx(xl,{className:"h-4 w-4"}),i.jsx("span",{children:h.patientEmail})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx(ua,{className:"h-4 w-4"}),i.jsx("span",{children:h.patientPhone})]})]})]}),i.jsx("div",{children:i.jsxs("div",{className:"text-sm text-gray-600 space-y-1",children:[i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx(mt,{className:"h-4 w-4"}),i.jsx("span",{children:new Date(h.preferredDate).toLocaleDateString("en-PH")}),i.jsx(Fs,{className:"h-4 w-4 ml-2"}),i.jsx("span",{children:h.preferredTime})]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-medium text-gray-700",children:"Service:"})," ",h.serviceType]}),h.perkRequested&&i.jsxs("div",{children:[i.jsx("span",{className:"font-medium text-gray-700",children:"Perk:"})," ",h.perkRequested]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-medium text-gray-700",children:"Clinic:"})," ",h.clinicName]})]})})]}),h.adminNotes&&i.jsx("div",{className:"bg-blue-50 p-3 rounded-lg mb-4",children:i.jsxs("p",{className:"text-sm text-gray-700",children:[i.jsx("strong",{children:"Admin Notes:"})," ",h.adminNotes]})}),h.clinicNotes&&i.jsx("div",{className:"bg-green-50 p-3 rounded-lg mb-4",children:i.jsxs("p",{className:"text-sm text-gray-700",children:[i.jsx("strong",{children:"Clinic Response:"})," ",h.clinicNotes]})}),i.jsxs("div",{className:"text-xs text-gray-500",children:["Requested: ",new Date(h.requestedAt).toLocaleString("en-PH")]})]}),i.jsx("div",{className:"flex items-center gap-2 ml-4",children:i.jsxs("div",{className:"text-xs text-gray-500 text-right",children:[i.jsxs("div",{children:["Sent to Clinic: ",new Date(h.forwardedAt).toLocaleString("en-PH")]}),h.processedAt&&i.jsxs("div",{children:["Processed: ",new Date(h.processedAt).toLocaleString("en-PH")]})]})})]})},h.id))})]}),a==="endorsement"&&i.jsxs("div",{className:"space-y-6",children:[i.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"Card Endorsement"}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Clinic"}),i.jsxs("select",{value:w.clinicId,onChange:h=>C({...w,clinicId:h.target.value}),className:"light-select",children:[i.jsx("option",{value:"",children:"Select Clinic"}),Fe.map(h=>i.jsxs("option",{value:h.id,children:[h.name," (",h.plan,")"]},h.id))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Start Range"}),i.jsx("input",{type:"text",value:w.startRange,onChange:h=>C({...w,startRange:h.target.value}),className:"light-input",placeholder:"MOC-00001-NCR-CVT001"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"End Range"}),i.jsx("input",{type:"text",value:w.endRange,onChange:h=>C({...w,endRange:h.target.value}),className:"light-input",placeholder:"MOC-00100-NCR-CVT001"})]})]}),i.jsx("button",{onClick:pm,className:"light-button-primary",children:"Assign Cards to Clinic"})]}),a==="master-list"&&i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"Data Management"}),i.jsxs("div",{className:"flex items-center space-x-3",children:[i.jsxs("button",{onClick:()=>B("cards"),className:`px-4 py-2 rounded-lg font-medium transition-colors ${$==="cards"?"bg-blue-100 text-blue-700":"text-gray-600 hover:bg-gray-100"}`,children:[i.jsx(fo,{className:"h-4 w-4 inline mr-2"}),"Cards"]}),i.jsxs("button",{onClick:()=>B("clinics"),className:`px-4 py-2 rounded-lg font-medium transition-colors ${$==="clinics"?"bg-blue-100 text-blue-700":"text-gray-600 hover:bg-gray-100"}`,children:[i.jsx(Hu,{className:"h-4 w-4 inline mr-2"}),"Clinics"]})]})]}),i.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[i.jsxs("div",{className:"relative flex-1",children:[i.jsx(Un,{className:"absolute left-3 top-3 h-4 w-4 text-gray-400"}),i.jsx("input",{type:"text",value:Ne,onChange:h=>ne(h.target.value),placeholder:$==="cards"?"Search cards by name or control number...":"Search clinics by name or code...",className:"light-input pl-10"})]}),$==="cards"&&i.jsxs("div",{className:"flex items-center space-x-2",children:[i.jsx(c0,{className:"h-4 w-4 text-gray-500"}),i.jsxs("select",{value:qn,onChange:h=>La(h.target.value),className:"light-select",children:[i.jsx("option",{value:"all",children:"All Status"}),i.jsx("option",{value:"active",children:"Active"}),i.jsx("option",{value:"inactive",children:"Inactive"})]})]})]}),$==="cards"&&i.jsx("div",{className:"light-table",children:i.jsxs("table",{className:"w-full",children:[i.jsx("thead",{className:"light-table-header",children:i.jsxs("tr",{children:[i.jsx("th",{className:"text-left p-4",children:"Control Number"}),i.jsx("th",{className:"text-left p-4",children:"Patient Name"}),i.jsx("th",{className:"text-left p-4",children:"Status"}),i.jsx("th",{className:"text-left p-4",children:"Clinic"}),i.jsx("th",{className:"text-left p-4",children:"Perks"}),i.jsx("th",{className:"text-left p-4",children:"Expiry"}),i.jsx("th",{className:"text-left p-4",children:"Actions"})]})}),i.jsx("tbody",{children:Ce.filter(h=>{const I=!Ne||h.fullName.toLowerCase().includes(Ne.toLowerCase())||h.controlNumber.toLowerCase().includes(Ne.toLowerCase()),z=qn==="all"||h.status===qn;return I&&z}).map(h=>{const I=Fe.find(H=>H.id===h.clinicId),z=X===h.controlNumber;return i.jsxs("tr",{className:"light-table-row",children:[i.jsx("td",{className:"p-4 font-mono text-sm",children:h.controlNumber}),i.jsx("td",{className:"p-4",children:z?i.jsx("input",{type:"text",value:le.fullName,onChange:H=>Pt({...le,fullName:H.target.value}),className:"light-input text-sm"}):h.fullName}),i.jsx("td",{className:"p-4",children:z?i.jsxs("select",{value:le.status,onChange:H=>Pt({...le,status:H.target.value}),className:"light-select text-sm",children:[i.jsx("option",{value:"active",children:"Active"}),i.jsx("option",{value:"inactive",children:"Inactive"})]}):i.jsx("span",{className:h.status==="active"?"status-active":"status-inactive",children:h.status})}),i.jsx("td",{className:"p-4",children:z?i.jsxs("select",{value:le.clinicId,onChange:H=>Pt({...le,clinicId:H.target.value}),className:"light-select text-sm",children:[i.jsx("option",{value:"",children:"Unassigned"}),Fe.map(H=>i.jsx("option",{value:H.id,children:H.name},H.id))]}):(I==null?void 0:I.name)||"Unassigned"}),i.jsx("td",{className:"p-4",children:z?i.jsxs("div",{className:"flex space-x-2",children:[i.jsx("input",{type:"number",min:"0",value:le.perksUsed,onChange:H=>Pt({...le,perksUsed:parseInt(H.target.value)||0}),className:"light-input text-sm w-16"}),i.jsx("span",{className:"text-gray-500 self-center",children:"/"}),i.jsx("input",{type:"number",min:"1",value:le.perksTotal,onChange:H=>Pt({...le,perksTotal:parseInt(H.target.value)||1}),className:"light-input text-sm w-16"})]}):`${h.perksUsed}/${h.perksTotal}`}),i.jsx("td",{className:"p-4",children:z?i.jsx("input",{type:"date",value:le.expiryDate,onChange:H=>Pt({...le,expiryDate:H.target.value}),className:"light-input text-sm"}):new Date(h.expiryDate).toLocaleDateString()}),i.jsx("td",{className:"p-4",children:i.jsx("div",{className:"flex items-center space-x-2",children:z?i.jsxs(i.Fragment,{children:[i.jsx("button",{onClick:()=>xm(h.controlNumber),className:"p-1 text-green-600 hover:text-green-700",title:"Save changes",children:i.jsx(wl,{className:"h-4 w-4"})}),i.jsx("button",{onClick:()=>G(null),className:"p-1 text-gray-600 hover:text-gray-700",title:"Cancel",children:i.jsx(tt,{className:"h-4 w-4"})})]}):i.jsxs(i.Fragment,{children:[i.jsx("button",{onClick:()=>vm(h.controlNumber),className:"p-1 text-blue-600 hover:text-blue-700",title:"Edit card",children:i.jsx(as,{className:"h-4 w-4"})}),i.jsx("button",{onClick:()=>wm(h.controlNumber),className:"p-1 text-red-600 hover:text-red-700",title:"Delete card",children:i.jsx(os,{className:"h-4 w-4"})})]})})})]},h.controlNumber)})})]})}),$==="clinics"&&i.jsx("div",{className:"light-table",children:i.jsxs("table",{className:"w-full",children:[i.jsx("thead",{className:"light-table-header",children:i.jsxs("tr",{children:[i.jsx("th",{className:"text-left p-4",children:"Name"}),i.jsx("th",{className:"text-left p-4",children:"Code"}),i.jsx("th",{className:"text-left p-4",children:"Region"}),i.jsx("th",{className:"text-left p-4",children:"Plan"}),i.jsx("th",{className:"text-left p-4",children:"Cards"}),i.jsx("th",{className:"text-left p-4",children:"Contact"}),i.jsx("th",{className:"text-left p-4",children:"Status"}),i.jsx("th",{className:"text-left p-4",children:"Actions"})]})}),i.jsx("tbody",{children:Fe.filter(h=>!Ne||h.name.toLowerCase().includes(Ne.toLowerCase())||h.code.toLowerCase().includes(Ne.toLowerCase())).map(h=>{var H;const I=(j==null?void 0:j.id)===h.id,z=Ce.filter(ae=>ae.clinicId===h.id);return i.jsxs("tr",{className:"light-table-row",children:[i.jsx("td",{className:"p-4",children:I?i.jsx("input",{type:"text",value:dt.name,onChange:ae=>Ar({...dt,name:ae.target.value}),className:"light-input text-sm"}):i.jsxs("div",{children:[i.jsx("div",{className:"font-medium",children:h.name}),i.jsx("div",{className:"text-xs text-gray-500",children:h.address})]})}),i.jsx("td",{className:"p-4 font-mono text-sm",children:h.code}),i.jsx("td",{className:"p-4",children:I?i.jsxs("select",{value:dt.region,onChange:ae=>Ar({...dt,region:ae.target.value}),className:"light-select text-sm",children:[i.jsx("option",{value:"",children:"Select Region"}),es.map(ae=>i.jsx("option",{value:ae.code,children:ae.name},ae.code))]}):((H=es.find(ae=>ae.code===h.region))==null?void 0:H.name)||h.region}),i.jsx("td",{className:"p-4",children:I?i.jsxs("select",{value:dt.plan,onChange:ae=>Ar({...dt,plan:ae.target.value}),className:"light-select text-sm",children:[i.jsx("option",{value:"starter",children:"Starter"}),i.jsx("option",{value:"growth",children:"Growth"}),i.jsx("option",{value:"pro",children:"Pro"})]}):i.jsx("span",{className:`plan-${h.plan} capitalize`,children:h.plan})}),i.jsx("td",{className:"p-4",children:i.jsxs("div",{className:"text-sm",children:[i.jsxs("div",{children:[z.length," / ",h.maxCards]}),i.jsx("div",{className:"w-16 bg-gray-200 rounded-full h-1 mt-1",children:i.jsx("div",{className:"bg-blue-500 h-1 rounded-full",style:{width:`${Math.min(z.length/h.maxCards*100,100)}%`}})})]})}),i.jsx("td",{className:"p-4",children:I?i.jsxs("div",{className:"space-y-1",children:[i.jsx("input",{type:"email",value:dt.email,onChange:ae=>Ar({...dt,email:ae.target.value}),placeholder:"Email",className:"light-input text-sm"}),i.jsx("input",{type:"text",value:dt.contactNumber,onChange:ae=>Ar({...dt,contactNumber:ae.target.value}),placeholder:"Phone",className:"light-input text-sm"})]}):i.jsxs("div",{className:"text-sm",children:[i.jsx("div",{children:h.email}),i.jsx("div",{className:"text-gray-500",children:h.contactNumber})]})}),i.jsx("td",{className:"p-4",children:i.jsx("span",{className:h.isActive?"status-active":"status-inactive",children:h.isActive?"Active":"Inactive"})}),i.jsxs("td",{className:"p-4",children:[i.jsx("div",{className:"flex items-center space-x-2",children:I?i.jsxs(i.Fragment,{children:[i.jsx("button",{onClick:()=>Ic(),className:"p-1 text-green-600 hover:text-green-700",title:"Save changes",children:i.jsx(wl,{className:"h-4 w-4"})}),i.jsx("button",{onClick:()=>N(null),className:"p-1 text-gray-600 hover:text-gray-700",title:"Cancel",children:i.jsx(tt,{className:"h-4 w-4"})})]}):i.jsxs(i.Fragment,{children:[i.jsx("button",{onClick:()=>Oc(h),className:"p-1 text-blue-600 hover:text-blue-700",title:"Edit clinic",children:i.jsx(as,{className:"h-4 w-4"})}),i.jsx("button",{onClick:()=>ni(ut===h.id?null:h.id),className:"p-1 text-amber-600 hover:text-amber-700",title:"Show/Hide Credentials (Emergency Access)",children:ut===h.id?i.jsx(l0,{className:"h-4 w-4"}):i.jsx(Wf,{className:"h-4 w-4"})}),i.jsx("button",{onClick:()=>Dc(h.id),className:"p-1 text-red-600 hover:text-red-700",title:"Delete clinic",children:i.jsx(os,{className:"h-4 w-4"})})]})}),ut===h.id&&i.jsxs("div",{className:"mt-3 p-4 bg-amber-50 border border-amber-200 rounded-lg",children:[i.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[i.jsx(Ht,{className:"h-4 w-4 text-amber-600"}),i.jsx("span",{className:"text-sm font-semibold text-amber-800",children:"Emergency Credentials"})]}),i.jsxs("div",{className:"space-y-2 text-sm",children:[i.jsxs("div",{className:"flex justify-between items-center",children:[i.jsx("span",{className:"text-gray-700 font-medium",children:"Clinic Code:"}),i.jsx("span",{className:"font-mono bg-white px-2 py-1 rounded border text-gray-900",children:h.code})]}),i.jsxs("div",{className:"flex justify-between items-center",children:[i.jsx("span",{className:"text-gray-700 font-medium",children:"Password:"}),i.jsx("span",{className:"font-mono bg-white px-2 py-1 rounded border text-gray-900",children:h.password})]})]}),i.jsxs("div",{className:"mt-3 p-2 bg-amber-100 rounded text-xs text-amber-800",children:[" ",i.jsx("strong",{children:"Emergency Use Only:"})," Only provide these credentials to clinic staff who have forgotten their login details. Keep this information secure."]})]})]})]},h.id)})})]})})]}),a==="settings"&&i.jsxs("div",{className:"space-y-6",children:[i.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"Admin Settings"}),i.jsx("div",{className:"light-card",children:i.jsxs("div",{className:"p-6",children:[i.jsxs("div",{className:"flex items-center justify-between mb-4",children:[i.jsxs("div",{children:[i.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Password Management"}),i.jsx("p",{className:"text-sm text-gray-600",children:"Change your admin password for security"})]}),i.jsx("button",{onClick:()=>Zt(!Tt),className:"light-button-primary",children:"Change Password"})]}),Tt&&i.jsx("div",{className:"border-t border-gray-200 pt-4",children:i.jsxs("form",{onSubmit:xe,className:"space-y-4 max-w-md",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Current Password"}),i.jsx("input",{type:"password",value:Ie.currentPassword,onChange:h=>je({...Ie,currentPassword:h.target.value}),className:"light-input",placeholder:"Enter current password",required:!0})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"New Password"}),i.jsx("input",{type:"password",value:Ie.newPassword,onChange:h=>je({...Ie,newPassword:h.target.value}),className:"light-input",placeholder:"Enter new password (min 8 characters)",minLength:8,required:!0})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Confirm New Password"}),i.jsx("input",{type:"password",value:Ie.confirmPassword,onChange:h=>je({...Ie,confirmPassword:h.target.value}),className:"light-input",placeholder:"Confirm new password",required:!0})]}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx("button",{type:"submit",className:"light-button-primary",children:"Update Password"}),i.jsx("button",{type:"button",onClick:()=>{Zt(!1),je({currentPassword:"",newPassword:"",confirmPassword:""})},className:"light-button-secondary",children:"Cancel"})]})]})})]})}),i.jsx("div",{className:"light-card",children:i.jsxs("div",{className:"p-6",children:[i.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"System Information"}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",children:[i.jsxs("div",{children:[i.jsx("span",{className:"font-medium text-gray-700",children:"Version:"}),i.jsx("span",{className:"ml-2 text-gray-600",children:"MOCARDS v3.0"})]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-medium text-gray-700",children:"Environment:"}),i.jsx("span",{className:"ml-2 text-gray-600",children:"Production"})]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-medium text-gray-700",children:"Last Login:"}),i.jsx("span",{className:"ml-2 text-gray-600",children:new Date().toLocaleString()})]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-medium text-gray-700",children:"Admin Username:"}),i.jsx("span",{className:"ml-2 text-gray-600",children:xt.username})]})]})]})})]})]})}),u.showModal&&i.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:i.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[i.jsxs("div",{className:"flex items-center justify-between mb-4",children:[i.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:u.editingPerk?"Edit Perk":"Create New Perk"}),i.jsx("button",{onClick:()=>f({...u,showModal:!1}),className:"text-gray-500 hover:text-gray-700",children:i.jsx(tt,{className:"h-5 w-5"})})]}),i.jsxs("form",{onSubmit:h=>{h.preventDefault(),Rt()},className:"space-y-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Type"}),i.jsx("select",{value:u.form.type,onChange:h=>f({...u,form:{...u.form,type:h.target.value}}),className:"light-select",children:Tr.map(h=>i.jsx("option",{value:h.value,children:h.label},h.value))})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Name"}),i.jsx("input",{type:"text",value:u.form.name,onChange:h=>f({...u,form:{...u.form,name:h.target.value}}),className:"light-input",placeholder:"e.g., Free Dental Cleaning",required:!0})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),i.jsx("textarea",{value:u.form.description,onChange:h=>f({...u,form:{...u.form,description:h.target.value}}),className:"light-input",placeholder:"Describe this perk...",rows:3,required:!0})]}),i.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Value (%)"}),i.jsx("input",{type:"number",min:"0",max:"100",value:u.form.value,onChange:h=>f({...u,form:{...u.form,value:parseInt(h.target.value)||0}}),className:"light-input",placeholder:"0"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Valid Days"}),i.jsx("input",{type:"number",min:"1",value:u.form.validFor,onChange:h=>f({...u,form:{...u.form,validFor:parseInt(h.target.value)||365}}),className:"light-input",placeholder:"365"})]})]}),i.jsxs("div",{className:"flex items-center space-x-6",children:[i.jsxs("label",{className:"flex items-center",children:[i.jsx("input",{type:"checkbox",checked:u.form.isActive,onChange:h=>f({...u,form:{...u.form,isActive:h.target.checked}}),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),i.jsx("span",{className:"ml-2 text-sm text-gray-700",children:"Active"})]}),i.jsxs("label",{className:"flex items-center",children:[i.jsx("input",{type:"checkbox",checked:u.form.requiresApproval,onChange:h=>f({...u,form:{...u.form,requiresApproval:h.target.checked}}),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),i.jsx("span",{className:"ml-2 text-sm text-gray-700",children:"Requires Approval"})]})]}),i.jsxs("div",{className:"flex gap-2 pt-4",children:[i.jsx("button",{type:"submit",className:"light-button-primary",children:u.editingPerk?"Update":"Create"}),i.jsx("button",{type:"button",onClick:()=>f({...u,showModal:!1}),className:"light-button-secondary",children:"Cancel"})]})]}),i.jsxs("div",{className:"mt-6",children:[i.jsx("h4",{className:"text-sm font-medium text-gray-900 mb-3",children:"Existing Perks"}),i.jsx("div",{className:"space-y-2 max-h-40 overflow-y-auto",children:Bn.map(h=>i.jsxs("div",{className:"flex items-center justify-between p-2 bg-gray-50 rounded",children:[i.jsxs("div",{children:[i.jsx("span",{className:"text-sm font-medium text-gray-900",children:h.name}),i.jsx("span",{className:`ml-2 text-xs px-2 py-1 rounded ${h.isActive?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"}`,children:h.isActive?"Active":"Inactive"})]}),i.jsxs("div",{className:"flex space-x-1",children:[i.jsx("button",{onClick:()=>Vn(h),className:"text-blue-600 hover:text-blue-800",children:i.jsx(as,{className:"h-4 w-4"})}),i.jsx("button",{onClick:()=>De(h),className:"text-red-600 hover:text-red-800",children:i.jsx(os,{className:"h-4 w-4"})})]})]},h.id))})]})]})})]})}const xx=({type:t})=>{const e={size:20};switch(t){case"success":return i.jsx(s0,{...e,className:"text-green-500"});case"error":return i.jsx(Hf,{...e,className:"text-red-500"});case"warning":return i.jsx(zs,{...e,className:"text-yellow-500"});case"info":return i.jsx(Qu,{...e,className:"text-blue-500"});case"loading":return i.jsx(d0,{...e,className:"text-blue-500 animate-spin"});default:return i.jsx(Qu,{...e,className:"text-gray-500"})}},wx=({toast:t})=>{const{removeToast:e}=Er(),r={success:"bg-green-50 border-green-200",error:"bg-red-50 border-red-200",warning:"bg-yellow-50 border-yellow-200",info:"bg-blue-50 border-blue-200",loading:"bg-blue-50 border-blue-200"},n={success:"text-green-800",error:"text-red-800",warning:"text-yellow-800",info:"text-blue-800",loading:"text-blue-800"};return i.jsx("div",{className:`
        max-w-sm w-full ${r[t.type]} border rounded-lg shadow-lg p-4
        transform transition-all duration-300 ease-in-out
        hover:shadow-xl animate-in slide-in-from-right-full
      `,children:i.jsxs("div",{className:"flex items-start gap-3",children:[i.jsx(xx,{type:t.type}),i.jsxs("div",{className:"flex-1 min-w-0",children:[i.jsx("h4",{className:`font-medium ${n[t.type]} text-sm`,children:t.title}),t.message&&i.jsx("p",{className:`mt-1 text-sm ${n[t.type]} opacity-90`,children:t.message}),t.action&&i.jsx("button",{onClick:t.action.onClick,className:`
                mt-2 text-sm font-medium ${n[t.type]}
                hover:underline focus:outline-none focus:underline
              `,children:t.action.label})]}),i.jsx("button",{onClick:()=>e(t.id),className:`
            ${n[t.type]} opacity-60 hover:opacity-100
            transition-opacity focus:outline-none
          `,children:i.jsx(tt,{size:16})})]})})},_x=()=>{const{toasts:t}=Er();return t.length===0?null:i.jsx("div",{className:"fixed top-4 right-4 z-50 space-y-2 max-h-screen overflow-y-auto",children:t.map(e=>i.jsx(wx,{toast:e},e.id))})};function bx(){const[t,e]=k.useState("card-lookup"),{isAuthenticated:r,user:n}=Rc(),s=()=>{switch(t){case"card-lookup":return i.jsx(Td,{});case"clinic-portal":return i.jsx(yx,{});case"admin-access":return i.jsx(vx,{});default:return i.jsx(Td,{})}},a=o=>{if(o==="card-lookup"){e(o);return}r&&n&&(n.type==="admin"&&o==="clinic-portal"||n.type==="clinic"&&o==="admin-access")||e(o)};return i.jsxs(v0,{children:[i.jsx(fx,{currentView:t,onViewChange:a,isAuthenticated:r,userType:n==null?void 0:n.type,children:s()}),i.jsx(_x,{})]})}ko.createRoot(document.getElementById("root")).render(i.jsx(Fm.StrictMode,{children:i.jsx(bx,{})}));
