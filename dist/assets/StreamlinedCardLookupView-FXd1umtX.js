import{u as y,j as e,t as h,a as v,b as w}from"./index-BYwebZkp.js";import{r as i}from"./charts-sad3owxz.js";import{d as C}from"./supabase-BYaNx0mI.js";import{S as d,U as n,G as k,M as S,P as T,d as _,b as P}from"./icons-BldG30mL.js";import"./vendor-N--QU9DW.js";import"./database-BUiByx9r.js";function I(){const[t,u]=i.useState(""),[a,m]=i.useState(null),[r,x]=i.useState(!1),[g,o]=i.useState(!1),{addToast:l}=y(),c=async()=>{if(!t.trim()){l(h("Empty Search","Please enter a MOC card number"));return}x(!0),o(!1),m(null),await new Promise(s=>setTimeout(s,800));try{const s=await C.getCardByControlNumber(t.trim());if(s){const p={id:s.id,controlNumber:s.control_number||s.unified_control_number||`${s.card_number}`,fullName:s.cardholder_name||"Card Holder",status:s.status==="activated"||s.status==="active"?"active":s.expires_at&&new Date(s.expires_at)<new Date?"expired":"inactive",perksTotal:5,perksUsed:s.perks?.filter(f=>f.claimed).length||0,clinicId:s.assigned_clinic_id||"",clinicName:s.clinic_name||(s.assigned_clinic_id?"Assigned Clinic":"Not Assigned"),expiryDate:s.expires_at?.split("T")[0]||"2025-12-31",createdAt:s.created_at};m(p),l(v("Card Found","Card information retrieved successfully"))}else o(!0),l(h("Card Not Found","No MOC card found with this number"))}catch(s){console.error("Search error:",s),l(w("Search Error","Failed to search for card"))}finally{x(!1)}},j=s=>{s.key==="Enter"&&c()},N=s=>{switch(s){case"active":return"bg-green-100 text-green-800 border-green-200";case"expired":return"bg-red-100 text-red-800 border-red-200";case"inactive":return"bg-gray-100 text-gray-800 border-gray-200";default:return"bg-gray-100 text-gray-800 border-gray-200"}},b=s=>{switch(s){case"active":return e.jsx(P,{className:"h-4 w-4 text-green-600"});case"expired":return e.jsx(_,{className:"h-4 w-4 text-red-600"});case"inactive":return e.jsx(n,{className:"h-4 w-4 text-gray-600"});default:return e.jsx(n,{className:"h-4 w-4 text-gray-600"})}};return e.jsxs("div",{className:"min-h-screen bg-gray-50 px-3 sm:px-0",children:[e.jsx("div",{className:"light-card mb-6",children:e.jsx("div",{className:"p-6",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-16 h-16 bg-blue-100 rounded-2xl flex items-center justify-center mx-auto mb-4",children:e.jsx(d,{className:"h-8 w-8 text-blue-600"})}),e.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Card Lookup"}),e.jsx("p",{className:"text-gray-600",children:"Enter a MOC card number to view complete card details"})]})})}),e.jsx("div",{className:"light-card mb-6",children:e.jsx("div",{className:"p-6",children:e.jsxs("div",{className:"max-w-md mx-auto",children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"MOC Card Number"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"text",value:t,onChange:s=>u(s.target.value),onKeyPress:j,placeholder:"Enter card number (e.g., MOC-12345-4A-CVT001)",className:"light-input pr-12",disabled:r}),e.jsx("button",{onClick:c,disabled:r,className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-blue-600 hover:text-blue-800 disabled:text-gray-400",children:e.jsx(d,{className:"h-5 w-5"})})]})]}),e.jsx("button",{onClick:c,disabled:r,className:"light-button-primary w-full",children:r?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-2 border-white border-t-transparent mr-2"}),"Searching..."]}):e.jsxs(e.Fragment,{children:[e.jsx(d,{className:"h-4 w-4 mr-2"}),"Search Card"]})})]})})}),a&&e.jsx("div",{className:"light-card",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"text-center mb-6",children:[e.jsx("div",{className:"w-16 h-16 bg-green-100 rounded-2xl flex items-center justify-center mx-auto mb-4",children:e.jsx(n,{className:"h-8 w-8 text-green-600"})}),e.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"Card Details Found"}),e.jsx("p",{className:"text-gray-600",children:"Complete information for this MOC card"})]}),e.jsxs("div",{className:"max-w-2xl mx-auto",children:[e.jsxs("div",{className:"bg-gray-50 p-4 rounded-xl mb-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("h3",{className:"font-semibold text-gray-900",children:"Card Information"}),e.jsxs("div",{className:`flex items-center space-x-2 px-3 py-1 rounded-full border ${N(a.status)}`,children:[b(a.status),e.jsx("span",{className:"text-sm font-medium capitalize",children:a.status})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Card Number"}),e.jsx("p",{className:"font-mono text-sm font-semibold text-gray-900",children:a.controlNumber})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Cardholder"}),e.jsx("p",{className:"font-medium text-gray-900",children:a.fullName})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Expires"}),e.jsx("p",{className:"font-medium text-gray-900",children:new Date(a.expiryDate).toLocaleDateString()})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Created"}),e.jsx("p",{className:"font-medium text-gray-900",children:new Date(a.createdAt).toLocaleDateString()})]})]})]}),e.jsxs("div",{className:"bg-blue-50 p-4 rounded-xl mb-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("h3",{className:"font-semibold text-gray-900 flex items-center",children:[e.jsx(k,{className:"h-4 w-4 mr-2 text-blue-600"}),"Benefits & Perks"]}),e.jsxs("span",{className:"text-sm text-blue-700 font-medium",children:[a.perksTotal-a.perksUsed," remaining"]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Total Perks"}),e.jsx("p",{className:"font-semibold text-blue-700",children:a.perksTotal})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Used"}),e.jsx("p",{className:"font-semibold text-gray-700",children:a.perksUsed})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Available"}),e.jsx("p",{className:"font-semibold text-green-700",children:a.perksTotal-a.perksUsed})]})]}),e.jsxs("div",{className:"mt-3",children:[e.jsxs("div",{className:"flex justify-between text-xs text-gray-600 mb-1",children:[e.jsx("span",{children:"Usage Progress"}),e.jsxs("span",{children:[Math.round(a.perksUsed/a.perksTotal*100),"%"]})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:"bg-blue-600 h-2 rounded-full transition-all duration-300",style:{width:`${a.perksUsed/a.perksTotal*100}%`}})})]})]}),e.jsxs("div",{className:"bg-green-50 p-4 rounded-xl",children:[e.jsxs("h3",{className:"font-semibold text-gray-900 flex items-center mb-3",children:[e.jsx(S,{className:"h-4 w-4 mr-2 text-green-600"}),"Clinic Assignment"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Assigned Clinic"}),e.jsx("p",{className:"font-medium text-gray-900",children:a.clinicName||"Not assigned to any clinic"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Clinic ID"}),e.jsx("p",{className:"font-mono text-sm text-gray-700",children:a.clinicId||"N/A"})]})]}),a.clinicId&&e.jsx("div",{className:"mt-3 p-3 bg-white rounded-lg border border-green-200",children:e.jsxs("div",{className:"flex items-center text-green-700",children:[e.jsx(T,{className:"h-4 w-4 mr-2"}),e.jsx("span",{className:"text-sm font-medium",children:"Card is ready for clinic services"})]})})]})]})]})}),g&&e.jsx("div",{className:"light-card",children:e.jsx("div",{className:"p-6",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-2xl flex items-center justify-center mx-auto mb-4",children:e.jsx(d,{className:"h-8 w-8 text-gray-400"})}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Card Not Found"}),e.jsxs("p",{className:"text-gray-600 mb-4",children:['No MOC card found with the number "',t,'".']}),e.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:e.jsxs("p",{className:"text-yellow-800 text-sm",children:[e.jsx("strong",{children:"Please check:"}),e.jsx("br",{}),"• The card number is correct",e.jsx("br",{}),"• The card has been properly activated",e.jsx("br",{}),"• Try searching without spaces or dashes"]})})]})})})]})}export{I as StreamlinedCardLookupView};
