import{u as p,j as e,t as o,d as f,a as g,b as v}from"./index-_Qz0svUm.js";import{r as c}from"./charts-sad3owxz.js";import{b as d,p as y,S as C,C as w}from"./icons-79JrDgB8.js";import"./vendor-N--QU9DW.js";import"./database-BUiByx9r.js";function F(){const[t,h]=c.useState(""),[a,i]=c.useState(null),[r,m]=c.useState(!1),[u,x]=c.useState(!1),{addToast:l}=p(),n=async()=>{if(!t.trim()){l(o("Empty Search","Please enter a MOC card number"));return}m(!0),x(!1),i(null);try{const s=await f.getCardByControlNumber(t.trim());if(s){const b={id:s.id,controlNumber:s.control_number||s.unified_control_number||`${s.card_number}`,fullName:s.cardholder_name||"Cardholder",status:s.status==="activated"||s.status==="active"?"active":"inactive",perksTotal:5,perksUsed:s.perks?.filter(j=>j.claimed).length||0,clinicId:s.assigned_clinic_id||"",expiryDate:s.expires_at?.split("T")[0]||"2025-12-31",createdAt:s.created_at};i(b),l(g("Card Found","Card information retrieved successfully"))}else x(!0),l(o("Card Not Found","No MOC card found with this number"))}catch(s){console.error("Search error:",s),l(v("Search Error","Failed to search for card"))}finally{m(!1)}},N=s=>{s.key==="Enter"&&n()};return e.jsxs("div",{className:"min-h-screen bg-gray-50 px-3 sm:px-0",children:[e.jsx("div",{className:"light-card mb-6",children:e.jsx("div",{className:"p-6",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-16 h-16 bg-blue-100 rounded-2xl flex items-center justify-center mx-auto mb-4",children:e.jsx(d,{className:"h-8 w-8 text-blue-600"})}),e.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Card Lookup"}),e.jsx("p",{className:"text-gray-600",children:"Enter a MOC card number to view card details"})]})})}),e.jsx("div",{className:"light-card mb-6",children:e.jsx("div",{className:"p-6",children:e.jsxs("div",{className:"max-w-md mx-auto",children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"MOC Card Number"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"text",value:t,onChange:s=>h(s.target.value),onKeyPress:N,placeholder:"Enter card number (e.g., MOC-12345-4A-CVT001)",className:"light-input pr-12",disabled:r}),e.jsx("button",{onClick:n,disabled:r,className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-blue-600 hover:text-blue-800 disabled:text-gray-400",children:e.jsx(d,{className:"h-5 w-5"})})]})]}),e.jsx("button",{onClick:n,disabled:r,className:"light-button-primary w-full",children:r?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-2 border-white border-t-transparent mr-2"}),"Searching..."]}):e.jsxs(e.Fragment,{children:[e.jsx(d,{className:"h-4 w-4 mr-2"}),"Search Card"]})})]})})}),a&&e.jsx("div",{className:"light-card",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"text-center mb-6",children:[e.jsx("div",{className:"w-16 h-16 bg-green-100 rounded-2xl flex items-center justify-center mx-auto mb-4",children:e.jsx(y,{className:"h-8 w-8 text-green-600"})}),e.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"Card Details"})]}),e.jsxs("div",{className:"max-w-md mx-auto space-y-4",children:[e.jsxs("div",{className:"bg-gray-50 p-4 rounded-xl",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Card Number"}),e.jsx("span",{className:"font-mono text-sm font-medium",children:a.controlNumber})]}),e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Status"}),e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${a.status==="active"?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:a.status})]}),e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Perks Available"}),e.jsxs("span",{className:"text-sm font-medium",children:[a.perksTotal-a.perksUsed," / ",a.perksTotal]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Expires"}),e.jsx("span",{className:"text-sm font-medium",children:a.expiryDate})]})]}),a.status==="active"&&e.jsxs("div",{className:"bg-green-50 p-4 rounded-xl border border-green-200",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(C,{className:"h-5 w-5 text-green-600 mr-2"}),e.jsx("span",{className:"text-green-800 font-medium",children:"Valid Card"})]}),e.jsx("p",{className:"text-green-700 text-sm mt-1",children:"This card is active and can be used for services."})]}),a.status!=="active"&&e.jsxs("div",{className:"bg-red-50 p-4 rounded-xl border border-red-200",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(w,{className:"h-5 w-5 text-red-600 mr-2"}),e.jsx("span",{className:"text-red-800 font-medium",children:"Inactive Card"})]}),e.jsx("p",{className:"text-red-700 text-sm mt-1",children:"This card is not active. Please contact the clinic for assistance."})]})]})]})}),u&&e.jsx("div",{className:"light-card",children:e.jsx("div",{className:"p-6",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-2xl flex items-center justify-center mx-auto mb-4",children:e.jsx(d,{className:"h-8 w-8 text-gray-400"})}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Card Not Found"}),e.jsxs("p",{className:"text-gray-600",children:['No MOC card found with the number "',t,'". Please check the card number and try again.']})]})})})]})}export{F as SimpleCardLookupView};
