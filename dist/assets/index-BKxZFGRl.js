const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/EnhancedCardLookupView-CaROf2s4.js","assets/charts-sad3owxz.js","assets/vendor-N--QU9DW.js","assets/icons-DSdcywBl.js","assets/database-BUiByx9r.js","assets/ClinicPortalView-BPuvy11G.js","assets/data-BqNksC5g.js","assets/AdminPortalView-DNkCU9Ih.js"])))=>i.map(i=>d[i]);
import{r as fe,a as ge,g as ye}from"./vendor-N--QU9DW.js";import{r as m,R as be}from"./charts-sad3owxz.js";import{S as C,E as ve,A as _,a as z,L as V,U as we,C as Ne,T as Se,X as k,M as H,b as le,c as de,d as je,H as Ce,e as J,D as Z,f as X,g as Y,h as E,i as Ae,j as ue,W as K,k as Q,l as _e,R as ke,I as ee,m as Ie,n as Ee,o as Te}from"./icons-DSdcywBl.js";import{c as me}from"./database-BUiByx9r.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))a(n);new MutationObserver(n=>{for(const l of n)if(l.type==="childList")for(const i of l.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&a(i)}).observe(document,{childList:!0,subtree:!0});function s(n){const l={};return n.integrity&&(l.integrity=n.integrity),n.referrerPolicy&&(l.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?l.credentials="include":n.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function a(n){if(n.ep)return;n.ep=!0;const l=s(n);fetch(n.href,l)}})();var P={exports:{}},j={};var te;function Re(){if(te)return j;te=1;var r=fe(),t=Symbol.for("react.element"),s=Symbol.for("react.fragment"),a=Object.prototype.hasOwnProperty,n=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,l={key:!0,ref:!0,__self:!0,__source:!0};function i(f,u,d){var p,o={},c=null,h=null;d!==void 0&&(c=""+d),u.key!==void 0&&(c=""+u.key),u.ref!==void 0&&(h=u.ref);for(p in u)a.call(u,p)&&!l.hasOwnProperty(p)&&(o[p]=u[p]);if(f&&f.defaultProps)for(p in u=f.defaultProps,u)o[p]===void 0&&(o[p]=u[p]);return{$$typeof:t,type:f,key:c,ref:h,props:o,_owner:n.current}}return j.Fragment=s,j.jsx=i,j.jsxs=i,j}var se;function Le(){return se||(se=1,P.exports=Re()),P.exports}var e=Le(),T={},re;function De(){if(re)return T;re=1;var r=ge();return T.createRoot=r.createRoot,T.hydrateRoot=r.hydrateRoot,T}var Me=De();const Pe=ye(Me),Oe="modulepreload",$e=function(r){return"/"+r},ae={},B=function(t,s,a){let n=Promise.resolve();if(s&&s.length>0){let u=function(d){return Promise.all(d.map(p=>Promise.resolve(p).then(o=>({status:"fulfilled",value:o}),o=>({status:"rejected",reason:o}))))};document.getElementsByTagName("link");const i=document.querySelector("meta[property=csp-nonce]"),f=i?.nonce||i?.getAttribute("nonce");n=u(s.map(d=>{if(d=$e(d),d in ae)return;ae[d]=!0;const p=d.endsWith(".css"),o=p?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${d}"]${o}`))return;const c=document.createElement("link");if(c.rel=p?"stylesheet":Oe,p||(c.as="script"),c.crossOrigin="",c.href=d,f&&c.setAttribute("nonce",f),document.head.appendChild(c),p)return new Promise((h,x)=>{c.addEventListener("load",h),c.addEventListener("error",()=>x(new Error(`Unable to preload CSS for ${d}`)))})}))}function l(i){const f=new Event("vite:preloadError",{cancelable:!0});if(f.payload=i,window.dispatchEvent(f),!f.defaultPrevented)throw i}return n.then(i=>{for(const f of i||[])f.status==="rejected"&&l(f.reason);return t().catch(l)})};class w{static config={maxLoginAttempts:5,lockoutDuration:15,sessionDuration:480,passwordMinLength:8,requireTwoFactor:!1};static rateLimits=new Map([["login",{windowMs:900*1e3,maxRequests:5}],["search",{windowMs:60*1e3,maxRequests:30}],["api",{windowMs:60*1e3,maxRequests:100}],["export",{windowMs:3600*1e3,maxRequests:10}]]);static attempts=new Map;static events=[];static sanitizeInput(t){return typeof t!="string"?"":t.trim().replace(/[<>\"']/g,"").replace(/[\x00-\x1F\x7F]/g,"").slice(0,1e3)}static validateControlNumber(t){const s=this.sanitizeInput(t);return s?/(union|select|insert|update|delete|drop|exec|script)/i.test(s)?(this.logSecurityEvent({type:"SUSPICIOUS_ACTIVITY",ip:"unknown",userAgent:"unknown",severity:"HIGH",details:{input:s,reason:"SQL injection attempt"}}),{valid:!1,message:"Invalid characters detected"}):/^MOC-[\w\d-]+$/.test(s)?s.length>50?{valid:!1,message:"Control number too long"}:{valid:!0}:{valid:!1,message:"Invalid control number format"}:{valid:!1,message:"Control number is required"}}static checkRateLimit(t,s){const a=this.rateLimits.get(t);if(!a)return{allowed:!0};const n=Date.now(),l=`${t}:${s}`,i=this.attempts.get(l);if(!i)return this.attempts.set(l,{count:1,lastAttempt:new Date(n),blocked:!1}),{allowed:!0};if(n-i.lastAttempt.getTime()>a.windowMs)return this.attempts.set(l,{count:1,lastAttempt:new Date(n),blocked:!1}),{allowed:!0};if(i.count>=a.maxRequests){const f=Math.ceil((a.windowMs-(n-i.lastAttempt.getTime()))/1e3);return this.logSecurityEvent({type:"RATE_LIMIT",ip:s,userAgent:"unknown",severity:"MEDIUM",details:{key:t,attempts:i.count,limit:a.maxRequests}}),{allowed:!1,retryAfter:f}}return i.count++,i.lastAttempt=new Date(n),{allowed:!0}}static createSession(t,s){const a={userId:t,userType:s,createdAt:new Date,expiresAt:new Date(Date.now()+this.config.sessionDuration*60*1e3),csrfToken:this.generateSecureToken()},n=this.generateSecureToken();return localStorage.setItem(`mocards_session_${n}`,JSON.stringify(a)),this.logSecurityEvent({type:"LOGIN_ATTEMPT",userId:t,ip:"unknown",userAgent:navigator.userAgent,severity:"LOW",details:{userType:s,sessionToken:n}}),n}static validateSession(t){try{const s=localStorage.getItem(`mocards_session_${t}`);if(!s)return{valid:!1};const a=JSON.parse(s);return new Date>new Date(a.expiresAt)?(this.destroySession(t),{valid:!1}):{valid:!0,userId:a.userId,userType:a.userType}}catch{return{valid:!1}}}static destroySession(t){localStorage.removeItem(`mocards_session_${t}`)}static validatePassword(t){const s=this.sanitizeInput(t);let a=0;if(s.length<this.config.passwordMinLength)return{valid:!1,message:`Password must be at least ${this.config.passwordMinLength} characters`,strength:0};s.length>=8&&(a+=20),s.length>=12&&(a+=10),/[a-z]/.test(s)&&(a+=20),/[A-Z]/.test(s)&&(a+=20),/[0-9]/.test(s)&&(a+=15),/[^a-zA-Z0-9]/.test(s)&&(a+=15);const n=a>=80?"Strong":a>=60?"Good":"Weak";return{valid:a>=60,message:a<60?`Password is too weak (${n})`:void 0,strength:a}}static logSecurityEvent(t){const s={...t,id:this.generateSecureToken(),timestamp:new Date};this.events.push(s),this.events.length>1e3&&(this.events=this.events.slice(-1e3)),(t.severity==="CRITICAL"||t.severity==="HIGH")&&console.warn("ðŸ”’ Security Alert:",s),this.sendToMonitoring(s)}static getSecurityEvents(t){return t?this.events.filter(s=>s.severity===t):this.events.slice(-100)}static validateFileUpload(t){return["application/pdf","image/jpeg","image/png","text/csv"].includes(t.type)?t.size>10485760?{valid:!1,message:"File size exceeds 10MB limit"}:{valid:!0}:{valid:!1,message:`File type '${t.type}' is not allowed`}}static generateSecureToken(t=32){const s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";let a="";const n=new Uint8Array(t);crypto.getRandomValues(n);for(let l=0;l<t;l++)a+=s[n[l]%s.length];return a}static sendToMonitoring(t){typeof window<"u"&&console.log("ðŸ“Š Security Event:",t.type,t.severity)}static updateConfig(t){this.config={...this.config,...t}}static getConfig(){return{...this.config}}static addRateLimit(t,s){this.rateLimits.set(t,s)}static getSecurityMetrics(){const t={LOW:0,MEDIUM:0,HIGH:0,CRITICAL:0};this.events.forEach(n=>{t[n.severity]++});const s=this.events.filter(n=>n.type==="RATE_LIMIT").length,a=Array.from(this.attempts.values()).filter(n=>n.blocked).length;return{totalEvents:this.events.length,eventsBySeverity:t,recentThreats:this.events.filter(n=>n.severity==="HIGH"||n.severity==="CRITICAL").slice(-10),rateLimitViolations:s,activeBlocks:a}}}const ze=()=>`toast-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,L=(r,t,s,a)=>({type:r,title:t,message:s,duration:a?.duration??(r==="loading"?void 0:5e3),action:a?.action,persistent:a?.persistent??r==="loading"}),ne=(r,t,s)=>L("success",r,t,{action:s}),q=(r,t,s)=>L("error",r,t,{action:s,duration:7e3}),qe=(r,t,s)=>L("warning",r,t,{action:s}),A=(r,t,s)=>L("info",r,t,{action:s}),pe=m.createContext(void 0),D=()=>{const r=m.useContext(pe);if(!r)throw new Error("useToast must be used within a ToastProvider");return r},Be=({children:r})=>{const[t,s]=m.useState([]),a=m.useCallback(u=>{const d=ze(),p={...u,id:d};return s(o=>[...o,p]),!u.persistent&&u.duration&&setTimeout(()=>{n(d)},u.duration),d},[]),n=m.useCallback(u=>{s(d=>d.filter(p=>p.id!==u))},[]),l=m.useCallback((u,d)=>{s(p=>p.map(o=>o.id===u?{...o,...d}:o))},[]),i=m.useCallback(()=>{s([])},[]),f={toasts:t,addToast:a,removeToast:n,updateToast:l,clearAllToasts:i};return e.jsx(pe.Provider,{value:f,children:r})},Ge=()=>{const[r,t]=m.useState({isBlocked:!1,attempts:0}),{addToast:s}=D(),a=m.useCallback((c,h)=>{const x=h||We(),g=w.checkRateLimit(c,x);return g.allowed?!0:(t(I=>({...I,isBlocked:!0,retryAfter:g.retryAfter,attempts:I.attempts+1,lastAttempt:new Date})),s(qe("Rate Limit Exceeded",`Too many ${c} attempts. Please try again in ${g.retryAfter} seconds.`,{label:"Understand",onClick:()=>{}})),!1)},[s]),n=m.useCallback((c,h="general")=>{if(h==="control_number")return w.validateControlNumber(c);{const x=w.sanitizeInput(c);return{valid:x===c,message:x!==c?"Input contains invalid characters":void 0,sanitized:x}}},[]),l=m.useCallback(c=>{const h=w.validateFileUpload(c);return h.valid||s(q("File Upload Error",h.message||"Invalid file",{label:"Try Again",onClick:()=>{}})),h},[s]),i=m.useCallback((c,h)=>{const x=w.createSession(c,h);return s(A("Secure Session Created","Your session is encrypted and will auto-expire for security.",{label:"Got it",onClick:()=>{}})),x},[s]),f=m.useCallback(c=>w.validateSession(c),[]),u=m.useCallback(c=>{w.destroySession(c),s(A("Session Ended","You have been securely logged out."))},[s]),d=m.useCallback(c=>w.validatePassword(c),[]),p=m.useCallback(()=>w.getSecurityMetrics(),[]),o=m.useCallback(c=>w.getSecurityEvents(c),[]);return m.useEffect(()=>{if(r.isBlocked&&r.retryAfter){const c=setTimeout(()=>{t(h=>({...h,isBlocked:!1,retryAfter:void 0})),s(A("Access Restored","You can now try again."))},r.retryAfter*1e3);return()=>clearTimeout(c)}},[r.isBlocked,r.retryAfter,s]),{securityState:r,checkRateLimit:a,validateInput:n,validateFileUpload:l,createSecureSession:i,validateSession:f,destroySession:u,validatePassword:d,getSecurityMetrics:p,getSecurityEvents:o}};function We(){const r=localStorage.getItem("mocards_client_id");if(r)return r;const t=Ue();return localStorage.setItem("mocards_client_id",t),t}function Ue(){const r=[navigator.userAgent,screen.width+"x"+screen.height,new Date().getTimezoneOffset(),navigator.language].join("|");let t=0;for(let s=0;s<r.length;s++){const a=r.charCodeAt(s);t=(t<<5)-t+a,t=t&t}return Math.abs(t).toString(36)+Date.now().toString(36)}const O=({className:r="",compact:t=!1})=>{const[s,a]=m.useState(null),[n,l]=m.useState(!1),{getSecurityMetrics:i}=Ge();if(m.useEffect(()=>{const o=()=>{const h=i();a(h)};o();const c=setInterval(o,3e4);return()=>clearInterval(c)},[i]),!s)return e.jsx("div",{className:`bg-[#1F2937] rounded-lg border border-[#374151] p-4 ${r}`,children:e.jsxs("div",{className:"animate-pulse",children:[e.jsx("div",{className:"h-6 bg-[#374151] rounded w-48 mb-4"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"h-4 bg-[#374151] rounded w-full"}),e.jsx("div",{className:"h-4 bg-[#374151] rounded w-3/4"})]})]})});const f=o=>{switch(o.toUpperCase()){case"CRITICAL":return"text-red-400 bg-red-900/20";case"HIGH":return"text-orange-400 bg-orange-900/20";case"MEDIUM":return"text-yellow-400 bg-yellow-900/20";case"LOW":return"text-blue-400 bg-blue-900/20";default:return"text-gray-400 bg-gray-900/20"}},d=(()=>{const{eventsBySeverity:o}=s,c=o.CRITICAL||0,h=o.HIGH||0,x=o.MEDIUM||0;let g=100;return g-=c*20,g-=h*10,g-=x*5,Math.max(g,0)})(),p=d>=80?"text-green-400":d>=60?"text-yellow-400":"text-red-400";return e.jsxs("div",{className:`bg-[#1F2937] rounded-lg border border-[#374151] ${r}`,children:[e.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-[#374151]",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(C,{className:"h-5 w-5 text-blue-400 mr-2"}),e.jsx("h3",{className:"text-[#E8EAED] font-medium",children:"Security Monitor"}),e.jsxs("div",{className:`ml-3 px-2 py-1 rounded text-xs font-medium ${p.replace("text-","bg-").replace("400","900/20")}`,children:["Score: ",e.jsxs("span",{className:p,children:[d,"/100"]})]})]}),e.jsx("button",{onClick:()=>l(!n),className:"text-[#9AA0A6] hover:text-[#E8EAED] transition-colors",children:e.jsx(ve,{className:"h-4 w-4"})})]}),e.jsxs("div",{className:"p-4",children:[e.jsxs("div",{className:`grid gap-4 mb-4 ${t?"grid-cols-2":"grid-cols-2 md:grid-cols-4"}`,children:[e.jsxs("div",{className:"bg-[#303134] rounded-lg p-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(_,{className:"h-4 w-4 text-blue-400"}),e.jsx("span",{className:"text-xs text-[#9AA0A6]",children:"Total Events"})]}),e.jsx("div",{className:"text-lg font-bold text-[#E8EAED] mt-1",children:s.totalEvents})]}),e.jsxs("div",{className:"bg-[#303134] rounded-lg p-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(z,{className:"h-4 w-4 text-red-400"}),e.jsx("span",{className:"text-xs text-[#9AA0A6]",children:"Threats"})]}),e.jsx("div",{className:"text-lg font-bold text-[#E8EAED] mt-1",children:(s.eventsBySeverity.HIGH||0)+(s.eventsBySeverity.CRITICAL||0)})]}),e.jsxs("div",{className:"bg-[#303134] rounded-lg p-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(V,{className:"h-4 w-4 text-yellow-400"}),e.jsx("span",{className:"text-xs text-[#9AA0A6]",children:"Rate Limits"})]}),e.jsx("div",{className:"text-lg font-bold text-[#E8EAED] mt-1",children:s.rateLimitViolations})]}),e.jsxs("div",{className:"bg-[#303134] rounded-lg p-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(we,{className:"h-4 w-4 text-purple-400"}),e.jsx("span",{className:"text-xs text-[#9AA0A6]",children:"Blocked"})]}),e.jsx("div",{className:"text-lg font-bold text-[#E8EAED] mt-1",children:s.activeBlocks})]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("h4",{className:"text-[#E8EAED] text-sm font-medium mb-2",children:"Event Severity Distribution"}),e.jsx("div",{className:"space-y-2",children:Object.entries(s.eventsBySeverity).map(([o,c])=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:`w-3 h-3 rounded-full mr-2 ${f(o).split(" ")[1]}`}),e.jsx("span",{className:"text-[#9AA0A6] text-sm capitalize",children:o.toLowerCase()})]}),e.jsx("span",{className:"text-[#E8EAED] font-medium",children:c})]},o))})]})]}),n&&e.jsxs("div",{className:"border-t border-[#374151] p-4",children:[e.jsx("h4",{className:"text-[#E8EAED] text-sm font-medium mb-3",children:"Recent Security Events"}),s.recentThreats.length===0?e.jsxs("div",{className:"text-center py-4",children:[e.jsx(C,{className:"h-8 w-8 text-green-400 mx-auto mb-2"}),e.jsx("p",{className:"text-[#9AA0A6] text-sm",children:"No security threats detected"}),e.jsx("p",{className:"text-[#9AA0A6] text-xs",children:"All systems operating normally"})]}):e.jsx("div",{className:"space-y-2",children:s.recentThreats.slice(0,5).map(o=>e.jsx("div",{className:"bg-[#303134] rounded-lg p-3",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center mb-1",children:[e.jsx("span",{className:`px-2 py-1 rounded text-xs font-medium ${f(o.severity)}`,children:o.severity}),e.jsx("span",{className:"text-[#9AA0A6] text-sm ml-2",children:o.type.replace("_"," ")})]}),e.jsx("p",{className:"text-[#E8EAED] text-sm",children:o.details.reason||"Security event detected"})]}),e.jsxs("div",{className:"flex items-center text-[#9AA0A6] text-xs",children:[e.jsx(Ne,{className:"h-3 w-3 mr-1"}),new Date(o.timestamp).toLocaleTimeString()]})]})},o.id))}),e.jsxs("div",{className:"mt-4 pt-4 border-t border-[#374151]",children:[e.jsx("h4",{className:"text-[#E8EAED] text-sm font-medium mb-2",children:"Security Recommendations"}),e.jsxs("div",{className:"space-y-2",children:[d<80&&e.jsxs("div",{className:"flex items-start",children:[e.jsx(Se,{className:"h-4 w-4 text-yellow-400 mr-2 mt-0.5 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-[#E8EAED] text-sm",children:"Improve Security Score"}),e.jsx("p",{className:"text-[#9AA0A6] text-xs",children:"Review recent security events and implement additional protections"})]})]}),s.rateLimitViolations>10&&e.jsxs("div",{className:"flex items-start",children:[e.jsx(V,{className:"h-4 w-4 text-blue-400 mr-2 mt-0.5 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-[#E8EAED] text-sm",children:"Review Rate Limiting"}),e.jsx("p",{className:"text-[#9AA0A6] text-xs",children:"High number of rate limit violations detected"})]})]}),(s.eventsBySeverity.HIGH||0)+(s.eventsBySeverity.CRITICAL||0)>0&&e.jsxs("div",{className:"flex items-start",children:[e.jsx(z,{className:"h-4 w-4 text-red-400 mr-2 mt-0.5 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-[#E8EAED] text-sm",children:"Address High Priority Threats"}),e.jsx("p",{className:"text-[#9AA0A6] text-xs",children:"Critical or high severity security events require attention"})]})]}),d>=80&&s.recentThreats.length===0&&e.jsxs("div",{className:"flex items-start",children:[e.jsx(C,{className:"h-4 w-4 text-green-400 mr-2 mt-0.5 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-[#E8EAED] text-sm",children:"Security Status Excellent"}),e.jsx("p",{className:"text-[#9AA0A6] text-xs",children:"All security systems operating normally"})]})]})]})]})]})]})},Fe=({currentView:r,onViewChange:t,onSecurityToggle:s,showSecurityDashboard:a,navItems:n})=>{const[l,i]=m.useState(!1),u=n||[{id:"card-lookup",label:"Card Lookup",icon:le,description:"Verify card validity",color:"text-blue-600",bgColor:"bg-blue-50",disabled:!1},{id:"clinic-portal",label:"Clinic Portal",icon:de,description:"Clinic management",color:"text-green-600",bgColor:"bg-green-50",disabled:!1},{id:"admin-access",label:"Admin Access",icon:C,description:"System administration",color:"text-purple-600",bgColor:"bg-purple-50",disabled:!1}],d=(o,c)=>{c||(t(o),i(!1))},p=()=>{i(!l)};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"lg:hidden bg-white shadow-lg border-b border-gray-200 fixed top-0 left-0 right-0 z-50",children:[e.jsxs("div",{className:"flex items-center justify-between px-4 py-3",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-8 h-8 bg-[#1A535C] rounded-lg flex items-center justify-center",children:e.jsx("span",{className:"text-white font-bold text-sm",children:"MC"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-lg font-bold text-gray-900",children:"MOCARDS"}),e.jsx("p",{className:"text-xs text-gray-500 -mt-1",children:"Dental Benefits Platform"})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:s,className:`p-2 rounded-lg transition-colors ${a?"bg-blue-600 text-white":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:e.jsx(_,{className:"h-4 w-4"})}),e.jsx("button",{onClick:p,className:"p-2 rounded-lg bg-gray-100 text-gray-600 hover:bg-gray-200 transition-colors",children:l?e.jsx(k,{className:"h-5 w-5"}):e.jsx(H,{className:"h-5 w-5"})})]})]}),e.jsx("div",{className:"px-4 pb-2",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-2 h-2 bg-[#1A535C] rounded-full"}),e.jsx("span",{className:"text-sm font-medium text-gray-700",children:u.find(o=>o.id===r)?.label})]})})]}),e.jsxs("div",{className:`lg:hidden fixed inset-0 z-50 transition-opacity duration-300 ${l?"opacity-100 visible":"opacity-0 invisible"}`,children:[e.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-50",onClick:()=>i(!1)}),e.jsxs("div",{className:`absolute right-0 top-0 h-full w-80 max-w-[85vw] bg-white shadow-xl transform transition-transform duration-300 ${l?"translate-x-0":"translate-x-full"}`,children:[e.jsx("div",{className:"p-6 bg-[#1A535C] text-white",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"text-xl font-bold",children:"MOCARDS CLOUD"}),e.jsx("button",{onClick:()=>i(!1),className:"p-2 rounded-lg hover:bg-white hover:bg-opacity-20 transition-colors",children:e.jsx(k,{className:"h-5 w-5"})})]})}),e.jsx("div",{className:"p-4 space-y-2",children:u.map(o=>{const c=o.icon,h=r===o.id,x=o.disabled;return e.jsxs("button",{onClick:()=>d(o.id,x),disabled:x,className:`w-full flex items-center space-x-3 p-4 rounded-xl transition-all duration-200 ${x?"bg-gray-200 text-gray-400 cursor-not-allowed opacity-60":h?"bg-[#1A535C] text-white shadow-lg":"hover:bg-gray-50 text-gray-700"}`,title:x?"Please logout to access this portal":void 0,children:[e.jsx("div",{className:`p-2 rounded-lg ${x?"bg-gray-300":h?"bg-white bg-opacity-20":o.bgColor}`,children:e.jsx(c,{className:`h-5 w-5 ${x?"text-gray-400":h?"text-white":o.color}`})}),e.jsxs("div",{className:"flex-1 text-left",children:[e.jsxs("div",{className:`font-medium ${x?"text-gray-400":h?"text-white":"text-gray-900"}`,children:[o.label,x&&e.jsx("span",{className:"ml-2",children:"ðŸ”’"})]}),e.jsx("div",{className:`text-sm ${x?"text-gray-500":h?"text-teal-200":"text-gray-500"}`,children:x?"Logout required":o.description})]}),e.jsx(je,{className:`h-4 w-4 ${x?"text-gray-400":h?"text-white":"text-gray-400"}`})]},o.id)})}),e.jsx("div",{className:"p-4 border-t border-gray-200",children:e.jsxs("button",{onClick:()=>{s(),i(!1)},className:`w-full flex items-center space-x-3 p-4 rounded-xl transition-all duration-200 ${a?"bg-blue-600 text-white":"hover:bg-blue-50 text-gray-700"}`,children:[e.jsx("div",{className:`p-2 rounded-lg ${a?"bg-white bg-opacity-20":"bg-blue-50"}`,children:e.jsx(_,{className:`h-5 w-5 ${a?"text-white":"text-blue-600"}`})}),e.jsxs("div",{className:"flex-1 text-left",children:[e.jsx("div",{className:`font-medium ${a?"text-white":"text-gray-900"}`,children:"Security Monitor"}),e.jsx("div",{className:`text-sm ${a?"text-blue-200":"text-gray-500"}`,children:"Live security dashboard"})]}),a&&e.jsx("div",{className:"w-2 h-2 bg-green-400 rounded-full animate-pulse"})]})}),e.jsx("div",{className:"absolute bottom-0 left-0 right-0 p-4 border-t border-gray-200 bg-gray-50",children:e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-xs text-gray-500",children:"MOCARDS v4.0"}),e.jsx("p",{className:"text-xs text-gray-400",children:"Â© 2025 Dental Group"})]})})]})]}),e.jsx("div",{className:"sm:hidden fixed bottom-0 left-0 right-0 z-40 bg-white border-t border-gray-200 shadow-lg",children:e.jsxs("div",{className:"grid grid-cols-4 py-2",children:[e.jsxs("button",{className:"flex flex-col items-center py-2 text-[#1A535C]",children:[e.jsx(Ce,{className:"h-5 w-5 mb-1"}),e.jsx("span",{className:"text-xs font-medium",children:"Home"})]}),u.slice(0,2).map(o=>{const c=o.icon,h=r===o.id;return e.jsxs("button",{onClick:()=>d(o.id),className:`flex flex-col items-center py-2 ${h?"text-[#1A535C]":"text-gray-400"}`,children:[e.jsx(c,{className:"h-5 w-5 mb-1"}),e.jsx("span",{className:"text-xs font-medium",children:o.label.split(" ")[0]})]},o.id)}),e.jsxs("button",{onClick:p,className:"flex flex-col items-center py-2 text-gray-600",children:[e.jsx(H,{className:"h-5 w-5 mb-1"}),e.jsx("span",{className:"text-xs font-medium",children:"Menu"})]})]})})]})},Ve=()=>{const[r,t]=m.useState(null),[s,a]=m.useState({isSupported:!1,isInstalled:!1,canInstall:!1,isStandalone:!1,platform:"unknown"});m.useEffect(()=>{const u=()=>{const p="serviceWorker"in navigator&&"PushManager"in window,o=window.matchMedia("(display-mode: standalone)").matches||window.navigator.standalone||document.referrer.includes("android-app://"),c=ie(),h=o||He();a({isSupported:p,isInstalled:h,canInstall:r!==null,isStandalone:o,platform:c})};u();const d=window.matchMedia("(display-mode: standalone)");return d.addListener(u),()=>d.removeListener(u)},[r]),m.useEffect(()=>{const u=p=>{console.log("[PWA] beforeinstallprompt fired"),p.preventDefault(),t(p)},d=()=>{console.log("[PWA] App was installed"),t(null),a(p=>({...p,isInstalled:!0,canInstall:!1}))};return window.addEventListener("beforeinstallprompt",u),window.addEventListener("appinstalled",d),()=>{window.removeEventListener("beforeinstallprompt",u),window.removeEventListener("appinstalled",d)}},[]),m.useEffect(()=>{s.isSupported&&Je()},[s.isSupported]);const n=m.useCallback(async()=>{if(!r)return{success:!1,error:"Installation prompt not available"};try{await r.prompt();const u=await r.userChoice;return console.log("[PWA] User choice:",u.outcome),u.outcome==="accepted"?(t(null),{success:!0,outcome:"accepted"}):{success:!1,outcome:"dismissed"}}catch(u){return console.error("[PWA] Installation failed:",u),{success:!1,error:u instanceof Error?u.message:"Installation failed"}}},[r]),l=m.useCallback(async u=>{const d={title:"MOCARDS Cloud - Dental Benefits Management Platform",text:"Professional dental benefits card management and clinic portal system",url:window.location.origin,...u};if(navigator.share)try{return await navigator.share(d),!0}catch(p){return p.name!=="AbortError"&&console.error("[PWA] Share failed:",p),!1}else try{return await navigator.clipboard.writeText(d.url),!0}catch(p){return console.error("[PWA] Clipboard write failed:",p),!1}},[]),i=m.useCallback(async()=>{if(!("Notification"in window))return console.warn("[PWA] This browser does not support notifications"),!1;if(Notification.permission==="granted")return!0;if(Notification.permission==="denied")return!1;try{return await Notification.requestPermission()==="granted"}catch(u){return console.error("[PWA] Notification permission request failed:",u),!1}},[]),f=m.useCallback(()=>{const u=ie(),d={ios:["Tap the Share button in Safari",'Scroll down and tap "Add to Home Screen"','Tap "Add" to install the app'],android:["Tap the menu button (â‹®) in Chrome",'Select "Add to Home screen"','Tap "Add" to install the app'],desktop:["Click the install button in your browser's address bar","Or use Ctrl+Shift+A (Cmd+Shift+A on Mac)",'Click "Install" when prompted']};return{platform:u,steps:d[u]||d.desktop}},[]);return{...s,installApp:n,shareApp:l,requestNotificationPermission:i,getInstallInstructions:f,canShare:"share"in navigator||"clipboard"in navigator}};function ie(){const r=navigator.userAgent.toLowerCase();return/iphone|ipad|ipod/.test(r)?"ios":/android/.test(r)?"android":/windows/.test(r)?"windows":/mac/.test(r)?"mac":"desktop"}function He(){return window.navigator.standalone||window.matchMedia("(display-mode: standalone)").matches||!!window.cordova||!!window.Capacitor||!!window.require}async function Je(){try{const r=await navigator.serviceWorker.register("/sw.js",{scope:"/"});return console.log("[PWA] Service Worker registered:",r),r.addEventListener("updatefound",()=>{const t=r.installing;t&&t.addEventListener("statechange",()=>{t.state==="installed"&&navigator.serviceWorker.controller&&console.log("[PWA] New service worker available")})}),!0}catch(r){return console.error("[PWA] Service Worker registration failed:",r),!1}}const Ze=async(r,t)=>"serviceWorker"in navigator&&"PushManager"in window?(await(await navigator.serviceWorker.ready).showNotification(r,{badge:"/icons/badge-72x72.png",icon:"/icons/icon-192x192.png",...t}),null):"Notification"in window&&Notification.permission==="granted"?new Notification(r,{icon:"/icons/icon-192x192.png",badge:"/icons/badge-72x72.png",...t}):null,$=({showPrompt:r=!0,onDismiss:t,compact:s=!1})=>{const[a,n]=m.useState(!1),[l,i]=m.useState(!1),[f,u]=m.useState(!1),{isSupported:d,isInstalled:p,canInstall:o,platform:c,installApp:h,shareApp:x,requestNotificationPermission:g,getInstallInstructions:I,canShare:G}=Ve(),{addToast:N}=D();m.useEffect(()=>{n(r&&d&&!p&&o&&!localStorage.getItem("pwa-prompt-dismissed"))},[r,d,p,o]);const W=async()=>{i(!0);try{const v=await h();if(v.success)N(ne("App Installed Successfully!","MOCARDS is now available on your home screen",{label:"Open App",onClick:()=>window.location.reload()})),n(!1),setTimeout(async()=>{await g()&&Ze("Welcome to MOCARDS!",{body:"You'll receive important updates and notifications here.",tag:"welcome"})},2e3);else if(v.outcome==="dismissed")N(A("Installation Cancelled","You can install MOCARDS anytime from your browser menu"));else throw new Error(v.error||"Installation failed")}catch(v){N(q("Installation Failed",v instanceof Error?v.message:"Please try again"))}finally{i(!1)}},U=async()=>{try{const v=await x();N(v?ne("Shared Successfully!","MOCARDS link has been shared"):A("Link Copied","MOCARDS link copied to clipboard"))}catch{N(q("Share Failed","Unable to share the app"))}},he=()=>{n(!1),localStorage.setItem("pwa-prompt-dismissed","true"),t?.()},F=()=>{u(!0)},xe=I();return!a&&!s?null:s?e.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx(J,{className:"h-6 w-6 text-blue-600"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-sm font-medium text-blue-900",children:"Install MOCARDS App"}),e.jsx("p",{className:"text-sm text-blue-700 mt-1",children:"Get faster access and offline capabilities"}),e.jsxs("div",{className:"flex items-center space-x-2 mt-3",children:[o?e.jsxs("button",{onClick:W,disabled:l,className:"inline-flex items-center px-3 py-1 bg-blue-600 text-white text-xs font-medium rounded-md hover:bg-blue-700 disabled:opacity-50",children:[e.jsx(Z,{className:"h-3 w-3 mr-1"}),l?"Installing...":"Install"]}):e.jsxs("button",{onClick:F,className:"inline-flex items-center px-3 py-1 bg-blue-100 text-blue-700 text-xs font-medium rounded-md hover:bg-blue-200",children:[e.jsx(X,{className:"h-3 w-3 mr-1"}),"How to Install"]}),G&&e.jsxs("button",{onClick:U,className:"inline-flex items-center px-3 py-1 bg-gray-100 text-gray-700 text-xs font-medium rounded-md hover:bg-gray-200",children:[e.jsx(Y,{className:"h-3 w-3 mr-1"}),"Share"]})]})]})]})}):e.jsxs(e.Fragment,{children:[a&&e.jsx("div",{className:"fixed bottom-4 left-4 right-4 md:left-auto md:right-4 md:max-w-sm z-50 animate-slide-in-right",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-xl border border-gray-200 p-6",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:e.jsx(J,{className:"h-6 w-6 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Install MOCARDS"}),e.jsx("p",{className:"text-sm text-gray-600",children:"For better performance & offline access"})]})]}),e.jsx("button",{onClick:he,className:"text-gray-400 hover:text-gray-600 transition-colors",children:e.jsx(k,{className:"h-5 w-5"})})]}),e.jsxs("div",{className:"space-y-2 mb-6",children:[e.jsxs("div",{className:"flex items-center text-sm text-gray-600",children:[e.jsx(E,{className:"h-4 w-4 text-green-500 mr-2"}),"Faster loading and performance"]}),e.jsxs("div",{className:"flex items-center text-sm text-gray-600",children:[e.jsx(E,{className:"h-4 w-4 text-green-500 mr-2"}),"Offline access to core features"]}),e.jsxs("div",{className:"flex items-center text-sm text-gray-600",children:[e.jsx(E,{className:"h-4 w-4 text-green-500 mr-2"}),"Push notifications for updates"]}),e.jsxs("div",{className:"flex items-center text-sm text-gray-600",children:[e.jsx(E,{className:"h-4 w-4 text-green-500 mr-2"}),"Home screen shortcut"]})]}),e.jsxs("div",{className:"flex space-x-3",children:[e.jsx("button",{onClick:W,disabled:l,className:"flex-1 flex items-center justify-center px-4 py-2 bg-blue-600 text-white font-medium rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50",children:l?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-2 border-white border-t-transparent mr-2"}),"Installing..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Z,{className:"h-4 w-4 mr-2"}),"Install App"]})}),e.jsx("button",{onClick:F,className:"px-3 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 transition-colors",children:e.jsx(X,{className:"h-4 w-4"})}),G&&e.jsx("button",{onClick:U,className:"px-3 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 transition-colors",children:e.jsx(Y,{className:"h-4 w-4"})})]})]})}),f&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsx("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(Ae,{className:"h-6 w-6 text-blue-600"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"How to Install"})]}),e.jsx("button",{onClick:()=>u(!1),className:"text-gray-400 hover:text-gray-600",children:e.jsx(k,{className:"h-5 w-5"})})]}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("div",{className:"flex items-center mb-3",children:[e.jsx("div",{className:"w-2 h-2 bg-blue-600 rounded-full mr-2"}),e.jsxs("span",{className:"text-sm font-medium text-gray-900",children:["Platform: ",c.charAt(0).toUpperCase()+c.slice(1)]})]}),e.jsx("ol",{className:"space-y-3",children:xe.steps.map((v,M)=>e.jsxs("li",{className:"flex items-start",children:[e.jsx("span",{className:"flex-shrink-0 w-6 h-6 bg-blue-100 text-blue-600 text-sm font-medium rounded-full flex items-center justify-center mr-3",children:M+1}),e.jsx("span",{className:"text-sm text-gray-700",children:v})]},M))})]}),e.jsx("div",{className:"bg-amber-50 border border-amber-200 rounded-lg p-3",children:e.jsxs("div",{className:"flex",children:[e.jsx(ue,{className:"h-5 w-5 text-amber-400 mt-0.5 mr-2"}),e.jsx("div",{children:e.jsxs("p",{className:"text-sm text-amber-800",children:[e.jsx("span",{className:"font-medium",children:"Note:"})," Installation steps may vary depending on your browser and operating system."]})})]})}),e.jsx("div",{className:"flex justify-end mt-6",children:e.jsx("button",{onClick:()=>u(!1),className:"px-4 py-2 bg-blue-600 text-white font-medium rounded-lg hover:bg-blue-700 transition-colors",children:"Got it"})})]})})})]})},Xe="https://lxyexybnotixgpzflota.supabase.co",Ye="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imx4eWV4eWJub3RpeGdwemZsb3RhIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjAyMDcwODIsImV4cCI6MjA3NTc4MzA4Mn0.TSbnvPKWiDdEFbyOh38qj_L87LZ75p3FiOW05hzEBlM",y=me(Xe,Ye),gt=Object.freeze(Object.defineProperty({__proto__:null,supabase:y},Symbol.toStringTag,{value:"Module"})),S={starter:{limit:500,price:299},growth:{limit:1e3,price:499},pro:{limit:2e3,price:799}},yt={starter:S.starter.limit,growth:S.growth.limit,pro:S.pro.limit},oe={starter:S.starter.price,growth:S.growth.price,pro:S.pro.price},bt=[{code:"01",name:"Ilocos Region (Region 1)"},{code:"02",name:"Cagayan Valley (Region 2)"},{code:"03",name:"Central Luzon (Region 3)"},{code:"4A",name:"Calabarzon (Region 4A)"},{code:"4B",name:"Mimaropa (Region 4B)"},{code:"05",name:"Bicol Region (Region 5)"},{code:"06",name:"Western Visayas (Region 6)"},{code:"07",name:"Central Visayas (Region 7)"},{code:"08",name:"Eastern Visayas (Region 8)"},{code:"09",name:"Zamboanga Peninsula (Region 9)"},{code:"10",name:"Northern Mindanao (Region 10)"},{code:"11",name:"Davao Region (Region 11)"},{code:"12",name:"Soccsksargen (Region 12)"},{code:"13",name:"Caraga Region (Region 13)"},{code:"NCR",name:"National Capital Region (NCR)"},{code:"CAR",name:"Cordillera Administrative Region (CAR)"}],vt=["CVT001","CVT002","CVT003","CVT004","CVT005","CVT006","CVT007","CVT008","CVT009","CVT010","BTG001","BTG002","BTG003","BTG004","BTG005","BTG006","BTG007","BTG008","BTG009","BTG010","LGN001","LGN002","LGN003","LGN004","LGN005","LGN006","LGN007","LGN008","LGN009","LGN010","Others","Custom"],wt=[{type:"dental_cleaning",name:"Free Dental Cleaning",description:"Complete professional dental cleaning service",value:1500,isActive:!0,validFor:365,requiresApproval:!1},{type:"consultation",name:"Free Dental Consultation",description:"Comprehensive dental consultation and check-up",value:500,isActive:!0,validFor:365,requiresApproval:!1},{type:"xray",name:"X-Ray Imaging Service",description:"Digital X-ray imaging for diagnosis",value:800,isActive:!0,validFor:365,requiresApproval:!0},{type:"treatment",name:"Treatment Discount",description:"20% discount on dental treatments and procedures",value:20,isActive:!0,validFor:365,requiresApproval:!0},{type:"discount",name:"General Service Discount",description:"10% discount on all dental services",value:10,isActive:!0,validFor:365,requiresApproval:!1}];class Ke{syncStatus="synced";lastSync=null;subscriptions=[];constructor(){this.setupRealTimeSubscriptions(),this.checkConnection()}async checkConnection(){try{const{error:t}=await y.from("cards").select("id").limit(1);if(t)throw t;return this.setSyncStatus("synced"),!0}catch(t){return console.error("[SupabaseCloudSync] Connection failed:",t),this.setSyncStatus("offline"),!1}}setSyncStatus(t){this.syncStatus=t,t==="synced"&&(this.lastSync=new Date)}setupRealTimeSubscriptions(){const t=y.channel("cards-changes").on("postgres_changes",{event:"*",schema:"public",table:"cards"},i=>{console.log("[SupabaseCloudSync] Cards changed:",i),this.lastSync=new Date}).subscribe(),s=y.channel("clinics-changes").on("postgres_changes",{event:"*",schema:"public",table:"clinics"},i=>{console.log("[SupabaseCloudSync] Clinics changed:",i),this.lastSync=new Date}).subscribe(),a=y.channel("appointments-changes").on("postgres_changes",{event:"*",schema:"public",table:"appointments"},i=>{console.log("[SupabaseCloudSync] Appointments changed:",i),this.lastSync=new Date}).subscribe(),n=y.channel("perks-changes").on("postgres_changes",{event:"*",schema:"public",table:"perks"},i=>{console.log("[SupabaseCloudSync] Perks changed:",i),this.lastSync=new Date}).subscribe(),l=y.channel("redemptions-changes").on("postgres_changes",{event:"*",schema:"public",table:"perk_redemptions"},i=>{console.log("[SupabaseCloudSync] Perk redemptions changed:",i),this.lastSync=new Date}).subscribe();this.subscriptions=[t,s,a,n,l]}async getAllCards(){try{this.setSyncStatus("syncing");let t=[],s=!0,a=0;const n=1e3;for(;s;){const{data:i,error:f}=await y.from("cards").select("*").order("created_at",{ascending:!1}).range(a,a+n-1);if(f)throw f;i&&i.length>0?(t=t.concat(i),a+=n,s=i.length===n):s=!1}console.log(`[SupabaseCloudSync] Retrieved ${t.length} total cards from database`),t||(t=[]);const l=(t||[]).map(i=>({id:i.id,controlNumber:i.control_number||`MOC-${i.id}`,fullName:i.full_name||"",status:i.status==="active"||i.status==="activated"?"active":"inactive",perksTotal:i.perks_total||5,perksUsed:i.perks_used||0,clinicId:i.clinic_id||"",expiryDate:i.expiry_date||"2025-12-31",notes:i.notes||"",createdAt:i.created_at,updatedAt:i.updated_at||i.created_at}));return this.setSyncStatus("synced"),l}catch(t){return console.error("[SupabaseCloudSync] Error getting cards:",t),this.setSyncStatus("error"),[]}}async createCard(t){try{this.setSyncStatus("syncing");const s={control_number:t.controlNumber,full_name:t.fullName||"",status:t.status,perks_total:t.perksTotal||5,perks_used:t.perksUsed||0,expiry_date:t.expiryDate};t.clinicId&&t.clinicId.trim()!==""&&(s.clinic_id=t.clinicId),t.notes&&(s.notes=t.notes);const{data:a,error:n}=await y.from("cards").insert(s).select().single();if(n)throw n;const l={id:a.id,controlNumber:a.control_number,fullName:a.full_name||"",status:a.status,perksTotal:a.perks_total,perksUsed:a.perks_used,clinicId:a.clinic_id||"",expiryDate:a.expiry_date,notes:a.notes||"",createdAt:a.created_at,updatedAt:a.updated_at||a.created_at};return this.setSyncStatus("synced"),l}catch(s){throw console.error("[SupabaseCloudSync] Error creating card:",s),this.setSyncStatus("error"),s}}async updateCard(t,s){try{this.setSyncStatus("syncing");const a={};s.status!==void 0&&(a.status=s.status==="active"?"activated":"unactivated"),s.clinicId!==void 0&&(a.clinic_id=s.clinicId||null),s.fullName!==void 0&&(a.full_name=s.fullName),s.perksTotal!==void 0&&(a.perks_total=s.perksTotal),s.perksUsed!==void 0&&(a.perks_used=s.perksUsed),s.notes!==void 0&&(a.notes=s.notes),s.expiryDate!==void 0&&(a.expiry_date=s.expiryDate),a.updated_at=new Date().toISOString();const{error:n}=await y.from("cards").update(a).eq("id",t);if(n)throw n;return this.setSyncStatus("synced"),!0}catch(a){return console.error("[SupabaseCloudSync] Error updating card:",a),this.setSyncStatus("error"),!1}}async getAllClinics(){try{this.setSyncStatus("syncing");const{data:t,error:s}=await y.from("clinics").select("*").order("created_at",{ascending:!1});if(s)throw s;const a=(t||[]).map(n=>({id:n.id,name:n.clinic_name,username:n.username||n.clinic_code.toLowerCase(),code:n.clinic_code,password:n.password_hash||"clinic123",plan:"starter",maxCards:500,region:n.region||"NCR",address:n.address,email:n.contact_email,contactNumber:n.contact_phone,subscriptionStatus:n.status==="active"?"active":"suspended",subscriptionStartDate:n.created_at.split("T")[0],subscriptionPrice:oe.starter,createdAt:n.created_at,updatedAt:n.updated_at,isActive:n.status==="active"}));return this.setSyncStatus("synced"),a}catch(t){return console.error("[SupabaseCloudSync] Error getting clinics:",t),this.setSyncStatus("error"),[]}}async createClinic(t){try{this.setSyncStatus("syncing");const s={clinic_name:t.name,username:t.username,clinic_code:t.code,password_hash:t.password,region:t.region,address:t.address,contact_email:t.email,contact_phone:t.contactNumber,status:t.isActive!==!1?"active":"inactive"},{data:a,error:n}=await y.from("clinics").insert(s).select().single();if(n)throw n;const l={id:a.id,name:a.clinic_name,username:t.username,code:a.clinic_code,password:t.password,plan:t.plan,maxCards:t.maxCards,region:a.region,address:a.address,email:a.contact_email,contactNumber:a.contact_phone,subscriptionStatus:a.status==="active"?"active":"suspended",subscriptionStartDate:a.created_at.split("T")[0],subscriptionPrice:oe[t.plan],createdAt:a.created_at,updatedAt:a.updated_at,isActive:a.status==="active"};return this.setSyncStatus("synced"),l}catch(s){throw console.error("[SupabaseCloudSync] Error creating clinic:",s),this.setSyncStatus("error"),s}}async getAllAppointments(){try{this.setSyncStatus("syncing");const{data:t,error:s}=await y.from("appointments").select("*").order("created_at",{ascending:!1});if(s)throw s;const a=(t||[]).map(n=>({id:n.id,cardControlNumber:n.control_number,clinicId:n.assigned_clinic_id||"",patientName:n.patient_name||"Unknown Patient",patientEmail:n.patient_email||"patient@example.com",patientPhone:n.patient_phone||"+63 000 000 0000",preferredDate:n.appointment_date,preferredTime:n.appointment_time,serviceType:n.service_type||"General Consultation",perkRequested:n.perk_type,status:this.mapAppointmentStatus(n.status),notes:n.cardholder_notes,createdAt:n.created_at}));return this.setSyncStatus("synced"),a}catch(t){return console.error("[SupabaseCloudSync] Error getting appointments:",t),this.setSyncStatus("error"),[]}}async createAppointment(t){try{this.setSyncStatus("syncing");const s={control_number:t.cardControlNumber,assigned_clinic_id:t.clinicId,appointment_date:t.preferredDate,appointment_time:t.preferredTime,perk_type:t.perkRequested||t.serviceType,cardholder_notes:t.notes,status:"waiting_for_approval",patient_name:t.patientName,patient_email:t.patientEmail,patient_phone:t.patientPhone,service_type:t.serviceType},{data:a,error:n}=await y.from("appointments").insert(s).select().single();if(n)throw n;const l={id:a.id,cardControlNumber:a.control_number,clinicId:a.assigned_clinic_id,patientName:a.patient_name,patientEmail:a.patient_email,patientPhone:a.patient_phone,preferredDate:a.appointment_date,preferredTime:a.appointment_time,serviceType:a.service_type,perkRequested:a.perk_type,status:this.mapAppointmentStatus(a.status),notes:a.cardholder_notes,createdAt:a.created_at};return this.setSyncStatus("synced"),l}catch(s){throw console.error("[SupabaseCloudSync] Error creating appointment:",s),this.setSyncStatus("error"),s}}async updateAppointment(t,s){try{this.setSyncStatus("syncing");const a={};s.status!==void 0&&(a.status=this.mapAppointmentStatusToSupabase(s.status)),s.notes!==void 0&&(a.cardholder_notes=s.notes),a.updated_at=new Date().toISOString();const{error:n}=await y.from("appointments").update(a).eq("id",t);if(n)throw n;return this.setSyncStatus("synced"),!0}catch(a){return console.error("[SupabaseCloudSync] Error updating appointment:",a),this.setSyncStatus("error"),!1}}async getAllPerks(){try{this.setSyncStatus("syncing");const{data:t,error:s}=await y.from("perk_templates").select("*").eq("is_active",!0).order("created_at",{ascending:!1});if(s)throw s;const a=(t||[]).map(n=>({id:n.id,type:this.mapPerkType(n.type),name:n.name,description:n.description||"",value:n.value||0,isActive:n.is_active,validFor:365,requiresApproval:!1,createdAt:n.created_at,updatedAt:n.updated_at}));return this.setSyncStatus("synced"),a}catch(t){return console.error("[SupabaseCloudSync] Error getting perks:",t),this.setSyncStatus("error"),[]}}async getAllPerkRedemptions(){try{this.setSyncStatus("syncing");const{data:t,error:s}=await y.from("perk_redemptions").select("*").order("used_at",{ascending:!1});if(s)throw console.error("[SupabaseCloudSync] Perk redemptions query failed:",s),s;const a=(t||[]).map(n=>({id:n.id,cardControlNumber:n.card_control_number||"Unknown",perkId:n.perk_id,perkName:n.perk_name||"Unknown Perk",clinicId:n.clinic_id,claimantName:n.claimant_name||"Unknown Patient",handledBy:n.handled_by||"System",serviceType:n.service_type||"General Service",usedAt:n.used_at,value:n.value||0,notes:n.notes||""}));return this.setSyncStatus("synced"),a}catch(t){return console.error("[SupabaseCloudSync] Error getting perk redemptions:",t),this.setSyncStatus("error"),[]}}mapAppointmentStatus(t){return{waiting_for_approval:"pending",approved:"accepted",pending_reschedule:"rescheduled",approved_reschedule:"accepted",cancelled:"cancelled",completed:"completed"}[t]||"pending"}mapAppointmentStatusToSupabase(t){return{pending:"waiting_for_approval",accepted:"approved",declined:"cancelled",rescheduled:"pending_reschedule",completed:"completed",cancelled:"cancelled"}[t]||"waiting_for_approval"}mapPerkType(t){return{consultation:"consultation",cleaning:"dental_cleaning",xray:"xray",discount:"discount",service:"treatment"}[t]||"consultation"}getSyncStatus(){return this.syncStatus}getLastSync(){return this.lastSync}async forceSync(){return await this.checkConnection()}cleanup(){this.subscriptions.forEach(t=>{y.removeChannel(t)}),this.subscriptions=[]}}const b=new Ke,Nt={cards:{getAll:()=>b.getAllCards(),save:async r=>(console.warn("[CloudOperations] Batch save not implemented for Supabase"),!0),add:async r=>{try{return await b.createCard(r)}catch(t){throw console.error("[CloudOperations] Error adding card:",t),t}},update:async(r,t)=>await b.updateCard(r,t),remove:async r=>{try{const{error:t}=await y.from("cards").delete().eq("id",r);return!t}catch(t){return console.error("[CloudOperations] Error removing card:",t),!1}}},clinics:{getAll:()=>b.getAllClinics(),save:async r=>(console.warn("[CloudOperations] Batch save not implemented for Supabase"),!0),add:async r=>{try{return await b.createClinic(r),!0}catch(t){return console.error("[CloudOperations] Error adding clinic:",t),!1}},update:async(r,t)=>{try{const{error:s}=await y.from("clinics").update({clinic_name:t.name,contact_email:t.email,contact_phone:t.contactNumber,updated_at:new Date().toISOString()}).eq("id",r);return!s}catch(s){return console.error("[CloudOperations] Error updating clinic:",s),!1}},remove:async r=>{try{const{error:t}=await y.from("clinics").delete().eq("id",r);return!t}catch(t){return console.error("[CloudOperations] Error removing clinic:",t),!1}}},appointments:{getAll:()=>b.getAllAppointments(),save:async r=>(console.warn("[CloudOperations] Batch save not implemented for Supabase"),!0),add:async r=>{try{return await b.createAppointment(r),!0}catch(t){return console.error("[CloudOperations] Error adding appointment:",t),!1}},update:async(r,t)=>await b.updateAppointment(r,t),remove:async r=>{try{const{error:t}=await y.from("appointments").delete().eq("id",r);return!t}catch(t){return console.error("[CloudOperations] Error removing appointment:",t),!1}}},perks:{getAll:()=>b.getAllPerks(),save:async r=>(console.warn("[CloudOperations] Batch save not implemented for Supabase"),!0),add:async r=>{try{const{error:t}=await y.from("perks").insert({name:r.name,description:r.description,type:r.type,value:r.value,is_active:r.isActive,is_system_default:!1});return!t}catch(t){return console.error("[CloudOperations] Error adding perk:",t),!1}},update:async(r,t)=>{try{const{error:s}=await y.from("perks").update({name:t.name,description:t.description,default_value:t.value,is_active:t.isActive,updated_at:new Date().toISOString()}).eq("id",r);return!s}catch(s){return console.error("[CloudOperations] Error updating perk:",s),!1}},remove:async r=>{try{const{error:t}=await y.from("perk_templates").delete().eq("id",r);return!t}catch(t){return console.error("[CloudOperations] Error removing perk:",t),!1}}},perkRedemptions:{getAll:()=>b.getAllPerkRedemptions(),save:async r=>(console.warn("[CloudOperations] Batch save not implemented for Supabase"),!0),add:async r=>{try{const{data:t,error:s}=await y.from("perk_redemptions").insert({perk_id:r.perkId,perk_name:r.perkName,clinic_id:r.clinicId,card_control_number:r.cardControlNumber,claimant_name:r.claimantName,handled_by:r.handledBy,service_type:r.serviceType,used_at:r.usedAt,value:r.value,notes:r.notes||null}).select().single();if(s)throw s;return{id:t.id,cardControlNumber:t.card_control_number,perkId:t.perk_id,perkName:t.perk_name,clinicId:t.clinic_id,claimantName:t.claimant_name,handledBy:t.handled_by,serviceType:t.service_type,usedAt:t.used_at,value:t.value,notes:t.notes||""}}catch(t){throw console.error("[CloudOperations] Error adding perk redemption:",t),t}}},sync:{getStatus:()=>b.getSyncStatus(),getLastSync:()=>b.getLastSync(),forceSync:()=>b.forceSync()}},Qe=()=>({status:b.getSyncStatus(),lastSync:b.getLastSync(),forceSync:b.forceSync}),et=({compact:r=!1,showText:t=!0,className:s=""})=>{const{status:a,lastSync:n,forceSync:l}=Qe(),[i,f]=m.useState(typeof navigator<"u"?navigator.onLine:!0);m.useEffect(()=>{const h=()=>f(!0),x=()=>f(!1);if(typeof window<"u")return window.addEventListener("online",h),window.addEventListener("offline",x),()=>{window.removeEventListener("online",h),window.removeEventListener("offline",x)}},[]);const d=((h,x)=>{if(!x)return{icon:K,color:"text-gray-500",bgColor:"bg-gray-100",text:"Offline",description:"Working offline. Will sync when connection is restored."};switch(h){case"synced":return{icon:Q,color:"text-green-600",bgColor:"bg-green-100",text:"Synced",description:"All data is synced across devices"};case"syncing":return{icon:ke,color:"text-blue-600",bgColor:"bg-blue-100",text:"Syncing...",description:"Syncing data across devices",animate:"animate-spin"};case"error":return{icon:ue,color:"text-red-600",bgColor:"bg-red-100",text:"Sync Error",description:"Failed to sync. Click to retry."};case"offline":return{icon:_e,color:"text-gray-500",bgColor:"bg-gray-100",text:"Offline",description:"Working offline"};default:return{icon:Q,color:"text-gray-600",bgColor:"bg-gray-100",text:"Unknown",description:"Sync status unknown"}}})(a,i),p=d.icon,o=async()=>{(a==="error"||!i&&i)&&await l()},c=()=>{if(!n)return"Never synced";const x=new Date().getTime()-n.getTime();return x<6e4?"Just now":x<36e5?`${Math.floor(x/6e4)}m ago`:x<864e5?`${Math.floor(x/36e5)}h ago`:n.toLocaleDateString()};return r?e.jsxs("button",{onClick:o,className:`flex items-center space-x-1 px-2 py-1 rounded-md ${d.bgColor} hover:opacity-80 transition-opacity ${s}`,title:`${d.description}. Last sync: ${c()}`,children:[e.jsx(p,{className:`h-3 w-3 ${d.color} ${d.animate||""}`}),t&&e.jsx("span",{className:`text-xs font-medium ${d.color}`,children:d.text})]}):e.jsxs("div",{className:`flex items-center space-x-3 p-3 rounded-lg ${d.bgColor} ${s}`,children:[e.jsx("div",{className:"p-2 rounded-full bg-white",children:e.jsx(p,{className:`h-4 w-4 ${d.color} ${d.animate||""}`})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("h4",{className:`text-sm font-semibold ${d.color}`,children:["Cloud Sync ",d.text]}),a==="error"&&e.jsx("button",{onClick:o,className:"text-xs text-red-600 hover:text-red-800 font-medium",children:"Retry"})]}),e.jsx("p",{className:"text-xs text-gray-600 mt-1",children:d.description}),n&&e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Last sync: ",c()]})]}),!i&&e.jsxs("div",{className:"flex items-center space-x-1 text-gray-500",children:[e.jsx(K,{className:"h-3 w-3"}),e.jsx("span",{className:"text-xs",children:"Offline"})]})]})},R=r=>{const[t,s]=m.useState(!1);return m.useEffect(()=>{const a=window.matchMedia(r);s(a.matches);const n=l=>{s(l.matches)};return a.addEventListener?a.addEventListener("change",n):a.addListener(n),()=>{a.removeEventListener?a.removeEventListener("change",n):a.removeListener(n)}},[r]),t},tt=()=>{const r=R("(max-width: 640px)"),t=R("(max-width: 1024px)"),s=R("(min-width: 1024px)"),a=R("(min-width: 1280px)");return{isMobile:r,isTablet:t,isDesktop:s,isLargeDesktop:a,isMobileOrTablet:r||t,isDesktopOrLarger:s}},st=()=>{const[r,t]=m.useState({width:typeof window<"u"?window.innerWidth:0,height:typeof window<"u"?window.innerHeight:0});return m.useEffect(()=>{const s=()=>{t({width:window.innerWidth,height:window.innerHeight})};return window.addEventListener("resize",s),s(),()=>window.removeEventListener("resize",s)},[]),{...r,isLandscape:r.width>r.height,isPortrait:r.height>r.width,isSmallMobile:r.width<375,isMobile:r.width<640,isTablet:r.width>=640&&r.width<1024,isDesktop:r.width>=1024,isHighDensity:typeof window<"u"?window.devicePixelRatio>1.5:!1}};function rt({currentView:r,onViewChange:t,children:s,isAuthenticated:a,userType:n}){const[l,i]=m.useState(!1),{isMobile:f,isTablet:u}=tt(),{height:d}=st();m.useEffect(()=>{f&&d<600&&i(!1)},[f,d]);const p=c=>!a||!n?!1:n==="admin"&&c==="clinic-portal"||n==="clinic"&&c==="admin-access",o=[{id:"enhanced-lookup",label:"Card Lookup",icon:le,description:"Verify card validity and search",disabled:!1},{id:"clinic-portal",label:"Clinic Portal",icon:de,description:"Clinic management",disabled:p("clinic-portal")},{id:"admin-access",label:"Admin Access",icon:C,description:"System administration",disabled:p("admin-access")}];return f?e.jsxs("div",{className:"min-h-screen bg-gray-50 pb-16",children:[e.jsx(Fe,{currentView:r,onViewChange:t,onSecurityToggle:()=>i(!l),showSecurityDashboard:l,navItems:o}),e.jsx("div",{className:"pt-20 px-4 pb-4",children:e.jsx("div",{className:"max-w-full mx-auto",children:s})}),l&&e.jsx("div",{className:"fixed inset-x-4 top-24 z-40 animate-slide-in-down",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-xl border border-gray-200 max-h-[70vh] overflow-y-auto",children:[e.jsx("div",{className:"p-3 border-b border-gray-200 bg-blue-600 text-white rounded-t-lg",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"font-semibold",children:"Security Monitor"}),e.jsx("button",{onClick:()=>i(!1),className:"text-white hover:bg-white hover:bg-opacity-20 rounded p-1 transition-colors",children:"âœ•"})]})}),e.jsx("div",{className:"p-4",children:e.jsx(O,{compact:!0})})]})}),e.jsx($,{})]}):u?e.jsxs("div",{className:"min-h-screen flex flex-col",children:[e.jsxs("div",{className:"bg-[#1A535C] text-white shadow-lg",children:[e.jsxs("div",{className:"flex items-center justify-between px-6 py-4",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-10 h-10 bg-white bg-opacity-20 rounded-lg flex items-center justify-center",children:e.jsx("span",{className:"text-white font-bold text-lg",children:"MC"})}),e.jsx("div",{children:e.jsx("h1",{className:"text-xl font-bold text-white",children:"MOCARDS CLOUD"})})]}),e.jsxs("button",{onClick:()=>i(!l),className:`flex items-center space-x-2 px-4 py-2 rounded-xl transition-all duration-200 ${l?"bg-blue-600 text-white shadow-lg":"bg-white bg-opacity-20 text-teal-100 hover:bg-opacity-30"}`,children:[e.jsx(_,{className:"h-4 w-4"}),e.jsx("span",{className:"text-sm font-medium",children:"Security"})]})]}),e.jsx("div",{className:"px-6 pb-4",children:e.jsx("div",{className:"flex space-x-2",children:o.map(c=>{const h=c.icon,x=r===c.id,g=c.disabled;return e.jsxs("button",{onClick:()=>!g&&t(c.id),disabled:g,className:`flex items-center space-x-2 px-4 py-2 rounded-xl transition-all duration-200 ${g?"bg-gray-400 bg-opacity-20 text-gray-500 cursor-not-allowed opacity-50":x?"bg-white text-[#1A535C] shadow-lg":"bg-white bg-opacity-10 text-teal-100 hover:bg-opacity-20"}`,title:g?"Please logout to access this portal":void 0,children:[e.jsx(h,{className:"h-4 w-4"}),e.jsx("span",{className:"text-sm font-medium",children:c.label}),g&&e.jsx("span",{className:"text-xs",children:"ðŸ”’"})]},c.id)})})})]}),e.jsxs("div",{className:"flex-1 bg-gray-50 relative",children:[e.jsx("div",{className:"p-6",children:s}),l&&e.jsx("div",{className:"fixed bottom-4 right-4 z-50 w-80 animate-slide-in-right",children:e.jsx(O,{})}),e.jsx($,{})]})]}):e.jsxs("div",{className:"min-h-screen flex",children:[e.jsxs("div",{className:"w-56 bg-[#1A535C] text-white flex flex-col fixed h-full z-10",children:[e.jsx("div",{className:"p-5 border-b border-teal-600",children:e.jsx("h1",{className:"text-lg font-bold text-white",children:"MOCARDS CLOUD"})}),e.jsx("nav",{className:"flex-1 p-3",children:e.jsx("ul",{className:"space-y-2",children:o.map(c=>{const h=c.icon,x=r===c.id,g=c.disabled;return e.jsx("li",{children:e.jsxs("button",{onClick:()=>!g&&t(c.id),disabled:g,className:`w-full flex items-center space-x-2.5 px-3 py-2.5 rounded-lg transition-all duration-200 ${g?"bg-gray-600 bg-opacity-20 text-gray-400 cursor-not-allowed opacity-60":x?"bg-white text-[#1A535C] shadow-lg":"text-teal-100 hover:bg-teal-600 hover:text-white"}`,title:g?"Please logout to access this portal":void 0,children:[e.jsx(h,{className:`h-4 w-4 ${g?"text-gray-400":x?"text-[#1A535C]":""}`}),e.jsxs("div",{className:"text-left flex-1",children:[e.jsxs("div",{className:`font-medium text-sm ${g?"text-gray-400":x?"text-[#1A535C]":""}`,children:[c.label,g&&e.jsx("span",{className:"ml-2",children:"ðŸ”’"})]}),e.jsx("div",{className:`text-xs ${g?"text-gray-500":x?"text-teal-600":"text-teal-300"}`,children:g?"Logout required":c.description})]})]})},c.id)})})}),e.jsxs("div",{className:"p-3 border-t border-teal-600",children:[e.jsxs("button",{onClick:()=>i(!l),className:`w-full flex items-center justify-center space-x-2 px-3 py-2.5 rounded-lg transition-all duration-200 ${l?"bg-blue-600 text-white shadow-lg":"text-teal-100 hover:bg-teal-600 hover:text-white"}`,children:[e.jsx(_,{className:"h-4 w-4"}),e.jsx("span",{className:"text-sm font-medium",children:"Security"})]}),e.jsx("div",{className:"mt-3",children:e.jsx(et,{compact:!0,className:"w-full"})}),e.jsxs("div",{className:"text-xs text-teal-300 text-center mt-2 leading-tight",children:["MOCARDS v4.0",e.jsx("br",{}),"Â© 2025 Dental Group"]})]})]}),e.jsx("div",{className:"flex-1 ml-56 bg-gray-50 min-h-screen",children:s}),l&&e.jsx("div",{className:"fixed bottom-4 right-4 z-50 w-96 animate-slide-in-right",children:e.jsx(O,{})}),e.jsx($,{})]})}const at=({type:r})=>{const t={size:20};switch(r){case"success":return e.jsx(Te,{...t,className:"text-green-500"});case"error":return e.jsx(Ee,{...t,className:"text-red-500"});case"warning":return e.jsx(z,{...t,className:"text-yellow-500"});case"info":return e.jsx(ee,{...t,className:"text-blue-500"});case"loading":return e.jsx(Ie,{...t,className:"text-blue-500 animate-spin"});default:return e.jsx(ee,{...t,className:"text-gray-500"})}},nt=({toast:r})=>{const{removeToast:t}=D(),s={success:"bg-green-50 border-green-200",error:"bg-red-50 border-red-200",warning:"bg-yellow-50 border-yellow-200",info:"bg-blue-50 border-blue-200",loading:"bg-blue-50 border-blue-200"},a={success:"text-green-800",error:"text-red-800",warning:"text-yellow-800",info:"text-blue-800",loading:"text-blue-800"};return e.jsx("div",{className:`
        max-w-sm w-full ${s[r.type]} border rounded-lg shadow-lg p-4
        transform transition-all duration-300 ease-in-out
        hover:shadow-xl animate-in slide-in-from-right-full
      `,children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(at,{type:r.type}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h4",{className:`font-medium ${a[r.type]} text-sm`,children:r.title}),r.message&&e.jsx("p",{className:`mt-1 text-sm ${a[r.type]} opacity-90`,children:r.message}),r.action&&e.jsx("button",{onClick:r.action.onClick,className:`
                mt-2 text-sm font-medium ${a[r.type]}
                hover:underline focus:outline-none focus:underline
              `,children:r.action.label})]}),e.jsx("button",{onClick:()=>t(r.id),className:`
            ${a[r.type]} opacity-60 hover:opacity-100
            transition-opacity focus:outline-none
          `,children:e.jsx(k,{size:16})})]})})},it=()=>{const{toasts:r}=D();return r.length===0?null:e.jsx("div",{className:"fixed top-4 right-4 z-50 space-y-2 max-h-screen overflow-y-auto",children:r.map(t=>e.jsx(nt,{toast:t},t.id))})},ot="https://lxyexybnotixgpzflota.supabase.co",ct="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imx4eWV4eWJub3RpeGdwemZsb3RhIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjAyMDcwODIsImV4cCI6MjA3NTc4MzA4Mn0.TSbnvPKWiDdEFbyOh38qj_L87LZ75p3FiOW05hzEBlM";me(ot,ct,{auth:{autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"pkce"},realtime:{params:{eventsPerSecond:10}},global:{headers:{"X-Application-Name":"MOCARDS-Enterprise"}}});m.createContext(null);function lt(){const[r,t]=m.useState(!1),[s,a]=m.useState(null);return{isAuthenticated:r,user:s,login:(i,f)=>{t(!0),a({type:i,...f})},logout:()=>{t(!1),a(null)}}}const ce=m.lazy(()=>B(()=>import("./EnhancedCardLookupView-CaROf2s4.js"),__vite__mapDeps([0,1,2,3,4])).then(r=>({default:r.EnhancedCardLookupView}))),dt=m.lazy(()=>B(()=>import("./ClinicPortalView-BPuvy11G.js"),__vite__mapDeps([5,1,2,6,3,4])).then(r=>({default:r.ClinicPortalView}))),ut=m.lazy(()=>B(()=>import("./AdminPortalView-DNkCU9Ih.js"),__vite__mapDeps([7,1,2,6,3,4])).then(r=>({default:r.AdminPortalView})));function mt(){const[r,t]=m.useState("enhanced-lookup"),{isAuthenticated:s,user:a}=lt();m.useEffect(()=>{!s&&(r==="admin-access"||r==="clinic-portal")&&t("enhanced-lookup")},[s]);const n=()=>{switch(r){case"enhanced-lookup":return e.jsx(ce,{});case"clinic-portal":return e.jsx(dt,{});case"admin-access":return e.jsx(ut,{});default:return e.jsx(ce,{})}},l=i=>{if(i==="enhanced-lookup"){t(i);return}s&&a&&(a.type==="admin"&&i==="clinic-portal"||a.type==="clinic"&&i==="admin-access")||t(i)};return e.jsxs(Be,{children:[e.jsx(rt,{currentView:r,onViewChange:l,isAuthenticated:s,userType:a?.type,children:e.jsx(m.Suspense,{fallback:e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsxs("div",{className:"light-card p-8 w-full max-w-md text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-2 border-blue-200 border-t-blue-600 mx-auto mb-4"}),e.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Loading..."}),e.jsx("p",{className:"text-gray-600",children:"Please wait while we load the application."})]})}),children:n()})}),e.jsx(it,{})]})}Pe.createRoot(document.getElementById("root")).render(e.jsx(be.StrictMode,{children:e.jsx(mt,{})}));export{vt as A,wt as D,bt as P,B as _,ne as a,q as b,lt as c,oe as d,yt as e,Nt as f,gt as g,e as j,y as s,qe as t,D as u};
