import{c as Ae,u as De,j as e,d as L,e as Y,p as ae,f as le,g as Te,a as u,b as g,t as Re}from"./index-CxeZ8DrT.js";import{r as n}from"./charts-sad3owxz.js";import{u as Ee}from"./useAutoRefresh-C3tFNj76.js";import{c as F,s as Le,B as Fe,q as V,G as S,U as G,t as ne,C as Ie,p as ie,r as He,n as Me,P as Be,u as Oe,X as W,v as Ue,w as $e,x as X}from"./icons-NYRR27RC.js";import"./vendor-N--QU9DW.js";import"./database-BUiByx9r.js";function Je(){const{isAuthenticated:I,user:j,login:re,logout:ce}=Ae();Ee({enabled:!0,showNotifications:!0});const[a,A]=n.useState(null),[N,H]=n.useState({username:"",password:""}),[de,D]=n.useState(!1),[w,T]=n.useState(null),[C,R]=n.useState(""),[f,me]=n.useState("dashboard"),[b,y]=n.useState([]),[E,J]=n.useState([]),[M,K]=n.useState(null),[oe,Q]=n.useState(!1),[Z,xe]=n.useState([]),[_,he]=n.useState([]),[B,pe]=n.useState(0),[ue,q]=n.useState(!0),[o,O]=n.useState(null),[i,p]=n.useState({preferredDate:"",preferredTime:"",serviceType:"",clinicNotes:"",patientPhone:"",patientEmail:""}),[ee,U]=n.useState(!1),[m,P]=n.useState({currentPassword:"",newPassword:"",confirmPassword:""}),{addToast:c}=De();n.useEffect(()=>{(async()=>{if(I&&j&&j.type==="clinic"&&j.clinicId&&!a)try{const t=await L.getById(j.clinicId);t?A(t):console.error("Clinic not found for ID:",j.clinicId)}catch(t){console.error("Failed to load clinic:",t)}})()},[I,j,a]),n.useEffect(()=>{(async()=>{if(a)try{q(!0);const l=(await Y.getByClinicId(a.id)).map(d=>({id:d.id,cardControlNumber:d.cardControlNumber,patientName:d.patientName,patientEmail:d.patientEmail,patientPhone:d.patientPhone,preferredDate:d.preferredDate,preferredTime:d.preferredTime,serviceType:d.serviceType,perkRequested:d.perkRequested||"",status:d.status,adminNotes:d.notes,clinicNotes:"",forwardedAt:d.createdAt,processedAt:void 0}));y(l);const r=await ae.getByClinicId(a.id);J(r);const v=await le.getByClinicId(a.id);xe(v);const h=await Te.getAll();he(h);const z=await L.getPlanLimit(a.id);pe(z)}catch(t){console.error("Failed to load clinic data:",t)}finally{q(!1)}})()},[a]);const ge=async(s,t)=>{await Y.updateStatus(s,"accepted"),y(l=>l.map(r=>r.id===s?{...r,status:"accepted",clinicNotes:t||"",processedAt:new Date().toISOString()}:r)),c(u("Appointment Accepted","Patient will be notified of the confirmation"))},je=async(s,t)=>{await Y.updateStatus(s,"declined"),y(l=>l.map(r=>r.id===s?{...r,status:"declined",clinicNotes:t,processedAt:new Date().toISOString()}:r)),c(Re("Appointment Declined","Patient will be notified with the reason"))},Ne=(s,t,l,r)=>{y(v=>v.map(h=>h.id===s?{...h,status:"rescheduled",preferredDate:t,preferredTime:l,clinicNotes:r||"Rescheduled by clinic",processedAt:new Date().toISOString()}:h)),c(u("Appointment Rescheduled","Patient will be contacted with new schedule"))},fe=s=>{const t=b.find(l=>l.id===s);t&&(p({preferredDate:t.preferredDate,preferredTime:t.preferredTime,serviceType:t.serviceType,clinicNotes:t.clinicNotes||"",patientPhone:t.patientPhone,patientEmail:t.patientEmail}),O(s))},be=s=>{y(t=>t.map(l=>l.id===s?{...l,preferredDate:i.preferredDate,preferredTime:i.preferredTime,serviceType:i.serviceType,clinicNotes:i.clinicNotes,patientPhone:i.patientPhone,patientEmail:i.patientEmail}:l)),O(null),c(u("Appointment Updated","Appointment details have been updated"))},ye=s=>{window.confirm("Are you sure you want to delete this appointment? This action cannot be undone.")&&(y(t=>t.filter(l=>l.id!==s)),c(u("Appointment Deleted","Appointment has been removed")))},ve=async s=>{s.preventDefault();const t=await L.authenticate(N.username,N.password);t?(A(t),re("clinic",t),c(u("Welcome",`Logged in to ${t.name}`))):c(g("Login Failed","Invalid clinic code or password"))},we=()=>{ce(),A(null),H({username:"",password:""})},Ce=async s=>{if(s.preventDefault(),!a)return;if(m.currentPassword!==a.password){c(g("Invalid Password","Current password is incorrect"));return}if(m.newPassword.length<8){c(g("Password Too Short","New password must be at least 8 characters long"));return}if(m.newPassword!==m.confirmPassword){c(g("Passwords Do Not Match","Please confirm your new password correctly"));return}const t={...a,password:m.newPassword};await L.update(a.id,{password:m.newPassword}),A(t),P({currentPassword:"",newPassword:"",confirmPassword:""}),U(!1),c(u("Password Changed","Your clinic password has been updated successfully"))},Pe=async s=>{if(s.preventDefault(),!w||!C||!a)return;const t=Z.find(k=>k.controlNumber===w),l=_.find(k=>k.id===C);if(!t||!l){c(g("Error","Card or perk not found"));return}if(t.perksUsed>=t.perksTotal){c(g("No Perks Available","This card has no available perks to redeem"));return}const r=prompt("Patient name (claimant):"),v=prompt("Staff member handling this redemption:"),h=prompt("Service type provided:"),z=prompt("Additional notes (optional):");if(!r||!v||!h){c(g("Missing Information","Please provide all required details for tracking"));return}const d=await ae.create({cardControlNumber:w,perkId:C,perkName:l.name,clinicId:a.id,claimantName:r,handledBy:v,serviceType:h,usedAt:new Date().toISOString(),value:l.value||0,notes:z||void 0});await le.updatePerks(w,t.perksUsed+1),J(k=>[...k,d]),D(!1),T(null),R(""),c(u("Perk Redeemed",`${l.name} has been successfully redeemed and tracked for ${r}`))};if(!I)return e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsxs("div",{className:"light-card p-8 w-full max-w-md",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("div",{className:"w-16 h-16 bg-blue-100 rounded-2xl flex items-center justify-center mx-auto mb-4",children:e.jsx(F,{className:"h-8 w-8 text-blue-600"})}),e.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Clinic Portal Login"}),e.jsx("p",{className:"text-gray-600",children:"Please authenticate with your clinic credentials"})]}),e.jsxs("form",{onSubmit:ve,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Username"}),e.jsx("input",{type:"text",value:N.username,onChange:s=>H({...N,username:s.target.value}),className:"light-input",placeholder:"Enter clinic username",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Password"}),e.jsx("input",{type:"password",value:N.password,onChange:s=>H({...N,password:s.target.value}),className:"light-input",placeholder:"Enter clinic password",required:!0})]}),e.jsxs("button",{type:"submit",className:"light-button-primary w-full flex items-center justify-center",children:[e.jsx(Le,{className:"h-4 w-4 mr-2"}),"Access Clinic Portal"]})]})]})});if(!a)return e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsxs("div",{className:"light-card p-8 w-full max-w-md text-center",children:[e.jsx("div",{className:"w-16 h-16 bg-blue-100 rounded-2xl flex items-center justify-center mx-auto mb-4",children:e.jsx(F,{className:"h-8 w-8 text-blue-600"})}),e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-2 border-blue-200 border-t-blue-600 mx-auto mb-4"}),e.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Loading Clinic Portal"}),e.jsx("p",{className:"text-gray-600",children:"Please wait while we load your clinic information..."})]})});if(ue)return e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsxs("div",{className:"light-card p-8 w-full max-w-md text-center",children:[e.jsx("div",{className:"w-16 h-16 bg-blue-100 rounded-2xl flex items-center justify-center mx-auto mb-4",children:e.jsx(F,{className:"h-8 w-8 text-blue-600"})}),e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-2 border-blue-200 border-t-blue-600 mx-auto mb-4"}),e.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Loading Clinic Data"}),e.jsx("p",{className:"text-gray-600",children:"Please wait while we load your cards, appointments, and redemption history..."})]})});const x=Z,se=x.filter(s=>s.status==="active"),$=B>0?x.length/B*100:0,te=b.filter(s=>s.status==="pending"),ke=[],Se=[{id:"dashboard",name:"Dashboard",icon:Fe},{id:"appointments",name:`Appointments (${te.length})`,icon:V},{id:"perks",name:"Perk History",icon:S},{id:"cards",name:"Assigned Cards",icon:G},{id:"settings",name:"Settings",icon:ne}];return e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx("div",{className:"light-card mb-6",children:e.jsx("div",{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"w-12 h-12 bg-blue-100 rounded-2xl flex items-center justify-center",children:e.jsx(F,{className:"h-6 w-6 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:a.name}),e.jsxs("p",{className:"text-gray-600",children:[a.address," • ",a.code]})]})]}),e.jsxs("button",{onClick:we,className:"light-button-secondary flex items-center space-x-2",children:[e.jsx(ne,{className:"h-4 w-4"}),e.jsx("span",{children:"Logout"})]})]})})}),e.jsx("div",{className:"light-card mb-6",children:e.jsx("div",{className:"p-2",children:e.jsx("div",{className:"flex space-x-2",children:Se.map(s=>{const t=s.icon;return e.jsxs("button",{onClick:()=>me(s.id),className:`flex items-center space-x-2 px-4 py-3 rounded-xl font-medium transition-colors ${f===s.id?"bg-blue-100 text-blue-700":"text-gray-600 hover:bg-gray-100"}`,children:[e.jsx(t,{className:"h-4 w-4"}),e.jsx("span",{children:s.name})]},s.id)})})})}),f==="dashboard"&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"light-card mb-6",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Subscription Status"}),e.jsxs("span",{className:`plan-${a.plan} capitalize`,children:[a.plan," Plan"]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-gray-600",children:"Cards Assigned"}),e.jsxs("span",{className:"font-medium",children:[x.length," / ",B]})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-3",children:e.jsx("div",{className:`h-3 rounded-full transition-all duration-300 ${$>90?"bg-red-500":$>70?"bg-yellow-500":"bg-green-500"}`,style:{width:`${Math.min($,100)}%`}})}),e.jsxs("div",{className:"grid grid-cols-3 gap-4 text-center",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:x.length}),e.jsx("p",{className:"text-xs text-gray-600",children:"Total Cards"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold text-green-600",children:se.length}),e.jsx("p",{className:"text-xs text-gray-600",children:"Active Cards"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold text-gray-400",children:x.length-se.length}),e.jsx("p",{className:"text-xs text-gray-600",children:"Inactive Cards"})]})]})]})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-6",children:[e.jsx("div",{className:"light-stat-card",children:e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"w-12 h-12 bg-blue-100 rounded-2xl flex items-center justify-center",children:e.jsx(G,{className:"h-6 w-6 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Today's Patients"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:b.filter(s=>new Date(s.preferredDate).toDateString()===new Date().toDateString()).length})]})]})}),e.jsx("div",{className:"light-stat-card",children:e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"w-12 h-12 bg-yellow-100 rounded-2xl flex items-center justify-center",children:e.jsx(Ie,{className:"h-6 w-6 text-yellow-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Pending Appointments"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:te.length})]})]})}),e.jsx("div",{className:"light-stat-card",children:e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"w-12 h-12 bg-green-100 rounded-2xl flex items-center justify-center",children:e.jsx(S,{className:"h-6 w-6 text-green-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Pending Perks"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:ke.length})]})]})})]})]}),f==="appointments"&&e.jsx("div",{className:"light-card",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Appointment Requests"}),e.jsxs("span",{className:"text-sm text-gray-600",children:[b.length," total requests"]})]}),b.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx(V,{className:"h-8 w-8 text-gray-400"})}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No Appointment Requests"}),e.jsx("p",{className:"text-gray-600",children:"No appointment requests have been forwarded to your clinic yet."})]}):e.jsx("div",{className:"space-y-4",children:b.map(s=>e.jsxs("div",{className:"border border-gray-200 rounded-xl p-6",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center",children:e.jsx(ie,{className:"h-5 w-5 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium text-gray-900",children:s.patientName}),e.jsx("p",{className:"text-sm text-gray-600",children:s.cardControlNumber})]})]}),e.jsx("span",{className:`px-3 py-1 rounded-full text-sm font-medium ${s.status==="pending"?"bg-yellow-100 text-yellow-800":s.status==="accepted"?"bg-green-100 text-green-800":s.status==="declined"?"bg-red-100 text-red-800":"bg-blue-100 text-blue-800"}`,children:s.status})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-4 mb-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Preferred Date"}),o===s.id?e.jsx("input",{type:"date",value:i.preferredDate,onChange:t=>p({...i,preferredDate:t.target.value}),className:"light-input text-sm mt-1"}):e.jsx("p",{className:"font-medium",children:new Date(s.preferredDate).toLocaleDateString()})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Preferred Time"}),o===s.id?e.jsx("input",{type:"time",value:i.preferredTime,onChange:t=>p({...i,preferredTime:t.target.value}),className:"light-input text-sm mt-1"}):e.jsx("p",{className:"font-medium",children:s.preferredTime})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Service"}),o===s.id?e.jsx("input",{type:"text",value:i.serviceType,onChange:t=>p({...i,serviceType:t.target.value}),className:"light-input text-sm mt-1"}):e.jsx("p",{className:"font-medium",children:s.serviceType})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Contact"}),o===s.id?e.jsx("input",{type:"tel",value:i.patientPhone,onChange:t=>p({...i,patientPhone:t.target.value}),className:"light-input text-sm mt-1"}):e.jsx("p",{className:"font-medium",children:s.patientPhone})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Email"}),o===s.id?e.jsx("input",{type:"email",value:i.patientEmail,onChange:t=>p({...i,patientEmail:t.target.value}),className:"light-input text-sm mt-1"}):e.jsx("p",{className:"font-medium",children:s.patientEmail})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Perk"}),e.jsx("p",{className:"font-medium",children:s.perkRequested})]})]}),s.adminNotes&&e.jsx("div",{className:"bg-blue-50 p-3 rounded-lg mb-4",children:e.jsxs("p",{className:"text-sm text-blue-800",children:[e.jsx("strong",{children:"Admin Notes:"})," ",s.adminNotes]})}),(s.clinicNotes||o===s.id)&&e.jsx("div",{className:"bg-gray-50 p-3 rounded-lg mb-4",children:o===s.id?e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Clinic Notes:"}),e.jsx("textarea",{value:i.clinicNotes,onChange:t=>p({...i,clinicNotes:t.target.value}),placeholder:"Add clinic notes...",className:"light-input text-sm resize-none",rows:2})]}):e.jsxs("p",{className:"text-sm text-gray-700",children:[e.jsx("strong",{children:"Clinic Notes:"})," ",s.clinicNotes]})}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[s.status==="pending"&&e.jsxs(e.Fragment,{children:[e.jsxs("button",{onClick:async()=>{const t=prompt("Add any notes for the patient (optional):");await ge(s.id,t||void 0)},className:"flex items-center space-x-2 px-4 py-2 bg-green-100 text-green-700 rounded-lg hover:bg-green-200 transition-colors",children:[e.jsx(He,{className:"h-4 w-4"}),e.jsx("span",{children:"Accept"})]}),e.jsxs("button",{onClick:async()=>{const t=prompt("Please provide a reason for declining:");t&&await je(s.id,t)},className:"flex items-center space-x-2 px-4 py-2 bg-red-100 text-red-700 rounded-lg hover:bg-red-200 transition-colors",children:[e.jsx(Me,{className:"h-4 w-4"}),e.jsx("span",{children:"Decline"})]}),e.jsxs("button",{onClick:()=>{const t=prompt("New preferred date (YYYY-MM-DD):"),l=prompt("New preferred time (HH:MM):"),r=prompt("Notes for the patient:");t&&l&&Ne(s.id,t,l,r||void 0)},className:"flex items-center space-x-2 px-4 py-2 bg-blue-100 text-blue-700 rounded-lg hover:bg-blue-200 transition-colors",children:[e.jsx(V,{className:"h-4 w-4"}),e.jsx("span",{children:"Reschedule"})]}),e.jsxs("a",{href:`tel:${s.patientPhone}`,className:"flex items-center space-x-2 px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors",children:[e.jsx(Be,{className:"h-4 w-4"}),e.jsx("span",{children:"Call Patient"})]})]}),o===s.id?e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>be(s.id),className:"flex items-center space-x-2 px-3 py-1 bg-green-100 text-green-700 rounded-lg hover:bg-green-200 transition-colors",title:"Save changes",children:e.jsx(Oe,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>O(null),className:"flex items-center space-x-2 px-3 py-1 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors",title:"Cancel",children:e.jsx(W,{className:"h-4 w-4"})})]}):e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>fe(s.id),className:"flex items-center space-x-2 px-3 py-1 bg-blue-100 text-blue-700 rounded-lg hover:bg-blue-200 transition-colors",title:"Edit appointment",children:e.jsx(Ue,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>ye(s.id),className:"flex items-center space-x-2 px-3 py-1 bg-red-100 text-red-700 rounded-lg hover:bg-red-200 transition-colors",title:"Delete appointment",children:e.jsx($e,{className:"h-4 w-4"})})]})]}),e.jsxs("div",{className:"text-xs text-gray-500 mt-4",children:["Forwarded: ",new Date(s.forwardedAt).toLocaleString(),s.processedAt&&e.jsxs("span",{children:[" • Processed: ",new Date(s.processedAt).toLocaleString()]})]})]},s.id))})]})}),f==="perks"&&e.jsx("div",{className:"light-card",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Perk Redemption History"}),e.jsxs("span",{className:"text-sm text-gray-600",children:[E.length," total redemptions"]})]}),E.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx(S,{className:"h-8 w-8 text-gray-400"})}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No Perk Redemptions"}),e.jsx("p",{className:"text-gray-600",children:"No perks have been redeemed at this clinic yet."})]}):e.jsx("div",{className:"space-y-4",children:E.map(s=>e.jsxs("div",{className:"border border-gray-200 rounded-xl p-6 bg-green-50",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-10 h-10 bg-green-100 rounded-full flex items-center justify-center",children:e.jsx(S,{className:"h-5 w-5 text-green-600"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium text-gray-900",children:s.claimantName}),e.jsx("p",{className:"text-sm text-gray-600",children:s.cardControlNumber})]})]}),e.jsx("span",{className:"px-3 py-1 rounded-full text-sm font-medium bg-green-100 text-green-800",children:"Redeemed"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 text-sm mb-4",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600 font-medium",children:"Perk:"}),e.jsx("p",{className:"text-gray-900 mt-1",children:s.perkName})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600 font-medium",children:"Service Type:"}),e.jsx("p",{className:"text-gray-900 mt-1",children:s.serviceType})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600 font-medium",children:"Handled By:"}),e.jsx("p",{className:"text-gray-900 mt-1",children:s.handledBy})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600 font-medium",children:"Value:"}),e.jsxs("p",{className:"text-gray-900 mt-1",children:["₱",s.value.toFixed(2)]})]})]}),s.notes&&e.jsxs("div",{className:"bg-blue-50 p-3 rounded-lg mb-4",children:[e.jsx("span",{className:"text-blue-800 font-medium text-sm",children:"Notes:"}),e.jsx("p",{className:"text-blue-700 text-sm mt-1",children:s.notes})]}),e.jsxs("div",{className:"text-xs text-gray-500 mt-4",children:["Redeemed: ",new Date(s.usedAt).toLocaleString("en-PH")]})]},s.id))})]})}),f==="cards"&&e.jsx("div",{className:"light-card",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Assigned Cards"}),e.jsxs("span",{className:"text-sm text-gray-600",children:[x.length," cards assigned to this clinic"]})]}),x.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx(G,{className:"h-8 w-8 text-gray-400"})}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No Cards Assigned"}),e.jsx("p",{className:"text-gray-600",children:"No MOC cards have been assigned to your clinic yet. Contact the administrator to get cards assigned."})]}):e.jsx("div",{className:"light-table",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"light-table-header",children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-left p-4",children:"Control Number"}),e.jsx("th",{className:"text-left p-4",children:"Patient Name"}),e.jsx("th",{className:"text-left p-4",children:"Status"}),e.jsx("th",{className:"text-left p-4",children:"Perks Available"}),e.jsx("th",{className:"text-left p-4",children:"Expiry"}),e.jsx("th",{className:"text-left p-4",children:"Actions"})]})}),e.jsx("tbody",{children:x.map(s=>e.jsxs("tr",{className:"light-table-row",children:[e.jsx("td",{className:"p-4 font-mono text-sm",children:s.controlNumber}),e.jsx("td",{className:"p-4",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-8 h-8 bg-gray-200 rounded-full flex items-center justify-center",children:e.jsx(ie,{className:"h-4 w-4 text-gray-600"})}),e.jsx("span",{className:"font-medium",children:s.fullName})]})}),e.jsx("td",{className:"p-4",children:e.jsx("span",{className:s.status==="active"?"status-active":"status-inactive",children:s.status})}),e.jsx("td",{className:"p-4",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-16 bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:"bg-blue-500 h-2 rounded-full",style:{width:`${(s.perksTotal-s.perksUsed)/s.perksTotal*100}%`}})}),e.jsxs("span",{className:"text-sm text-gray-600",children:[s.perksTotal-s.perksUsed,"/",s.perksTotal]})]})}),e.jsx("td",{className:"p-4 text-gray-600",children:new Date(s.expiryDate).toLocaleDateString()}),e.jsx("td",{className:"p-4",children:e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:()=>{T(s.controlNumber),D(!0)},disabled:s.perksUsed>=s.perksTotal,className:"btn-primary text-sm px-3 py-1 disabled:opacity-50 disabled:cursor-not-allowed",children:[e.jsx(X,{className:"h-4 w-4 mr-1"}),"Redeem Perk"]}),e.jsx("button",{onClick:()=>{K(s.controlNumber),Q(!0)},className:"light-button-secondary text-sm px-3 py-1",title:"View perk redemption history",children:"History"})]})})]},s.controlNumber))})]})})]})}),f==="settings"&&e.jsx("div",{className:"light-card",children:e.jsxs("div",{className:"p-6",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-6",children:"Clinic Settings"}),e.jsxs("div",{className:"mb-8",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Password Management"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Change your clinic password for security"})]}),e.jsx("button",{onClick:()=>U(!ee),className:"light-button-primary",children:"Change Password"})]}),ee&&e.jsx("div",{className:"border-t border-gray-200 pt-4",children:e.jsxs("form",{onSubmit:Ce,className:"space-y-4 max-w-md",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Current Password"}),e.jsx("input",{type:"password",value:m.currentPassword,onChange:s=>P({...m,currentPassword:s.target.value}),className:"light-input",placeholder:"Enter current password",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"New Password"}),e.jsx("input",{type:"password",value:m.newPassword,onChange:s=>P({...m,newPassword:s.target.value}),className:"light-input",placeholder:"Enter new password (min 8 characters)",minLength:8,required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Confirm New Password"}),e.jsx("input",{type:"password",value:m.confirmPassword,onChange:s=>P({...m,confirmPassword:s.target.value}),className:"light-input",placeholder:"Confirm new password",required:!0})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{type:"submit",className:"light-button-primary",children:"Update Password"}),e.jsx("button",{type:"button",onClick:()=>{U(!1),P({currentPassword:"",newPassword:"",confirmPassword:""})},className:"light-button-secondary",children:"Cancel"})]})]})})]}),e.jsxs("div",{className:"border-t border-gray-200 pt-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Clinic Information"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-700",children:"Clinic Name:"}),e.jsx("span",{className:"ml-2 text-gray-600",children:a.name})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-700",children:"Clinic Code:"}),e.jsx("span",{className:"ml-2 text-gray-600",children:a.code})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-700",children:"Plan:"}),e.jsx("span",{className:"ml-2 text-gray-600 capitalize",children:a.plan})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-700",children:"Region:"}),e.jsx("span",{className:"ml-2 text-gray-600",children:a.region})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-700",children:"Email:"}),e.jsx("span",{className:"ml-2 text-gray-600",children:a.email})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-700",children:"Contact:"}),e.jsx("span",{className:"ml-2 text-gray-600",children:a.contactNumber})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("span",{className:"font-medium text-gray-700",children:"Address:"}),e.jsx("span",{className:"ml-2 text-gray-600",children:a.address})]})]})]}),e.jsxs("div",{className:"border-t border-gray-200 pt-6 mt-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Support"}),e.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg",children:[e.jsxs("p",{className:"text-sm text-gray-700",children:[e.jsx("strong",{children:"Need Help?"})," Contact MOCARDS support at"," ",e.jsx("a",{href:"mailto:admin@mocards.cloud",className:"text-blue-600 hover:text-blue-700",children:"admin@mocards.cloud"})]}),e.jsx("p",{className:"text-xs text-gray-500 mt-2",children:"For password reset assistance, please include your clinic code and name in your message."})]})]})]})}),de&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsx("div",{className:"bg-white rounded-xl shadow-xl w-full max-w-md mx-4",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Redeem Perk"}),e.jsx("button",{onClick:()=>{D(!1),T(null),R("")},className:"text-gray-400 hover:text-gray-600",children:e.jsx(W,{className:"h-6 w-6"})})]}),e.jsxs("form",{onSubmit:Pe,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Card Control Number"}),e.jsx("input",{type:"text",value:w||"",disabled:!0,className:"light-input bg-gray-50"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Select Perk to Redeem"}),e.jsxs("select",{value:C,onChange:s=>R(s.target.value),className:"light-select",required:!0,children:[e.jsx("option",{value:"",children:"Choose a perk..."}),_.filter(s=>s.isActive).map(s=>e.jsxs("option",{value:s.id,children:[s.name," - ",s.description]},s.id))]})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsxs("button",{type:"submit",className:"btn-primary flex-1",disabled:!C,children:[e.jsx(X,{className:"h-4 w-4 mr-2"}),"Redeem Perk"]}),e.jsx("button",{type:"button",onClick:()=>{D(!1),T(null),R("")},className:"btn-secondary",children:"Cancel"})]})]})]})})}),oe&&M&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-xl w-full max-w-4xl mx-4 max-h-[90vh] overflow-hidden",children:[e.jsx("div",{className:"p-6 border-b border-gray-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Perk Redemption History"}),e.jsxs("p",{className:"text-sm text-gray-600",children:["Card: ",M]})]}),e.jsx("button",{onClick:()=>{Q(!1),K(null)},className:"text-gray-400 hover:text-gray-600",children:e.jsx(W,{className:"h-6 w-6"})})]})}),e.jsx("div",{className:"p-6 overflow-y-auto max-h-[70vh]",children:(()=>{const s=E.filter(t=>t.cardControlNumber===M);return s.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx(S,{className:"h-8 w-8 text-gray-400"})}),e.jsx("h4",{className:"text-lg font-medium text-gray-900 mb-2",children:"No Redemption History"}),e.jsx("p",{className:"text-gray-600",children:"This card has not been used to redeem any perks yet."})]}):e.jsxs("div",{className:"space-y-4",children:[s.map((t,l)=>e.jsxs("div",{className:"border border-gray-200 rounded-xl p-6 bg-gray-50",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-8 h-8 bg-green-100 rounded-full flex items-center justify-center",children:e.jsxs("span",{className:"text-green-600 font-bold text-sm",children:["#",s.length-l]})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-gray-900",children:t.perkName}),e.jsxs("p",{className:"text-sm text-gray-600",children:["Service: ",t.serviceType]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-sm font-medium text-gray-900",children:new Date(t.usedAt).toLocaleDateString()}),e.jsx("p",{className:"text-xs text-gray-500",children:new Date(t.usedAt).toLocaleTimeString()})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600 font-medium",children:"Claimant Name:"}),e.jsx("p",{className:"text-gray-900 mt-1",children:t.claimantName})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600 font-medium",children:"Handled By:"}),e.jsx("p",{className:"text-gray-900 mt-1",children:t.handledBy})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600 font-medium",children:"Value:"}),e.jsxs("p",{className:"text-gray-900 mt-1",children:["₱",t.value.toFixed(2)]})]})]}),t.notes&&e.jsxs("div",{className:"mt-4 p-3 bg-blue-50 rounded-lg",children:[e.jsx("span",{className:"text-blue-800 font-medium text-sm",children:"Notes:"}),e.jsx("p",{className:"text-blue-700 text-sm mt-1",children:t.notes})]}),e.jsx("div",{className:"mt-4 pt-4 border-t border-gray-200",children:e.jsxs("p",{className:"text-xs text-gray-500",children:["Redeemed on ",new Date(t.usedAt).toLocaleDateString("en-PH",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"})]})})]},t.id)),e.jsxs("div",{className:"mt-6 p-4 bg-blue-50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(X,{className:"h-5 w-5 text-blue-600"}),e.jsxs("span",{className:"font-semibold text-blue-900",children:["Total Redemptions: ",s.length]})]}),e.jsx("p",{className:"text-sm text-blue-700 mt-2",children:"This record provides proof of perk usage to prevent misuse and duplicate claims."})]})]})})()})]})})]})}export{Je as ClinicPortalView};
